"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[924],{1894:(e,t,n)=>{let r,i,o,s,a,l;n.d(t,{A:()=>Tr,C:()=>wU,E:()=>wW,O:()=>Tn,Q:()=>Th,S:()=>Z,X:()=>Tc,Y:()=>PU,a:()=>Te,b:()=>BS,c:()=>BO,d:()=>Tt,e:()=>Bw,f:()=>P$,g:()=>Bk,h:()=>c7,i:()=>PI,j:()=>Bx,k:()=>To,l:()=>PV,m:()=>kV,n:()=>Pl,o:()=>Bl,p:()=>UO,q:()=>Bt,r:()=>Uv,s:()=>C9,t:()=>Bv,u:()=>Bd,v:()=>Be,w:()=>Ux,x:()=>Bb});var c,h,u,d,f,p,m,g,y,b,v,x,w,k,O,S=n(840),C=n(8101),T=n(6049),A=n(525),E=n(1013).Buffer,M=Object.defineProperty,_=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D=(e,t,n)=>_(e,"symbol"!=typeof t?t+"":t,n);let N=(0,S.c)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),R=(0,S.c)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),P=(0,S.c)("CaseSensitive",[["path",{d:"m3 15 4-8 4 8",key:"1vwr6u"}],["path",{d:"M4 13h6",key:"1r9ots"}],["circle",{cx:"18",cy:"12",r:"3",key:"1kchzo"}],["path",{d:"M21 9v6",key:"anns31"}]]),j=(0,S.c)("ChartBar",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16h8",key:"srdodz"}],["path",{d:"M7 11h12",key:"127s9w"}],["path",{d:"M7 6h3",key:"w9rmul"}]]),I=(0,S.c)("ChartColumnIncreasing",[["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),$=(0,S.c)("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),L=(0,S.c)("ChartNoAxesCombined",[["path",{d:"M12 16v5",key:"zza2cw"}],["path",{d:"M16 14v7",key:"1g90b9"}],["path",{d:"M20 10v11",key:"1iqoj0"}],["path",{d:"m22 3-8.646 8.646a.5.5 0 0 1-.708 0L9.354 8.354a.5.5 0 0 0-.707 0L2 15",key:"1fw8x9"}],["path",{d:"M4 18v3",key:"1yp0dc"}],["path",{d:"M8 14v7",key:"n3cwzv"}]]),q=(0,S.c)("ChartScatter",[["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}],["circle",{cx:"18.5",cy:"5.5",r:".5",fill:"currentColor",key:"lysivs"}],["circle",{cx:"11.5",cy:"11.5",r:".5",fill:"currentColor",key:"byv1b8"}],["circle",{cx:"7.5",cy:"16.5",r:".5",fill:"currentColor",key:"nkw3mc"}],["circle",{cx:"17.5",cy:"14.5",r:".5",fill:"currentColor",key:"1gjh6j"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}]]),B=(0,S.c)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),F=(0,S.c)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),Q=(0,S.c)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),V=(0,S.c)("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]),W=(0,S.c)("Move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]),U=(0,S.c)("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),H=(0,S.c)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),G=(0,S.c)("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),X=(0,S.c)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),Z=(0,S.c)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Y=(0,S.c)("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]),J=(0,S.c)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),K=[],ee=[];function et(e){return e>=127462&&e<=127487}function en(e,t,n){if(t==e.length)return t;t&&ei(e.charCodeAt(t))&&eo(e.charCodeAt(t-1))&&t--;let r=er(e,t);for(t+=es(r);t<e.length;){let i=er(e,t);if(8205==r||8205==i||n&&function(e){if(e<768)return!1;for(let t=0,n=K.length;;){let r=t+n>>1;if(e<K[r])n=r;else{if(!(e>=ee[r]))return!0;t=r+1}if(t==n)return!1}}(i))t+=es(i),r=i;else if(et(i)){let n=0,r=t-2;for(;r>=0&&et(er(e,r));)n++,r-=2;if(n%2==0)break;t+=2}else break}return t}function er(e,t){let n=e.charCodeAt(t);if(!eo(n)||t+1==e.length)return n;let r=e.charCodeAt(t+1);return ei(r)?(n-55296<<10)+(r-56320)+65536:n}function ei(e){return e>=56320&&e<57344}function eo(e){return e>=55296&&e<56320}function es(e){return e<65536?1:2}(()=>{let e="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let t=0,n=0;t<e.length;t++)(t%2?ee:K).push(n+=e[t])})();let ea=class e{lineAt(e){if(e<0||e>this.length)throw RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=em(this,e,t);let r=[];return this.decompose(0,e,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(t,this.length,r,1),ec.from(r,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=em(this,e,t);let n=[];return this.decompose(e,t,n,0),ec.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),r=new eu(this),i=new eu(e);for(let e=t,o=t;;){if(r.next(e),i.next(e),e=0,r.lineBreak!=i.lineBreak||r.done!=i.done||r.value!=i.value)return!1;if(o+=r.value.length,r.done||o>=n)return!0}}iter(e=1){return new eu(this,e)}iterRange(e,t=this.length){return new ed(this,e,t)}iterLines(e,t){let n;if(null==e)n=this.iter();else{null==t&&(t=this.lines+1);let r=this.line(e).from;n=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new ef(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(t){if(0==t.length)throw RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new el(t):ec.from(el.split(t,[])):e.empty}};class el extends ea{constructor(e,t=function(e){let t=-1;for(let n of e)t+=n.length+1;return t}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,r){for(let i=0;;i++){let o=this.text[i],s=r+o.length;if((t?n:s)>=e)return new ep(r,s,n,o);r=s+1,n++}}decompose(e,t,n,r){let i=e<=0&&t>=this.length?this:new el(eh(this.text,[""],e,t),Math.min(t,this.length)-Math.max(0,e));if(1&r){let e=n.pop(),t=eh(i.text,e.text.slice(),0,i.length);if(t.length<=32)n.push(new el(t,e.length+i.length));else{let e=t.length>>1;n.push(new el(t.slice(0,e)),new el(t.slice(e)))}}else n.push(i)}replace(e,t,n){if(!(n instanceof el))return super.replace(e,t,n);[e,t]=em(this,e,t);let r=eh(this.text,eh(n.text,eh(this.text,[""],0,e)),t),i=this.length+n.length-(t-e);return r.length<=32?new el(r,i):ec.from(el.split(r,[]),i)}sliceString(e,t=this.length,n=`
`){[e,t]=em(this,e,t);let r="";for(let i=0,o=0;i<=t&&o<this.text.length;o++){let s=this.text[o],a=i+s.length;i>e&&o&&(r+=n),e<a&&t>i&&(r+=s.slice(Math.max(0,e-i),t-i)),i=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],r=-1;for(let i of e)n.push(i),r+=i.length+1,32==n.length&&(t.push(new el(n,r)),n=[],r=-1);return r>-1&&t.push(new el(n,r)),t}}let ec=class e extends ea{constructor(e,t){for(let n of(super(),this.children=e,this.length=t,this.lines=0,e))this.lines+=n.lines}lineInner(e,t,n,r){for(let i=0;;i++){let o=this.children[i],s=r+o.length,a=n+o.lines-1;if((t?a:s)>=e)return o.lineInner(e,t,n,r);r=s+1,n=a+1}}decompose(e,t,n,r){for(let i=0,o=0;o<=t&&i<this.children.length;i++){let s=this.children[i],a=o+s.length;if(e<=a&&t>=o){let i=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!i?n.push(s):s.decompose(e-o,t-o,n,i)}o=a+1}}replace(t,n,r){if([t,n]=em(this,t,n),r.lines<this.lines)for(let i=0,o=0;i<this.children.length;i++){let s=this.children[i],a=o+s.length;if(t>=o&&n<=a){let l=s.replace(t-o,n-o,r),c=this.lines-s.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let o=this.children.slice();return o[i]=l,new e(o,this.length-(n-t)+r.length)}return super.replace(o,a,l)}o=a+1}return super.replace(t,n,r)}sliceString(e,t=this.length,n=`
`){[e,t]=em(this,e,t);let r="";for(let i=0,o=0;i<this.children.length&&o<=t;i++){let s=this.children[i],a=o+s.length;o>e&&i&&(r+=n),e<a&&t>o&&(r+=s.sliceString(e-o,t-o,n)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(t,n){if(!(t instanceof e))return 0;let r=0,[i,o,s,a]=n>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;i+=n,o+=n){if(i==s||o==a)return r;let e=this.children[i],l=t.children[o];if(e!=l)return r+e.scanIdentical(l,n);r+=e.length+1}}static from(t,n=t.reduce((e,t)=>e+t.length+1,-1)){let r=0;for(let e of t)r+=e.lines;if(r<32){let e=[];for(let n of t)n.flatten(e);return new el(e,n)}let i=Math.max(32,r>>5),o=i<<1,s=i>>1,a=[],l=0,c=-1,h=[];function u(){0!=l&&(a.push(1==h.length?h[0]:e.from(h,c)),c=-1,l=h.length=0)}for(let n of t)!function t(n){let r;if(n.lines>o&&n instanceof e)for(let e of n.children)t(e);else n.lines>s&&(l>s||!l)?(u(),a.push(n)):n instanceof el&&l&&(r=h[h.length-1])instanceof el&&n.lines+r.lines<=32?(l+=n.lines,c+=n.length+1,h[h.length-1]=new el(r.text.concat(n.text),r.length+1+n.length)):(l+n.lines>i&&u(),l+=n.lines,c+=n.length+1,h.push(n))}(n);return u(),1==a.length?a[0]:new e(a,n)}};function eh(e,t,n=0,r=1e9){for(let i=0,o=0,s=!0;o<e.length&&i<=r;o++){let a=e[o],l=i+a.length;l>=n&&(l>r&&(a=a.slice(0,r-i)),i<n&&(a=a.slice(n-i)),s?(t[t.length-1]+=a,s=!1):t.push(a)),i=l+1}return t}ea.empty=new el([""],0);class eu{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof el?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,r=this.nodes[n],i=this.offsets[n],o=i>>1,s=r instanceof el?r.text.length:r.children.length;if(o==(t>0?s:0)){if(0==n)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&i)==(t>0?0:1)){if(this.offsets[n]+=t,0==e)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof el){let i=r.text[o+(t<0?-1:0)];if(this.offsets[n]+=t,i.length>Math.max(0,e))return this.value=0==e?i:t>0?i.slice(e):i.slice(0,i.length-e),this;e-=i.length}else{let i=r.children[o+(t<0?-1:0)];e>i.length?(e-=i.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(i),this.offsets.push(t>0?1:(i instanceof el?i.text.length:i.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class ed{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new eu(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=n?r:t<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class ef{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:r}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}"u">typeof Symbol&&(ea.prototype[Symbol.iterator]=function(){return this.iter()},eu.prototype[Symbol.iterator]=ed.prototype[Symbol.iterator]=ef.prototype[Symbol.iterator]=function(){return this});let ep=class{constructor(e,t,n,r){this.from=e,this.to=t,this.number=n,this.text=r}get length(){return this.to-this.from}};function em(e,t,n){return[t=Math.max(0,Math.min(e.length,t)),Math.max(t,Math.min(e.length,n))]}function eg(e,t,n=!0,r=!0){return function(e,t,n=!0,r=!0){return(n?en:function(e,t,n){for(;t>0;){let r=en(e,t-2,n);if(r<t)return r;t--}return 0})(e,t,r)}(e,t,n,r)}function ey(e,t){let n=e.charCodeAt(t);if(!(n>=55296&&n<56320)||t+1==e.length)return n;let r=e.charCodeAt(t+1);return r>=56320&&r<57344?(n-55296<<10)+(r-56320)+65536:n}function eb(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(((e-=65536)>>10)+55296,(1023&e)+56320)}function ev(e){return e<65536?1:2}let ex=/\r\n?|\n/;var ew=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(ew||(ew={}));class ek{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,r=0;t<this.sections.length;){let i=this.sections[t++],o=this.sections[t++];o<0?(e(n,r,i),r+=i):r+=o,n+=i}}iterChangedRanges(e,t=!1){eT(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];r<0?e.push(n,r):e.push(r,n)}return new ek(e)}composeDesc(e){return this.empty?e:e.empty?this:eE(this,e)}mapDesc(e,t=!1){return e.empty?this:eA(this,e,t)}mapPos(e,t=-1,n=ew.Simple){let r=0,i=0;for(let o=0;o<this.sections.length;){let s=this.sections[o++],a=this.sections[o++],l=r+s;if(a<0){if(l>e)return i+(e-r);i+=s}else{if(n!=ew.Simple&&l>=e&&(n==ew.TrackDel&&r<e&&l>e||n==ew.TrackBefore&&r<e||n==ew.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!s)return e==r||t<0?i:i+a;i+=a}r=l}if(e>r)throw RangeError(`Position ${e} is out of range for changeset of length ${r}`);return i}touchesRange(e,t=e){for(let n=0,r=0;n<this.sections.length&&r<=t;){let i=this.sections[n++],o=this.sections[n++],s=r+i;if(o>=0&&r<=t&&s>=e)return!(r<e)||!(s>t)||"cover";r=s}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+n+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(e=>"number"!=typeof e))throw RangeError("Invalid JSON representation of ChangeDesc");return new ek(e)}static create(e){return new ek(e)}}class eO extends ek{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw RangeError("Applying change set to a document with the wrong length");return eT(this,(t,n,r,i,o)=>e=e.replace(r,r+(n-t),o),!1),e}mapDesc(e,t=!1){return eA(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let r=0,i=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s>=0){t[r]=s,t[r+1]=o;let a=r>>1;for(;n.length<a;)n.push(ea.empty);n.push(o?e.slice(i,i+o):ea.empty)}i+=o}return new eO(t,n)}compose(e){return this.empty?e:e.empty?this:eE(this,e,!0)}map(e,t=!1){return e.empty?this:eA(this,e,t,!0)}iterChanges(e,t=!1){eT(this,e,t)}get desc(){return ek.create(this.sections)}filter(e){let t=[],n=[],r=[],i=new eM(this);e:for(let o=0,s=0;;){let a=o==e.length?1e9:e[o++];for(;s<a||s==a&&0==i.len;){if(i.done)break e;let e=Math.min(i.len,a-s);eS(r,e,-1);let o=-1==i.ins?-1:0==i.off?i.ins:0;eS(t,e,o),o>0&&eC(n,t,i.text),i.forward(e),s+=e}let l=e[o++];for(;s<l;){if(i.done)break e;let e=Math.min(i.len,l-s);eS(t,e,-1),eS(r,e,-1==i.ins?-1:0==i.off?i.ins:0),i.forward(e),s+=e}}return{changes:new eO(t,n),filtered:ek.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],r=this.sections[t+1];r<0?e.push(n):0==r?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let r=[],i=[],o=0,s=null;function a(e=!1){if(!e&&!r.length)return;o<t&&eS(r,t-o,-1);let n=new eO(r,i);s=s?s.compose(n.map(s)):n,r=[],i=[],o=0}return function e(l){if(Array.isArray(l))for(let t of l)e(t);else if(l instanceof eO){if(l.length!=t)throw RangeError(`Mismatched change set length (got ${l.length}, expected ${t})`);a(),s=s?s.compose(l.map(s)):l}else{let{from:e,to:s=e,insert:c}=l;if(e>s||e<0||s>t)throw RangeError(`Invalid change range ${e} to ${s} (in doc of length ${t})`);let h=c?"string"==typeof c?ea.of(c.split(n||ex)):c:ea.empty,u=h.length;if(e==s&&0==u)return;e<o&&a(),e>o&&eS(r,e-o,-1),eS(r,s-e,u),eC(i,r,h),o=s}}(e),a(!s),s}static empty(e){return new eO(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let r=0;r<e.length;r++){let i=e[r];if("number"==typeof i)t.push(i,-1);else{if(!Array.isArray(i)||"number"!=typeof i[0]||i.some((e,t)=>t&&"string"!=typeof e))throw RangeError("Invalid JSON representation of ChangeSet");if(1==i.length)t.push(i[0],0);else{for(;n.length<r;)n.push(ea.empty);n[r]=ea.of(i.slice(1)),t.push(i[0],n[r].length)}}}return new eO(t,n)}static createSet(e,t){return new eO(e,t)}}function eS(e,t,n,r=!1){if(0==t&&n<=0)return;let i=e.length-2;i>=0&&n<=0&&n==e[i+1]?e[i]+=t:i>=0&&0==t&&0==e[i]?e[i+1]+=n:r?(e[i]+=t,e[i+1]+=n):e.push(t,n)}function eC(e,t,n){if(0==n.length)return;let r=t.length-2>>1;if(r<e.length)e[e.length-1]=e[e.length-1].append(n);else{for(;e.length<r;)e.push(ea.empty);e.push(n)}}function eT(e,t,n){let r=e.inserted;for(let i=0,o=0,s=0;s<e.sections.length;){let a=e.sections[s++],l=e.sections[s++];if(l<0)i+=a,o+=a;else{let c=i,h=o,u=ea.empty;for(;c+=a,h+=l,l&&r&&(u=u.append(r[s-2>>1])),!(n||s==e.sections.length||e.sections[s+1]<0);)a=e.sections[s++],l=e.sections[s++];t(i,c,o,h,u),i=c,o=h}}}function eA(e,t,n,r=!1){let i=[],o=r?[]:null,s=new eM(e),a=new eM(t);for(let e=-1;;){if(s.done&&a.len||a.done&&s.len)throw Error("Mismatched change set lengths");if(-1==s.ins&&-1==a.ins){let e=Math.min(s.len,a.len);eS(i,e,-1),s.forward(e),a.forward(e)}else if(a.ins>=0&&(s.ins<0||e==s.i||0==s.off&&(a.len<s.len||a.len==s.len&&!n))){let t=a.len;for(eS(i,a.ins,-1);t;){let n=Math.min(s.len,t);s.ins>=0&&e<s.i&&s.len<=n&&(eS(i,0,s.ins),o&&eC(o,i,s.text),e=s.i),s.forward(n),t-=n}a.next()}else if(s.ins>=0){let t=0,n=s.len;for(;n;)if(-1==a.ins){let e=Math.min(n,a.len);t+=e,n-=e,a.forward(e)}else if(0==a.ins&&a.len<n)n-=a.len,a.next();else break;eS(i,t,e<s.i?s.ins:0),o&&e<s.i&&eC(o,i,s.text),e=s.i,s.forward(s.len-n)}else{if(s.done&&a.done)return o?eO.createSet(i,o):ek.create(i);throw Error("Mismatched change set lengths")}}}function eE(e,t,n=!1){let r=[],i=n?[]:null,o=new eM(e),s=new eM(t);for(let e=!1;;){if(o.done&&s.done)return i?eO.createSet(r,i):ek.create(r);if(0==o.ins)eS(r,o.len,0,e),o.next();else if(0!=s.len||s.done){if(o.done||s.done)throw Error("Mismatched change set lengths");{let t=Math.min(o.len2,s.len),n=r.length;if(-1==o.ins){let n=-1==s.ins?-1:s.off?0:s.ins;eS(r,t,n,e),i&&n&&eC(i,r,s.text)}else -1==s.ins?(eS(r,o.off?0:o.len,t,e),i&&eC(i,r,o.textBit(t))):(eS(r,o.off?0:o.len,s.off?0:s.ins,e),i&&!s.off&&eC(i,r,s.text));e=(o.ins>t||s.ins>=0&&s.len>t)&&(e||r.length>n),o.forward2(t),s.forward(t)}}else eS(r,0,s.ins,e),i&&eC(i,r,s.text),s.next()}}class eM{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return -2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?ea.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?ea.empty:t[n].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}let e_=class e{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let e=7&this.flags;return 7==e?null:e}get goalColumn(){let e=this.flags>>6;return 0xffffff==e?void 0:e}map(t,n=-1){let r,i;return this.empty?r=i=t.mapPos(this.from,n):(r=t.mapPos(this.from,1),i=t.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new e(r,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return eD.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return eD.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw RangeError("Invalid JSON representation for SelectionRange");return eD.range(e.anchor,e.head)}static create(t,n,r){return new e(t,n,r)}};class eD{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:eD.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new eD([this.main],0)}addRange(e,t=!0){return eD.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,eD.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw RangeError("Invalid JSON representation for EditorSelection");return new eD(e.ranges.map(e=>e_.fromJSON(e)),e.main)}static single(e,t=e){return new eD([eD.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw RangeError("A selection needs at least one range");for(let n=0,r=0;r<e.length;r++){let i=e[r];if(i.empty?i.from<=n:i.from<n)return eD.normalized(e.slice(),t);n=i.to}return new eD(e,t)}static cursor(e,t=0,n,r){return e_.create(e,e,(0==t?0:t<0?8:16)|(null==n?7:Math.min(6,n))|(r??0xffffff)<<6)}static range(e,t,n,r){let i=(n??0xffffff)<<6|(null==r?7:Math.min(6,r));return t<e?e_.create(t,e,48|i):e_.create(e,t,(t>e?8:0)|i)}static normalized(e,t=0){let n=e[t];e.sort((e,t)=>e.from-t.from),t=e.indexOf(n);for(let n=1;n<e.length;n++){let r=e[n],i=e[n-1];if(r.empty?r.from<=i.to:r.from<i.to){let o=i.from,s=Math.max(r.to,i.to);n<=t&&t--,e.splice(--n,2,r.anchor>r.head?eD.range(s,o):eD.range(o,s))}}return new eD(e,t)}}function eN(e,t){for(let n of e.ranges)if(n.to>t)throw RangeError("Selection points outside of document")}let eR=0;class eP{constructor(e,t,n,r,i){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=r,this.id=eR++,this.default=e([]),this.extensions="function"==typeof i?i(this):i}get reader(){return this}static define(e={}){return new eP(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(e.combine?(e,t)=>e===t:ej),!!e.static,e.enables)}of(e){return new eI([],this,0,e)}compute(e,t){if(this.isStatic)throw Error("Can't compute a static facet");return new eI(e,this,1,t)}computeN(e,t){if(this.isStatic)throw Error("Can't compute a static facet");return new eI(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],n=>t(n.field(e)))}}function ej(e,t){return e==t||e.length==t.length&&e.every((e,n)=>e===t[n])}class eI{constructor(e,t,n,r){this.dependencies=e,this.facet=t,this.type=n,this.value=r,this.id=eR++}dynamicSlot(e){var t;let n=this.value,r=this.facet.compareInput,i=this.id,o=e[i]>>1,s=2==this.type,a=!1,l=!1,c=[];for(let n of this.dependencies)"doc"==n?a=!0:"selection"==n?l=!0:(null!==(t=e[n.id])&&void 0!==t?t:1)&1||c.push(e[n.id]);return{create:e=>(e.values[o]=n(e),1),update(e,t){if(a&&t.docChanged||l&&(t.docChanged||t.selection)||eL(e,c)){let t=n(e);if(s?!e$(t,e.values[o],r):!r(t,e.values[o]))return e.values[o]=t,1}return 0},reconfigure:(e,t)=>{let a,l=t.config.address[i];if(null!=l){let i=eX(t,l);if(this.dependencies.every(n=>n instanceof eP?t.facet(n)===e.facet(n):!(n instanceof ez)||t.field(n,!1)==e.field(n,!1))||(s?e$(a=n(e),i,r):r(a=n(e),i)))return e.values[o]=i,0}else a=n(e);return e.values[o]=a,1}}}}function e$(e,t,n){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function eL(e,t){let n=!1;for(let r of t)1&eG(e,r)&&(n=!0);return n}let eq=eP.define({static:!0});class ez{constructor(e,t,n,r,i){this.id=e,this.createF=t,this.updateF=n,this.compareF=r,this.spec=i,this.provides=void 0}static define(e){let t=new ez(eR++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(eq).find(e=>e.field==this);return((null==t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>(e.values[t]=this.create(e),1),update:(e,n)=>{let r=e.values[t],i=this.updateF(r,n);return this.compareF(r,i)?0:(e.values[t]=i,1)},reconfigure:(e,n)=>{let r=e.facet(eq),i=n.facet(eq),o;return(o=r.find(e=>e.field==this))&&o!=i.find(e=>e.field==this)?(e.values[t]=o.create(e),1):null!=n.config.address[this.id]?(e.values[t]=n.field(this),0):(e.values[t]=this.create(e),1)}}}init(e){return[this,eq.of({field:this,create:e})]}get extension(){return this}}let eB={lowest:4,low:3,default:2,high:1,highest:0};function eF(e){return t=>new eV(t,e)}let eQ={highest:eF(eB.highest),high:eF(eB.high),default:eF(eB.default),low:eF(eB.low),lowest:eF(eB.lowest)};class eV{constructor(e,t){this.inner=e,this.prec=t}}class eW{of(e){return new eU(this,e)}reconfigure(e){return eW.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class eU{constructor(e,t){this.compartment=e,this.inner=t}}let eH=class e{constructor(e,t,n,r,i,o){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=r,this.staticValues=i,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(t,n,r){let i,o,s=[],a=Object.create(null),l=new Map;for(let e of(i=[[],[],[],[],[]],o=new Map,function e(t,r){let s=o.get(t);if(null!=s){if(s<=r)return;let e=i[s].indexOf(t);e>-1&&i[s].splice(e,1),t instanceof eU&&l.delete(t.compartment)}if(o.set(t,r),Array.isArray(t))for(let n of t)e(n,r);else if(t instanceof eU){if(l.has(t.compartment))throw RangeError("Duplicate use of compartment in extensions");let i=n.get(t.compartment)||t.inner;l.set(t.compartment,i),e(i,r)}else if(t instanceof eV)e(t.inner,t.prec);else if(t instanceof ez)i[r].push(t),t.provides&&e(t.provides,r);else if(t instanceof eI)i[r].push(t),t.facet.extensions&&e(t.facet.extensions,eB.default);else{let n=t.extension;if(!n)throw Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);e(n,r)}}(t,eB.default),i.reduce((e,t)=>e.concat(t))))e instanceof ez?s.push(e):(a[e.facet.id]||(a[e.facet.id]=[])).push(e);let c=Object.create(null),h=[],u=[];for(let e of s)c[e.id]=u.length<<1,u.push(t=>e.slot(t));let d=null==r?void 0:r.config.facets;for(let e in a){let t=a[e],n=t[0].facet,i=d&&d[e]||[];if(t.every(e=>0==e.type)){if(c[n.id]=h.length<<1|1,ej(i,t))h.push(r.facet(n));else{let e=n.combine(t.map(e=>e.value));h.push(r&&n.compare(e,r.facet(n))?r.facet(n):e)}}else{for(let e of t)0==e.type?(c[e.id]=h.length<<1|1,h.push(e.value)):(c[e.id]=u.length<<1,u.push(t=>e.dynamicSlot(t)));c[n.id]=u.length<<1,u.push(e=>(function(e,t,n){let r=n.map(t=>e[t.id]),i=n.map(e=>e.type),o=r.filter(e=>!(1&e)),s=e[t.id]>>1;function a(e){let n=[];for(let t=0;t<r.length;t++){let o=eX(e,r[t]);if(2==i[t])for(let e of o)n.push(e);else n.push(o)}return t.combine(n)}return{create(e){for(let t of r)eG(e,t);return e.values[s]=a(e),1},update(e,n){if(!eL(e,o))return 0;let r=a(e);return t.compare(r,e.values[s])?0:(e.values[s]=r,1)},reconfigure(e,i){let o=eL(e,r),l=i.config.facets[t.id],c=i.facet(t);if(l&&!o&&ej(n,l))return e.values[s]=c,0;let h=a(e);return t.compare(h,c)?(e.values[s]=c,0):(e.values[s]=h,1)}}})(e,n,t))}}return new e(t,l,u.map(e=>e(c)),c,h,a)}};function eG(e,t){if(1&t)return 2;let n=t>>1,r=e.status[n];if(4==r)throw Error("Cyclic dependency between fields and/or facets");if(2&r)return r;e.status[n]=4;let i=e.computeSlot(e,e.config.dynamicSlots[n]);return e.status[n]=2|i}function eX(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}let eZ=eP.define(),eY=eP.define({combine:e=>e.some(e=>e),static:!0}),eJ=eP.define({combine:e=>e.length?e[0]:void 0,static:!0}),eK=eP.define(),e0=eP.define(),e1=eP.define(),e2=eP.define({combine:e=>!!e.length&&e[0]});class e5{constructor(e,t){this.type=e,this.value=t}static define(){return new e3}}class e3{of(e){return new e5(this,e)}}class e4{constructor(e){this.map=e}of(e){return new e6(this,e)}}class e6{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new e6(this.type,t)}is(e){return this.type==e}static define(e={}){return new e4(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let r of e){let e=r.map(t);e&&n.push(e)}return n}}e6.reconfigure=e6.define(),e6.appendConfig=e6.define();let e8=class e{constructor(t,n,r,i,o,s){this.startState=t,this.changes=n,this.selection=r,this.effects=i,this.annotations=o,this.scrollIntoView=s,this._doc=null,this._state=null,r&&eN(r,n.newLength),o.some(t=>t.type==e.time)||(this.annotations=o.concat(e.time.of(Date.now())))}static create(t,n,r,i,o,s){return new e(t,n,r,i,o,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let n=this.annotation(e.userEvent);return!!(n&&(n==t||n.length>t.length&&n.slice(0,t.length)==t&&"."==n[t.length]))}};function e9(e,t,n){var r;let i,o,s;return n?(i=t.changes,o=eO.empty(t.changes.length),s=e.changes.compose(t.changes)):(i=t.changes.map(e.changes),o=e.changes.mapDesc(t.changes,!0),s=e.changes.compose(i)),{changes:s,selection:t.selection?t.selection.map(o):null===(r=e.selection)||void 0===r?void 0:r.map(i),effects:e6.mapEffects(e.effects,i).concat(e6.mapEffects(t.effects,o)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function e7(e,t,n){let r=t.selection,i=tt(t.annotations);return t.userEvent&&(i=i.concat(e8.userEvent.of(t.userEvent))),{changes:t.changes instanceof eO?t.changes:eO.of(t.changes||[],n,e.facet(eJ)),selection:r&&(r instanceof eD?r:eD.single(r.anchor,r.head)),effects:tt(t.effects),annotations:i,scrollIntoView:!!t.scrollIntoView}}e8.time=e5.define(),e8.userEvent=e5.define(),e8.addToHistory=e5.define(),e8.remote=e5.define();let te=[];function tt(e){return null==e?te:Array.isArray(e)?e:[e]}var tn=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(tn||(tn={}));let tr=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{r=RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}let ti=class e{constructor(e,t,n,r,i,o){this.config=e,this.doc=t,this.selection=n,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=i,o&&(o._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)eG(this,e<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(null==n){if(t)throw RangeError("Field is not present in this state");return}return eG(this,n),eX(this,n)}update(...e){return function e(t,n,r){let i=e7(t,n.length?n[0]:{},t.doc.length);n.length&&!1===n[0].filter&&(r=!1);for(let e=1;e<n.length;e++){!1===n[e].filter&&(r=!1);let o=!!n[e].sequential;i=e9(i,e7(t,n[e],o?i.changes.newLength:t.doc.length),o)}let o=e8.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return function(e){let t=e.startState,n=t.facet(e1),r=e;for(let i=n.length-1;i>=0;i--){let o=n[i](e);o&&Object.keys(o).length&&(r=e9(r,e7(t,o,e.changes.newLength),!0))}return r==e?e:e8.create(t,e.changes,e.selection,r.effects,r.annotations,r.scrollIntoView)}(r?function(t){let n=t.startState,r=!0;for(let e of n.facet(eK)){let n=e(t);if(!1===n){r=!1;break}Array.isArray(n)&&(r=!0===r?n:function(e,t){let n=[];for(let r=0,i=0;;){let o,s;if(r<e.length&&(i==t.length||t[i]>=e[r]))o=e[r++],s=e[r++];else{if(!(i<t.length))return n;o=t[i++],s=t[i++]}!n.length||n[n.length-1]<o?n.push(o,s):n[n.length-1]<s&&(n[n.length-1]=s)}}(r,n))}if(!0!==r){let e,i;if(!1===r)i=t.changes.invertedDesc,e=eO.empty(n.doc.length);else{let n=t.changes.filter(r);e=n.changes,i=n.filtered.mapDesc(n.changes).invertedDesc}t=e8.create(n,e,t.selection&&t.selection.map(i),e6.mapEffects(t.effects,i),t.annotations,t.scrollIntoView)}let i=n.facet(e0);for(let r=i.length-1;r>=0;r--){let o=i[r](t);t=o instanceof e8?o:Array.isArray(o)&&1==o.length&&o[0]instanceof e8?o[0]:e(n,tt(o),!1)}return t}(o):o)}(this,e,!0)}applyTransaction(t){let n,r=this.config,{base:i,compartments:o}=r;for(let e of t.effects)e.is(eW.reconfigure)?(r&&(o=new Map,r.compartments.forEach((e,t)=>o.set(t,e)),r=null),o.set(e.value.compartment,e.value.extension)):e.is(e6.reconfigure)?(r=null,i=e.value):e.is(e6.appendConfig)&&(r=null,i=tt(i).concat(e.value));n=r?t.startState.values.slice():new e(r=eH.resolve(i,o,this),this.doc,this.selection,r.dynamicSlots.map(()=>null),(e,t)=>t.reconfigure(e,this),null).values;let s=t.startState.facet(eY)?t.newSelection:t.newSelection.asSingle();new e(r,t.newDoc,s,n,(e,n)=>n.update(e,t),t)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:eD.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),r=this.changes(n.changes),i=[n.range],o=tt(n.effects);for(let n=1;n<t.ranges.length;n++){let s=e(t.ranges[n]),a=this.changes(s.changes),l=a.map(r);for(let e=0;e<n;e++)i[e]=i[e].map(l);let c=r.mapDesc(a,!0);i.push(s.range.map(c)),r=r.compose(l),o=e6.mapEffects(o,l).concat(e6.mapEffects(tt(s.effects),c))}return{changes:r,selection:eD.create(i,t.mainIndex),effects:o}}changes(t=[]){return t instanceof eO?t:eO.of(t,this.doc.length,this.facet(e.lineSeparator))}toText(t){return ea.of(t.split(this.facet(e.lineSeparator)||ex))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(eG(this,t),eX(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let r=e[n];r instanceof ez&&null!=this.config.address[r.id]&&(t[n]=r.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(t,n={},r){if(!t||"string"!=typeof t.doc)throw RangeError("Invalid JSON representation for EditorState");let i=[];if(r){for(let e in r)if(Object.prototype.hasOwnProperty.call(t,e)){let n=r[e],o=t[e];i.push(n.init(e=>n.spec.fromJSON(o,e)))}}return e.create({doc:t.doc,selection:eD.fromJSON(t.selection),extensions:n.extensions?i.concat([n.extensions]):i})}static create(t={}){let n=eH.resolve(t.extensions||[],new Map),r=t.doc instanceof ea?t.doc:ea.of((t.doc||"").split(n.staticFacet(e.lineSeparator)||ex)),i=t.selection?t.selection instanceof eD?t.selection:eD.single(t.selection.anchor,t.selection.head):eD.single(0);return eN(i,r.length),n.staticFacet(eY)||(i=i.asSingle()),new e(n,r,i,n.dynamicSlots.map(()=>null),(e,t)=>t.create(e),null)}get tabSize(){return this.facet(e.tabSize)}get lineBreak(){return this.facet(e.lineSeparator)||`
`}get readOnly(){return this.facet(e2)}phrase(t,...n){for(let n of this.facet(e.phrases))if(Object.prototype.hasOwnProperty.call(n,t)){t=n[t];break}return n.length&&(t=t.replace(/\$(\$|\d*)/g,(e,t)=>{if("$"==t)return"$";let r=+(t||1);return!r||r>n.length?e:n[r-1]})),t}languageDataAt(e,t,n=-1){let r=[];for(let i of this.facet(eZ))for(let o of i(this,t,n))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){var t;return t=this.languageDataAt("wordChars",e).join(""),e=>{if(!/\S/.test(e))return tn.Space;if(function(e){if(r)return r.test(e);for(let t=0;t<e.length;t++){let n=e[t];if(/\w/.test(n)||n>"\x80"&&(n.toUpperCase()!=n.toLowerCase()||tr.test(n)))return!0}return!1}(e))return tn.Word;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return tn.Word;return tn.Other}}wordAt(e){let{text:t,from:n,length:r}=this.doc.lineAt(e),i=this.charCategorizer(e),o=e-n,s=e-n;for(;o>0;){let e=eg(t,o,!1);if(i(t.slice(e,o))!=tn.Word)break;o=e}for(;s<r;){let e=eg(t,s);if(i(t.slice(s,e))!=tn.Word)break;s=e}return o==s?null:eD.range(o+n,s+n)}};function to(e,t,n={}){let r={};for(let t of e)for(let e of Object.keys(t)){let i=t[e],o=r[e];if(void 0===o)r[e]=i;else if(!(o===i||void 0===i)){if(Object.hasOwnProperty.call(n,e))r[e]=n[e](o,i);else throw Error("Config merge conflict for field "+e)}}for(let e in t)void 0===r[e]&&(r[e]=t[e]);return r}ti.allowMultipleSelections=eY,ti.tabSize=eP.define({combine:e=>e.length?e[0]:4}),ti.lineSeparator=eJ,ti.readOnly=e2,ti.phrases=eP.define({compare(e,t){let n=Object.keys(e),r=Object.keys(t);return n.length==r.length&&n.every(n=>e[n]==t[n])}}),ti.languageData=eZ,ti.changeFilter=eK,ti.transactionFilter=e0,ti.transactionExtender=e1,eW.reconfigure=e6.define();class ts{eq(e){return this==e}range(e,t=e){return ta.create(e,t,this)}}ts.prototype.startSide=ts.prototype.endSide=0,ts.prototype.point=!1,ts.prototype.mapMode=ew.TrackDel;let ta=class e{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(t,n,r){return new e(t,n,r)}};function tl(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class tc{constructor(e,t,n,r){this.from=e,this.to=t,this.value=n,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,r=0){let i=n?this.to:this.from;for(let o=r,s=i.length;;){if(o==s)return o;let r=o+s>>1,a=i[r]-e||(n?this.value[r].endSide:this.value[r].startSide)-t;if(r==o)return a>=0?o:s;a>=0?s=r:o=r+1}}between(e,t,n,r){for(let i=this.findIndex(t,-1e9,!0),o=this.findIndex(n,1e9,!1,i);i<o;i++)if(!1===r(this.from[i]+e,this.to[i]+e,this.value[i]))return!1}map(e,t){let n=[],r=[],i=[],o=-1,s=-1;for(let a=0;a<this.value.length;a++){let l=this.value[a],c=this.from[a]+e,h=this.to[a]+e,u,d;if(c==h){let e=t.mapPos(c,l.startSide,l.mapMode);if(null==e||(u=d=e,l.startSide!=l.endSide&&(d=t.mapPos(c,l.endSide))<u))continue}else if((u=t.mapPos(c,l.startSide))>(d=t.mapPos(h,l.endSide))||u==d&&l.startSide>0&&l.endSide<=0)continue;0>(d-u||l.endSide-l.startSide)||(o<0&&(o=u),l.point&&(s=Math.max(s,d-u)),n.push(l),r.push(u-o),i.push(d-o))}return{mapped:n.length?new tc(r,i,n,s):null,pos:o}}}class th{constructor(e,t,n,r){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=r}static create(e,t,n,r){return new th(e,t,n,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:r=0,filterTo:i=this.length}=e,o=e.filter;if(0==t.length&&!o)return this;if(n&&(t=t.slice().sort(tl)),this.isEmpty)return t.length?th.of(t):this;let s=new tf(this,null,-1).goto(0),a=0,l=[],c=new tu;for(;s.value||a<t.length;)if(a<t.length&&(s.from-t[a].from||s.startSide-t[a].value.startSide)>=0){let e=t[a++];c.addInner(e.from,e.to,e.value)||l.push(e)}else 1==s.rangeIndex&&s.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(s.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(s.chunkIndex)||i<this.chunkPos[s.chunkIndex])&&c.addChunk(this.chunkPos[s.chunkIndex],this.chunk[s.chunkIndex])?s.nextChunk():((!o||r>s.to||i<s.from||o(s.from,s.to,s.value))&&(c.addInner(s.from,s.to,s.value)||l.push(ta.create(s.from,s.to,s.value))),s.next());return c.finishInner(this.nextLayer.isEmpty&&!l.length?th.empty:this.nextLayer.update({add:l,filter:o,filterFrom:r,filterTo:i}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],r=-1;for(let i=0;i<this.chunk.length;i++){let o=this.chunkPos[i],s=this.chunk[i],a=e.touchesRange(o,o+s.length);if(!1===a)r=Math.max(r,s.maxPoint),t.push(s),n.push(e.mapPos(o));else if(!0===a){let{mapped:i,pos:a}=s.map(o,e);i&&(r=Math.max(r,i.maxPoint),t.push(i),n.push(a))}}let i=this.nextLayer.map(e);return 0==t.length?i:new th(n,t,i||th.empty,r)}between(e,t,n){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let i=this.chunkPos[r],o=this.chunk[r];if(t>=i&&e<=i+o.length&&!1===o.between(i,e-i,t-i,n))return}this.nextLayer.between(e,t,n)}}iter(e=0){return tp.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return tp.from(e).goto(t)}static compare(e,t,n,r,i=-1){let o=e.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i),s=t.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i),a=td(o,s,n),l=new tg(o,a,i),c=new tg(s,a,i);n.iterGaps((e,t,n)=>ty(l,e,c,t,n,r)),n.empty&&0==n.length&&ty(l,0,c,0,0,r)}static eq(e,t,n=0,r){null==r&&(r=0x3b9ac9ff);let i=e.filter(e=>!e.isEmpty&&0>t.indexOf(e)),o=t.filter(t=>!t.isEmpty&&0>e.indexOf(t));if(i.length!=o.length)return!1;if(!i.length)return!0;let s=td(i,o),a=new tg(i,s,0).goto(n),l=new tg(o,s,0).goto(n);for(;;){if(a.to!=l.to||!tb(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>r)return!0;a.next(),l.next()}}static spans(e,t,n,r,i=-1){let o=new tg(e,null,i).goto(t),s=t,a=o.openStart;for(;;){let e=Math.min(o.to,n);if(o.point){let n=o.activeForPoint(o.to),i=o.pointFrom<t?n.length+1:o.point.startSide<0?n.length:Math.min(n.length,a);r.point(s,e,o.point,n,i,o.pointRank),a=Math.min(o.openEnd(e),n.length)}else e>s&&(r.span(s,e,o.active,a),a=o.openEnd(e));if(o.to>n)return a+(o.point&&o.to>n?1:0);s=o.to,o.next()}}static of(e,t=!1){let n=new tu;for(let r of e instanceof ta?[e]:t?function(e){if(e.length>1)for(let t=e[0],n=1;n<e.length;n++){let r=e[n];if(tl(t,r)>0)return e.slice().sort(tl);t=r}return e}(e):e)n.add(r.from,r.to,r.value);return n.finish()}static join(e){if(!e.length)return th.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let r=e[n];r!=th.empty;r=r.nextLayer)t=new th(r.chunkPos,r.chunk,t,Math.max(r.maxPoint,t.maxPoint));return t}}th.empty=new th([],[],null,-1),th.empty.nextLayer=th.empty;class tu{finishChunk(e){this.chunks.push(new tc(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new tu)).add(e,t,n)}addInner(e,t,n){let r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&0>(e-this.lastFrom||n.startSide-this.last.startSide))throw Error("Ranges must be added sorted by `from` position and `startSide`");return!(r<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if(0>(e-this.lastTo||t.value[0].startSide-this.last.endSide))return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(th.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=th.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function td(e,t,n){let r=new Map;for(let t of e)for(let e=0;e<t.chunk.length;e++)t.chunk[e].maxPoint<=0&&r.set(t.chunk[e],t.chunkPos[e]);let i=new Set;for(let e of t)for(let t=0;t<e.chunk.length;t++){let o=r.get(e.chunk[t]);null==o||(n?n.mapPos(o):o)!=e.chunkPos[t]||null!=n&&n.touchesRange(o,o+e.chunk[t].length)||i.add(e.chunk[t])}return i}class tf{constructor(e,t,n,r=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){0>(this.to-e||this.endSide-t)&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class tp{constructor(e){this.heap=e}static from(e,t=null,n=-1){let r=[];for(let i=0;i<e.length;i++)for(let o=e[i];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&r.push(new tf(o,t,n,i));return 1==r.length?r[0]:new tp(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let e=this.heap.length>>1;e>=0;e--)tm(this.heap,e);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let e=this.heap.length>>1;e>=0;e--)tm(this.heap,e);0>(this.to-e||this.value.endSide-t)&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),tm(this.heap,0)}}}function tm(e,t){for(let n=e[t];;){let r=(t<<1)+1;if(r>=e.length)break;let i=e[r];if(r+1<e.length&&i.compare(e[r+1])>=0&&(i=e[r+1],r++),0>n.compare(i))break;e[r]=n,e[t]=i,t=r}}class tg{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=tp.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&0>(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t);)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){tv(this.active,e),tv(this.activeTo,e),tv(this.activeRank,e),this.minActive=tw(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:r,rank:i}=this.cursor;for(;t<this.activeRank.length&&(i-this.activeRank[t]||r-this.activeTo[t])>0;)t++;tx(this.active,t,n),tx(this.activeTo,t,r),tx(this.activeRank,t,i),e&&tx(e,t,this.cursor.from),this.minActive=tw(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&0>(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&tv(n,r)}else if(this.cursor.value){if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let e=this.cursor.value;if(e.point){if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=e,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=e.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else this.addActive(n),this.cursor.next()}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let t=n.length-1;t>=0&&n[t]<e;t--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function ty(e,t,n,r,i,o){e.goto(t),n.goto(r);let s=r+i,a=r,l=r-t;for(;;){let t=e.to+l-n.to,r=t||e.endSide-n.endSide,i=r<0?e.to+l:n.to,c=Math.min(i,s);if(e.point||n.point?e.point&&n.point&&(e.point==n.point||e.point.eq(n.point))&&tb(e.activeForPoint(e.to),n.activeForPoint(n.to))||o.comparePoint(a,c,e.point,n.point):c>a&&!tb(e.active,n.active)&&o.compareRange(a,c,e.active,n.active),i>s)break;(t||e.openEnd!=n.openEnd)&&o.boundChange&&o.boundChange(i),a=i,r<=0&&e.next(),r>=0&&n.next()}}function tb(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n]&&!e[n].eq(t[n]))return!1;return!0}function tv(e,t){for(let n=t,r=e.length-1;n<r;n++)e[n]=e[n+1];e.pop()}function tx(e,t,n){for(let n=e.length-1;n>=t;n--)e[n+1]=e[n];e[t]=n}function tw(e,t){let n=-1,r=1e9;for(let i=0;i<t.length;i++)0>(t[i]-r||e[i].endSide-e[n].endSide)&&(n=i,r=t[i]);return n}function tk(e,t,n=e.length){let r=0;for(let i=0;i<n&&i<e.length;)9==e.charCodeAt(i)?(r+=t-r%t,i++):(r++,i=eg(e,i));return r}function tO(e,t,n,r){for(let r=0,i=0;;){if(i>=t)return r;if(r==e.length)break;i+=9==e.charCodeAt(r)?n-i%n:1,r=eg(e,r)}return!0===r?-1:e.length}function tS(e,t){let n=0;for(let t of e)null!=t&&(t=+t)>=t&&++n;return n}function tC(e){return 0|e.length}function tT(e){return!(e>0)}function tA(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function tE(e,t){let n=0,r,i=0,o=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(r=t-i,i+=r/++n,o+=r*(t-i));else{let s=-1;for(let a of e)null!=(a=t(a,++s,e))&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}function tM(e,t){let n=tE(e,t);return n&&Math.sqrt(n)}function t_(e,t){let n,r;if(void 0===t)for(let t of e)null!=t&&(void 0===n?t>=t&&(n=r=t):(n>t&&(n=t),r<t&&(r=t)));else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class tD{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let t=this._partials,n=0;for(let r=0;r<this._n&&r<32;r++){let i=t[r],o=e+i,s=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);s&&(t[n++]=s),e=o}return t[n]=e,this._n=n+1,this}valueOf(){let e=this._partials,t=this._n,n,r,i,o=0;if(t>0){for(o=e[--t];t>0&&(o=(n=o)+(r=e[--t]),!(i=r-(o-n))););t>0&&(i<0&&e[t-1]<0||i>0&&e[t-1]>0)&&(n=o+(r=2*i),r==n-o&&(o=n))}return o}}class tN extends Map{constructor(e,t=t$){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,n]of e)this.set(t,n)}get(e){return super.get(tP(this,e))}has(e){return super.has(tP(this,e))}set(e,t){return super.set(tj(this,e),t)}delete(e){return super.delete(tI(this,e))}}class tR extends Set{constructor(e,t=t$){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let t of e)this.add(t)}has(e){return super.has(tP(this,e))}add(e){return super.add(tj(this,e))}delete(e){return super.delete(tI(this,e))}}function tP({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):n}function tj({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function tI({_intern:e,_key:t},n){let r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function t$(e){return null!==e&&"object"==typeof e?e.valueOf():e}function tL(e){return e}function tq(e,...t){return tB(e,tL,tL,t)}function tz(e,t,...n){return tB(e,tL,t,n)}function tB(e,t,n,r){return function e(i,o){if(o>=r.length)return n(i);let s=new tN,a=r[o++],l=-1;for(let e of i){let t=a(e,++l,i),n=s.get(t);n?n.push(e):s.set(t,[e])}for(let[t,n]of s)s.set(t,e(n,o));return t(s)}(e,0)}function tF(e,...t){if("function"!=typeof e[Symbol.iterator])throw TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&2!==n.length||t.length>1){var r;let i=Uint32Array.from(e,(e,t)=>t);return t.length>1?(t=t.map(t=>e.map(t)),i.sort((e,n)=>{for(let r of t){let t=tV(r[e],r[n]);if(t)return t}})):(n=e.map(n),i.sort((e,t)=>tV(n[e],n[t]))),r=e,Array.from(i,e=>r[e])}return e.sort(tQ(n))}function tQ(e=S.s){if(e===S.s)return tV;if("function"!=typeof e)throw TypeError("compare is not a function");return(t,n)=>{let r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function tV(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function tW(e,t,n){return(2!==t.length?tF(tz(e,t,n),([e,t],[n,r])=>(0,S.s)(t,r)||(0,S.s)(e,n)):tF(tq(e,n),([e,n],[r,i])=>t(n,i)||(0,S.s)(e,r))).map(([e])=>e)}let tU=Math.sqrt(50),tH=Math.sqrt(10),tG=Math.sqrt(2);function tX(e,t,n){let r,i,o;let s=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(s)),l=s/Math.pow(10,a),c=l>=tU?10:l>=tH?5:l>=tG?2:1;return a<0?(r=Math.round(e*(o=Math.pow(10,-a)/c)),i=Math.round(t*o),r/o<e&&++r,i/o>t&&--i,o=-o):(r=Math.round(e/(o=Math.pow(10,a)*c)),i=Math.round(t/o),r*o<e&&++r,i*o>t&&--i),i<r&&.5<=n&&n<2?tX(e,t,2*n):[r,i,o]}function tZ(e,t,n){if(t=+t,e=+e,!((n=+n)>0))return[];if(e===t)return[e];let r=t<e,[i,o,s]=r?tX(t,e,n):tX(e,t,n);if(!(o>=i))return[];let a=o-i+1,l=Array(a);if(r){if(s<0)for(let e=0;e<a;++e)l[e]=-((o-e)/s);else for(let e=0;e<a;++e)l[e]=(o-e)*s}else if(s<0)for(let e=0;e<a;++e)l[e]=-((i+e)/s);else for(let e=0;e<a;++e)l[e]=(i+e)*s;return l}function tY(e,t,n){return tX(e=+e,t=+t,n=+n)[2]}function tJ(e,t,n){t=+t,e=+e,n=+n;let r=t<e,i=r?tY(t,e,n):tY(e,t,n);return(r?-1:1)*(i<0?-(1/i):i)}function tK(e){return Math.max(1,Math.ceil(Math.log(tS(e))/Math.LN2)+1)}function t0(e,t){let n;if(void 0===t)for(let t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function t1(e,t){let n,r=-1,i=-1;if(void 0===t)for(let t of e)++i,null!=t&&(n<t||void 0===n&&t>=t)&&(n=t,r=i);else for(let o of e)null!=(o=t(o,++i,e))&&(n<o||void 0===n&&o>=o)&&(n=o,r=i);return r}function t2(e,t){let n;if(void 0===t)for(let t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function t5(e,t){let n,r=-1,i=-1;if(void 0===t)for(let t of e)++i,null!=t&&(n>t||void 0===n&&t>=t)&&(n=t,r=i);else for(let o of e)null!=(o=t(o,++i,e))&&(n>o||void 0===n&&o>=o)&&(n=o,r=i);return r}function t3(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function t4(e,t=S.s){let n,r=!1;if(1===t.length){let i;for(let o of e){let e=t(o);(r?(0,S.s)(e,i)>0:0===(0,S.s)(e,e))&&(n=o,i=e,r=!0)}}else for(let i of e)(r?t(i,n)>0:0===t(i,i))&&(n=i,r=!0);return n}function t6(e,t,n){if(!(!(r=(e=Float64Array.from((0,S.v)(e,n))).length)||isNaN(t=+t))){if(t<=0||r<2)return t2(e);if(t>=1)return t0(e);var r,i=(r-1)*t,o=Math.floor(i),s=t0((function e(t,n,r=0,i=1/0,o){if(n=Math.floor(n),r=Math.floor(Math.max(0,r)),i=Math.floor(Math.min(t.length-1,i)),!(r<=n&&n<=i))return t;for(o=void 0===o?tV:tQ(o);i>r;){if(i-r>600){let s=i-r+1,a=n-r+1,l=Math.log(s),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1),u=Math.max(r,Math.floor(n-a*c/s+h)),d=Math.min(i,Math.floor(n+(s-a)*c/s+h));e(t,n,u,d,o)}let s=t[n],a=r,l=i;for(t3(t,r,n),o(t[i],s)>0&&t3(t,r,i);a<l;){for(t3(t,a,l),++a,--l;0>o(t[a],s);)++a;for(;o(t[l],s)>0;)--l}0===o(t[r],s)?t3(t,r,l):t3(t,++l,i),l<=n&&(r=l+1),n<=l&&(i=l-1)}return t})(e,o).subarray(0,o+1));return s+(t2(e.subarray(o+1))-s)*(i-o)}}function t8(e,t,n){let r=tS(e),i=t6(e,.75)-t6(e,.25);return r&&i?Math.ceil((n-t)/(2*i*Math.pow(r,-1/3))):1}function t9(e,t,n){let r=tS(e),i=tM(e);return r&&i?Math.ceil((n-t)*Math.cbrt(r)/(3.49*i)):1}function t7(e,t){return t6(e,.5,t)}function ne(e){return Array.from(function*(e){for(let t of e)yield*t}(e))}function nt(e,t){let n=new tN;if(void 0===t)for(let t of e)null!=t&&t>=t&&n.set(t,(n.get(t)||0)+1);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&i>=i&&n.set(i,(n.get(i)||0)+1)}let r,i=0;for(let[e,t]of n)t>i&&(i=t,r=e);return r}function nn(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function nr(e){if("function"!=typeof e[Symbol.iterator])throw TypeError("values is not iterable");return Array.from(e).reverse()}function ni(e){return e}function no(e){return"translate("+e+",0)"}function ns(){return!this.__axis}function na(e){return"string"==typeof e?new S.w([[document.querySelector(e)]],[document.documentElement]):new S.w([[e]],S.x)}let nl=Math.PI/180,nc=180/Math.PI,nh=4/29,nu=6/29,nd=6/29*3*(6/29),nf=6/29*(6/29)*(6/29);function np(e){if(e instanceof ng)return new ng(e.l,e.a,e.b,e.opacity);if(e instanceof nk)return nO(e);e instanceof S.R||(e=(0,S.y)(e));var t,n,r=nx(e.r),i=nx(e.g),o=nx(e.b),s=ny((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?t=n=s:(t=ny((.4360747*r+.3850649*i+.1430804*o)/.96422),n=ny((.0139322*r+.0971045*i+.7141733*o)/.82521)),new ng(116*s-16,500*(t-s),200*(s-n),e.opacity)}function nm(e,t,n,r){return 1==arguments.length?np(e):new ng(e,t,n,r??1)}function ng(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function ny(e){return e>nf?Math.pow(e,1/3):e/nd+nh}function nb(e){return e>nu?e*e*e:nd*(e-nh)}function nv(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function nx(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function nw(e,t,n,r){return 1==arguments.length?function(e){if(e instanceof nk)return new nk(e.h,e.c,e.l,e.opacity);if(e instanceof ng||(e=np(e)),0===e.a&&0===e.b)return new nk(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*nc;return new nk(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new nk(e,t,n,r??1)}function nk(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function nO(e){if(isNaN(e.h))return new ng(e.l,0,0,e.opacity);var t=e.h*nl;return new ng(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}(0,S.z)(ng,nm,(0,S.A)(S.E,{brighter(e){return new ng(this.l+18*(e??1),this.a,this.b,this.opacity)},darker(e){return new ng(this.l-18*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=.96422*nb(t),e=1*nb(e),n=.82521*nb(n),new S.R(nv(3.1338561*t-1.6168667*e-.4906146*n),nv(-.9787684*t+1.9161415*e+.033454*n),nv(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),(0,S.z)(nk,nw,(0,S.A)(S.E,{brighter(e){return new nk(this.h,this.c,this.l+18*(e??1),this.opacity)},darker(e){return new nk(this.h,this.c,this.l-18*(e??1),this.opacity)},rgb(){return nO(this).rgb()}}));var nS=-1.78277*.29227-.1347134789;function nC(e,t,n,r){return 1==arguments.length?function(e){if(e instanceof nT)return new nT(e.h,e.s,e.l,e.opacity);e instanceof S.R||(e=(0,S.y)(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(nS*r+-1.7884503806*t-3.5172982438*n)/(nS+-1.7884503806-3.5172982438),o=r-i,s=-((1.97294*(n-i)- -.29227*o)/.90649),a=Math.sqrt(s*s+o*o)/(1.97294*i*(1-i)),l=a?Math.atan2(s,o)*nc-120:NaN;return new nT(l<0?l+360:l,a,i,e.opacity)}(e):new nT(e,t,n,r??1)}function nT(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function nA(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?(0,S.J)(t):("number"===i?S.L:"string"===i?(r=(0,S.P)(t))?(t=r,S.N):S.O:t instanceof S.P?S.N:t instanceof Date?function(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}:!ArrayBuffer.isView(n=t)||n instanceof DataView?Array.isArray(t)?function(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=Array(i),s=Array(r);for(n=0;n<i;++n)o[n]=nA(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<i;++n)s[n]=o[n](e);return s}}:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var n,r={},i={};for(n in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)n in e?r[n]=nA(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}:S.L:function(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}})(e,t)}function nE(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}(0,S.z)(nT,nC,(0,S.A)(S.E,{brighter(e){return e=null==e?S.H:Math.pow(S.H,e),new nT(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?S.G:Math.pow(S.G,e),new nT(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*nl,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new S.R(255*(t+n*(-.14861*r+1.78277*i)),255*(t+n*(-.29227*r+-.90649*i)),255*(t+1.97294*r*n),this.opacity)}}));let nM=(rq=S.V,function(e,t){var n=rq((e=(0,S.Q)(e)).h,(t=(0,S.Q)(t)).h),r=(0,S.U)(e.s,t.s),i=(0,S.U)(e.l,t.l),o=(0,S.U)(e.opacity,t.opacity);return function(t){return e.h=n(t),e.s=r(t),e.l=i(t),e.opacity=o(t),e+""}}),n_=(rz=S.V,function(e,t){var n=rz((e=nw(e)).h,(t=nw(t)).h),r=(0,S.U)(e.c,t.c),i=(0,S.U)(e.l,t.l),o=(0,S.U)(e.opacity,t.opacity);return function(t){return e.h=n(t),e.c=r(t),e.l=i(t),e.opacity=o(t),e+""}});function nD(e){return function t(n){function r(t,r){var i=e((t=nC(t)).h,(r=nC(r)).h),o=(0,S.U)(t.s,r.s),s=(0,S.U)(t.l,r.l),a=(0,S.U)(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=s(Math.pow(e,n)),t.opacity=a(e),t+""}}return n=+n,r.gamma=t,r}(1)}nD(S.V);var nN=nD(S.U);function nR(e,t){void 0===t&&(t=e,e=nA);for(var n=0,r=t.length-1,i=t[0],o=Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}function nP(e,t){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}let nj=Math.PI,nI=2*nj,n$=nI-1e-6;function nL(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class nq{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?nL:function(e){let t=Math.floor(e);if(!(t>=0))throw Error(`invalid digits: ${e}`);if(t>15)return nL;let n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,o){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw Error(`negative radius: ${i}`);let o=this._x1,s=this._y1,a=n-e,l=r-t,c=o-e,h=s-t,u=c*c+h*h;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(u>1e-6){if(Math.abs(h*a-l*c)>1e-6&&i){let d=n-o,f=r-s,p=a*a+l*l,m=Math.sqrt(p),g=Math.sqrt(u),y=i*Math.tan((nj-Math.acos((p+u-(d*d+f*f))/(2*m*g)))/2),b=y/g,v=y/m;Math.abs(b-1)>1e-6&&this._append`L${e+b*c},${t+b*h}`,this._append`A${i},${i},0,0,${+(h*d>c*f)},${this._x1=e+v*a},${this._y1=t+v*l}`}else this._append`L${this._x1=e},${this._y1=t}`}}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw Error(`negative radius: ${n}`);let s=n*Math.cos(r),a=n*Math.sin(r),l=e+s,c=t+a,h=1^o,u=o?r-i:i-r;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&this._append`L${l},${c}`,n&&(u<0&&(u=u%nI+nI),u>n$?this._append`A${n},${n},0,1,${h},${e-s},${t-a}A${n},${n},0,1,${h},${this._x1=l},${this._y1=c}`:u>1e-6&&this._append`A${n},${n},0,${+(u>=nj)},${h},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function nz(e=3){return new nq(+e)}function nB(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function nF(e){return(e=nB(Math.abs(e)))?e[1]:NaN}var nQ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function nV(e){var t;if(!(t=nQ.exec(e)))throw Error("invalid format: "+e);return new nW({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function nW(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function nU(e,t){var n=nB(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+Array(i-r.length+2).join("0")}nV.prototype=nW.prototype,nW.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let nH={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>nU(100*e,t),r:nU,s:function(e,t){var n=nB(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(rB=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+Array(1-o).join("0")+nB(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function nG(e){return e}var nX=Array.prototype.map,nZ=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];rQ=(rF=function(e){var t,n,r,i=void 0===e.grouping||void 0===e.thousands?nG:(t=nX.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],s=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(e.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),o=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",l=void 0===e.numerals?nG:(r=nX.call(e.numerals,String),function(e){return e.replace(/[0-9]/g,function(e){return r[+e]})}),c=void 0===e.percent?"%":e.percent+"",h=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=nV(e)).fill,n=e.align,r=e.sign,d=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,y=e.trim,b=e.type;"n"===b?(m=!0,b="g"):nH[b]||(void 0===g&&(g=12),y=!0,b="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var v="$"===d?o:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===d?s:/[%p]/.test(b)?c:"",w=nH[b],k=/[defgprs%]/.test(b);function O(e){var o,s,c,d=v,O=x;if("c"===b)O=w(e)+O,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:w(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==r&&(S=!1),d=(S?"("===r?r:h:"-"===r||"("===r?"":r)+d,O=("s"===b?nZ[8+rB/3]:"")+O+(S&&"("===r?")":""),k){for(o=-1,s=e.length;++o<s;)if(48>(c=e.charCodeAt(o))||c>57){O=(46===c?a+e.slice(o+1):e.slice(o))+O,e=e.slice(0,o);break}}}m&&!f&&(e=i(e,1/0));var C=d.length+e.length+O.length,T=C<p?Array(p-C+1).join(t):"";switch(m&&f&&(e=i(T+e,T.length?p-O.length:1/0),T=""),n){case"<":e=d+e+O+T;break;case"=":e=d+T+e+O;break;case"^":e=T.slice(0,C=T.length>>1)+d+e+O+T.slice(C);break;default:e=T+d+e+O}return l(e)}return g=void 0===g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),O.toString=function(){return e+""},O}return{format:d,formatPrefix:function(e,t){var n=d(((e=nV(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(nF(t)/3))),i=Math.pow(10,-r),o=nZ[8+r/3];return function(e){return n(i*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]})).format,rV=rF.formatPrefix;var nY=Math.PI,nJ=nY/2,nK=nY/4,n0=2*nY,n1=180/nY,n2=nY/180,n5=Math.abs,n3=Math.atan,n4=Math.atan2,n6=Math.cos,n8=Math.exp,n9=Math.log,n7=Math.pow,re=Math.sin,rt=Math.sign||function(e){return e>0?1:e<0?-1:0},rn=Math.sqrt,rr=Math.tan;function ri(e){return e>1?0:e<-1?nY:Math.acos(e)}function ro(e){return e>1?nJ:e<-1?-nJ:Math.asin(e)}function rs(){}function ra(e,t){e&&rc.hasOwnProperty(e.type)&&rc[e.type](e,t)}var rl={Feature:function(e,t){ra(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)ra(n[r].geometry,t)}},rc={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){rh(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)rh(n[r],t,0)},Polygon:function(e,t){ru(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)ru(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)ra(n[r],t)}};function rh(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function ru(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)rh(e[n],t,1);t.polygonEnd()}function rd(e,t){e&&rl.hasOwnProperty(e.type)?rl[e.type](e,t):ra(e,t)}function rf(e){return[n4(e[1],e[0]),ro(e[2])]}function rp(e){var t=e[0],n=e[1],r=n6(n);return[r*n6(t),r*re(t),re(n)]}function rm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function rg(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function ry(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function rb(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function rv(e){var t=rn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function rx(e,t){function n(n,r){return t((n=e(n,r))[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function rw(e,t){return n5(e)>nY&&(e-=Math.round(e/n0)*n0),[e,t]}function rk(e,t,n){return(e%=n0)?t||n?rx(rS(e),rC(t,n)):rS(e):t||n?rC(t,n):rw}function rO(e){return function(t,n){return n5(t+=e)>nY&&(t-=Math.round(t/n0)*n0),[t,n]}}function rS(e){var t=rO(e);return t.invert=rO(-e),t}function rC(e,t){var n=n6(e),r=re(e),i=n6(t),o=re(t);function s(e,t){var s=n6(t),a=n6(e)*s,l=re(e)*s,c=re(t),h=c*n+a*r;return[n4(l*i-h*o,a*n-c*r),ro(h*i+l*o)]}return s.invert=function(e,t){var s=n6(t),a=n6(e)*s,l=re(e)*s,c=re(t),h=c*i-l*o;return[n4(l*i+c*o,a*n+h*r),ro(h*n-a*r)]},s}function rT(e,t){t=rp(t),t[0]-=e,rv(t);var n=ri(-t[1]);return((0>-t[2]?-n:n)+n0-1e-6)%n0}function rA(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:rs,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function rE(e,t){return 1e-6>n5(e[0]-t[0])&&1e-6>n5(e[1]-t[1])}function rM(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function r_(e,t,n,r,i){var o,s,a=[],l=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],s=e[t];if(rE(r,s)){if(!r[2]&&!s[2]){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);i.lineEnd();return}s[0]+=2e-6}a.push(n=new rM(r,e,null,!0)),l.push(n.o=new rM(r,null,n,!1)),a.push(n=new rM(s,e,null,!1)),l.push(n.o=new rM(s,null,n,!0))}}),a.length){for(l.sort(t),rD(a),rD(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var c,h,u=a[0];;){for(var d=u,f=!0;d.v;)if((d=d.n)===u)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(o=0,s=c.length;o<s;++o)i.point((h=c[o])[0],h[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(o=(c=d.p.z).length-1;o>=0;--o)i.point((h=c[o])[0],h[1]);else r(d.x,d.p.x,-1,i);d=d.p}c=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function rD(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function rN(e){return n5(e[0])<=nY?e[0]:rt(e[0])*((n5(e[0])+nY)%n0-nY)}function rR(e,t,n,r){return function(i){var o,s,a,l=t(i),c=rA(),h=t(c),u=!1,d={point:f,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=v,s=[],o=[]},polygonEnd:function(){d.point=f,d.lineStart=m,d.lineEnd=g,s=ne(s);var e=function(e,t){var n=rN(t),r=t[1],i=re(r),o=[re(n),-n6(n),0],s=0,a=0,l=new tD;1===i?r=nJ+1e-6:-1===i&&(r=-nJ-1e-6);for(var c=0,h=e.length;c<h;++c)if(d=(u=e[c]).length)for(var u,d,f=u[d-1],p=rN(f),m=f[1]/2+nK,g=re(m),y=n6(m),b=0;b<d;++b,p=x,g=k,y=O,f=v){var v=u[b],x=rN(v),w=v[1]/2+nK,k=re(w),O=n6(w),S=x-p,C=S>=0?1:-1,T=C*S,A=T>nY,E=g*k;if(l.add(n4(E*C*re(T),y*O+E*n6(T))),s+=A?S+C*n0:S,A^p>=n^x>=n){var M=rg(rp(f),rp(v));rv(M);var _=rg(o,M);rv(_);var D=(A^S>=0?-1:1)*ro(_[2]);(r>D||r===D&&(M[0]||M[1]))&&(a+=A^S>=0?1:-1)}}return(s<-1e-6||s<1e-6&&l<-1e-12)^1&a}(o,r);s.length?(u||(i.polygonStart(),u=!0),r_(s,rj,e,n,i)):e&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),s=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(t,n){e(t,n)&&i.point(t,n)}function p(e,t){l.point(e,t)}function m(){d.point=p,l.lineStart()}function g(){d.point=f,l.lineEnd()}function y(e,t){a.push([e,t]),h.point(e,t)}function b(){h.lineStart(),a=[]}function v(){y(a[0][0],a[0][1]),h.lineEnd();var e,t,n,r,l=h.clean(),d=c.result(),f=d.length;if(a.pop(),o.push(a),a=null,f){if(1&l){if((t=(n=d[0]).length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}return}f>1&&2&l&&d.push(d.pop().concat(d.shift())),s.push(d.filter(rP))}}return d}}function rP(e){return e.length>1}function rj(e,t){return((e=e.x)[0]<0?e[1]-nJ-1e-6:nJ-e[1])-((t=t.x)[0]<0?t[1]-nJ-1e-6:nJ-t[1])}rw.invert=rw;let rI=rR(function(){return!0},function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,s){var a,l,c,h,u,d,f=o>0?nY:-nY,p=n5(o-n);1e-6>n5(p-nY)?(e.point(n,r=(r+s)/2>0?nJ:-nJ),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(f,r),e.point(o,r),t=0):i!==f&&p>=nY&&(1e-6>n5(n-i)&&(n-=1e-6*i),1e-6>n5(o-f)&&(o-=1e-6*f),a=n,l=r,r=n5(d=re(a-(c=o)))>1e-6?n3((re(l)*(u=n6(s))*re(c)-re(s)*(h=n6(l))*re(a))/(h*u*d)):(l+s)/2,e.point(i,r),e.lineEnd(),e.lineStart(),e.point(f,r),t=0),e.point(n=o,r=s),i=f},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}},function(e,t,n,r){var i;if(null==e)i=n*nJ,r.point(-nY,i),r.point(0,i),r.point(nY,i),r.point(nY,0),r.point(nY,-i),r.point(0,-i),r.point(-nY,-i),r.point(-nY,0),r.point(-nY,i);else if(n5(e[0]-t[0])>1e-6){var o=e[0]<t[0]?nY:-nY;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])},[-nY,-nJ]);function r$(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,a,c){var h=0,u=0;if(null==i||(h=s(i,a))!==(u=s(o,a))||0>l(i,o)^a>0)do c.point(0===h||3===h?e:n,h>1?r:t);while((h=(h+a+4)%4)!==u);else c.point(o[0],o[1])}function s(r,i){return 1e-6>n5(r[0]-e)?i>0?0:3:1e-6>n5(r[0]-n)?i>0?2:1:1e-6>n5(r[1]-t)?i>0?1:0:i>0?3:2}function a(e,t){return l(e.x,t.x)}function l(e,t){var n=s(e,1),r=s(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(s){var l,c,h,u,d,f,p,m,g,y,b,v=s,x=rA(),w={point:k,lineStart:function(){w.point=O,c&&c.push(h=[]),y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(O(u,d),f&&g&&x.rejoin(),l.push(x.result())),w.point=k,g&&v.lineEnd()},polygonStart:function(){v=x,l=[],c=[],b=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=c.length;n<i;++n)for(var o,s,a=c[n],l=1,h=a.length,u=a[0],d=u[0],f=u[1];l<h;++l)o=d,s=f,d=(u=a[l])[0],f=u[1],s<=r?f>r&&(d-o)*(r-s)>(f-s)*(e-o)&&++t:f<=r&&(d-o)*(r-s)<(f-s)*(e-o)&&--t;return t}(),n=b&&t,i=(l=ne(l)).length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),i&&r_(l,a,t,o,s),s.polygonEnd()),v=s,l=c=h=null}};function k(e,t){i(e,t)&&v.point(e,t)}function O(o,s){var a=i(o,s);if(c&&h.push([o,s]),y)u=o,d=s,f=a,y=!1,a&&(v.lineStart(),v.point(o,s));else if(a&&g)v.point(o,s);else{var l=[p=Math.max(-1e9,Math.min(1e9,p)),m=Math.max(-1e9,Math.min(1e9,m))],x=[o=Math.max(-1e9,Math.min(1e9,o)),s=Math.max(-1e9,Math.min(1e9,s))];!function(e,t,n,r,i,o){var s,a=e[0],l=e[1],c=t[0],h=t[1],u=0,d=1,f=c-a,p=h-l;if(s=n-a,!(!f&&s>0)){if(s/=f,f<0){if(s<u)return;s<d&&(d=s)}else if(f>0){if(s>d)return;s>u&&(u=s)}if(s=i-a,!(!f&&s<0)){if(s/=f,f<0){if(s>d)return;s>u&&(u=s)}else if(f>0){if(s<u)return;s<d&&(d=s)}if(s=r-l,!(!p&&s>0)){if(s/=p,p<0){if(s<u)return;s<d&&(d=s)}else if(p>0){if(s>d)return;s>u&&(u=s)}if(s=o-l,!(!p&&s<0)){if(s/=p,p<0){if(s>d)return;s>u&&(u=s)}else if(p>0){if(s<u)return;s<d&&(d=s)}return u>0&&(e[0]=a+u*f,e[1]=l+u*p),d<1&&(t[0]=a+d*f,t[1]=l+d*p),!0}}}}}(l,x,e,t,n,r)?a&&(v.lineStart(),v.point(o,s),b=!1):(g||(v.lineStart(),v.point(l[0],l[1])),v.point(x[0],x[1]),a||v.lineEnd(),b=!1)}p=o,m=s,g=a}return w}}let rL=e=>e;var rq,rz,rB,rF,rQ,rV,rW,rU,rH,rG,rX=new tD,rZ=new tD,rY={point:rs,lineStart:rs,lineEnd:rs,polygonStart:function(){rY.lineStart=rJ,rY.lineEnd=r1},polygonEnd:function(){rY.lineStart=rY.lineEnd=rY.point=rs,rX.add(n5(rZ)),rZ=new tD},result:function(){var e=rX/2;return rX=new tD,e}};function rJ(){rY.point=rK}function rK(e,t){rY.point=r0,rW=rH=e,rU=rG=t}function r0(e,t){rZ.add(rG*e-rH*t),rH=e,rG=t}function r1(){r0(rW,rU)}var r2,r5,r3,r4,r6=1/0,r8=1/0,r9=-1/0,r7=r9,ie={point:function(e,t){e<r6&&(r6=e),e>r9&&(r9=e),t<r8&&(r8=t),t>r7&&(r7=t)},lineStart:rs,lineEnd:rs,polygonStart:rs,polygonEnd:rs,result:function(){var e=[[r6,r8],[r9,r7]];return r9=r7=-(r8=r6=1/0),e}},ir=0,ii=0,io=0,is=0,ia=0,il=0,ic=0,ih=0,iu=0,id={point:ip,lineStart:im,lineEnd:ib,polygonStart:function(){id.lineStart=iv,id.lineEnd=ix},polygonEnd:function(){id.point=ip,id.lineStart=im,id.lineEnd=ib},result:function(){var e=iu?[ic/iu,ih/iu]:il?[is/il,ia/il]:io?[ir/io,ii/io]:[NaN,NaN];return ir=ii=io=is=ia=il=ic=ih=iu=0,e}};function ip(e,t){ir+=e,ii+=t,++io}function im(){id.point=ig}function ig(e,t){id.point=iy,ip(r3=e,r4=t)}function iy(e,t){var n=e-r3,r=t-r4,i=rn(n*n+r*r);is+=i*(r3+e)/2,ia+=i*(r4+t)/2,il+=i,ip(r3=e,r4=t)}function ib(){id.point=ip}function iv(){id.point=iw}function ix(){ik(r2,r5)}function iw(e,t){id.point=ik,ip(r2=r3=e,r5=r4=t)}function ik(e,t){var n=e-r3,r=t-r4,i=rn(n*n+r*r);is+=i*(r3+e)/2,ia+=i*(r4+t)/2,il+=i,ic+=(i=r4*e-r3*t)*(r3+e),ih+=i*(r4+t),iu+=3*i,ip(r3=e,r4=t)}function iO(e){this._context=e}iO.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,n0)}},result:rs};var iS,iC,iT,iA,iE,iM=new tD,i_={point:rs,lineStart:function(){i_.point=iD},lineEnd:function(){iS&&iN(iC,iT),i_.point=rs},polygonStart:function(){iS=!0},polygonEnd:function(){iS=null},result:function(){var e=+iM;return iM=new tD,e}};function iD(e,t){i_.point=iN,iC=iA=e,iT=iE=t}function iN(e,t){iA-=e,iE-=t,iM.add(rn(iA*iA+iE*iE)),iA=e,iE=t}class iR{constructor(e){this._append=null==e?iP:function(e){let t=Math.floor(e);if(!(t>=0))throw RangeError(`invalid digits: ${e}`);if(t>15)return iP;if(t!==i){let e=10**t;i=t,o=function(t){let n=1;this._+=t[0];for(let r=t.length;n<r;++n)this._+=Math.round(arguments[n]*e)/e+t[n]}}return o}(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:this._append`M${e},${t}`,this._point=1;break;case 1:this._append`L${e},${t}`;break;default:if(this._append`M${e},${t}`,this._radius!==s||this._append!==o){let e=this._radius,t=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,s=e,o=this._append,a=this._,this._=t}this._+=a}}result(){let e=this._;return this._="",e.length?e:null}}function iP(e){let t=1;this._+=e[0];for(let n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function ij(e,t){let n=3,r=4.5,i,o;function s(e){return e&&("function"==typeof r&&o.pointRadius(+r.apply(this,arguments)),rd(e,i(o))),o.result()}return s.area=function(e){return rd(e,i(rY)),rY.result()},s.measure=function(e){return rd(e,i(i_)),i_.result()},s.bounds=function(e){return rd(e,i(ie)),ie.result()},s.centroid=function(e){return rd(e,i(id)),id.result()},s.projection=function(t){return arguments.length?(i=null==t?(e=null,rL):(e=t).stream,s):e},s.context=function(e){return arguments.length?(o=null==e?(t=null,new iR(n)):new iO(t=e),"function"!=typeof r&&o.pointRadius(r),s):t},s.pointRadius=function(e){return arguments.length?(r="function"==typeof e?e:(o.pointRadius(+e),+e),s):r},s.digits=function(e){if(!arguments.length)return n;if(null==e)n=null;else{let t=Math.floor(e);if(!(t>=0))throw RangeError(`invalid digits: ${e}`);n=t}return null===t&&(o=new iR(n)),s},s.projection(e).digits(n).context(t)}function iI(e){return{stream:i$(e)}}function i$(e){return function(t){var n=new iL;for(var r in e)n[r]=e[r];return n.stream=t,n}}function iL(){}function iq(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),rd(n,e.stream(ie)),t(ie.result()),null!=r&&e.clipExtent(r),e}function iz(e,t,n){return iq(e,function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),s=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,a=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([s,a])},n)}function iB(e,t,n){return iz(e,[[0,0],t],n)}function iF(e,t,n){return iq(e,function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,s=-i*n[0][1];e.scale(150*i).translate([o,s])},n)}function iQ(e,t,n){return iq(e,function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],s=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,s])},n)}iL.prototype={constructor:iL,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var iV=n6(30*n2);function iW(e,t){return+t?function(e,t){function n(r,i,o,s,a,l,c,h,u,d,f,p,m,g){var y=c-r,b=h-i,v=y*y+b*b;if(v>4*t&&m--){var x=s+d,w=a+f,k=l+p,O=rn(x*x+w*w+k*k),S=ro(k/=O),C=1e-6>n5(n5(k)-1)||1e-6>n5(o-u)?(o+u)/2:n4(w,x),T=e(C,S),A=T[0],E=T[1],M=A-r,_=E-i,D=b*M-y*_;(D*D/v>t||n5((y*M+b*_)/v-.5)>.3||s*d+a*f+l*p<iV)&&(n(r,i,o,s,a,l,A,E,C,x/=O,w/=O,k,m,g),g.point(A,E),n(A,E,C,x,w,k,c,h,u,d,f,p,m,g))}}return function(t){var r,i,o,s,a,l,c,h,u,d,f,p,m={point:g,lineStart:y,lineEnd:v,polygonStart:function(){t.polygonStart(),m.lineStart=x},polygonEnd:function(){t.polygonEnd(),m.lineStart=y}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){h=NaN,m.point=b,t.lineStart()}function b(r,i){var o=rp([r,i]),s=e(r,i);n(h,u,c,d,f,p,h=s[0],u=s[1],c=r,d=o[0],f=o[1],p=o[2],16,t),t.point(h,u)}function v(){m.point=g,t.lineEnd()}function x(){y(),m.point=w,m.lineEnd=k}function w(e,t){b(r=e,t),i=h,o=u,s=d,a=f,l=p,m.point=b}function k(){n(h,u,c,d,f,p,i,o,r,s,a,l,16,t),m.lineEnd=v,v()}return m}}(e,t):i$({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}var iU=i$({point:function(e,t){this.stream.point(e*n2,t*n2)}});function iH(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(o,s){return[t+e*(o*=r),n-e*(s*=i)]}return o.invert=function(o,s){return[(o-t)/e*r,(n-s)/e*i]},o}(e,t,n,r,i);var s=n6(o),a=re(o),l=s*e,c=a*e,h=s/e,u=a/e,d=(a*n-s*t)/e,f=(a*t+s*n)/e;function p(e,o){return[l*(e*=r)-c*(o*=i)+t,n-c*e-l*o]}return p.invert=function(e,t){return[r*(h*e-u*t+d),i*(f-u*e-h*t)]},p}function iG(e){return iX(function(){return e})()}function iX(e){var t,n,r,i,o,s,a,l,c,h,u=150,d=480,f=250,p=0,m=0,g=0,y=0,b=0,v=0,x=1,w=1,k=null,O=rI,S=null,C=rL,T=.5;function A(e){return l(e[0]*n2,e[1]*n2)}function E(e){return(e=l.invert(e[0],e[1]))&&[e[0]*n1,e[1]*n1]}function M(){var e=iH(u,0,0,x,w,v).apply(null,t(p,m)),r=iH(u,d-e[0],f-e[1],x,w,v);return n=rk(g,y,b),a=rx(t,r),l=rx(n,a),s=iW(a,T),_()}function _(){return c=h=null,A}return A.stream=function(e){var t;return c&&h===e?c:c=iU((t=n,i$({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}}))(O(s(C(h=e)))))},A.preclip=function(e){return arguments.length?(O=e,k=void 0,_()):O},A.postclip=function(e){return arguments.length?(C=e,S=r=i=o=null,_()):C},A.clipAngle=function(e){return arguments.length?(O=+e?function(e){var t=n6(e),n=2*n2,r=t>0,i=n5(t)>1e-6;function o(e,n){return n6(e)*n6(n)>t}function s(e,n,r){var i=rp(e),o=rp(n),s=[1,0,0],a=rg(i,o),l=rm(a,a),c=a[0],h=l-c*c;if(!h)return!r&&e;var u=rg(s,a),d=rb(s,t*l/h);ry(d,rb(a,-t*c/h));var f=rm(d,u),p=rm(u,u),m=f*f-p*(rm(d,d)-1);if(!(m<0)){var g=rn(m),y=rb(u,(-f-g)/p);if(ry(y,d),y=rf(y),!r)return y;var b,v=e[0],x=n[0],w=e[1],k=n[1];x<v&&(b=v,v=x,x=b);var O=x-v,S=1e-6>n5(O-nY);if(!S&&k<w&&(b=w,w=k,k=b),S||O<1e-6?S?w+k>0^y[1]<(1e-6>n5(y[0]-v)?w:k):w<=y[1]&&y[1]<=k:O>nY^(v<=y[0]&&y[0]<=x)){var C=rb(u,(-f+g)/p);return ry(C,d),[y,rf(C)]}}}function a(t,n){var i=r?e:nY-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return rR(o,function(e){var t,n,l,c,h;return{lineStart:function(){c=l=!1,h=1},point:function(u,d){var f,p,m=[u,d],g=o(u,d),y=r?g?0:a(u,d):g?a(u+(u<0?nY:-nY),d):0;(!t&&(c=l=g)&&e.lineStart(),g!==l&&(!(p=s(t,m))||rE(t,p)||rE(m,p))&&(m[2]=1),g!==l)?(h=0,g?(e.lineStart(),p=s(m,t),e.point(p[0],p[1])):(p=s(t,m),e.point(p[0],p[1],2),e.lineEnd()),t=p):i&&t&&r^g&&!(y&n)&&(f=s(m,t,!0))&&(h=0,r?(e.lineStart(),e.point(f[0][0],f[0][1]),e.point(f[1][0],f[1][1]),e.lineEnd()):(e.point(f[1][0],f[1][1]),e.lineEnd(),e.lineStart(),e.point(f[0][0],f[0][1],3))),!g||t&&rE(t,m)||e.point(m[0],m[1]),t=m,l=g,n=y},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return h|(c&&l)<<1}}},function(t,r,i,o){!function(e,t,n,r,i,o){if(n){var s=n6(t),a=re(t),l=r*n;null==i?(i=t+r*n0,o=t-l/2):(i=rT(s,i),o=rT(s,o),(r>0?i<o:i>o)&&(i+=r*n0));for(var c,h=i;r>0?h>o:h<o;h-=l)c=rf([s,-a*n6(h),-a*re(h)]),e.point(c[0],c[1])}}(o,e,n,i,t,r)},r?[0,-e]:[-nY,e-nY])}(k=e*n2):(k=null,rI),_()):k*n1},A.clipExtent=function(e){return arguments.length?(C=null==e?(S=r=i=o=null,rL):r$(S=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),_()):null==S?null:[[S,r],[i,o]]},A.scale=function(e){return arguments.length?(u=+e,M()):u},A.translate=function(e){return arguments.length?(d=+e[0],f=+e[1],M()):[d,f]},A.center=function(e){return arguments.length?(p=e[0]%360*n2,m=e[1]%360*n2,M()):[p*n1,m*n1]},A.rotate=function(e){return arguments.length?(g=e[0]%360*n2,y=e[1]%360*n2,b=e.length>2?e[2]%360*n2:0,M()):[g*n1,y*n1,b*n1]},A.angle=function(e){return arguments.length?(v=e%360*n2,M()):v*n1},A.reflectX=function(e){return arguments.length?(x=e?-1:1,M()):x<0},A.reflectY=function(e){return arguments.length?(w=e?-1:1,M()):w<0},A.precision=function(e){return arguments.length?(s=iW(a,T=e*e),_()):rn(T)},A.fitExtent=function(e,t){return iz(A,e,t)},A.fitSize=function(e,t){return iB(A,e,t)},A.fitWidth=function(e,t){return iF(A,e,t)},A.fitHeight=function(e,t){return iQ(A,e,t)},function(){return t=e.apply(this,arguments),A.invert=t.invert&&E,M()}}function iZ(e){var t=0,n=nY/3,r=iX(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*n2,n=e[1]*n2):[t*n1,n*n1]},i}function iY(e,t){var n=re(e),r=(n+re(t))/2;if(1e-6>n5(r))return function(e){var t=n6(e);function n(e,n){return[e*t,re(n)/t]}return n.invert=function(e,n){return[e/t,ro(n*t)]},n}(e);var i=1+n*(2*r-n),o=rn(i)/r;function s(e,t){var n=rn(i-2*r*re(t))/r;return[n*re(e*=r),o-n*n6(e)]}return s.invert=function(e,t){var n=o-t,s=n4(e,n5(n))*rt(n);return n*r<0&&(s-=nY*rt(e)*rt(n)),[s/r,ro((i-(e*e+n*n)*r*r)/(2*r))]},s}function iJ(){return iZ(iY).scale(155.424).center([0,33.6442])}function iK(){return iJ().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function i0(){var e,t,n,r,i,o,s=iK(),a=iJ().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=iJ().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){o=[e,t]}};function h(e){var t=e[0],s=e[1];return o=null,n.point(t,s),o||(r.point(t,s),o)||(i.point(t,s),o)}function u(){return e=t=null,h}return h.invert=function(e){var t=s.scale(),n=s.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:s).invert(e)},h.stream=function(n){var r,i;return e&&t===n?e:(i=(r=[s.stream(t=n),a.stream(n),l.stream(n)]).length,e={point:function(e,t){for(var n=-1;++n<i;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<i;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<i;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<i;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<i;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<i;)r[e].polygonEnd()}})},h.precision=function(e){return arguments.length?(s.precision(e),a.precision(e),l.precision(e),u()):s.precision()},h.scale=function(e){return arguments.length?(s.scale(e),a.scale(.35*e),l.scale(e),h.translate(s.translate())):s.scale()},h.translate=function(e){if(!arguments.length)return s.translate();var t=s.scale(),o=+e[0],h=+e[1];return n=s.translate(e).clipExtent([[o-.455*t,h-.238*t],[o+.455*t,h+.238*t]]).stream(c),r=a.translate([o-.307*t,h+.201*t]).clipExtent([[o-.425*t+1e-6,h+.12*t+1e-6],[o-.214*t-1e-6,h+.234*t-1e-6]]).stream(c),i=l.translate([o-.205*t,h+.212*t]).clipExtent([[o-.214*t+1e-6,h+.166*t+1e-6],[o-.115*t-1e-6,h+.234*t-1e-6]]).stream(c),u()},h.fitExtent=function(e,t){return iz(h,e,t)},h.fitSize=function(e,t){return iB(h,e,t)},h.fitWidth=function(e,t){return iF(h,e,t)},h.fitHeight=function(e,t){return iQ(h,e,t)},h.scale(1070)}function i1(e){return function(t,n){var r=n6(t),i=n6(n),o=e(r*i);return o===1/0?[2,0]:[o*i*re(t),o*re(n)]}}function i2(e){return function(t,n){var r=rn(t*t+n*n),i=e(r),o=re(i);return[n4(t*o,r*n6(i)),ro(r&&n*o/r)]}}var i5=i1(function(e){return rn(2/(1+e))});function i3(){return iG(i5).scale(124.75).clipAngle(179.999)}i5.invert=i2(function(e){return 2*ro(e/2)});var i4=i1(function(e){return(e=ri(e))&&e/re(e)});function i6(){return iG(i4).scale(79.4188).clipAngle(179.999)}function i8(e,t){return[e,n9(rr((nJ+t)/2))]}function i9(){return i7(i8).scale(961/n0)}function i7(e){var t,n,r,i=iG(e),o=i.center,s=i.scale,a=i.translate,l=i.clipExtent,c=null;function h(){var o=nY*s(),a=i((function(e){function t(t){return t=e(t[0]*n2,t[1]*n2),t[0]*=n1,t[1]*=n1,t}return e=rk(e[0]*n2,e[1]*n2,e.length>2?e[2]*n2:0),t.invert=function(t){return t=e.invert(t[0]*n2,t[1]*n2),t[0]*=n1,t[1]*=n1,t},t})(i.rotate()).invert([0,0]));return l(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:e===i8?[[Math.max(a[0]-o,c),t],[Math.min(a[0]+o,n),r]]:[[c,Math.max(a[1]-o,t)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(e){return arguments.length?(s(e),h()):s()},i.translate=function(e){return arguments.length?(a(e),h()):a()},i.center=function(e){return arguments.length?(o(e),h()):o()},i.clipExtent=function(e){return arguments.length?(null==e?c=t=n=r=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),h()):null==c?null:[[c,t],[n,r]]},h()}function oe(e){return rr((nJ+e)/2)}function ot(e,t){var n=n6(e),r=e===t?re(e):n9(n/n6(t))/n9(oe(t)/oe(e)),i=n*n7(oe(e),r)/r;if(!r)return i8;function o(e,t){i>0?t<-nJ+1e-6&&(t=-nJ+1e-6):t>nJ-1e-6&&(t=nJ-1e-6);var n=i/n7(oe(t),r);return[n*re(r*e),i-n*n6(r*e)]}return o.invert=function(e,t){var n=i-t,o=rt(r)*rn(e*e+n*n),s=n4(e,n5(n))*rt(n);return n*r<0&&(s-=nY*rt(e)*rt(n)),[s/r,2*n3(n7(i/o,1/r))-nJ]},o}function on(){return iZ(ot).scale(109.5).parallels([30,30])}function or(e,t){return[e,t]}function oi(){return iG(or).scale(152.63)}function oo(e,t){var n=n6(e),r=e===t?re(e):(n-n6(t))/(t-e),i=n/r+e;if(1e-6>n5(r))return or;function o(e,t){var n=i-t,o=r*e;return[n*re(o),i-n*n6(o)]}return o.invert=function(e,t){var n=i-t,o=n4(e,n5(n))*rt(n);return n*r<0&&(o-=nY*rt(e)*rt(n)),[o/r,i-rt(r)*rn(e*e+n*n)]},o}function oa(){return iZ(oo).scale(131.154).center([0,13.9389])}i4.invert=i2(function(e){return e}),i8.invert=function(e,t){return[e,2*n3(n8(t))-nJ]},or.invert=or;var ol=rn(3)/2;function oc(e,t){var n=ro(ol*re(t)),r=n*n,i=r*r*r;return[e*n6(n)/(ol*(1.340264+-.24331799999999998*r+i*(.0062510000000000005+.034164*r))),n*(1.340264+-.081106*r+i*(893e-6+.003796*r))]}function oh(){return iG(oc).scale(177.158)}function ou(e,t){var n=n6(t),r=n6(e)*n;return[n*re(e)/r,re(t)/r]}function od(){return iG(ou).scale(144.049).clipAngle(60)}function of(e,t){return[n6(t)*re(e),re(t)]}function op(){return iG(of).scale(249.5).clipAngle(90.000001)}function om(e,t){var n=n6(t),r=1+n6(e)*n;return[n*re(e)/r,re(t)/r]}function og(){return iG(om).scale(250).clipAngle(142)}function oy(e,t){return[n9(rr((nJ+t)/2)),-e]}function ob(){var e=i7(oy),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}function ov(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function ox(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}oc.invert=function(e,t){for(var n,r,i=t,o=i*i,s=o*o*o,a=0;a<12&&(r=i*(1.340264+-.081106*o+s*(893e-6+.003796*o))-t,i-=n=r/(1.340264+-.24331799999999998*o+s*(.0062510000000000005+.034164*o)),s=(o=i*i)*o*o,!(1e-12>n5(n)));++a);return[ol*e*(1.340264+-.24331799999999998*o+s*(.0062510000000000005+.034164*o))/n6(i),ro(re(i)/ol)]},ou.invert=i2(n3),of.invert=i2(ro),om.invert=i2(function(e){return 2*n3(e)}),oy.invert=function(e,t){return[-t,2*n3(n8(e))-nJ]};let ow=Symbol("implicit");function ok(){var e=new tN,t=[],n=[],r=ow;function i(i){let o=e.get(i);if(void 0===o){if(r!==ow)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();for(let r of(t=[],e=new tN,n))e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return ok(t,n).unknown(r)},ov.apply(i,arguments),i}function oO(){var e,t,n=ok().unknown(void 0),r=n.domain,i=n.range,o=0,s=1,a=!1,l=0,c=0,h=.5;function u(){var n=r().length,u=s<o,d=u?s:o,f=u?o:s;e=(f-d)/Math.max(1,n-l+2*c),a&&(e=Math.floor(e)),d+=(f-d-e*(n-l))*h,t=e*(1-l),a&&(d=Math.round(d),t=Math.round(t));var p=(0,S.W)(n).map(function(t){return d+e*t});return i(u?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),u()):r()},n.range=function(e){return arguments.length?([o,s]=e,o=+o,s=+s,u()):[o,s]},n.rangeRound=function(e){return[o,s]=e,o=+o,s=+s,a=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(a=!!e,u()):a},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),u()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),u()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,u()):c},n.align=function(e){return arguments.length?(h=Math.max(0,Math.min(1,e)),u()):h},n.copy=function(){return oO(r(),[o,s]).round(a).paddingInner(l).paddingOuter(c).align(h)},ov.apply(u(),arguments)}function oS(e){return+e}var oC=[0,1];function oT(e){return e}function oA(e,t){var n;return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n})}function oE(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=oA(i,r),o=n(s,o)):(r=oA(r,i),o=n(o,s)),function(e){return o(r(e))}}function oM(e,t,n){var r=Math.min(e.length,t.length)-1,i=Array(r),o=Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=oA(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(t){var n=(0,S.Y)(e,t,1,r)-1;return o[n](i[n](t))}}function o_(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function oD(){var e,t,n,r,i,o,s=oC,a=oC,l=nA,c=oT;function h(){var e,t,n,l=Math.min(s.length,a.length);return c!==oT&&(e=s[0],t=s[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=l>2?oM:oE,i=o=null,u}function u(t){return null==t||isNaN(t=+t)?n:(i||(i=r(s.map(e),a,l)))(e(c(t)))}return u.invert=function(n){return c(t((o||(o=r(a,s.map(e),S.L)))(n)))},u.domain=function(e){return arguments.length?(s=Array.from(e,oS),h()):s.slice()},u.range=function(e){return arguments.length?(a=Array.from(e),h()):a.slice()},u.rangeRound=function(e){return a=Array.from(e),l=nE,h()},u.clamp=function(e){return arguments.length?(c=!!e||oT,h()):c!==oT},u.interpolate=function(e){return arguments.length?(l=e,h()):l},u.unknown=function(e){return arguments.length?(n=e,u):n},function(n,r){return e=n,t=r,h()}}function oN(e){var t=e.domain;return e.ticks=function(e){var n=t();return tZ(n[0],n[n.length-1],e??10)},e.tickFormat=function(e,n){var r=t();return function(e,t,n,r){var i,o,s=tJ(e,t,n);switch((r=nV(r??",f")).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(o=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(nF(a)/3)))-nF(Math.abs(s))))||(r.precision=o),rV(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=Math.max(0,nF(Math.abs(Math.max(Math.abs(e),Math.abs(t)))-(i=Math.abs(i=s)))-nF(i))+1)||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=Math.max(0,-nF(Math.abs(s))))||(r.precision=o-("%"===r.type)*2)}return rQ(r)}(r[0],r[r.length-1],e??10,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),s=0,a=o.length-1,l=o[s],c=o[a],h=10;for(c<l&&(i=l,l=c,c=i,i=s,s=a,a=i);h-- >0;){if((i=tY(l,c,n))===r)return o[s]=l,o[a]=c,t(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else if(i<0)l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i;else break;r=i}return e},e}function oR(){var e=oD()(oT,oT);return e.copy=function(){return o_(e,oR())},ov.apply(e,arguments),oN(e)}function oP(e,t){e=e.slice();var n,r=0,i=e.length-1,o=e[r],s=e[i];return s<o&&(n=r,r=i,i=n,n=o,o=s,s=n),e[r]=t.floor(o),e[i]=t.ceil(s),e}function oj(e){return Math.log(e)}function oI(e){return Math.exp(e)}function o$(e){return-Math.log(-e)}function oL(e){return-Math.exp(-e)}function oq(e){return isFinite(e)?+("1e"+e):e<0?0:e}function oz(e){return(t,n)=>-e(-t,n)}function oB(e){let t=e(oj,oI),n=t.domain,r=10,i,o;function s(){var s,a;return i=(s=r)===Math.E?Math.log:10===s&&Math.log10||2===s&&Math.log2||(s=Math.log(s),e=>Math.log(e)/s),o=10===(a=r)?oq:a===Math.E?Math.exp:e=>Math.pow(a,e),n()[0]<0?(i=oz(i),o=oz(o),e(o$,oL)):e(oj,oI),t}return t.base=function(e){return arguments.length?(r=+e,s()):r},t.domain=function(e){return arguments.length?(n(e),s()):n()},t.ticks=e=>{let t=n(),s=t[0],a=t[t.length-1],l=a<s;l&&([s,a]=[a,s]);let c=i(s),h=i(a),u,d,f=null==e?10:+e,p=[];if(!(r%1)&&h-c<f){if(c=Math.floor(c),h=Math.ceil(h),s>0){for(;c<=h;++c)for(u=1;u<r;++u)if(!((d=c<0?u/o(-c):u*o(c))<s)){if(d>a)break;p.push(d)}}else for(;c<=h;++c)for(u=r-1;u>=1;--u)if(!((d=c>0?u/o(-c):u*o(c))<s)){if(d>a)break;p.push(d)}2*p.length<f&&(p=tZ(s,a,f))}else p=tZ(c,h,Math.min(h-c,f)).map(o);return l?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===r?"s":","),"function"!=typeof n&&(r%1||null!=(n=nV(n)).precision||(n.trim=!0),n=rQ(n)),e===1/0)return n;let s=Math.max(1,r*e/t.ticks().length);return e=>{let t=e/o(Math.round(i(e)));return t*r<r-.5&&(t*=r),t<=s?n(e):""}},t.nice=()=>n(oP(n(),{floor:e=>o(Math.floor(i(e))),ceil:e=>o(Math.ceil(i(e)))})),t}function oF(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function oQ(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function oV(e){var t=1,n=e(oF(1),oQ(t));return n.constant=function(n){return arguments.length?e(oF(t=+n),oQ(t)):t},oN(n)}function oW(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function oU(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function oH(e){return e<0?-e*e:e*e}function oG(e){var t=e(oT,oT),n=1;return t.exponent=function(t){return arguments.length?1==(n=+t)?e(oT,oT):.5===n?e(oU,oH):e(oW(n),oW(1/n)):n},oN(t)}let oX=new Date,oZ=new Date;function oY(e,t,n,r){function i(t){return e(t=0==arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{let t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{let s;let a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return a;do a.push(s=new Date(+n)),t(n,o),e(n);while(s<n&&n<r);return a},i.filter=n=>oY(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e){if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}}),n&&(i.count=(t,r)=>(oX.setTime(+t),oZ.setTime(+r),e(oX),e(oZ),Math.floor(n(oX,oZ))),i.every=e=>isFinite(e=Math.floor(e))&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null),i}let oJ=oY(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);oJ.every=e=>isFinite(e=Math.floor(e))&&e>0?e>1?oY(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):oJ:null,oJ.range;let oK=oY(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+1e3*t)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds());oK.range;let o0=oY(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},(e,t)=>{e.setTime(+e+6e4*t)},(e,t)=>(t-e)/6e4,e=>e.getMinutes());o0.range;let o1=oY(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+6e4*t)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes());o1.range;let o2=oY(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-6e4*e.getMinutes())},(e,t)=>{e.setTime(+e+36e5*t)},(e,t)=>(t-e)/36e5,e=>e.getHours());o2.range;let o5=oY(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+36e5*t)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours());o5.range;let o3=oY(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1);o3.range;let o4=oY(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1);o4.range;let o6=oY(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5));function o8(e){return oY(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/6048e5)}o6.range;let o9=o8(0),o7=o8(1),se=o8(2),st=o8(3),sn=o8(4),sr=o8(5),si=o8(6);function so(e){return oY(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/6048e5)}o9.range,o7.range,se.range,st.range,sn.range,sr.range,si.range;let ss=so(0),sa=so(1),sl=so(2),sc=so(3),sh=so(4),su=so(5),sd=so(6);ss.range,sa.range,sl.range,sc.range,sh.range,su.range,sd.range;let sf=oY(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());sf.range;let sp=oY(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());sp.range;let sm=oY(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());sm.every=e=>isFinite(e=Math.floor(e))&&e>0?oY(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null,sm.range;let sg=oY(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());function sy(e,t,n,r,i,o){let s=[[oK,1,1e3],[oK,5,5e3],[oK,15,15e3],[oK,30,3e4],[o,1,6e4],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[t,1,2592e6],[t,3,7776e6],[e,1,31536e6]];function a(t,n,r){let i=Math.abs(n-t)/r,o=(0,S.Z)(([,,e])=>e).right(s,i);if(o===s.length)return e.every(tJ(t/31536e6,n/31536e6,r));if(0===o)return oJ.every(Math.max(tJ(t,n,r),1));let[a,l]=s[i/s[o-1][2]<s[o][2]/i?o-1:o];return a.every(l)}return[function(e,t,n){let r=t<e;r&&([e,t]=[t,e]);let i=n&&"function"==typeof n.range?n:a(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},a]}sg.every=e=>isFinite(e=Math.floor(e))&&e>0?oY(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null,sg.range;let[sb,sv]=sy(sg,sp,ss,o6,o5,o1),[sx,sw]=sy(sm,sf,o9,o3,o2,o0);function sk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function sO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function sS(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var sC={"-":"",_:" ",0:"0"},sT=/^\s*\d+/,sA=/^%/,sE=/[\\^$*+?|[\]().{}]/g;function sM(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?Array(n-o+1).join(t)+i:i)}function s_(e){return e.replace(sE,"\\$&")}function sD(e){return RegExp("^(?:"+e.map(s_).join("|")+")","i")}function sN(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function sR(e,t,n){var r=sT.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function sP(e,t,n){var r=sT.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function sj(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function sI(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function s$(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function sL(e,t,n){var r=sT.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function sq(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function sz(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function sB(e,t,n){var r=sT.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function sF(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function sQ(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function sV(e,t,n){var r=sT.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function sW(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function sU(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function sH(e,t,n){var r=sT.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function sG(e,t,n){var r=sT.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function sX(e,t,n){var r=sT.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function sZ(e,t,n){var r=sA.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function sY(e,t,n){var r=sT.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function sJ(e,t,n){var r=sT.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function sK(e,t){return sM(e.getDate(),t,2)}function s0(e,t){return sM(e.getHours(),t,2)}function s1(e,t){return sM(e.getHours()%12||12,t,2)}function s2(e,t){return sM(1+o3.count(sm(e),e),t,3)}function s5(e,t){return sM(e.getMilliseconds(),t,3)}function s3(e,t){return s5(e,t)+"000"}function s4(e,t){return sM(e.getMonth()+1,t,2)}function s6(e,t){return sM(e.getMinutes(),t,2)}function s8(e,t){return sM(e.getSeconds(),t,2)}function s9(e){var t=e.getDay();return 0===t?7:t}function s7(e,t){return sM(o9.count(sm(e)-1,e),t,2)}function ae(e){var t=e.getDay();return t>=4||0===t?sn(e):sn.ceil(e)}function at(e,t){return e=ae(e),sM(sn.count(sm(e),e)+(4===sm(e).getDay()),t,2)}function an(e){return e.getDay()}function ar(e,t){return sM(o7.count(sm(e)-1,e),t,2)}function ai(e,t){return sM(e.getFullYear()%100,t,2)}function ao(e,t){return sM((e=ae(e)).getFullYear()%100,t,2)}function as(e,t){return sM(e.getFullYear()%1e4,t,4)}function aa(e,t){var n=e.getDay();return sM((e=n>=4||0===n?sn(e):sn.ceil(e)).getFullYear()%1e4,t,4)}function al(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+sM(t/60|0,"0",2)+sM(t%60,"0",2)}function ac(e,t){return sM(e.getUTCDate(),t,2)}function ah(e,t){return sM(e.getUTCHours(),t,2)}function au(e,t){return sM(e.getUTCHours()%12||12,t,2)}function ad(e,t){return sM(1+o4.count(sg(e),e),t,3)}function af(e,t){return sM(e.getUTCMilliseconds(),t,3)}function ap(e,t){return af(e,t)+"000"}function am(e,t){return sM(e.getUTCMonth()+1,t,2)}function ag(e,t){return sM(e.getUTCMinutes(),t,2)}function ay(e,t){return sM(e.getUTCSeconds(),t,2)}function ab(e){var t=e.getUTCDay();return 0===t?7:t}function av(e,t){return sM(ss.count(sg(e)-1,e),t,2)}function ax(e){var t=e.getUTCDay();return t>=4||0===t?sh(e):sh.ceil(e)}function aw(e,t){return e=ax(e),sM(sh.count(sg(e),e)+(4===sg(e).getUTCDay()),t,2)}function ak(e){return e.getUTCDay()}function aO(e,t){return sM(sa.count(sg(e)-1,e),t,2)}function aS(e,t){return sM(e.getUTCFullYear()%100,t,2)}function aC(e,t){return sM((e=ax(e)).getUTCFullYear()%100,t,2)}function aT(e,t){return sM(e.getUTCFullYear()%1e4,t,4)}function aA(e,t){var n=e.getUTCDay();return sM((e=n>=4||0===n?sh(e):sh.ceil(e)).getUTCFullYear()%1e4,t,4)}function aE(){return"+0000"}function aM(){return"%"}function a_(e){return+e}function aD(e){return Math.floor(+e/1e3)}function aN(e){return new Date(e)}function aR(e){return e instanceof Date?+e:+new Date(+e)}function aP(e,t,n,r,i,o,s,a,l,c){var h=oD()(oT,oT),u=h.invert,d=h.domain,f=c(".%L"),p=c(":%S"),m=c("%I:%M"),g=c("%I %p"),y=c("%a %d"),b=c("%b %d"),v=c("%B"),x=c("%Y");function w(e){return(l(e)<e?f:a(e)<e?p:s(e)<e?m:o(e)<e?g:r(e)<e?i(e)<e?y:b:n(e)<e?v:x)(e)}return h.invert=function(e){return new Date(u(e))},h.domain=function(e){return arguments.length?d(Array.from(e,aR)):d().map(aN)},h.ticks=function(t){var n=d();return e(n[0],n[n.length-1],t??10)},h.tickFormat=function(e,t){return null==t?w:c(t)},h.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],e??10)),e?d(oP(n,e)):h},h.copy=function(){return o_(h,aP(e,t,n,r,i,o,s,a,l,c))},h}function aj(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function aI(){var e,t,n,r,i,o,s,a=0,l=.5,c=1,h=1,u=oT,d=!1;function f(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-t)*(h*e<h*t?r:i),u(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,u=nR(e,[n,r,i]),f):[u(0),u(.5),u(1)]}}return f.domain=function(s){return arguments.length?([a,l,c]=s,e=o(a=+a),t=o(l=+l),n=o(c=+c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),h=t<e?-1:1,f):[a,l,c]},f.clamp=function(e){return arguments.length?(d=!!e,f):d},f.interpolator=function(e){return arguments.length?(u=e,f):u},f.range=p(nA),f.rangeRound=p(nE),f.unknown=function(e){return arguments.length?(s=e,f):s},function(s){return o=s,e=s(a),t=s(l),n=s(c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),h=t<e?-1:1,f}}function a$(e){for(var t=e.length/6|0,n=Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}h=(c=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths,c=sD(i),h=sN(i),u=sD(o),d=sN(o),f=sD(s),p=sN(s),m=sD(a),g=sN(a),y=sD(l),b=sN(l),v={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return a[e.getMonth()]},c:null,d:sK,e:sK,f:s3,g:ao,G:aa,H:s0,I:s1,j:s2,L:s5,m:s4,M:s6,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:a_,s:aD,S:s8,u:s9,U:s7,V:at,w:an,W:ar,x:null,X:null,y:ai,Y:as,Z:al,"%":aM},x={a:function(e){return s[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return a[e.getUTCMonth()]},c:null,d:ac,e:ac,f:ap,g:aC,G:aA,H:ah,I:au,j:ad,L:af,m:am,M:ag,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:a_,s:aD,S:ay,u:ab,U:av,V:aw,w:ak,W:aO,x:null,X:null,y:aS,Y:aT,Z:aE,"%":aM},w={a:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:sQ,e:sQ,f:sX,g:sq,G:sL,H:sW,I:sW,j:sV,L:sG,m:sF,M:sU,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=h.get(r[0].toLowerCase()),n+r[0].length):-1},q:sB,Q:sY,s:sJ,S:sH,u:sP,U:sj,V:sI,w:sR,W:s$,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:sq,Y:sL,Z:sz,"%":sZ};function k(e,t){return function(n){var r,i,o,s=[],a=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++a<c;)37===e.charCodeAt(a)&&(s.push(e.slice(l,a)),null!=(i=sC[r=e.charAt(++a)])?r=e.charAt(++a):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),s.push(r),l=a+1);return s.push(e.slice(l,a)),s.join("")}}function O(e,t){return function(n){var r,i,o=sS(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(!t||"Z"in o||(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=(i=(r=sO(sS(o.y,0,1))).getUTCDay())>4||0===i?sa.ceil(r):sa(r),r=o4.offset(r,(o.V-1)*7),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(r=(i=(r=sk(sS(o.y,0,1))).getDay())>4||0===i?o7.ceil(r):o7(r),r=o3.offset(r,(o.V-1)*7),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?sO(sS(o.y,0,1)).getUTCDay():sk(sS(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,sO(o)):sk(o)}}function S(e,t,n,r){for(var i,o,s=0,a=t.length,l=n.length;s<a;){if(r>=l)return -1;if(37===(i=t.charCodeAt(s++))){if(!(o=w[(i=t.charAt(s++))in sC?t.charAt(s++):i])||(r=o(e,n,r))<0)return -1}else if(i!=n.charCodeAt(r++))return -1}return r}return v.x=k(n,v),v.X=k(r,v),v.c=k(t,v),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=O(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=O(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})).format,c.parse,u=c.utcFormat,c.utcParse;let aL=a$("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),aq=a$("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),az=a$("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),aB=a$("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),aF=a$("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),aQ=a$("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),aV=a$("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),aW=a$("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),aU=a$("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),aH=a$("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),aG=a$("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),aX=e=>(0,S._)(e[e.length-1]);var aZ=[,,,].concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(a$);let aY=aX(aZ);var aJ=[,,,].concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(a$);let aK=aX(aJ);var a0=[,,,].concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(a$);let a1=aX(a0);var a2=[,,,].concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(a$);let a5=aX(a2);var a3=[,,,].concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(a$);let a4=aX(a3);var a6=[,,,].concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(a$);let a8=aX(a6);var a9=[,,,].concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(a$);let a7=aX(a9);var le=[,,,].concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(a$);let lt=aX(le);var ln=[,,,].concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(a$);let lr=aX(ln);var li=[,,,].concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(a$);let lo=aX(li);var ls=[,,,].concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(a$);let la=aX(ls);var ll=[,,,].concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(a$);let lc=aX(ll);var lh=[,,,].concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(a$);let lu=aX(lh);var ld=[,,,].concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(a$);let lf=aX(ld);var lp=[,,,].concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(a$);let lm=aX(lp);var lg=[,,,].concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(a$);let ly=aX(lg);var lb=[,,,].concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(a$);let lv=aX(lb);var lx=[,,,].concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(a$);let lw=aX(lx);var lk=[,,,].concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(a$);let lO=aX(lk);var lS=[,,,].concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(a$);let lC=aX(lS);var lT=[,,,].concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(a$);let lA=aX(lT);var lE=[,,,].concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(a$);let lM=aX(lE);var l_=[,,,].concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(a$);let lD=aX(l_);var lN=[,,,].concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(a$);let lR=aX(lN);var lP=[,,,].concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(a$);let lj=aX(lP);var lI=[,,,].concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(a$);let l$=aX(lI);var lL=[,,,].concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(a$);let lq=aX(lL);function lz(e){return"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-(e=Math.max(0,Math.min(1,e)))*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-2710.57*e)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-67.37*e)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-2475.67*e)))))))+")"}let lB=nN(nC(300,.5,0),nC(-240,.5,1));var lF=nN(nC(-100,.75,.35),nC(80,1.5,.8)),lQ=nN(nC(260,.75,.35),nC(80,1.5,.8)),lV=nC();function lW(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return lV.h=360*e-100,lV.s=1.5-1.5*t,lV.l=.8-.9*t,lV+""}var lU=(0,S.$)(),lH=Math.PI/3,lG=2*Math.PI/3;function lX(e){var t;return e=(.5-e)*Math.PI,lU.r=255*(t=Math.sin(e))*t,lU.g=255*(t=Math.sin(e+lH))*t,lU.b=255*(t=Math.sin(e+lG))*t,lU+""}function lZ(e){return"rgb("+Math.max(0,Math.min(255,Math.round(34.61+(e=Math.max(0,Math.min(1,e)))*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-14825.05*e)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+707.56*e)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-6838.66*e)))))))+")"}function lY(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}let lJ=lY(a$("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var lK=lY(a$("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),l0=lY(a$("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),l1=lY(a$("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));let l2=Object.freeze(Object.defineProperty({__proto__:null,interpolateBlues:lM,interpolateBrBG:aY,interpolateBuGn:lo,interpolateBuPu:la,interpolateCividis:lz,interpolateCool:lQ,interpolateCubehelixDefault:lB,interpolateGnBu:lc,interpolateGreens:lD,interpolateGreys:lR,interpolateInferno:l0,interpolateMagma:lK,interpolateOrRd:lu,interpolateOranges:lq,interpolatePRGn:aK,interpolatePiYG:a1,interpolatePlasma:l1,interpolatePuBu:lm,interpolatePuBuGn:lf,interpolatePuOr:a5,interpolatePuRd:ly,interpolatePurples:lj,interpolateRainbow:lW,interpolateRdBu:a4,interpolateRdGy:a8,interpolateRdPu:lv,interpolateRdYlBu:a7,interpolateRdYlGn:lt,interpolateReds:l$,interpolateSinebow:lX,interpolateSpectral:lr,interpolateTurbo:lZ,interpolateViridis:lJ,interpolateWarm:lF,interpolateYlGn:lO,interpolateYlGnBu:lw,interpolateYlOrBr:lC,interpolateYlOrRd:lA,schemeAccent:aq,schemeBlues:lE,schemeBrBG:aZ,schemeBuGn:li,schemeBuPu:ls,schemeCategory10:aL,schemeDark2:az,schemeGnBu:ll,schemeGreens:l_,schemeGreys:lN,schemeObservable10:aB,schemeOrRd:lh,schemeOranges:lL,schemePRGn:aJ,schemePaired:aF,schemePastel1:aQ,schemePastel2:aV,schemePiYG:a0,schemePuBu:lp,schemePuBuGn:ld,schemePuOr:a2,schemePuRd:lg,schemePurples:lP,schemeRdBu:a3,schemeRdGy:a6,schemeRdPu:lb,schemeRdYlBu:a9,schemeRdYlGn:le,schemeReds:lI,schemeSet1:aW,schemeSet2:aU,schemeSet3:aH,schemeSpectral:ln,schemeTableau10:aG,schemeYlGn:lk,schemeYlGnBu:lx,schemeYlOrBr:lS,schemeYlOrRd:lT},Symbol.toStringTag,{value:"Module"}));function l5(e){return function(){return e}}let l3=Math.cos,l4=Math.min,l6=Math.sin,l8=Math.sqrt,l9=Math.PI,l7=2*l9;function ce(e){this._context=e}function ct(e){return new ce(e)}function cn(e){return e[0]}function cr(e){return e[1]}ce.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};class ci{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}let co=l8(3),cs={draw(e,t){let n=.59436*l8(t+l4(t/28,.75)),r=n/2,i=r*co;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-i,-r),e.lineTo(i,r),e.moveTo(-i,r),e.lineTo(i,-r)}},ca={draw(e,t){let n=l8(t/l9);e.moveTo(n,0),e.arc(0,0,n,0,l7)}},cl={draw(e,t){let n=l8(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},cc=l8(1/3),ch=2*cc,cu={draw(e,t){let n=l8(t/ch),r=n*cc;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},cd={draw(e,t){let n=.62625*l8(t);e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},cf={draw(e,t){let n=.87559*l8(t-l4(t/7,2));e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},cp={draw(e,t){let n=l8(t),r=-n/2;e.rect(r,r,n,n)}},cm={draw(e,t){let n=.4431*l8(t);e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},cg=l6(l9/10)/l6(7*l9/10),cy=l6(l7/10)*cg,cb=-l3(l7/10)*cg,cv={draw(e,t){let n=l8(.8908130915292852*t),r=cy*n,i=cb*n;e.moveTo(0,-n),e.lineTo(r,i);for(let t=1;t<5;++t){let o=l7*t/5,s=l3(o),a=l6(o);e.lineTo(a*n,-s*n),e.lineTo(s*r-a*i,a*r+s*i)}e.closePath()}},cx=l8(3),cw={draw(e,t){let n=-l8(t/(3*cx));e.moveTo(0,2*n),e.lineTo(-cx*n,-n),e.lineTo(cx*n,-n),e.closePath()}},ck=l8(3),cO={draw(e,t){let n=.6824*l8(t),r=n/2,i=n*ck/2;e.moveTo(0,-n),e.lineTo(i,r),e.lineTo(-i,r),e.closePath()}},cS=l8(3)/2,cC=1/l8(12),cT=(cC/2+1)*3,cA={draw(e,t){let n=l8(t/cT),r=n/2,i=n*cC,o=n*cC+n,s=-r;e.moveTo(r,i),e.lineTo(r,o),e.lineTo(s,o),e.lineTo(-.5*r-cS*i,cS*r+-.5*i),e.lineTo(-.5*r-cS*o,cS*r+-.5*o),e.lineTo(-.5*s-cS*o,cS*s+-.5*o),e.lineTo(-.5*r+cS*i,-.5*i-cS*r),e.lineTo(-.5*r+cS*o,-.5*o-cS*r),e.lineTo(-.5*s+cS*o,-.5*o-cS*s),e.closePath()}},cE={draw(e,t){let n=.6189*l8(t-l4(t/6,1.7));e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},cM=[ca,cl,cu,cp,cv,cw,cA],c_=[ca,cf,cE,cO,cs,cm,cd];function cD(){}function cN(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function cR(e){this._context=e}function cP(e){this._context=e}function cj(e){this._context=e}function cI(e,t){this._basis=new cR(e),this._beta=t}cR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:cN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:cN(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},cP.prototype={areaStart:cD,areaEnd:cD,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:cN(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},cj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:cN(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},cI.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],s=e[n]-i,a=t[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+r*s),this._beta*t[l]+(1-this._beta)*(o+r*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};let c$=function e(t){function n(e){return 1===t?new cR(e):new cI(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function cL(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function cq(e,t){this._context=e,this._k=(1-t)/6}cq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:cL(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:cL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};let cz=function e(t){function n(e){return new cq(e,t)}return n.tension=function(t){return e(+t)},n}(0);function cB(e,t){this._context=e,this._k=(1-t)/6}cB.prototype={areaStart:cD,areaEnd:cD,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:cL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};let cF=function e(t){function n(e){return new cB(e,t)}return n.tension=function(t){return e(+t)},n}(0);function cQ(e,t){this._context=e,this._k=(1-t)/6}cQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};let cV=function e(t){function n(e){return new cQ(e,t)}return n.tension=function(t){return e(+t)},n}(0);function cW(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>1e-12){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>1e-12){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,h=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*c+e._x1*e._l23_2a-t*e._l12_2a)/h,s=(s*c+e._y1*e._l23_2a-n*e._l12_2a)/h}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function cU(e,t){this._context=e,this._alpha=t}cU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:cW(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};let cH=function e(t){function n(e){return t?new cU(e,t):new cq(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function cG(e,t){this._context=e,this._alpha=t}cG.prototype={areaStart:cD,areaEnd:cD,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:cW(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};let cX=function e(t){function n(e){return t?new cG(e,t):new cB(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function cZ(e,t){this._context=e,this._alpha=t}cZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cW(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};let cY=function e(t){function n(e){return t?new cZ(e,t):new cQ(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function cJ(e){this._context=e}function cK(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0);return((o<0?-1:1)+(s<0?-1:1))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs((o*i+s*r)/(r+i)))||0}function c0(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function c1(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function c2(e){this._context=e}function c5(e){this._context=new c3(e)}function c3(e){this._context=e}function c4(e){this._context=e}function c6(e){var t,n,r=e.length-1,i=Array(r),o=Array(r),s=Array(r);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,s[t]-=n*s[t-1];for(i[r-1]=s[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function c8(e,t){this._context=e,this._t=t}cJ.prototype={areaStart:cD,areaEnd:cD,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},c2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:c1(this,this._t0,c0(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,!((e=+e)===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,c1(this,c0(this,n=cK(this,e,t)),n);break;default:c1(this,this._t0,n=cK(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(c5.prototype=Object.create(c2.prototype)).point=function(e,t){c2.prototype.point.call(this,t,e)},c3.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},c4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n){if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=c6(e),i=c6(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s])}(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},c8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};let c9=[{message:"Checking format...",time:4e3},{message:"Cleaning formatting niggles...",time:1e4}],c7=({apiEndpoint:e,token:t,onClick:n=null,onProjectCreated:r=(...e)=>{},children:i=null})=>{let o=(0,C.useContext)(S.M),[s,a]=(0,C.useState)(!1),[l,c]=(0,C.useState)([]),[h,u]=(0,C.useState)("Uploading");return S.j.jsxs("div",{className:"w-full h-full",children:[S.j.jsx(S.a0,{disabled:s,acceptedFileTypes:[".csv",".xls",".xlsx",".pdf"],showIcon:!0,allowMultiple:!0,selectedFiles:l,onRemoveFile:e=>{console.time("CreateNewProject:onRemoveFile"),c(l.filter((t,n)=>n!==e)),console.timeEnd("CreateNewProject:onRemoveFile")},onFileSelect:async(e,t)=>{console.time("CreateNewProject:onFileSelect");try{c([...l,...t])}catch(e){console.error(e),o.error("Failed to process the files")}console.timeEnd("CreateNewProject:onFileSelect")},onDrop:async(e,t)=>{console.time("CreateNewProject:onDrop");try{c([...l,...t])}catch(e){o.error(e.message||"Failed to process the files"),console.log(e.stack)}console.timeEnd("CreateNewProject:onDrop")},onInvalidFiles:(e,t,n)=>{console.warn("Invalid files:",n,t),o.error("Only CSV or Excel files are accepted")}}),S.j.jsx(S.B,{className:(0,S.t)("absolute bottom-1/4 p-4 left-0 right-0 mx-auto w-fit rounded-full z-[10] shadow-md",s||!l.length?"pointer-events-none":""),disabled:s||0===l.length,variant:"primary",onClick:async()=>{try{if(n){await n(l);return}console.time("CreateNewProject:uploadFiles"),a(!0);let i=c9.map(({message:e,time:t})=>setTimeout(()=>{u(e)},t));u("Sending to servers");let{projectName:s,dbInfo:c}=await (0,S.h)(e,t,l);i.forEach(clearTimeout),o.success(`Project ${s} created successfully`),r(s,c)}catch(e){console.error("Error during file upload:",e),o.error(e.message||"Failed to upload files")}finally{a(!1),u(""),console.timeEnd("CreateNewProject:uploadFiles")}},children:i||(l.length?s?S.j.jsxs(S.j.Fragment,{children:[S.j.jsx(S.d,{}),h]}):"Click to upload":"Select some files")})]})};function he(){return(he=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let ht=typeof Symbol>"u"?"__":Symbol.for(""),hn=typeof Symbol>"u"?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),hr="u">typeof globalThis?globalThis:"u">typeof window?window:{};class hi{constructor(e,t){this.rules=[];let{finish:n}=t||{};function r(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}for(let t in e)!function e(t,i,o,s){let a=[],l=/^@(\w+)\b/.exec(t[0]),c=l&&"keyframes"==l[1];if(l&&null==i)return o.push(t[0]+";");for(let n in i){let s=i[n];if(/&/.test(n))e(n.split(/,\s*/).map(e=>t.map(t=>e.replace(/&/,t))).reduce((e,t)=>e.concat(t)),s,o);else if(s&&"object"==typeof s){if(!l)throw RangeError("The value of a property ("+n+") should be a primitive value.");e(r(n),s,a,c)}else null!=s&&a.push(n.replace(/_.*/,"").replace(/[A-Z]/g,e=>"-"+e.toLowerCase())+": "+s+";")}(a.length||c)&&o.push((!n||l||s?t:t.map(n)).join(", ")+" {"+a.join(" ")+"}")}(r(t),e[t],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=hr[ht]||1;return hr[ht]=e+1,""+e.toString(36)}static mount(e,t,n){let r=e[hn],i=n&&n.nonce;r?i&&r.setNonce(i):r=new hs(e,i),r.mount(Array.isArray(t)?t:[t],e)}}let ho=new Map;class hs{constructor(e,t){let n=e.ownerDocument||e,r=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let t=ho.get(n);if(t)return e[hn]=t;this.sheet=new r.CSSStyleSheet,ho.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[hn]=this}mount(e,t){let n=this.sheet,r=0,i=0;for(let t=0;t<e.length;t++){let o=e[t],s=this.modules.indexOf(o);if(s<i&&s>-1&&(this.modules.splice(s,1),i--,s=-1),-1==s){if(this.modules.splice(i++,0,o),n)for(let e=0;e<o.rules.length;e++)n.insertRule(o.rules[e],r++)}else{for(;i<s;)r+=this.modules[i++].rules.length;r+=o.rules.length,i++}}if(n)0>t.adoptedStyleSheets.indexOf(this.sheet)&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+`
`;this.styleTag.textContent=e;let n=t.head||t;this.styleTag.parentNode!=n&&n.insertBefore(this.styleTag,n.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}for(var ha={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},hl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},hc="u">typeof navigator&&/Mac/.test(navigator.platform),hh="u">typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),hu=0;hu<10;hu++)ha[48+hu]=ha[96+hu]=String(hu);for(var hu=1;hu<=24;hu++)ha[hu+111]="F"+hu;for(var hu=65;hu<=90;hu++)ha[hu]=String.fromCharCode(hu+32),hl[hu]=String.fromCharCode(hu);for(var hd in ha)hl.hasOwnProperty(hd)||(hl[hd]=ha[hd]);function hf(e){var t=!(hc&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||hh&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?hl:ha)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}function hp(e){return(11==e.nodeType?e.getSelection?e:e.ownerDocument:e).getSelection()}function hm(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function hg(e,t){if(!t.anchorNode)return!1;try{return hm(e,t.anchorNode)}catch{return!1}}function hy(e){return 3==e.nodeType?hE(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function hb(e,t,n,r){return!!n&&(hw(e,t,n,r,-1)||hw(e,t,n,r,1))}function hv(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function hx(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}function hw(e,t,n,r,i){for(;;){if(e==n&&t==r)return!0;if(t==(i<0?0:hk(e))){if("DIV"==e.nodeName)return!1;let n=e.parentNode;if(!n||1!=n.nodeType)return!1;t=hv(e)+(i<0?0:1),e=n}else{if(1!=e.nodeType||1==(e=e.childNodes[t+(i<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=i<0?hk(e):0}}}function hk(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function hO(e,t){let n=t?e.left:e.right;return{left:n,right:n,top:e.top,bottom:e.bottom}}function hS(e,t){let n=t.width/e.offsetWidth,r=t.height/e.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||1>Math.abs(t.width-e.offsetWidth))&&(n=1),(r>.995&&r<1.005||!isFinite(r)||1>Math.abs(t.height-e.offsetHeight))&&(r=1),{scaleX:n,scaleY:r}}class hC{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?hk(t):0),n,Math.min(e.focusOffset,n?hk(n):0))}set(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r}}let hT=null;function hA(e){if(e.setActive)return e.setActive();if(hT)return e.focus(hT);let t=[];for(let n=e;n&&(t.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(e.focus(null==hT?{get preventScroll(){return hT={preventScroll:!0},!0}}:void 0),!hT){hT=!1;for(let e=0;e<t.length;){let n=t[e++],r=t[e++],i=t[e++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=i&&(n.scrollLeft=i)}}}function hE(e,t,n=t){let r=l||(l=document.createRange());return r.setEnd(e,n),r.setStart(e,t),r}function hM(e,t,n,r){let i={key:t,code:t,keyCode:n,which:n,cancelable:!0};r&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=r);let o=new KeyboardEvent("keydown",i);o.synthetic=!0,e.dispatchEvent(o);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,e.dispatchEvent(s),o.defaultPrevented||s.defaultPrevented}function h_(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}function hD(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}function hN(e,t){for(let n=e,r=t;;){if(3==n.nodeType&&r>0)return{node:n,offset:r};if(1==n.nodeType&&r>0){if("false"==n.contentEditable)return null;r=hk(n=n.childNodes[r-1])}else{if(!n.parentNode||hx(n))return null;r=hv(n),n=n.parentNode}}}function hR(e,t){for(let n=e,r=t;;){if(3==n.nodeType&&r<n.nodeValue.length)return{node:n,offset:r};if(1==n.nodeType&&r<n.childNodes.length){if("false"==n.contentEditable)return null;n=n.childNodes[r],r=0}else{if(!n.parentNode||hx(n))return null;r=hv(n)+1,n=n.parentNode}}}class hP{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new hP(e.parentNode,hv(e),t)}static after(e,t){return new hP(e.parentNode,hv(e)+1,t)}}let hj=[];class hI{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(2&this.flags){let n=this.dom,r=null,i;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=r?r.nextSibling:n.firstChild)){let e=hI.get(i);(!e||!e.parent&&e.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(e,t),o.flags&=-8}if(i=r?r.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&i!=o.dom&&(t.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=h$(i);else n.insertBefore(o.dom,i);r=o.dom}for((i=r?r.nextSibling:n.firstChild)&&t&&t.node==n&&(t.written=!0);i;)i=h$(i)}else if(1&this.flags)for(let n of this.children)7&n.flags&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let r=0==hk(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==this.dom)break;0==r&&t.firstChild!=t.lastChild&&(r=e==t.firstChild?-1:1),e=t}n=r<0?e:e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!hI.get(n);)n=n.nextSibling;if(!n)return this.length;for(let e=0,t=0;;e++){let r=this.children[e];if(r.dom==n)return t;t+=r.length+r.breakAfter}}domBoundsAround(e,t,n=0){let r=-1,i=-1,o=-1,s=-1;for(let a=0,l=n,c=n;a<this.children.length;a++){let n=this.children[a],h=l+n.length;if(l<e&&h>t)return n.domBoundsAround(e,t,l);if(h>=e&&-1==r&&(r=a,i=l),l>t&&n.dom.parentNode==this.dom){o=a,s=c;break}c=h,l=h+n.breakAfter}return{from:i,to:s<0?n+this.length:s,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),1&t.flags)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,7&this.flags&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=hj){this.markDirty();for(let r=e;r<t;r++){let e=this.children[r];e.parent==this&&0>n.indexOf(e)&&e.destroy()}n.length<250?this.children.splice(e,t-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(t));for(let e=0;e<n.length;e++)n[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new hL(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,r,i,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}function h$(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}hI.prototype.breakAfter=0;class hL{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function hq(e,t,n,r,i,o,s,a,l){let{children:c}=e,h=c.length?c[t]:null,u=o.length?o[o.length-1]:null,d=u?u.breakAfter:s;if(!(t==r&&h&&!s&&!d&&o.length<2&&h.merge(n,i,o.length?u:null,0==n,a,l))){if(r<c.length){let e=c[r];e&&(i<e.length||e.breakAfter&&null!=u&&u.breakAfter)?(t==r&&(e=e.split(i),i=0),!d&&u&&e.merge(0,i,u,!0,0,l)?o[o.length-1]=e:((i||e.children.length&&!e.children[0].length)&&e.merge(0,i,null,!1,0,l),o.push(e))):null!=e&&e.breakAfter&&(u?u.breakAfter=1:s=1),r++}for(h&&(h.breakAfter=s,n>0&&(!s&&o.length&&h.merge(n,h.length,o[0],!1,a,0)?h.breakAfter=o.shift().breakAfter:(n<h.length||h.children.length&&0==h.children[h.children.length-1].length)&&h.merge(n,h.length,null,!1,a,0),t++));t<r&&o.length;)if(c[r-1].become(o[o.length-1]))r--,o.pop(),l=o.length?0:a;else if(c[t].become(o[0]))t++,o.shift(),a=o.length?0:l;else break;!o.length&&t&&r<c.length&&!c[t-1].breakAfter&&c[r].merge(0,0,c[t-1],!1,a,l)&&t--,(t<r||o.length)&&e.replaceChildren(t,r,o)}}function hz(e,t,n,r,i,o){let s=e.childCursor(),{i:a,off:l}=s.findPos(n,1),{i:c,off:h}=s.findPos(t,-1),u=t-n;for(let e of r)u+=e.length;e.length+=u,hq(e,c,h,a,l,r,0,i,o)}let hB="u">typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},hF="u">typeof document?document:{documentElement:{style:{}}},hQ=/Edge\/(\d+)/.exec(hB.userAgent),hV=/MSIE \d/.test(hB.userAgent),hW=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(hB.userAgent),hU=!!(hV||hW||hQ),hH=!hU&&/gecko\/(\d+)/i.test(hB.userAgent),hG=!hU&&/Chrome\/(\d+)/.exec(hB.userAgent),hX="webkitFontSmoothing"in hF.documentElement.style,hZ=!hU&&/Apple Computer/.test(hB.vendor),hY=hZ&&(/Mobile\/\w+/.test(hB.userAgent)||hB.maxTouchPoints>2);var hJ={mac:hY||/Mac/.test(hB.platform),windows:/Win/.test(hB.platform),linux:/Linux|X11/.test(hB.platform),ie:hU,ie_version:hV?hF.documentMode||6:hW?+hW[1]:hQ?+hQ[1]:0,gecko:hH,gecko_version:hH?+(/Firefox\/(\d+)/.exec(hB.userAgent)||[0,0])[1]:0,chrome:!!hG,chrome_version:hG?+hG[1]:0,ios:hY,android:/Android\b/.test(hB.userAgent),webkit:hX,safari:hZ,webkit_version:hX?+(/\bAppleWebKit\/(\d+)/.exec(hB.userAgent)||[0,0])[1]:0,tabSize:null!=hF.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class hK extends hI{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,t,n){return!(8&this.flags)&&(!n||n instanceof hK&&!(this.length-(t-e)+n.length>256)&&!(8&n.flags))&&(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new hK(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=8&this.flags,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new hP(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return function(e,t,n){let r=e.nodeValue.length;t>r&&(t=r);let i=t,o=t,s=0;0==t&&n<0||t==r&&n>=0?hJ.chrome||hJ.gecko||(t?(i--,s=1):o<r&&(o++,s=-1)):n<0?i--:o<r&&o++;let a=hE(e,i,o).getClientRects();if(!a.length)return null;let l=a[(s?s<0:n>=0)?0:a.length-1];return hJ.safari&&!s&&0==l.width&&(l=Array.prototype.find.call(a,e=>e.width)||l),s?hO(l,s<0):l||null}(this.dom,e,t)}}class h0 extends hI{constructor(e,t=[],n=0){for(let r of(super(),this.mark=e,this.children=t,this.length=n,t))r.setParent(this)}setAttrs(e){if(h_(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,r,i,o){return(!n||!!(n instanceof h0&&n.mark.eq(this.mark))&&(!e||!(i<=0))&&(!(t<this.length)||!(o<=0)))&&(hz(this,e,t,n?n.children.slice():[],i-1,o-1),this.markDirty(),!0)}split(e){let t=[],n=0,r=-1,i=0;for(let o of this.children){let s=n+o.length;s>e&&t.push(n<e?o.split(e-n):o),r<0&&n>=e&&(r=i),n=s,i++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new h0(this.mark,t,o)}domAtPos(e){return h5(this,e)}coordsAt(e,t){return h3(this,e,t)}}class h1 extends hI{static create(e,t,n){return new h1(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=h1.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,r,i,o){return(!n||n instanceof h1&&!!this.widget.compare(n.widget)&&(!(e>0)||!(i<=0))&&(!(t<this.length)||!(o<=0)))&&(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof h1&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return ea.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):ea.empty}domAtPos(e){return(this.length?0==e:this.side>0)?hP.before(this.dom):hP.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let r=this.dom.getClientRects(),i=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let t=o?r.length-1:0;i=r[t],!(e>0?0==t:t==r.length-1||i.top<i.bottom);t+=o?-1:1);return hO(i,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class h2 extends hI{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof h2&&e.side==this.side}split(){return new h2(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?hP.before(this.dom):hP.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ea.empty}get isHidden(){return!0}}function h5(e,t){let n=e.dom,{children:r}=e,i=0;for(let e=0;i<r.length;i++){let o=r[i],s=e+o.length;if(!(s==e&&0>=o.getSide())){if(t>e&&t<s&&o.dom.parentNode==n)return o.domAtPos(t-e);if(t<=e)break;e=s}}for(let e=i;e>0;e--){let t=r[e-1];if(t.dom.parentNode==n)return t.domAtPos(t.length)}for(let e=i;e<r.length;e++){let t=r[e];if(t.dom.parentNode==n)return t.domAtPos(0)}return new hP(n,0)}function h3(e,t,n){let r=null,i=-1,o=null,s=-1;!function e(t,a){for(let l=0,c=0;l<t.children.length&&c<=a;l++){let h=t.children[l],u=c+h.length;u>=a&&(h.children.length?e(h,a-c):(!o||o.isHidden&&n>0)&&(u>a||c==u&&h.getSide()>0)?(o=h,s=a-c):(c<a||c==u&&0>h.getSide()&&!h.isHidden)&&(r=h,i=a-c)),c=u}}(e,t);let a=(n<0?r:o)||r||o;return a?a.coordsAt(Math.max(0,a==r?i:s),n):function(e){let t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();let n=hy(t);return n[n.length-1]||null}(e)}function h4(e,t){for(let n in e)"class"==n&&t.class?t.class+=" "+e.class:"style"==n&&t.style?t.style+=";"+e.style:t[n]=e[n];return t}hK.prototype.children=h1.prototype.children=h2.prototype.children=hj;let h6=Object.create(null);function h8(e,t,n){if(e==t)return!0;e||(e=h6),t||(t=h6);let r=Object.keys(e),i=Object.keys(t);if(r.length-(n&&r.indexOf(n)>-1?1:0)!=i.length-(n&&i.indexOf(n)>-1?1:0))return!1;for(let o of r)if(o!=n&&(-1==i.indexOf(o)||e[o]!==t[o]))return!1;return!0}function h9(e,t,n){let r=!1;if(t)for(let i in t)n&&i in n||(r=!0,"style"==i?e.style.cssText="":e.removeAttribute(i));if(n)for(let i in n)t&&t[i]==n[i]||(r=!0,"style"==i?e.style.cssText=n[i]:e.setAttribute(i,n[i]));return r}let h7=class{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return -1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}};var ue=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(ue||(ue={}));let ut=class extends ts{constructor(e,t,n,r){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new un(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new ui(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:i,end:o}=uo(e,t);n=(i?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new ui(e,n,r,t,e.widget||null,!0)}static line(e){return new ur(e)}static set(e,t=!1){return th.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}};ut.none=th.empty;class un extends ut{constructor(e){let{start:t,end:n}=uo(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof un&&this.tagName==e.tagName&&(this.class||(null===(t=this.attrs)||void 0===t?void 0:t.class))==(e.class||(null===(n=e.attrs)||void 0===n?void 0:n.class))&&h8(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw RangeError("Mark decorations may not be empty");return super.range(e,t)}}un.prototype.point=!1;class ur extends ut{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof ur&&this.spec.class==e.spec.class&&h8(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}ur.prototype.mapMode=ew.TrackBefore,ur.prototype.point=!0;class ui extends ut{constructor(e,t,n,r,i,o){super(t,n,i,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?ew.TrackBefore:ew.TrackAfter:ew.TrackDel}get type(){return this.startSide!=this.endSide?ue.WidgetRange:this.startSide<=0?ue.WidgetBefore:ue.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){var t,n;return e instanceof ui&&((t=this.widget)==(n=e.widget)||!!(t&&n&&t.compare(n)))&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}function uo(e,t=!1){let{inclusiveStart:n,inclusiveEnd:r}=e;return null==n&&(n=e.inclusive),null==r&&(r=e.inclusive),{start:n??t,end:r??t}}function us(e,t,n,r=0){let i=n.length-1;i>=0&&n[i]+r>=e?n[i]=Math.max(n[i],t):n.push(e,t)}ui.prototype.point=!0;class ua extends hI{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,r,i,o){if(n){if(!(n instanceof ua))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),hz(this,e,t,n?n.children.slice():[],i,o),!0}split(e){let t=new ua;if(t.breakAfter=this.breakAfter,0==this.length)return t;let{i:n,off:r}=this.childPos(e);r&&(t.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let e=n;e<this.children.length;e++)t.append(this.children[e],0);for(;n>0&&0==this.children[n-1].length;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){h8(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){!function e(t,n,r){let i,{children:o}=t;r>0&&n instanceof h0&&o.length&&(i=o[o.length-1])instanceof h0&&i.mark.eq(n.mark)?e(i,n.children[0],r-1):(o.push(n),n.setParent(t)),t.length+=n.length}(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=h4(t,this.attrs||{})),n&&(this.attrs=h4({class:n},this.attrs||{}))}domAtPos(e){return h5(this,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?4&this.flags&&(h_(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(h9(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&hI.get(r)instanceof h0;)r=r.lastChild;if(!r||!this.length||"BR"!=r.nodeName&&(null===(n=hI.get(r))||void 0===n?void 0:n.isEditable)==!1&&(!hJ.ios||!this.children.some(e=>e instanceof hK))){let e=document.createElement("BR");e.cmIgnore=!0,this.dom.appendChild(e)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof hK)||/[^ -~]/.test(n.text))return null;let r=hy(n.dom);if(1!=r.length)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=h3(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:e}=this.parent.view.viewState,t=n.bottom-n.top;if(2>Math.abs(t-e.lineHeight)&&e.textHeight<t){let r=(t-e.textHeight)/2;return{top:n.top+r,bottom:n.bottom-r,left:n.left,right:n.left}}}return n}become(e){return e instanceof ua&&0==this.children.length&&0==e.children.length&&h8(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let n=0,r=0;n<e.children.length;n++){let i=e.children[n],o=r+i.length;if(o>=t){if(i instanceof ua)return i;if(o>t)break}r=o+i.breakAfter}return null}}class ul extends hI{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,r,i,o){return(!n||n instanceof ul&&!!this.widget.compare(n.widget)&&(!(e>0)||!(i<=0))&&(!(t<this.length)||!(o<=0)))&&(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return 0==e?hP.before(this.dom):hP.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new ul(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return hj}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ea.empty}domBoundsAround(){return null}become(e){return e instanceof ul&&e.widget.constructor==this.widget.constructor&&(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)||(this.widget instanceof uc?null:hO(this.dom.getBoundingClientRect(),this.length?0==e:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t!=n&&(e<0?t<0:n>0)}}class uc extends h7{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class uh{constructor(e,t,n,r){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof ul&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new ua),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(uu(new h2(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||e&&this.content.length&&this.content[this.content.length-1]instanceof ul||this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:t,lineBreak:n,done:r}=this.cursor.next(this.skip);if(this.skip=0,r)throw Error("Ran out of text content when drawing inline views");if(n){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}this.text=t,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(uu(new hK(this.text.slice(this.textOff,this.textOff+r)),t),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,n,r,i,o){if(this.disallowBlockEffectsFor[o]&&n instanceof ui){if(n.block)throw RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw RangeError("Decorations that replace line breaks may not be specified via plugins")}let s=t-e;if(n instanceof ui){if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new ul(n.widget||ud.block,s,n));else{let o=h1.create(n.widget||ud.inline,s,s?0:n.startSide),a=this.atCursorPos&&!o.isEditable&&i<=r.length&&(e<t||n.startSide>0),l=!o.isEditable&&(e<t||i>r.length||n.startSide<=0),c=this.getLine();2!=this.pendingBuffer||a||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(r),a&&(c.append(uu(new h2(1),r),i),i=r.length+Math.max(0,i-r.length)),c.append(uu(o,r),i),this.atCursorPos=l,this.pendingBuffer=l?e<t||i>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);s&&(this.textOff+s<=this.text.length?this.textOff+=s:(this.skip+=s-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=i)}static build(e,t,n,r,i){let o=new uh(e,t,n,i);return o.openEnd=th.spans(r,t,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function uu(e,t){for(let n of t)e=new h0(n,[e],e.length);return e}class ud extends h7{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}ud.inline=new ud("span"),ud.block=new ud("div");var uf=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(uf||(uf={}));let up=uf.LTR,um=uf.RTL;function ug(e){let t=[];for(let n=0;n<e.length;n++)t.push(1<<+e[n]);return t}let uy=ug("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ub=ug("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),uv=Object.create(null),ux=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),n=e.charCodeAt(1);uv[t]=n,uv[n]=-t}function uw(e){return e<=247?uy[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?ub[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}let uk=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class uO{get dir(){return this.level%2?um:up}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,r){let i=-1;for(let o=0;o<e.length;o++){let s=e[o];if(s.from<=t&&s.to>=t){if(s.level==n)return o;(i<0||(0!=r?r<0?s.from<t:s.to>t:e[i].level>s.level))&&(i=o)}}if(i<0)throw RangeError("Index out of range");return i}}let uS=[];function uC(e){return[new uO(0,e,0)]}let uT="",uA=eP.define(),uE=eP.define(),uM=eP.define(),u_=eP.define(),uD=eP.define(),uN=eP.define(),uR=eP.define(),uP=eP.define(),uj=eP.define(),uI=eP.define({combine:e=>e.some(e=>e)}),u$=eP.define({combine:e=>e.some(e=>e)}),uL=eP.define();class uq{constructor(e,t="nearest",n="nearest",r=5,i=5,o=!1){this.range=e,this.y=t,this.x=n,this.yMargin=r,this.xMargin=i,this.isSnapshot=o}map(e){return e.empty?this:new uq(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new uq(eD.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}let uz=e6.define({map:(e,t)=>e.map(t)}),uB=e6.define();function uF(e,t,n){let r=e.facet(u_);r.length?r[0](t):window.onerror?window.onerror(String(t),n,void 0,void 0,t):n?console.error(n+":",t):console.error(t)}let uQ=eP.define({combine:e=>!e.length||e[0]}),uV=0,uW=eP.define();class uU{constructor(e,t,n,r,i){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=r,this.extension=i(this)}static define(e,t){let{eventHandlers:n,eventObservers:r,provide:i,decorations:o}=t||{};return new uU(uV++,e,n,r,e=>{let t=[uW.of(e)];return o&&t.push(uZ.of(t=>{let n=t.plugin(e);return n?o(n):ut.none})),i&&t.push(i(e)),t})}static fromClass(e,t){return uU.define(t=>new e(t),t)}}class uH{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(t){if(uF(e.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){uF(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!(null===(t=this.value)||void 0===t)&&t.destroy)try{this.value.destroy()}catch(t){uF(e.state,t,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}let uG=eP.define(),uX=eP.define(),uZ=eP.define(),uY=eP.define(),uJ=eP.define(),uK=eP.define();function u0(e,t){let n=e.state.facet(uK);if(!n.length)return n;let r=n.map(t=>t instanceof Function?t(e):t),i=[];return th.spans(r,t.from,t.to,{point(){},span(e,n,r,o){let s=e-t.from,a=n-t.from,l=i;for(let e=r.length-1;e>=0;e--,o--){let n=r[e].spec.bidiIsolate,i;if(null==n&&(n=function(e,t,n){for(let r=t;r<n;r++){let t=uw(e.charCodeAt(r));if(1==t)break;if(2==t||4==t)return um}return up}(t.text,s,a)),o>0&&l.length&&(i=l[l.length-1]).to==s&&i.direction==n)i.to=a,l=i.inner;else{let e={from:s,to:a,direction:n,inner:[]};l.push(e),l=e.inner}}}}),i}let u1=eP.define();function u2(e){let t=0,n=0,r=0,i=0;for(let o of e.state.facet(u1)){let s=o(e);s&&(null!=s.left&&(t=Math.max(t,s.left)),null!=s.right&&(n=Math.max(n,s.right)),null!=s.top&&(r=Math.max(r,s.top)),null!=s.bottom&&(i=Math.max(i,s.bottom)))}return{left:t,right:n,top:r,bottom:i}}let u5=eP.define();class u3{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}join(e){return new u3(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(0==t.length)return e;let n=[];for(let r=0,i=0,o=0,s=0;;r++){let a=r==e.length?null:e[r],l=o-s,c=a?a.fromB:1e9;for(;i<t.length&&t[i]<c;){let e=t[i],r=t[i+1],o=Math.max(s,e),a=Math.min(c,r);if(o<=a&&new u3(o+l,a+l,o,a).addToSet(n),r>c)break;i+=2}if(!a)return n;new u3(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),o=a.toA,s=a.toB}}}class u4{constructor(e,t,n){for(let r of(this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=eO.empty(this.startState.doc.length),n))this.changes=this.changes.compose(r.changes);let r=[];this.changes.iterChangedRanges((e,t,n,i)=>r.push(new u3(e,t,n,i))),this.changedRanges=r}static create(e,t,n){return new u4(e,t,n)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}class u6 extends hI{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ut.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new ua],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new u3(0,0,0,e.state.doc.length)],0,null)}update(e){var t,n,r,i,o,s;let a,l;let c=e.changedRanges;this.minWidth>0&&c.length&&(c.every(({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let h=-1;!(this.view.inputState.composing>=0)||this.view.observer.editContext||(!(null===(t=this.domChanged)||void 0===t)&&t.newSel?h=this.domChanged.newSel.head:(n=e.changes,r=this.hasComposition,a=!1,r&&n.iterChangedRanges((e,t)=>{e<r.to&&t>r.from&&(a=!0)}),a||e.selectionSet||(h=e.state.selection.main.head)));let u=h>-1?function(e,t,n){let r=u8(e,n);if(!r)return null;let{node:i,from:o,to:s}=r,a=i.nodeValue;if(/[\n\r]/.test(a)||e.state.doc.sliceString(r.from,r.to)!=a)return null;let l=t.invertedDesc,c=new u3(l.mapPos(o),l.mapPos(s),o,s),h=[];for(let t=i.parentNode;;t=t.parentNode){let n=hI.get(t);if(n instanceof h0)h.push({node:t,deco:n.mark});else{if(n instanceof ua||"DIV"==t.nodeName&&t.parentNode==e.contentDOM)return{range:c,text:i,marks:h,line:t};if(t==e.contentDOM)return null;h.push({node:t,deco:new un({inclusive:!0,attributes:function(e){let t=Object.create(null);for(let n=0;n<e.attributes.length;n++){let r=e.attributes[n];t[r.name]=r.value}return t}(t),tagName:t.tagName.toLowerCase()})})}}}(this.view,e.changes,h):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:t,to:n}=this.hasComposition;c=new u3(t,n,e.changes.mapPos(t,-1),e.changes.mapPos(n,1)).addToSet(c.slice())}this.hasComposition=u?{from:u.range.fromB,to:u.range.toB}:null,(hJ.ie||hJ.chrome)&&!u&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let d=(i=this.decorations,o=this.updateDeco(),s=e.changes,l=new u9,th.compare(i,o,s,l),l.changes);return c=u3.extendWithRanges(c,d),(!!(7&this.flags)||0!=c.length)&&(this.updateInner(c,e.startState.doc.length,u),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let e=hJ.chrome||hJ.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,e),this.flags&=-8,e&&(e.written||r.selectionRange.focusNode!=e.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(e=>e.flags&=-9);let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let e of this.children)e instanceof ul&&e.widget instanceof uc&&i.push(e.dom);r.updateGaps(i)}updateChildren(e,t,n){let r=n?n.range.addToSet(e.slice()):e,i=this.childCursor(t);for(let e=r.length-1;;e--){let t=e>=0?r[e]:null;if(!t)break;let{fromA:o,toA:s,fromB:a,toB:l}=t,c,h,u,d;if(n&&n.range.fromB<l&&n.range.toB>a){let e=uh.build(this.view.state.doc,a,n.range.fromB,this.decorations,this.dynamicDecorationMap),t=uh.build(this.view.state.doc,n.range.toB,l,this.decorations,this.dynamicDecorationMap);h=e.breakAtStart,u=e.openStart,d=t.openEnd;let r=this.compositionView(n);t.breakAtStart?r.breakAfter=1:t.content.length&&r.merge(r.length,r.length,t.content[0],!1,t.openStart,0)&&(r.breakAfter=t.content[0].breakAfter,t.content.shift()),e.content.length&&r.merge(0,0,e.content[e.content.length-1],!0,0,e.openEnd)&&e.content.pop(),c=e.content.concat(r).concat(t.content)}else({content:c,breakAtStart:h,openStart:u,openEnd:d}=uh.build(this.view.state.doc,a,l,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=i.findPos(s,1),{i:m,off:g}=i.findPos(o,-1);hq(this,m,g,f,p,c,h,u,d)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){for(let t of(this.editContextFormatting=this.editContextFormatting.map(e.changes),e.transactions))for(let e of t.effects)e.is(uB)&&(this.editContextFormatting=e.value)}compositionView(e){let t=new hK(e.text.nodeValue);for(let{deco:n}of(t.flags|=8,e.marks))t=new h0(n,[t],t.length);let n=new ua;return n.append(t,0),n}fixCompositionDOM(e){let t=(e,t)=>{t.flags|=8|(t.children.some(e=>7&e.flags)?1:0),this.markedForComposition.add(t);let n=hI.get(e);n&&n!=t&&(n.dom=null),t.setDOM(e)},n=this.childPos(e.range.fromB,1),r=this.children[n.i];t(e.line,r);for(let i=e.marks.length-1;i>=-1;i--)n=r.childPos(n.off,1),r=r.children[n.i],t(i>=0?e.marks[i].node:e.text,r)}updateSelection(e=!1,t=!1){var n;(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,i=r==this.dom,o=!i&&!(this.view.state.facet(uQ)||this.dom.tabIndex>-1)&&hg(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(i||t||o))return;let s=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(hJ.gecko&&a.empty&&!this.hasComposition&&1==(n=l).node.nodeType&&n.node.firstChild&&(0==n.offset||"false"==n.node.childNodes[n.offset-1].contentEditable)&&(n.offset==n.node.childNodes.length||"false"==n.node.childNodes[n.offset].contentEditable)){let e=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(e,l.node.childNodes[l.offset]||null)),l=c=new hP(e,0),s=!0}let h=this.view.observer.selectionRange;!s&&h.focusNode&&(hb(l.node,l.offset,h.anchorNode,h.anchorOffset)&&hb(c.node,c.offset,h.focusNode,h.focusOffset)||this.suppressWidgetCursorChange(h,a))||(this.view.observer.ignore(()=>{hJ.android&&hJ.chrome&&this.dom.contains(h.focusNode)&&function(e,t){for(let n=e;n&&n!=t;n=n.assignedSlot||n.parentNode)if(1==n.nodeType&&"false"==n.contentEditable)return!0;return!1}(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let e=hp(this.view.root);if(e){if(a.empty){if(hJ.gecko){var t,n;let e=(t=l.node,n=l.offset,1!=t.nodeType?0:(n&&"false"==t.childNodes[n-1].contentEditable?1:0)|(n<t.childNodes.length&&"false"==t.childNodes[n].contentEditable?2:0));if(e&&3!=e){let t=(1==e?hN:hR)(l.node,l.offset);t&&(l=new hP(t.node,t.offset))}}e.collapse(l.node,l.offset),null!=a.bidiLevel&&void 0!==e.caretBidiLevel&&(e.caretBidiLevel=a.bidiLevel)}else if(e.extend){e.collapse(l.node,l.offset);try{e.extend(c.node,c.offset)}catch{}}else{let t=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),t.setEnd(c.node,c.offset),t.setStart(l.node,l.offset),e.removeAllRanges(),e.addRange(t)}}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new hP(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new hP(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&hb(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=hp(e.root),{anchorNode:r,anchorOffset:i}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let o=ua.find(this,t.head);if(!o)return;let s=o.posAtStart;if(t.head==s||t.head==s+o.length)return;let a=this.coordsAt(t.head,-1),l=this.coordsAt(t.head,1);if(!a||!l||a.bottom>l.top)return;let c=this.domAtPos(t.head+t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&n.collapse(r,i)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let r=e.offset;!n&&r<t.childNodes.length;r++){let e=hI.get(t.childNodes[r]);e instanceof ua&&(n=e.domAtPos(0))}for(let r=e.offset-1;!n&&r>=0;r--){let e=hI.get(t.childNodes[r]);e instanceof ua&&(n=e.domAtPos(e.length))}return n?new hP(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let e=hI.get(t);if(e&&e.rootView==this)return e;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let e=this.children[t];if(n<e.length||e instanceof ua)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,r=0;for(let i=this.length,o=this.children.length-1;o>=0;o--){let s=this.children[o],a=i-s.breakAfter,l=a-s.length;if(a<e)break;if(l<=e&&(l<e||s.covers(-1))&&(a>e||s.covers(1))&&(!n||s instanceof ua&&!(n instanceof ua&&t>=0)))n=s,r=l;else if(n&&l==e&&a==e&&s instanceof ul&&2>Math.abs(t)){if(s.deco.startSide<0)break;o&&(n=null)}i=l}return n?n.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),r=this.children[t];if(!(r instanceof ua))return null;for(;r.children.length;){let{i:e,off:t}=r.childPos(n,1);for(;;e++){if(e==r.children.length)return null;if((r=r.children[e]).length)break}n=t}if(!(r instanceof hK))return null;let i=eg(r.text,n);if(i==n)return null;let o=hE(r.dom,n,i).getClientRects();for(let e=0;e<o.length;e++){let t=o[e];if(e==o.length-1||t.top<t.bottom&&t.left<t.right)return t}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:r}=e,i=this.view.contentDOM.clientWidth,o=i>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,s=-1,a=this.view.textDirection==uf.LTR;for(let e=0,l=0;l<this.children.length;l++){let c=this.children[l],h=e+c.length;if(h>r)break;if(e>=n){let n=c.dom.getBoundingClientRect();if(t.push(n.height),o){let t=c.dom.lastChild,r=t?hy(t):[];if(r.length){let t=r[r.length-1],o=a?t.right-n.left:n.right-t.left;o>s&&(s=o,this.minWidth=i,this.minWidthFrom=e,this.minWidthTo=h)}}}e=h+c.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return"rtl"==getComputedStyle(this.children[t].dom).direction?uf.RTL:uf.LTR}measureTextSize(){for(let e of this.children)if(e instanceof ua){let t=e.measureTextSize();if(t)return t}let e=document.createElement("div"),t,n,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let i=hy(e.firstChild)[0];t=e.getBoundingClientRect().height,n=i?i.width/27:7,r=i?i.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new hL(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,r=0;;r++){let i=r==t.viewports.length?null:t.viewports[r],o=i?i.from-1:this.length;if(o>n){let r=(t.lineBlockAt(o).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(ut.replace({widget:new uc(r),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!i)break;n=i.to+1}return ut.set(e)}updateDeco(){let e=1,t=this.view.state.facet(uZ).map(t=>(this.dynamicDecorationMap[e++]="function"==typeof t)?t(this.view):t),n=!1,r=this.view.state.facet(uY).map((e,t)=>{let r="function"==typeof e;return r&&(n=!0),r?e(this.view):e});for(r.length&&(this.dynamicDecorationMap[e++]=n,t.push(th.join(r))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let t=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=t.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let t of this.view.state.facet(uL))try{if(t(this.view,e.range,e))return!0}catch(e){uF(this.view.state,e,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!n)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let i=u2(this.view),o={left:n.left-i.left,top:n.top-i.top,right:n.right+i.right,bottom:n.bottom+i.bottom},{offsetWidth:s,offsetHeight:a}=this.view.scrollDOM;!function(e,t,n,r,i,o,s,a){let l=e.ownerDocument,c=l.defaultView||window;for(let h=e,u=!1;h&&!u;)if(1==h.nodeType){let e,d=h==l.body,f=1,p=1;if(d)e=function(e){let t=e.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let t=h.getBoundingClientRect();({scaleX:f,scaleY:p}=hS(h,t)),e={left:t.left,right:t.left+h.clientWidth*f,top:t.top,bottom:t.top+h.clientHeight*p}}let m=0,g=0;if("nearest"==i)t.top<e.top?(g=-(e.top-t.top+s),n>0&&t.bottom>e.bottom+g&&(g=t.bottom-e.bottom+g+s)):t.bottom>e.bottom&&(g=t.bottom-e.bottom+s,n<0&&t.top-g<e.top&&(g=-(e.top+g-t.top+s)));else{let r=t.bottom-t.top,o=e.bottom-e.top;g=("center"==i&&r<=o?t.top+r/2-o/2:"start"==i||"center"==i&&n<0?t.top-s:t.bottom-o+s)-e.top}if("nearest"==r?t.left<e.left?(m=-(e.left-t.left+o),n>0&&t.right>e.right+m&&(m=t.right-e.right+m+o)):t.right>e.right&&(m=t.right-e.right+o,n<0&&t.left<e.left+m&&(m=-(e.left+m-t.left+o))):m=("center"==r?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==r==a?t.left-o:t.right-(e.right-e.left)+o)-e.left,m||g){if(d)c.scrollBy(m,g);else{let e=0,n=0;if(g){let e=h.scrollTop;h.scrollTop+=g/p,n=(h.scrollTop-e)*p}if(m){let t=h.scrollLeft;h.scrollLeft+=m/f,e=(h.scrollLeft-t)*f}t={left:t.left-e,top:t.top-n,right:t.right-e,bottom:t.bottom-n},e&&1>Math.abs(e-m)&&(r="nearest"),n&&1>Math.abs(n-g)&&(i="nearest")}}if(d)break;h=h.assignedSlot||h.parentNode}else if(11==h.nodeType)h=h.host;else break}(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,s),-s),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==uf.LTR)}}function u8(e,t){let n=e.observer.selectionRange;if(!n.focusNode)return null;let r=hN(n.focusNode,n.focusOffset),i=hR(n.focusNode,n.focusOffset),o=r||i;if(i&&r&&i.node!=r.node){let t=hI.get(i.node);if(!t||t instanceof hK&&t.text!=i.node.nodeValue)o=i;else if(e.docView.lastCompositionAfterCursor){let e=hI.get(r.node);!e||e instanceof hK&&e.text!=r.node.nodeValue||(o=i)}}if(e.docView.lastCompositionAfterCursor=o!=r,!o)return null;let s=t-o.offset;return{from:s,to:s+o.node.nodeValue.length,node:o.node}}let u9=class{constructor(){this.changes=[]}compareRange(e,t){us(e,t,this.changes)}comparePoint(e,t){us(e,t,this.changes)}boundChange(e){us(e,e,this.changes)}};function u7(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function de(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function dt(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function dn(e,t,n){let r=e.nodeValue.length,i=-1,o=1e9,s=0;for(let a=0;a<r;a++){let r=hE(e,a,a+1).getClientRects();for(let l=0;l<r.length;l++){let c=r[l];if(c.top==c.bottom)continue;s||(s=t-c.left);let h=(c.top>n?c.top-n:n-c.bottom)-1;if(c.left-1<=t&&c.right+1>=t&&h<o){let n=t>=(c.left+c.right)/2,r=n;if((hJ.chrome||hJ.gecko)&&hE(e,a).getBoundingClientRect().left==c.right&&(r=!n),h<=0)return{node:e,offset:a+(r?1:0)};i=a+(r?1:0),o=h}}}return{node:e,offset:i>-1?i:s>0?e.nodeValue.length:0}}function dr(e,t,n,r=-1){var i,o;let s=e.contentDOM.getBoundingClientRect(),a=s.top+e.viewState.paddingTop,l,{docHeight:c}=e.viewState,{x:h,y:u}=t,d=u-a;if(d<0)return 0;if(d>c)return e.state.doc.length;for(let t=e.viewState.heightOracle.textHeight/2,i=!1;(l=e.elementAtHeight(d)).type!=ue.Text;)for(;!((d=r>0?l.bottom+t:l.top-t)>=0&&d<=c);){if(i)return n?null:0;i=!0,r=-r}u=a+d;let f=l.from;if(f<e.viewport.from)return 0==e.viewport.from?0:n?null:di(e,s,l,h,u);if(f>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:n?null:di(e,s,l,h,u);let p=e.dom.ownerDocument,m=e.root.elementFromPoint?e.root:p,g=m.elementFromPoint(h,u);g&&!e.contentDOM.contains(g)&&(g=null),g||(h=Math.max(s.left+1,Math.min(s.right-1,h)),(g=m.elementFromPoint(h,u))&&!e.contentDOM.contains(g)&&(g=null));let y,b=-1;if(g&&(null===(i=e.docView.nearest(g))||void 0===i?void 0:i.isEditable)!=!1){if(p.caretPositionFromPoint){let e=p.caretPositionFromPoint(h,u);e&&({offsetNode:y,offset:b}=e)}else if(p.caretRangeFromPoint){let t=p.caretRangeFromPoint(h,u);t&&({startContainer:y,startOffset:b}=t,(!e.contentDOM.contains(y)||hJ.safari&&function(e,t,n){let r;if(3!=e.nodeType||t!=(r=e.nodeValue.length))return!1;for(let t=e.nextSibling;t;t=t.nextSibling)if(1!=t.nodeType||"BR"!=t.nodeName)return!1;return hE(e,r-1,r).getBoundingClientRect().left>n}(y,b,h)||hJ.chrome&&function(e,t,n){if(0!=t)return!1;for(let t=e;;){let e=t.parentNode;if(!e||1!=e.nodeType||e.firstChild!=t)return!1;if(e.classList.contains("cm-line"))break;t=e}return n-(1==e.nodeType?e.getBoundingClientRect():hE(e,0,Math.max(e.nodeValue.length,1)).getBoundingClientRect()).left>5}(y,b,h))&&(y=void 0))}y&&(b=Math.min(hk(y),b))}if(!y||!e.docView.dom.contains(y)){let t=ua.find(e.docView,f);if(!t)return d>l.top+l.height/2?l.to:l.from;({node:y,offset:b}=function e(t,n,r){let i,o,s,a,l=!1,c,h,u,d;for(let m=t.firstChild;m;m=m.nextSibling){let t=hy(m);for(let g=0;g<t.length;g++){var f,p;let y=t[g];o&&u7(o,y)&&(y=de(dt(y,o.bottom),o.top));let b=(f=y).left>n?f.left-n:Math.max(0,n-f.right),v=(p=y).top>r?p.top-r:Math.max(0,r-p.bottom);if(0==b&&0==v)return 3==m.nodeType?dn(m,n,r):e(m,n,r);if(!i||a>v||a==v&&s>b){i=m,o=y,s=b,a=v;let e=v?r<y.top?-1:1:b?n<y.left?-1:1:0;l=!e||(e>0?g<t.length-1:g>0)}0==b?r>y.bottom&&(!u||u.bottom<y.bottom)?(c=m,u=y):r<y.top&&(!d||d.top>y.top)&&(h=m,d=y):u&&u7(u,y)?u=dt(u,y.bottom):d&&u7(d,y)&&(d=de(d,y.top))}}if(u&&u.bottom>=r?(i=c,o=u):d&&d.top<=r&&(i=h,o=d),!i)return{node:t,offset:0};let m=Math.max(o.left,Math.min(o.right,n));if(3==i.nodeType)return dn(i,m,r);if(l&&"false"!=i.contentEditable)return e(i,m,r);let g=Array.prototype.indexOf.call(t.childNodes,i)+(n>=(o.left+o.right)/2?1:0);return{node:t,offset:g}}(t.dom,h,u))}let v=e.docView.nearest(y);if(!v)return null;if(!v.isWidget||(null===(o=v.dom)||void 0===o?void 0:o.nodeType)!=1)return v.localPosFromDOM(y,b)+v.posAtStart;{let e=v.dom.getBoundingClientRect();return t.y<e.top||t.y<=e.bottom&&t.x<=(e.left+e.right)/2?v.posAtStart:v.posAtEnd}}function di(e,t,n,r,i){let o=Math.round((r-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&n.height>1.5*e.defaultLineHeight){let t=e.viewState.heightOracle.textHeight;o+=Math.floor((i-n.top-(e.defaultLineHeight-t)*.5)/t)*e.viewState.heightOracle.lineLength}let s=e.state.sliceDoc(n.from,n.to);return n.from+tO(s,o,e.state.tabSize)}function ds(e,t){let n=e.lineBlockAt(t);if(Array.isArray(n.type)){for(let e of n.type)if(e.to>t||e.to==t&&(e.to==n.to||e.type==ue.Text))return e}return n}function da(e,t,n,r){let i=e.state.doc.lineAt(t.head),o=e.bidiSpans(i),s=e.textDirectionAt(i.from);for(let a=t,l=null;;){let t=function(e,t,n,r,i){var o;let s=r.head-e.from,a=uO.find(t,s,null!==(o=r.bidiLevel)&&void 0!==o?o:-1,r.assoc),l=t[a],c=l.side(i,n);if(s==c){let e=a+=i?1:-1;if(e<0||e>=t.length)return null;s=(l=t[a=e]).side(!i,n),c=l.side(i,n)}let h=eg(e.text,s,l.forward(i,n));(h<l.from||h>l.to)&&(h=c),uT=e.text.slice(Math.min(s,h),Math.max(s,h));let u=a==(i?t.length-1:0)?null:t[a+(i?1:-1)];return u&&h==c&&u.level+(i?0:1)<l.level?eD.cursor(u.side(!i,n)+e.from,u.forward(i,n)?1:-1,u.level):eD.cursor(h+e.from,l.forward(i,n)?-1:1,l.level)}(i,o,s,a,n),c=uT;if(!t){if(i.number==(n?e.state.doc.lines:1))return a;c=`
`,i=e.state.doc.line(i.number+(n?1:-1)),o=e.bidiSpans(i),t=e.visualLineSide(i,!n)}if(l){if(!l(c))return a}else{if(!r)return t;l=r(c)}a=t}}function dl(e,t,n){for(;;){let r=0;for(let i of e)i.between(t-1,t+1,(e,i,o)=>{if(t>e&&t<i){let o=r||n||(t-e<i-t?-1:1);t=o<0?e:i,r=o}});if(!r)return t}}function dc(e,t,n){let r=dl(e.state.facet(uJ).map(t=>t(e)),n.from,t.head>n.from?-1:1);return r==n.from?n:eD.cursor(r,r<n.from?1:-1)}class dh{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(ti.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=""}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r);let e=this.text.length;this.readNode(r);let i=r.nextSibling;if(i==t)break;let o=hI.get(r),s=hI.get(i);(o&&s?o.breakAfter:(o?o.breakAfter:hx(r))||hx(i)&&("BR"!=r.nodeName||r.cmIgnore)&&this.text.length>e)&&this.lineBreak(),r=i}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let i=-1,o=1,s;if(this.lineSeparator?(i=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(s=r.exec(t))&&(i=s.index,o=s[0].length),this.append(t.slice(n,i<0?t.length:i)),i<0)break;if(this.lineBreak(),o>1)for(let t of this.points)t.node==e&&t.pos>this.text.length&&(t.pos-=o-1);n=i+o}}readNode(e){if(e.cmIgnore)return;let t=hI.get(e),n=t&&t.overrideDOMText;if(null!=n){this.findPointInside(e,n.length);for(let e=n.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(3==e.nodeType?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(!function(e,t,n){for(;;){if(!t||n<hk(t))return!1;if(t==e)return!0;n=hv(t)+1,t=t.parentNode}}(e,n.node,n.offset)?0:t))}}class du{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class dd{constructor(e,t,n,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:i,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let t=i||o?[]:function(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}=e.observer.selectionRange;return n&&(t.push(new du(n,r)),(i!=n||o!=r)&&t.push(new du(i,o))),t}(e),n=new dh(t,e.state);n.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=n.text,this.newSel=function(e,t){if(0==e.length)return null;let n=e[0].pos,r=2==e.length?e[1].pos:n;return n>-1&&r>-1?eD.single(n+t,r+t):null}(t,this.bounds.from)}else{let t=e.observer.selectionRange,n=i&&i.node==t.focusNode&&i.offset==t.focusOffset||!hm(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),r=o&&o.node==t.anchorNode&&o.offset==t.anchorOffset||!hm(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset),s=e.viewport;if((hJ.ios||hJ.chrome)&&e.state.selection.main.empty&&n!=r&&(s.from>0||s.to<e.state.doc.length)){let t=Math.min(n,r),i=Math.max(n,r),o=s.from-t,a=s.to-i;(0==o||1==o||0==t)&&(0==a||-1==a||i==e.state.doc.length)&&(n=0,r=e.state.doc.length)}this.newSel=eD.single(r,n)}}}function df(e,t){let n,{newSel:r}=t,i=e.state.selection.main,o=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;if(t.bounds){let{from:r,to:s}=t.bounds,a=i.from,l=null;(8===o||hJ.android&&t.text.length<s-r)&&(a=i.to,l="end");let c=function(e,t,n,r){let i=Math.min(e.length,t.length),o=0;for(;o<i&&e.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==i&&e.length==t.length)return null;let s=e.length,a=t.length;for(;s>0&&a>0&&e.charCodeAt(s-1)==t.charCodeAt(a-1);)s--,a--;if("end"==r){let e=Math.max(0,o-Math.min(s,a));n-=s+e-o}if(s<o&&e.length<t.length){let e=n<=o&&n>=s?o-n:0;o-=e,a=o+(a-s),s=o}else if(a<o){let e=n<=o&&n>=a?o-n:0;o-=e,s=o+(s-a),a=o}return{from:o,toA:s,toB:a}}(e.state.doc.sliceString(r,s,""),t.text,a-r,l);c&&(hJ.chrome&&13==o&&c.toB==c.from+2&&""==t.text.slice(c.from,c.toB)&&c.toB--,n={from:r+c.from,to:r+c.toA,insert:ea.of(t.text.slice(c.from,c.toB).split(""))})}else r&&(!e.hasFocus&&e.state.facet(uQ)||r.main.eq(i))&&(r=null);if(!n&&!r)return!1;if(!n&&t.typeOver&&!i.empty&&r&&r.main.empty?n={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,i.to)}:(hJ.mac||hJ.android)&&n&&n.from==n.to&&n.from==i.head-1&&/^\. ?$/.test(n.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(r&&2==n.insert.length&&(r=eD.single(r.main.anchor-1,r.main.head-1)),n={from:n.from,to:n.to,insert:ea.of([n.insert.toString().replace("."," ")])}):n&&n.from>=i.from&&n.to<=i.to&&(n.from!=i.from||n.to!=i.to)&&i.to-i.from-(n.to-n.from)<=4?n={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,n.from).append(n.insert).append(e.state.doc.slice(n.to,i.to))}:hJ.chrome&&n&&n.from==n.to&&n.from==i.head&&n.insert.toString()==`
 `&&e.lineWrapping&&(r&&(r=eD.single(r.main.anchor-1,r.main.head-1)),n={from:i.from,to:i.to,insert:ea.of([" "])}),n)return dp(e,n,r,o);if(!r||r.main.eq(i))return!1;{let t=!1,n="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),n=e.inputState.lastSelectionOrigin),e.dispatch({selection:r,scrollIntoView:t,userEvent:n}),!0}}function dp(e,t,n,r=-1){if(hJ.ios&&e.inputState.flushIOSKey(t))return!0;let i=e.state.selection.main;if(hJ.android&&(t.to==i.to&&(t.from==i.from||t.from==i.from-1&&" "==e.state.sliceDoc(t.from,i.from))&&1==t.insert.length&&2==t.insert.lines&&hM(e.contentDOM,"Enter",13)||(t.from==i.from-1&&t.to==i.to&&0==t.insert.length||8==r&&t.insert.length<t.to-t.from&&t.to>i.head)&&hM(e.contentDOM,"Backspace",8)||t.from==i.from&&t.to==i.to+1&&0==t.insert.length&&hM(e.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();e.inputState.composing>=0&&e.inputState.composing++;let s,a=()=>s||(s=function(e,t,n){let r,i=e.state,o=i.selection.main;if(t.from>=o.from&&t.to<=o.to&&t.to-t.from>=(o.to-o.from)/3&&(!n||n.main.empty&&n.main.from==t.from+t.insert.length)&&e.inputState.composing<0){let n=o.from<t.from?i.sliceDoc(o.from,t.from):"",s=o.to>t.to?i.sliceDoc(t.to,o.to):"";r=i.replaceSelection(e.state.toText(n+t.insert.sliceString(0,void 0,e.state.lineBreak)+s))}else{let s=i.changes(t),a=n&&n.main.to<=s.newLength?n.main:void 0;if(i.selection.ranges.length>1&&e.inputState.composing>=0&&t.to<=o.to&&t.to>=o.to-10){let l=e.state.sliceDoc(t.from,t.to),c,h=n&&u8(e,n.main.head);if(h){let e=t.insert.length-(t.to-t.from);c={from:h.from,to:h.to-e}}else c=e.state.doc.lineAt(o.head);let u=o.to-t.to,d=o.to-o.from;r=i.changeByRange(n=>{if(n.from==o.from&&n.to==o.to)return{changes:s,range:a||n.map(s)};let r=n.to-u,h=r-l.length;if(n.to-n.from!=d||e.state.sliceDoc(h,r)!=l||n.to>=c.from&&n.from<=c.to)return{range:n};let f=i.changes({from:h,to:r,insert:t.insert}),p=n.to-o.to;return{changes:f,range:a?eD.range(Math.max(0,a.anchor+p),Math.max(0,a.head+p)):n.map(f)}})}else r={changes:s,selection:a&&i.selection.replaceRange(a)}}let s="input.type";return(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,s+=".compose",e.inputState.compositionFirstChange&&(s+=".start",e.inputState.compositionFirstChange=!1)),i.update(r,{userEvent:s,scrollIntoView:!0})}(e,t,n));return e.state.facet(uN).some(n=>n(e,t.from,t.to,o,a))||e.dispatch(a()),!0}let dm=class{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,hJ.safari&&e.contentDOM.addEventListener("input",()=>null),hJ.gecko&&function(e){dz.has(e)||(dz.add(e),e.addEventListener("copy",()=>{}),e.addEventListener("cut",()=>{}))}(e.contentDOM.ownerDocument)}handleEvent(e){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target,r;n!=e.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(r=hI.get(n))&&r.ignoreEvent(t))return!1;return!0}(this.view,e)||this.ignoreDuringComposition(e)||"keydown"==e.type&&this.keydown(e)||(0!=this.view.updateState?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let n=this.handlers[e];if(n){for(let e of n.observers)e(this.view,t);for(let e of n.handlers){if(t.defaultPrevented)break;if(e(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=function(e){let t=Object.create(null);function n(e){return t[e]||(t[e]={observers:[],handlers:[]})}for(let t of e){let e=t.spec;if(e&&e.domEventHandlers)for(let r in e.domEventHandlers){let i=e.domEventHandlers[r];i&&n(r).handlers.push(dg(t.value,i))}if(e&&e.domEventObservers)for(let r in e.domEventObservers){let i=e.domEventObservers[r];i&&n(r).observers.push(dg(t.value,i))}}for(let e in dk)n(e).handlers.push(dk[e]);for(let e in dO)n(e).observers.push(dO[e]);return t}(e),n=this.handlers,r=this.view.contentDOM;for(let e in t)if("scroll"!=e){let i=!t[e].handlers.length,o=n[e];o&&!o.handlers.length!=i&&(r.removeEventListener(e,this.handleEvent),o=null),o||r.addEventListener(e,this.handleEvent,{passive:i})}for(let e in n)"scroll"==e||t[e]||r.removeEventListener(e,this.handleEvent);this.handlers=t}keydown(e){let t;return this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),!!(9==e.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))||((this.tabFocusMode>0&&27!=e.keyCode&&0>dv.indexOf(e.keyCode)&&(this.tabFocusMode=-1),hJ.android&&hJ.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))?(this.view.observer.delayAndroidKey(e.key,e.keyCode),!0):hJ.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=dy.find(t=>t.keyCode==e.keyCode))&&!e.ctrlKey||db.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(229!=e.keyCode&&this.view.observer.forceFlush(),!1))}flushIOSKey(e){let t=this.pendingIOSKey;return!(!t||"Enter"==t.key&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString()))&&(this.pendingIOSKey=void 0,hM(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&(this.composing>0||!!(hJ.safari&&!hJ.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}};function dg(e,t){return(n,r)=>{try{return t.call(e,r,n)}catch(e){uF(n.state,e)}}}let dy=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],db="dthko",dv=[16,17,18,20,91,92,224,225];function dx(e){return .7*Math.max(0,e)+8}class dw{constructor(e,t,n,r){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=function(e){let t=e.ownerDocument,n,r;for(let i=e.parentNode;i&&!(i==t.body||n&&r);)if(1==i.nodeType)!r&&i.scrollHeight>i.clientHeight&&(r=i),!n&&i.scrollWidth>i.clientWidth&&(n=i),i=i.assignedSlot||i.parentNode;else if(11==i.nodeType)i=i.host;else break;return{x:n,y:r}}(e.contentDOM),this.atoms=e.state.facet(uJ).map(t=>t(e));let i=e.contentDOM.ownerDocument;i.addEventListener("mousemove",this.move=this.move.bind(this)),i.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ti.allowMultipleSelections)&&function(e,t){let n=e.state.facet(uA);return n.length?n[0](t):hJ.mac?t.metaKey:t.ctrlKey}(e,t),this.dragging=!!function(e,t){let{main:n}=e.state.selection;if(n.empty)return!1;let r=hp(e.root);if(!r||0==r.rangeCount)return!0;let i=r.getRangeAt(0).getClientRects();for(let e=0;e<i.length;e++){let n=i[e];if(n.left<=t.clientX&&n.right>=t.clientX&&n.top<=t.clientY&&n.bottom>=t.clientY)return!0}return!1}(e,t)&&1==dP(t)&&null}start(e){!1===this.dragging&&this.select(e)}move(e){var t;if(0==e.buttons)return this.destroy();if(this.dragging||null==this.dragging&&10>Math.max(Math.abs((t=this.startEvent).clientX-e.clientX),Math.abs(t.clientY-e.clientY)))return;this.select(this.lastEvent=e);let n=0,r=0,i=0,o=0,s=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:s}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=u2(this.view);e.clientX-l.left<=i+6?n=-dx(i-e.clientX):e.clientX+l.right>=s-6&&(n=dx(e.clientX-s)),e.clientY-l.top<=o+6?r=-dx(o-e.clientY):e.clientY+l.bottom>=a-6&&(r=dx(e.clientY-a)),this.setScrollSpeed(n,r)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let r=e.ranges[n],i=null;if(r.empty){let e=dl(this.atoms,r.from,0);e!=r.from&&(i=eD.cursor(e,-1))}else{let e=dl(this.atoms,r.from,-1),t=dl(this.atoms,r.to,1);(e!=r.from||t!=r.to)&&(i=eD.range(r.from==r.anchor?e:t,r.from==r.head?e:t))}i&&(t||(t=e.ranges.slice()),t[n]=i)}return t?eD.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,!1===this.dragging))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}let dk=Object.create(null),dO=Object.create(null),dS=hJ.ie&&hJ.ie_version<15||hJ.ios&&hJ.webkit_version<604;function dC(e,t,n){for(let r of e.facet(t))n=r(n,e);return n}function dT(e,t){t=dC(e.state,uP,t);let{state:n}=e,r,i=1,o=n.toText(t),s=o.lines==n.selection.ranges.length;if(null!=dI&&n.selection.ranges.every(e=>e.empty)&&dI==o.toString()){let e=-1;r=n.changeByRange(r=>{let a=n.doc.lineAt(r.from);if(a.from==e)return{range:r};e=a.from;let l=n.toText((s?o.line(i++).text:t)+n.lineBreak);return{changes:{from:a.from,insert:l},range:eD.cursor(r.from+l.length)}})}else r=s?n.changeByRange(e=>{let t=o.line(i++);return{changes:{from:e.from,to:e.to,insert:t.text},range:eD.cursor(e.from+t.length)}}):n.replaceSelection(o);e.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}function dA(e,t,n,r){if(1==r)return eD.cursor(t,n);if(2==r)return function(e,t,n=1){let r=e.charCategorizer(t),i=e.doc.lineAt(t),o=t-i.from;if(0==i.length)return eD.cursor(t);0==o?n=1:o==i.length&&(n=-1);let s=o,a=o;n<0?s=eg(i.text,o,!1):a=eg(i.text,o);let l=r(i.text.slice(s,a));for(;s>0;){let e=eg(i.text,s,!1);if(r(i.text.slice(e,s))!=l)break;s=e}for(;a<i.length;){let e=eg(i.text,a);if(r(i.text.slice(a,e))!=l)break;a=e}return eD.range(s+i.from,a+i.from)}(e.state,t,n);{let n=ua.find(e.docView,t),r=e.state.doc.lineAt(n?n.posAtEnd:t),i=n?n.posAtStart:r.from,o=n?n.posAtEnd:r.to;return o<e.state.doc.length&&o==r.to&&o++,eD.range(i,o)}}dO.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},dk.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),27==t.keyCode&&0!=e.inputState.tabFocusMode&&(e.inputState.tabFocusMode=Date.now()+2e3),!1),dO.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},dO.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},dk.mousedown=(e,t)=>{if(e.observer.flush(),e.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let r of e.state.facet(uM))if(n=r(e,t))break;if(n||0!=t.button||(n=function(e,t){let n=dM(e,t),r=dP(t),i=e.state.selection;return{update(e){e.docChanged&&(n.pos=e.changes.mapPos(n.pos),i=i.map(e.changes))},get(t,o,s){let a=dM(e,t),l,c=dA(e,a.pos,a.bias,r);if(n.pos!=a.pos&&!o){let t=dA(e,n.pos,n.bias,r),i=Math.min(t.from,c.from),o=Math.max(t.to,c.to);c=i<c.from?eD.range(i,o):eD.range(o,i)}return o?i.replaceRange(i.main.extend(c.from,c.to)):s&&1==r&&i.ranges.length>1&&(l=function(e,t){for(let n=0;n<e.ranges.length;n++){let{from:r,to:i}=e.ranges[n];if(r<=t&&i>=t)return eD.create(e.ranges.slice(0,n).concat(e.ranges.slice(n+1)),e.mainIndex==n?0:e.mainIndex-(e.mainIndex>n?1:0))}return null}(i,a.pos))?l:s?i.addRange(c):eD.create([c])}}}(e,t)),n){let r=!e.hasFocus;e.inputState.startMouseSelection(new dw(e,t,n,r)),r&&e.observer.ignore(()=>{hA(e.contentDOM);let t=e.root.activeElement;t&&!t.contains(e.contentDOM)&&t.blur()});let i=e.inputState.mouseSelection;if(i)return i.start(t),!1===i.dragging}return!1};let dE=(e,t,n)=>t>=n.top&&t<=n.bottom&&e>=n.left&&e<=n.right;function dM(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:n,bias:function(e,t,n,r){let i=ua.find(e.docView,t);if(!i)return 1;let o=t-i.posAtStart;if(0==o)return 1;if(o==i.length)return -1;let s=i.coordsAt(o,-1);if(s&&dE(n,r,s))return -1;let a=i.coordsAt(o,1);return a&&dE(n,r,a)?1:s&&s.bottom>=r?-1:1}(e,n,t.clientX,t.clientY)}}let d_=hJ.ie&&hJ.ie_version<=11,dD=null,dN=0,dR=0;function dP(e){if(!d_)return e.detail;let t=dD,n=dR;return dD=e,dR=Date.now(),dN=!t||n>Date.now()-400&&2>Math.abs(t.clientX-e.clientX)&&2>Math.abs(t.clientY-e.clientY)?(dN+1)%3:1}function dj(e,t,n,r){let i;if(!(n=dC(e.state,uP,n)))return;let o=e.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:s}=e.inputState,a=r&&s&&((i=e.state.facet(uE)).length?i[0](t):hJ.mac?!t.altKey:!t.ctrlKey)?{from:s.from,to:s.to}:null,l={from:o,insert:n},c=e.state.changes(a?[a,l]:l);e.focus(),e.dispatch({changes:c,selection:{anchor:c.mapPos(o,-1),head:c.mapPos(o,1)},userEvent:a?"move.drop":"input.drop"}),e.inputState.draggedContent=null}dk.dragstart=(e,t)=>{let{selection:{main:n}}=e.state;if(t.target.draggable){let r=e.docView.nearest(t.target);if(r&&r.isWidget){let e=r.posAtStart,t=e+r.length;(e>=n.to||t<=n.from)&&(n=eD.range(e,t))}}let{inputState:r}=e;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=n,t.dataTransfer&&(t.dataTransfer.setData("Text",dC(e.state,uj,e.state.sliceDoc(n.from,n.to))),t.dataTransfer.effectAllowed="copyMove"),!1},dk.dragend=e=>(e.inputState.draggedContent=null,!1),dk.drop=(e,t)=>{if(!t.dataTransfer)return!1;if(e.state.readOnly)return!0;let n=t.dataTransfer.files;if(n&&n.length){let r=Array(n.length),i=0,o=()=>{++i==n.length&&dj(e,t,r.filter(e=>null!=e).join(e.state.lineBreak),!1)};for(let e=0;e<n.length;e++){let t=new FileReader;t.onerror=o,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(r[e]=t.result),o()},t.readAsText(n[e])}return!0}{let n=t.dataTransfer.getData("Text");if(n)return dj(e,t,n,!0),!0}return!1},dk.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();let n=dS?null:t.clipboardData;return n?(dT(e,n.getData("text/plain")||n.getData("text/uri-list")),!0):(function(e){let t=e.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{e.focus(),n.remove(),dT(e,n.value)},50)}(e),!1)};let dI=null;dk.copy=dk.cut=(e,t)=>{let{text:n,ranges:r,linewise:i}=function(e){let t=[],n=[],r=!1;for(let r of e.selection.ranges)r.empty||(t.push(e.sliceDoc(r.from,r.to)),n.push(r));if(!t.length){let i=-1;for(let{from:r}of e.selection.ranges){let o=e.doc.lineAt(r);o.number>i&&(t.push(o.text),n.push({from:o.from,to:Math.min(e.doc.length,o.to+1)})),i=o.number}r=!0}return{text:dC(e,uj,t.join(e.lineBreak)),ranges:n,linewise:r}}(e.state);if(!n&&!i)return!1;dI=i?n:null,"cut"!=t.type||e.state.readOnly||e.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let o=dS?null:t.clipboardData;return o?(o.clearData(),o.setData("text/plain",n),!0):(function(e,t){let n=e.dom.parentNode;if(!n)return;let r=n.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=t,r.focus(),r.selectionEnd=t.length,r.selectionStart=0,setTimeout(()=>{r.remove(),e.focus()},50)}(e,n),!1)};let d$=e5.define();function dL(e,t){let n=[];for(let r of e.facet(uR)){let i=r(e,t);i&&n.push(i)}return n?e.update({effects:n,annotations:d$.of(!0)}):null}function dq(e){setTimeout(()=>{let t=e.hasFocus;if(t!=e.inputState.notifiedFocused){let n=dL(e.state,t);n?e.dispatch(n):e.update([])}},10)}dO.focus=e=>{e.inputState.lastFocusTime=Date.now(),!e.scrollDOM.scrollTop&&(e.inputState.lastScrollTop||e.inputState.lastScrollLeft)&&(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),dq(e)},dO.blur=e=>{e.observer.clearSelectionRange(),dq(e)},dO.compositionstart=dO.compositionupdate=e=>{e.observer.editContext||(null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0))},dO.compositionend=e=>{e.observer.editContext||(e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,hJ.chrome&&hJ.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then(()=>e.observer.flush()):setTimeout(()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])},50))},dO.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},dk.beforeinput=(e,t)=>{var n,r;let i;if("insertReplacementText"==t.inputType&&e.observer.editContext){let r=null===(n=t.dataTransfer)||void 0===n?void 0:n.getData("text/plain"),i=t.getTargetRanges();if(r&&i.length){let t=i[0],n=e.posAtDOM(t.startContainer,t.startOffset),o=e.posAtDOM(t.endContainer,t.endOffset);return dp(e,{from:n,to:o,insert:e.state.toText(r)},null),!0}}if(hJ.chrome&&hJ.android&&(i=dy.find(e=>e.inputType==t.inputType))&&(e.observer.delayAndroidKey(i.key,i.keyCode),"Backspace"==i.key||"Delete"==i.key)){let t=(null===(r=window.visualViewport)||void 0===r?void 0:r.height)||0;setTimeout(()=>{var n;((null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())},100)}return hJ.ios&&"deleteContentForward"==t.inputType&&e.observer.flushSoon(),hJ.safari&&"insertText"==t.inputType&&e.inputState.composing>=0&&setTimeout(()=>dO.compositionend(e,t),20),!1};let dz=new Set,dB=["pre-wrap","normal","pre-line","break-spaces"],dF=!1;class dQ{constructor(e){this.lineWrapping=e,this.doc=ea.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return dB.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(10*r)]||(t=!0,this.heightSamples[Math.floor(10*r)]=!0)}return t}refresh(e,t,n,r,i,o){let s=dB.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=i,a){this.heightSamples={};for(let e=0;e<o.length;e++){let t=o[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return a}}class dV{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class dW{constructor(e,t,n,r,i){this.from=e,this.length=t,this.top=n,this.height=r,this._content=i}get type(){return"number"==typeof this._content?ue.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ui?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new dW(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var dU=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(dU||(dU={}));class dH{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>.001&&(dF=!0),this.height=e)}replace(e,t,n){return dH.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,r){let i=this,o=n.doc;for(let s=r.length-1;s>=0;s--){let{fromA:a,toA:l,fromB:c,toB:h}=r[s],u=i.lineAt(a,dU.ByPosNoHeight,n.setDoc(t),0,0),d=u.to>=l?u:i.lineAt(l,dU.ByPosNoHeight,n,0,0);for(h+=d.to-l,l=d.to;s>0&&u.from<=r[s-1].toA;)a=r[s-1].fromA,c=r[s-1].fromB,s--,a<u.from&&(u=i.lineAt(a,dU.ByPosNoHeight,n,0,0));c+=u.from-a,a=u.from;let f=d0.build(n.setDoc(o),e,c,h);i=dG(i,i.replace(a,l,f))}return i.updateHeight(n,0)}static empty(){return new dZ(0,0)}static of(e){if(1==e.length)return e[0];let t=0,n=e.length,r=0,i=0;for(;;)if(t==n){if(r>2*i){let i=e[t-1];i.break?e.splice(--t,1,i.left,null,i.right):e.splice(--t,1,i.left,i.right),n+=1+i.break,r-=i.size}else if(i>2*r){let t=e[n];t.break?e.splice(n,1,t.left,null,t.right):e.splice(n,1,t.left,t.right),n+=2+t.break,i-=t.size}else break}else if(r<i){let n=e[t++];n&&(r+=n.size)}else{let t=e[--n];t&&(i+=t.size)}let o=0;return null==e[t-1]?(o=1,t--):null==e[t]&&(o=1,n++),new dJ(dH.of(e.slice(0,t)),o,dH.of(e.slice(n)))}}function dG(e,t){return e==t?e:(e.constructor!=t.constructor&&(dF=!0),t)}dH.prototype.size=1;class dX extends dH{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,r){return new dW(r,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,r,i){return this.blockAt(0,n,r,i)}forEachLine(e,t,n,r,i,o){e<=i+this.length&&t>=i&&o(this.blockAt(0,n,r,i))}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class dZ extends dX{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,r){return new dW(r,this.length,n,this.height,this.breaks)}replace(e,t,n){let r=n[0];return 1==n.length&&(r instanceof dZ||r instanceof dY&&4&r.flags)&&10>Math.abs(this.length-r.length)?(r instanceof dY?r=new dZ(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):dH.of(n)}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more?this.setHeight(r.heights[r.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class dY extends dH{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,i=r-n+1,o,s=0;if(e.lineWrapping){let t=Math.min(this.height,e.lineHeight*i);o=t/i,this.length>i+1&&(s=(this.height-t)/(this.length-i-1))}else o=this.height/i;return{firstLine:n,lastLine:r,perLine:o,perChar:s}}blockAt(e,t,n,r){let{firstLine:i,lastLine:o,perLine:s,perChar:a}=this.heightMetrics(t,r);if(t.lineWrapping){let i=r+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),o=t.doc.lineAt(i),l=s+o.length*a,c=Math.max(n,e-l/2);return new dW(o.from,o.length,c,l,0)}{let r=Math.max(0,Math.min(o-i,Math.floor((e-n)/s))),{from:a,length:l}=t.doc.line(i+r);return new dW(a,l,n+s*r,s,0)}}lineAt(e,t,n,r,i){if(t==dU.ByHeight)return this.blockAt(e,n,r,i);if(t==dU.ByPosNoHeight){let{from:t,to:r}=n.doc.lineAt(e);return new dW(t,r-t,0,0,0)}let{firstLine:o,perLine:s,perChar:a}=this.heightMetrics(n,i),l=n.doc.lineAt(e),c=s+l.length*a,h=l.number-o,u=r+s*h+a*(l.from-i-h);return new dW(l.from,l.length,Math.max(r,Math.min(u,r+this.height-c)),c,0)}forEachLine(e,t,n,r,i,o){e=Math.max(e,i),t=Math.min(t,i+this.length);let{firstLine:s,perLine:a,perChar:l}=this.heightMetrics(n,i);for(let c=e,h=r;c<=t;){let t=n.doc.lineAt(c);if(c==e){let n=t.number-s;h+=a*n+l*(e-i-n)}let r=a+l*t.length;o(new dW(t.from,t.length,h,r,0)),h+=r,c=t.to+1}}replace(e,t,n){let r=this.length-t;if(r>0){let e=n[n.length-1];e instanceof dY?n[n.length-1]=new dY(e.length+r):n.push(null,new dY(r-1))}if(e>0){let t=n[0];t instanceof dY?n[0]=new dY(e+t.length):n.unshift(new dY(e-1),null)}return dH.of(n)}decomposeLeft(e,t){t.push(new dY(e-1),null)}decomposeRight(e,t){t.push(null,new dY(this.length-e-1))}updateHeight(e,t=0,n=!1,r){let i=t+this.length;if(r&&r.from<=t+this.length&&r.more){let n=[],o=Math.max(t,r.from),s=-1;for(r.from>t&&n.push(new dY(r.from-t-1).updateHeight(e,t));o<=i&&r.more;){let t=e.doc.lineAt(o).length;n.length&&n.push(null);let i=r.heights[r.index++];-1==s?s=i:Math.abs(i-s)>=.001&&(s=-2);let a=new dZ(t,i);a.outdated=!1,n.push(a),o+=t+1}o<=i&&n.push(null,new dY(i-o).updateHeight(e,o));let a=dH.of(n);return(s<0||Math.abs(a.height-this.height)>=.001||Math.abs(s-this.heightMetrics(e,t).perLine)>=.001)&&(dF=!0),dG(this,a)}return(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class dJ extends dH{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return 1&this.flags}blockAt(e,t,n,r){let i=n+this.left.height;return e<i?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,i,r+this.left.length+this.break)}lineAt(e,t,n,r,i){let o=r+this.left.height,s=i+this.left.length+this.break,a=t==dU.ByHeight?e<o:e<s,l=a?this.left.lineAt(e,t,n,r,i):this.right.lineAt(e,t,n,o,s);if(this.break||(a?l.to<s:l.from>s))return l;let c=t==dU.ByPosNoHeight?dU.ByPosNoHeight:dU.ByPos;return a?l.join(this.right.lineAt(s,c,n,o,s)):this.left.lineAt(s,c,n,r,i).join(l)}forEachLine(e,t,n,r,i,o){let s=r+this.left.height,a=i+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,r,i,o),t>=a&&this.right.forEachLine(e,t,n,s,a,o);else{let l=this.lineAt(a,dU.ByPos,n,r,i);e<l.from&&this.left.forEachLine(e,l.from-1,n,r,i,o),l.to>=e&&l.from<=t&&o(l),t>l.to&&this.right.forEachLine(l.to+1,t,n,s,a,o)}}replace(e,t,n){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));let i=[];e>0&&this.decomposeLeft(e,i);let o=i.length;for(let e of n)i.push(e);if(e>0&&dK(i,o-1),t<this.length){let e=i.length;this.decomposeRight(t,i),dK(i,e)}return dH.of(i)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&e>=++n&&t.push(null),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?dH.of(this.break?[e,null,t]:[e,t]):(this.left=dG(this.left,e),this.right=dG(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,r){let{left:i,right:o}=this,s=t+i.length+this.break,a=null;return r&&r.from<=t+i.length&&r.more?a=i=i.updateHeight(e,t,n,r):i.updateHeight(e,t,n),r&&r.from<=s+o.length&&r.more?a=o=o.updateHeight(e,s,n,r):o.updateHeight(e,s,n),a?this.balanced(i,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function dK(e,t){let n,r;null==e[t]&&(n=e[t-1])instanceof dY&&(r=e[t+1])instanceof dY&&e.splice(t-1,3,new dY(n.length+1+r.length))}class d0{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof dZ?n.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new dZ(e-this.pos,-1)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0,i=n.widget?n.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=t-e;n.block?this.addBlock(new dX(o,r,n)):(o||i||r>=5)&&this.addLineDeco(r,i,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new dZ(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new dY(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof dZ)return e;let t=new dZ(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let r=this.ensureLine();r.length+=n,r.collapsed+=n,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof dZ||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new dZ(0,-1));let n=e;for(let e of this.nodes)e instanceof dZ&&e.updateHeight(this.oracle,n),n+=e?e.length:1;return this.nodes}static build(e,t,n,r){let i=new d0(n,e);return th.spans(t,n,r,i,0),i.finish(n)}}class d1{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&us(e,t,this.changes,5)}}class d2{constructor(e,t,n,r){this.from=e,this.to=t,this.size=n,this.displaySize=r}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],i=t[n];if(r.from!=i.from||r.to!=i.to||r.size!=i.size)return!1}return!0}draw(e,t){return ut.replace({widget:new d5(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class d5 extends h7{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class d3{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=d9,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=uf.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(uX).some(e=>"function"!=typeof e&&"cm-lineWrapping"==e.class);this.heightOracle=new dQ(t),this.stateDeco=e.facet(uZ).filter(e=>"function"!=typeof e),this.heightMap=dH.empty().applyChanges(this.stateDeco,ea.empty,this.heightOracle.setDoc(e.doc),[new u3(0,0,0,e.doc.length)]);for(let e=0;e<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());e++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ut.set(this.lineGaps.map(e=>e.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let r=n?t.head:t.anchor;if(!e.some(({from:e,to:t})=>r>=e&&r<=t)){let{from:t,to:n}=this.lineBlockAt(r);e.push(new d4(t,n))}}return this.viewports=e.sort((e,t)=>e.from-t.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?d9:new d7(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(fe(e,this.scaler))})}update(e,t=null){var n,r;let i;this.state=e.state;let o=this.stateDeco;this.stateDeco=this.state.facet(uZ).filter(e=>"function"!=typeof e);let s=e.changedRanges,a=u3.extendWithRanges(s,(n=this.stateDeco,r=e?e.changes:eO.empty(this.state.doc.length),i=new d1,th.compare(o,n,r,i,0),i.changes)),l=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);dF=!1,this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=l||dF)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let h=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<h.from||t.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,t));let u=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(u||!e.changes.empty||2&e.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(u$)&&(this.mustEnforceCursorAssoc=!0)}measure(e){var t;let n,r,i=e.contentDOM,o=window.getComputedStyle(i),s=this.heightOracle,a=o.whiteSpace;this.defaultTextDirection="rtl"==o.direction?uf.RTL:uf.LTR;let l=this.heightOracle.mustRefreshForWrapping(a),c=i.getBoundingClientRect(),h=l||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let u=0,d=0;if(c.width&&c.height){let{scaleX:e,scaleY:t}=hS(i,c);(e>.005&&Math.abs(this.scaleX-e)>.005||t>.005&&Math.abs(this.scaleY-t)>.005)&&(this.scaleX=e,this.scaleY=t,u|=16,l=h=!0)}let f=(parseInt(o.paddingTop)||0)*this.scaleY,p=(parseInt(o.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=p)&&(this.paddingTop=f,this.paddingBottom=p,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let m=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=m&&(this.scrollAnchorHeight=-1,this.scrollTop=m),this.scrolledToBottom=hD(e.scrollDOM);let g=(this.printing?function(e,t){let n=e.getBoundingClientRect();return{left:0,right:n.right-n.left,top:t,bottom:n.bottom-(n.top+t)}}:function(e,t){let n=e.getBoundingClientRect(),r=e.ownerDocument,i=r.defaultView||window,o=Math.max(0,n.left),s=Math.min(i.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(i.innerHeight,n.bottom);for(let t=e.parentNode;t&&t!=r.body;)if(1==t.nodeType){let n=t,r=window.getComputedStyle(n);if((n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)&&"visible"!=r.overflow){let r=n.getBoundingClientRect();o=Math.max(o,r.left),s=Math.min(s,r.right),a=Math.max(a,r.top),l=Math.min(t==e.parentNode?i.innerHeight:l,r.bottom)}t="absolute"==r.position||"fixed"==r.position?n.offsetParent:n.parentNode}else if(11==t.nodeType)t=t.host;else break;return{left:o-n.left,right:Math.max(o,s)-n.left,top:a-(n.top+t),bottom:Math.max(a,l)-(n.top+t)}})(i,this.paddingTop),y=g.top-this.pixelViewport.top,b=g.bottom-this.pixelViewport.bottom;this.pixelViewport=g;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(h=!0)),!this.inView&&!this.scrollTarget&&(n=(t=e.dom).getBoundingClientRect(),r=t.ownerDocument.defaultView||window,!(n.left<r.innerWidth)||!(n.right>0)||!(n.top<r.innerHeight)||!(n.bottom>0)))return 0;let x=c.width;if((this.contentDOMWidth!=x||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),h){let t=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(t)&&(l=!0),l||s.lineWrapping&&Math.abs(x-this.contentDOMWidth)>s.charWidth){let{lineHeight:n,charWidth:r,textHeight:i}=e.docView.measureTextSize();(l=n>0&&s.refresh(a,n,r,i,x/r,t))&&(e.docView.minWidth=0,u|=16)}for(let n of(y>0&&b>0?d=Math.max(y,b):y<0&&b<0&&(d=Math.min(y,b)),dF=!1,this.viewports)){let r=n.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(n);this.heightMap=(l?dH.empty().applyChanges(this.stateDeco,ea.empty,this.heightOracle,[new u3(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,l,new dV(n.from,r))}dF&&(u|=2)}let w=!this.viewportIsAppropriate(this.viewport,d)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(2&u&&(u|=this.updateScaler()),this.viewport=this.getViewport(d,this.scrollTarget),u|=this.updateForViewport()),(2&u||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(l?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,i=this.heightOracle,{visibleTop:o,visibleBottom:s}=this,a=new d4(r.lineAt(o-1e3*n,dU.ByHeight,i,0,0).from,r.lineAt(s+(1-n)*1e3,dU.ByHeight,i,0,0).to);if(t){let{head:e}=t.range;if(e<a.from||e>a.to){let n=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=r.lineAt(e,dU.ByPos,i,0,0),s;s="center"==t.y?(o.top+o.bottom)/2-n/2:"start"==t.y||"nearest"==t.y&&e<a.from?o.top:o.bottom-n,a=new d4(r.lineAt(s-500,dU.ByHeight,i,0,0).from,r.lineAt(s+n+500,dU.ByHeight,i,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new d4(this.heightMap.lineAt(n,dU.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,dU.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,dU.ByPos,this.heightOracle,0,0),{bottom:i}=this.heightMap.lineAt(t,dU.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:s}=this;return(0==e||r<=o-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||i>=s+Math.max(10,Math.min(n,250)))&&r>o-2e3&&i<s+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let r of e)t.touchesRange(r.from,r.to)||n.push(new d2(t.mapPos(r.from),t.mapPos(r.to),r.size,r.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,i=r>>1,o=r<<1;if(this.defaultTextDirection!=uf.LTR&&!n)return[];let s=[],a=(r,o,l,c)=>{if(o-r<i)return;let h=this.state.selection.main,u=[h.from];for(let e of(h.empty||u.push(h.to),u))if(e>r&&e<o){a(r,e-10,l,c),a(e+10,o,l,c);return}let d=function(e,t){for(let n of e)if(t(n))return n}(e,e=>e.from>=l.from&&e.to<=l.to&&Math.abs(e.from-r)<i&&Math.abs(e.to-o)<i&&!u.some(t=>e.from<t&&e.to>t));if(!d){if(o<l.to&&t&&n&&t.visibleRanges.some(e=>e.from<=o&&e.to>=o)){let e=t.moveToLineBoundary(eD.cursor(o),!1,!0).head;e>r&&(o=e)}let e=this.gapSize(l,r,o,c),i=n||e<2e6?e:2e6;d=new d2(r,o,e,i)}s.push(d)},l=t=>{var i,s,l;let c,h,u;if(t.length<o||t.type!=ue.Text)return;let d=(i=t.from,s=t.to,l=this.stateDeco,c=[],h=i,u=0,th.spans(l,i,s,{span(){},point(e,t){e>h&&(c.push({from:h,to:e}),u+=e-h),h=t}},20),h<s&&(c.push({from:h,to:s}),u+=s-h),{total:u,ranges:c});if(d.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,p,m;if(n){let e=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,n,i;if(null!=f){let r=d8(d,f),o=((this.visibleBottom-this.visibleTop)/2+e)/t.height;n=r-o,i=r+o}else n=(this.visibleTop-t.top-e)/t.height,i=(this.visibleBottom-t.top+e)/t.height;p=d6(d,n),m=d6(d,i)}else{let n=d.total*this.heightOracle.charWidth,i=r*this.heightOracle.charWidth,o=0;if(n>2e6)for(let n of e)n.from>=t.from&&n.from<t.to&&n.size!=n.displaySize&&n.from*this.heightOracle.charWidth+o<this.pixelViewport.left&&(o=n.size-n.displaySize);let s=this.pixelViewport.left+o,a=this.pixelViewport.right+o,l,c;if(null!=f){let e=d8(d,f),t=((a-s)/2+i)/n;l=e-t,c=e+t}else l=(s-i)/n,c=(a+i)/n;p=d6(d,l),m=d6(d,c)}p>t.from&&a(t.from,p,t,d),m<t.to&&a(m,t.to,t,d)};for(let e of this.viewportLines)Array.isArray(e.type)?e.type.forEach(l):l(e);return s}gapSize(e,t,n,r){let i=d8(r,n)-d8(r,t);return this.heightOracle.lineWrapping?e.height*i:r.total*this.heightOracle.charWidth*i}updateLineGaps(e){d2.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ut.set(e.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let n=[];th.spans(t,this.viewport.from,this.viewport.to,{span(e,t){n.push({from:e,to:t})},point(){}},20);let r=0;if(n.length!=this.visibleRanges.length)r=12;else for(let t=0;t<n.length&&!(8&r);t++){let i=this.visibleRanges[t],o=n[t];(i.from!=o.from||i.to!=o.to)&&(r|=4,e&&e.mapPos(i.from,-1)==o.from&&e.mapPos(i.to,1)==o.to||(r|=8))}return this.visibleRanges=n,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||fe(this.heightMap.lineAt(e,dU.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||fe(this.heightMap.lineAt(this.scaler.fromDOM(e),dU.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return fe(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class d4{constructor(e,t){this.from=e,this.to=t}}function d6({total:e,ranges:t},n){if(n<=0)return t[0].from;if(n>=1)return t[t.length-1].to;let r=Math.floor(e*n);for(let e=0;;e++){let{from:n,to:i}=t[e],o=i-n;if(r<=o)return n+r;r-=o}}function d8(e,t){let n=0;for(let{from:r,to:i}of e.ranges){if(t<=i){n+=t-r;break}n+=i-r}return n/e.total}let d9={toDOM:e=>e,fromDOM:e=>e,scale:1,eq(e){return e==this}};class d7{constructor(e,t,n){let r=0,i=0,o=0;for(let s of(this.viewports=n.map(({from:n,to:i})=>{let o=t.lineAt(n,dU.ByPos,e,0,0).top,s=t.lineAt(i,dU.ByPos,e,0,0).bottom;return r+=s-o,{from:n,to:i,top:o,bottom:s,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r),this.viewports))s.domTop=o+(s.top-i)*this.scale,o=s.domBottom=s.domTop+(s.bottom-s.top),i=s.bottom}toDOM(e){for(let t=0,n=0,r=0;;t++){let i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.top)return r+(e-n)*this.scale;if(e<=i.bottom)return i.domTop+(e-i.top);n=i.bottom,r=i.domBottom}}fromDOM(e){for(let t=0,n=0,r=0;;t++){let i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.domTop)return n+(e-r)/this.scale;if(e<=i.domBottom)return i.top+(e-i.domTop);n=i.bottom,r=i.domBottom}}eq(e){return e instanceof d7&&this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to)}}function fe(e,t){if(1==t.scale)return e;let n=t.toDOM(e.top),r=t.toDOM(e.bottom);return new dW(e.from,e.length,n,r-n,Array.isArray(e._content)?e._content.map(e=>fe(e,t)):e._content)}let ft=eP.define({combine:e=>e.join(" ")}),fn=eP.define({combine:e=>e.indexOf(!0)>-1}),fr=hi.newName(),fi=hi.newName(),fo=hi.newName(),fs={"&light":"."+fi,"&dark":"."+fo};function fa(e,t,n){return new hi(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,t=>{if("&"==t)return e;if(!n||!n[t])throw RangeError(`Unsupported selector: ${t}`);return n[t]}):e+" "+t})}let fl=fa("."+fr,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},fs),fc={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},fh=hJ.ie&&hJ.ie_version<=11,fu=class{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new hC,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let e of t)this.queue.push(e);(hJ.ie&&hJ.ie_version<=11||hJ.ios&&e.composing)&&t.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&!1!==e.constructor.EDIT_CONTEXT&&!(hJ.chrome&&hJ.chrome_version<126)&&(this.editContext=new fp(e),e.state.facet(uQ)&&(e.contentDOM.editContext=this.editContext.editContext)),fh&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var e;(null===(e=this.view.docView)||void 0===e?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){("change"!=e.type&&e.type||e.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){for(let t of(this.gapIntersection.disconnect(),e))this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(uQ)?n.root.activeElement!=this.dom:!hg(this.dom,r))return;let i=r.anchorNode&&n.docView.nearest(r.anchorNode);if(i&&i.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(hJ.ie&&hJ.ie_version<=11||hJ.android&&hJ.chrome)&&!n.state.selection.main.empty&&r.focusNode&&hb(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=hp(e.root);if(!t)return!1;let n=hJ.safari&&11==e.root.nodeType&&e.root.activeElement==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return ff(e,n)}let n=null;function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.contentDOM.addEventListener("beforeinput",r,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",r,!0),n?ff(e,n):null}(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let r=hg(this.dom,n);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&function(e,t){let n=t.focusNode,r=t.focusOffset;if(!n||t.anchorNode!=n||t.anchorOffset!=r)return!1;for(r=Math.min(r,hk(n));;)if(r){if(1!=n.nodeType)return!1;let e=n.childNodes[r-1];"false"==e.contentEditable?r--:r=hk(n=e)}else{if(n==e)return!0;r=hv(n),n=n.parentNode}}(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(1==n.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(11==n.nodeType)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,fc),fh&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),fh&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;this.delayedAndroidKey||(this.flushingAndroidKey=this.view.win.requestAnimationFrame(()=>{let e=this.delayedAndroidKey;e&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=e.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&e.force&&hM(this.dom,e.key,e.keyCode))})),this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!(null===(n=this.delayedAndroidKey)||void 0===n)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,r=!1;for(let i of e){let e=this.readMutation(i);e&&(e.typeOver&&(r=!0),-1==t?{from:t,to:n}=e:(t=Math.min(e.from,t),n=Math.max(e.to,n)))}return{from:t,to:n,typeOver:r}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),r=this.selectionChanged&&hg(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let i=new dd(this.view,e,t,n);return this.view.docView.domChanged={newSel:i.newSel?i.newSel.main:null},i}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,r=df(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.flags|=4),"childList"!=e.type)return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null;{let n=fd(t,e.previousSibling||e.target.previousSibling,-1),r=fd(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(uQ)!=e.state.facet(uQ)&&(e.view.contentDOM.editContext=e.state.facet(uQ)?this.editContext.editContext:null))}destroy(){var e,t,n;for(let r of(this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(n=this.resizeScroll)||void 0===n||n.disconnect(),this.scrollTargets))r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}};function fd(e,t,n){for(;t;){let r=hI.get(t);if(r&&r.parent==e)return r;let i=t.parentNode;t=i!=e.dom?i:n>0?t.nextSibling:t.previousSibling}return null}function ff(e,t){let n=t.startContainer,r=t.startOffset,i=t.endContainer,o=t.endOffset,s=e.docView.domAtPos(e.state.selection.main.anchor);return hb(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}class fp{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});for(let n in this.handlers.textupdate=t=>{let n=e.state.selection.main,{anchor:r,head:i}=n,o=this.toEditorPos(t.updateRangeStart),s=this.toEditorPos(t.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:t.updateRangeStart,editorBase:o,drifted:!1});let a={from:o,to:s,insert:ea.of(t.text.split(`
`))};if(a.from==this.from&&r<this.from?a.from=r:a.to==this.to&&r>this.to&&(a.to=r),a.from==a.to&&!a.insert.length){let r=eD.single(this.toEditorPos(t.selectionStart),this.toEditorPos(t.selectionEnd));r.main.eq(n)||e.dispatch({selection:r,userEvent:"select"});return}if((hJ.mac||hJ.android)&&a.from==i-1&&/^\. ?$/.test(t.text)&&"off"==e.contentDOM.getAttribute("autocorrect")&&(a={from:o,to:s,insert:ea.of([t.text.replace("."," ")])}),this.pendingContextChange=a,!e.state.readOnly){let n=this.to-this.from+(a.to-a.from+a.insert.length);dp(e,a,eD.single(this.toEditorPos(t.selectionStart,n),this.toEditorPos(t.selectionEnd,n)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let r=[],i=null;for(let t=this.toEditorPos(n.rangeStart),o=this.toEditorPos(n.rangeEnd);t<o;t++){let n=e.coordsForChar(t);i=n&&new DOMRect(n.left,n.top,n.right-n.left,n.bottom-n.top)||i||new DOMRect,r.push(i)}t.updateCharacterBounds(n.rangeStart,r)},this.handlers.textformatupdate=t=>{let n=[];for(let e of t.getTextFormats()){let t=e.underlineStyle,r=e.underlineThickness;if("None"!=t&&"None"!=r){let i=this.toEditorPos(e.rangeStart),o=this.toEditorPos(e.rangeEnd);if(i<o){let e=`text-decoration: underline ${"Dashed"==t?"dashed ":"Squiggle"==t?"wavy ":""}${"Thin"==r?1:2}px`;n.push(ut.mark({attributes:{style:e}}).range(i,o))}}}e.dispatch({effects:uB.of(ut.set(n))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:t}=this.composing;this.composing=null,t&&this.reset(e.state)}},this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:e=>{this.editContext.updateControlBounds(e.contentDOM.getBoundingClientRect());let t=hp(e.root);t&&t.rangeCount&&this.editContext.updateSelectionBounds(t.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,r=this.pendingContextChange;return e.changes.iterChanges((i,o,s,a,l)=>{if(n)return;let c=l.length-(o-i);if(r&&o>=r.to){if(r.from==i&&r.to==o&&r.insert.eq(l)){r=this.pendingContextChange=null,t+=c,this.to+=c;return}r=null,this.revertPending(e.state)}if(i+=t,(o+=t)<=this.from)this.from+=c,this.to+=c;else if(i<this.to){if(i<this.from||o>this.to||this.to-this.from+l.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(i),this.toContextPos(o),l.toString()),this.to+=c}t+=c}),r&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(e=>!e.isUserEvent("input.type")&&e.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):this.applyEdits(e)&&this.rangeIsValid(e.state)?(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state):(this.pendingContextChange=null,this.reset(e.state)),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),r=this.toContextPos(t.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(n,r)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>3e4)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}let fm=class e{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;for(let t of(this.dispatchTransactions=e.dispatchTransactions||n&&(e=>e.forEach(e=>n(e,this)))||(e=>this.update(e)),this.dispatch=this.dispatch.bind(this),this._root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new d3(e.state||ti.create(e)),e.scrollTo&&e.scrollTo.is(uz)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(uW).map(e=>new uH(e)),this.plugins))t.update(this);this.observer=new fu(this),this.inputState=new dm(this),this.inputState.ensureHandlers(this.plugins),this.docView=new u6(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!(null===(t=document.fonts)||void 0===t)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=1==e.length&&e[0]instanceof e8?e:1==e.length&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(0!=this.updateState)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,r,i=this.state;for(let t of e){if(t.startState!=i)throw RangeError("Trying to update state with a transaction that doesn't start from the previous state.");i=t.state}if(this.destroyed){this.viewState.state=i;return}let o=this.hasFocus,s=0,a=null;e.some(e=>e.annotation(d$))?(this.inputState.notifiedFocused=o,s=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,(a=dL(i,o))||(s=1));let l=this.observer.delayedAndroidKey,c=null;if(l?(this.observer.clearDelayedAndroidKey(),((c=this.observer.readChange())&&!this.state.doc.eq(i.doc)||!this.state.selection.eq(i.selection))&&(c=null)):this.observer.clear(),i.facet(ti.phrases)!=this.state.facet(ti.phrases))return this.setState(i);r=u4.create(this,i,e),r.flags|=s;let h=this.viewState.scrollTarget;try{for(let t of(this.updateState=2,e)){if(h&&(h=h.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;h=new uq(e.empty?e:eD.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(uz)&&(h=e.value.clip(this.state))}this.viewState.update(r,h),this.bidiCache=fb.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(u5)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(e=>e.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(ft)!=r.state.facet(ft)&&(this.viewState.mustMeasureContent=!0),(t||n||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!r.empty)for(let e of this.state.facet(uD))try{e(r)}catch(e){uF(this.state,e,"update listener")}(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!df(this,c)&&l.force&&hM(this.contentDOM,l.key,l.keyCode)})}setState(e){if(0!=this.updateState)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);for(let t of(this.viewState=new d3(e),this.plugins=e.facet(uW).map(e=>new uH(e)),this.pluginMap.clear(),this.plugins))t.update(this);this.docView.destroy(),this.docView=new u6(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(uW),n=e.state.facet(uW);if(t!=n){let r=[];for(let i of n){let n=t.indexOf(i);if(n<0)r.push(new uH(i));else{let t=this.plugins[n];t.mustUpdate=e,r.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let t of this.plugins)t.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(e){uF(this.state,e,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,r=n.scrollTop*this.scaleY,{scrollAnchorPos:i,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let e=0;;e++){if(o<0){if(hD(n))i=-1,o=this.viewState.heightMap.height;else{let e=this.viewState.scrollAnchorAt(r);i=e.from,o=e.top}}this.updateState=1;let s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];4&s||([this.measureRequests,a]=[a,this.measureRequests]);let l=a.map(e=>{try{return e.read(this)}catch(e){return uF(this.state,e),fy}}),c=u4.create(this,this.state,[]),h=!1;c.flags|=s,t?t.flags|=s:t=c,this.updateState=2,c.empty||(this.updatePlugins(c),this.inputState.update(c),this.updateAttrs(),(h=this.docView.update(c))&&this.docViewUpdate());for(let e=0;e<a.length;e++)if(l[e]!=fy)try{let t=a[e];t.write&&t.write(l[e],this)}catch(e){uF(this.state,e)}if(h&&this.docView.updateSelection(!0),!c.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let e=(i<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(i).top)-o;if(e>1||e<-1){r+=e,n.scrollTop=r/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let e of this.state.facet(uD))e(t)}get themeClasses(){return fr+" "+(this.state.facet(fn)?fo:fi)+" "+this.state.facet(ft)}updateAttrs(){let e=fv(this,uG,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(uQ)?"true":"false",class:"cm-content",style:`${hJ.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),fv(this,uX,t);let n=this.observer.ignore(()=>{let n=h9(this.contentDOM,this.contentAttrs,t),r=h9(this.dom,this.editorAttrs,e);return n||r});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(t){let n=!0;for(let r of t)for(let t of r.effects)t.is(e.announce)&&(n&&(this.announceDOM.textContent=""),n=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(u5);let t=this.state.facet(e.cspNonce);hi.mount(this.root,this.styleModules.concat(fl).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e&&!(this.measureRequests.indexOf(e)>-1)){if(null!=e.key){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(t=>t.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return dc(this,e,da(this,e,t,n))}moveByGroup(e,t){return dc(this,e,da(this,e,t,t=>{var n;let r,i;return n=e.head,i=(r=this.state.charCategorizer(n))(t),e=>{let t=r(e);return i==tn.Space&&(i=t),i==t}}))}visualLineSide(e,t){let n=this.bidiSpans(e),r=this.textDirectionAt(e.from),i=n[t?n.length-1:0];return eD.cursor(i.side(t,r)+e.from,i.forward(!t,r)?1:-1)}moveToLineBoundary(e,t,n=!0){return function(e,t,n,r){let i=ds(e,t.head),o=r&&i.type==ue.Text&&(e.lineWrapping||i.widgetLineBreaks)?e.coordsAtPos(t.assoc<0&&t.head>i.from?t.head-1:t.head):null;if(o){let t=e.dom.getBoundingClientRect(),r=e.textDirectionAt(i.from),s=e.posAtCoords({x:n==(r==uf.LTR)?t.right-1:t.left+1,y:(o.top+o.bottom)/2});if(null!=s)return eD.cursor(s,n?-1:1)}return eD.cursor(n?i.to:i.from,n?-1:1)}(this,e,t,n)}moveVertically(e,t,n){return dc(this,e,function(e,t,n,r){let i=t.head,o=n?1:-1;if(i==(n?e.state.doc.length:0))return eD.cursor(i,t.assoc);let s=t.goalColumn,a,l=e.contentDOM.getBoundingClientRect(),c=e.coordsAtPos(i,t.assoc||-1),h=e.documentTop;if(c)null==s&&(s=c.left-l.left),a=o<0?c.top:c.bottom;else{let t=e.viewState.lineBlockAt(i);null==s&&(s=Math.min(l.right-l.left,e.defaultCharacterWidth*(i-t.from))),a=(o<0?t.top:t.bottom)+h}let u=l.left+s,d=r??e.viewState.heightOracle.textHeight>>1;for(let t=0;;t+=10){let n=a+(d+t)*o,r=dr(e,{x:u,y:n},!1,o);if(n<l.top||n>l.bottom||(o<0?r<i:r>i)){let t=e.docView.coordsForChar(r),i=!t||n<t.top?-1:1;return eD.cursor(r,i,void 0,s)}}}(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),dr(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),i=this.bidiSpans(r);return hO(n,i[uO.find(i,e-r.from,-1,t)].dir==uf.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(uI)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>fg)return uC(e.length);let t=this.textDirectionAt(e.from),n;for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t&&(r.fresh||function e(t,n){if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],o=n[r];if(i.from!=o.from||i.to!=o.to||i.direction!=o.direction||!e(i.inner,o.inner))return!1}return!0}(r.isolates,n=u0(this,e))))return r.order;n||(n=u0(this,e));let r=function(e,t,n){if(!e)return[new uO(0,0,t==um?1:0)];if(t==up&&!n.length&&!uk.test(e))return uC(e.length);if(n.length)for(;e.length>uS.length;)uS[uS.length]=256;let r=[],i=t==up?0:1;return function e(t,n,r,i,o,s,a){let l=n%2?2:1;(function(e,t,n,r,i){for(let o=0;o<=r.length;o++){let s=o?r[o-1].to:t,a=o<r.length?r[o].from:n,l=o?256:i;for(let t=s,n=l,r=l;t<a;t++){let i=uw(e.charCodeAt(t));512==i?i=n:8==i&&4==r&&(i=16),uS[t]=4==i?2:i,7&i&&(r=i),n=i}for(let e=s,t=l,r=l;e<a;e++){let i=uS[e];if(128==i)e<a-1&&t==uS[e+1]&&24&t?i=uS[e]=t:uS[e]=256;else if(64==i){let i=e+1;for(;i<a&&64==uS[i];)i++;let o=e&&8==t||i<n&&8==uS[i]?1==r?1:8:256;for(let t=e;t<i;t++)uS[t]=o;e=i-1}else 8==i&&1==r&&(uS[e]=1);t=i,7&i&&(r=i)}}})(t,o,s,i,l),function(e,t,n,r,i){let o=1==i?2:1;for(let s=0,a=0,l=0;s<=r.length;s++){let c=s?r[s-1].to:t,h=s<r.length?r[s].from:n;for(let t=c,n,r,s;t<h;t++)if(r=uv[n=e.charCodeAt(t)]){if(r<0){for(let e=a-3;e>=0;e-=3)if(ux[e+1]==-r){let n=ux[e+2],r=2&n?i:4&n?1&n?o:i:0;r&&(uS[t]=uS[ux[e]]=r),a=e;break}}else{if(189==ux.length)break;ux[a++]=t,ux[a++]=n,ux[a++]=l}}else if(2==(s=uS[t])||1==s){let e=s==i;l=e?0:1;for(let t=a-3;t>=0;t-=3){let n=ux[t+2];if(2&n)break;if(e)ux[t+2]|=2;else{if(4&n)break;ux[t+2]|=4}}}}}(t,o,s,i,l),function(e,t,n,r){for(let i=0,o=r;i<=n.length;i++){let s=i?n[i-1].to:e,a=i<n.length?n[i].from:t;for(let l=s;l<a;){let s=uS[l];if(256==s){let s=l+1;for(;;)if(s==a){if(i==n.length)break;s=n[i++].to,a=i<n.length?n[i].from:t}else if(256==uS[s])s++;else break;let c=1==o,h=c==((s<t?uS[s]:r)==1)?c?1:2:r;for(let t=s,r=i,o=r?n[r-1].to:e;t>l;)t==o&&(t=n[--r].from,o=r?n[r-1].to:e),uS[--t]=h;l=s}else o=s,l++}}}(o,s,i,l),function t(n,r,i,o,s,a,l){let c=o%2?2:1;if(o%2==s%2)for(let h=r,u=0;h<i;){let r=!0,d=!1;if(u==a.length||h<a[u].from){let e=uS[h];e!=c&&(r=!1,d=16==e)}let f=r||1!=c?null:[],p=r?o:o+1,m=h;e:for(;;)if(u<a.length&&m==a[u].from){if(d)break;let t=a[u];if(!r)for(let e=t.to,n=u+1;;){if(e==i)break e;if(n<a.length&&a[n].from==e)e=a[n++].to;else{if(uS[e]==c)break e;break}}(u++,f)?f.push(t):(t.from>h&&l.push(new uO(h,t.from,p)),e(n,t.direction==up!=!(p%2)?o+1:o,s,t.inner,t.from,t.to,l),h=t.to),m=t.to}else{if(m==i||(r?uS[m]!=c:uS[m]==c))break;m++}f?t(n,h,m,o+1,s,f,l):h<m&&l.push(new uO(h,m,p)),h=m}else for(let h=i,u=a.length;h>r;){let i=!0,d=!1;if(!u||h>a[u-1].to){let e=uS[h-1];e!=c&&(i=!1,d=16==e)}let f=i||1!=c?null:[],p=i?o:o+1,m=h;e:for(;;)if(u&&m==a[u-1].to){if(d)break;let t=a[--u];if(!i)for(let e=t.from,n=u;;){if(e==r)break e;if(n&&a[n-1].to==e)e=a[--n].from;else{if(uS[e-1]==c)break e;break}}f?f.push(t):(t.to<h&&l.push(new uO(t.to,h,p)),e(n,t.direction==up!=!(p%2)?o+1:o,s,t.inner,t.from,t.to,l),h=t.from),m=t.from}else{if(m==r||(i?uS[m-1]!=c:uS[m-1]==c))break;m--}f?t(n,m,h,o+1,s,f,l):m<h&&l.push(new uO(m,h,p)),h=m}}(t,o,s,n,r,i,a)}(e,i,i,n,0,e.length,r),r}(e.text,t,n);return this.bidiCache.push(new fb(e.from,e.to,t,n,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||hJ.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{hA(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of(this.root.activeElement==this.contentDOM&&this.contentDOM.blur(),this.plugins))e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return uz.of(new uq("number"==typeof e?eD.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return uz.of(new uq(eD.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){null==e?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof e?this.inputState.tabFocusMode=e?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return uU.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return uU.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=hi.newName(),r=[ft.of(n),u5.of(fa(`.${n}`,e))];return t&&t.dark&&r.push(fn.of(!0)),r}static baseTheme(e){return eQ.lowest(u5.of(fa("."+fr,e,fs)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),r=n&&hI.get(n)||hI.get(e);return(null===(t=null==r?void 0:r.rootView)||void 0===t?void 0:t.view)||null}};fm.styleModule=u5,fm.inputHandler=uN,fm.clipboardInputFilter=uP,fm.clipboardOutputFilter=uj,fm.scrollHandler=uL,fm.focusChangeEffect=uR,fm.perLineTextDirection=uI,fm.exceptionSink=u_,fm.updateListener=uD,fm.editable=uQ,fm.mouseSelectionStyle=uM,fm.dragMovesSelection=uE,fm.clickAddsSelectionRange=uA,fm.decorations=uZ,fm.outerDecorations=uY,fm.atomicRanges=uJ,fm.bidiIsolatedRanges=uK,fm.scrollMargins=u1,fm.darkTheme=fn,fm.cspNonce=eP.define({combine:e=>e.length?e[0]:""}),fm.contentAttributes=uX,fm.editorAttributes=uG,fm.lineWrapping=fm.contentAttributes.of({class:"cm-lineWrapping"}),fm.announce=e6.define();let fg=4096,fy={};class fb{constructor(e,t,n,r,i,o){this.from=e,this.to=t,this.dir=n,this.isolates=r,this.fresh=i,this.order=o}static update(e,t){if(t.empty&&!e.some(e=>e.fresh))return e;let n=[],r=e.length?e[e.length-1].dir:uf.LTR;for(let i=Math.max(0,e.length-10);i<e.length;i++){let o=e[i];o.dir!=r||t.touchesRange(o.from,o.to)||n.push(new fb(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function fv(e,t,n){for(let r=e.state.facet(t),i=r.length-1;i>=0;i--){let t=r[i],o="function"==typeof t?t(e):t;o&&h4(o,n)}return n}let fx=hJ.mac?"mac":hJ.windows?"win":hJ.linux?"linux":"key";function fw(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}let fk=eQ.default(fm.domEventHandlers({keydown:(e,t)=>fE(fC(t.state),e,t,"editor")})),fO=eP.define({enables:fk}),fS=new WeakMap;function fC(e){let t=e.facet(fO),n=fS.get(t);return n||fS.set(t,n=function(e,t=fx){let n=Object.create(null),r=Object.create(null),i=(e,t)=>{let n=r[e];if(null==n)r[e]=t;else if(n!=t)throw Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},o=(e,r,o,s,a)=>{var l,c;let h=n[e]||(n[e]=Object.create(null)),u=r.split(/ (?!$)/).map(e=>(function(e,t){let n,r,i,o;let s=e.split(/-(?!$)/),a=s[s.length-1];"Space"==a&&(a=" ");for(let e=0;e<s.length-1;++e){let a=s[e];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))i=!0;else if(/^mod$/i.test(a))"mac"==t?o=!0:r=!0;else throw Error("Unrecognized modifier name: "+a)}return n&&(a="Alt-"+a),r&&(a="Ctrl-"+a),o&&(a="Meta-"+a),i&&(a="Shift-"+a),a})(e,t));for(let t=1;t<u.length;t++){let n=u.slice(0,t).join(" ");i(n,!0),h[n]||(h[n]={preventDefault:!0,stopPropagation:!1,run:[t=>{let r=fT={view:t,prefix:n,scope:e};return setTimeout(()=>{fT==r&&(fT=null)},4e3),!0}]})}let d=u.join(" ");i(d,!1);let f=h[d]||(h[d]={preventDefault:!1,stopPropagation:!1,run:(null===(c=null===(l=h._any)||void 0===l?void 0:l.run)||void 0===c?void 0:c.slice())||[]});o&&f.run.push(o),s&&(f.preventDefault=!0),a&&(f.stopPropagation=!0)};for(let r of e){let e=r.scope?r.scope.split(" "):["editor"];if(r.any)for(let t of e){let e=n[t]||(n[t]=Object.create(null));e._any||(e._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:i}=r;for(let t in e)e[t].run.push(e=>i(e,fA))}let i=r[t]||r.key;if(i)for(let t of e)o(t,i,r.run,r.preventDefault,r.stopPropagation),r.shift&&o(t,"Shift-"+i,r.shift,r.preventDefault,r.stopPropagation)}return n}(t.reduce((e,t)=>e.concat(t),[]))),n}let fT=null,fA=null;function fE(e,t,n,r){fA=t;let i=hf(t),o=ev(ey(i,0))==i.length&&" "!=i,s="",a=!1,l=!1,c=!1;fT&&fT.view==n&&fT.scope==r&&(s=fT.prefix+" ",0>dv.indexOf(t.keyCode)&&(l=!0,fT=null));let h=new Set,u=e=>{if(e){for(let t of e.run)if(!h.has(t)&&(h.add(t),t(n)))return e.stopPropagation&&(c=!0),!0;e.preventDefault&&(e.stopPropagation&&(c=!0),l=!0)}return!1},d=e[r],f,p;return d&&(u(d[s+fw(i,t,!o)])?a=!0:o&&(t.altKey||t.metaKey||t.ctrlKey)&&!(hJ.windows&&t.ctrlKey&&t.altKey)&&(f=ha[t.keyCode])&&f!=i?(u(d[s+fw(f,t,!0)])||t.shiftKey&&(p=hl[t.keyCode])!=i&&p!=f&&u(d[s+fw(p,t,!1)]))&&(a=!0):o&&t.shiftKey&&u(d[s+fw(i,t,!0)])&&(a=!0),!a&&u(d._any)&&(a=!0)),l&&(a=!0),a&&c&&t.stopPropagation(),fA=null,a}class fM{constructor(e,t,n,r,i){this.className=e,this.left=t,this.top=n,this.width=r,this.height=i}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(!n.empty)return function(e,t,n){if(n.to<=e.viewport.from||n.from>=e.viewport.to)return[];let r=Math.max(n.from,e.viewport.from),i=Math.min(n.to,e.viewport.to),o=e.textDirection==uf.LTR,s=e.contentDOM,a=s.getBoundingClientRect(),l=f_(e),c=s.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),u=a.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),d=a.right-(h?parseInt(h.paddingRight):0),f=ds(e,r),p=ds(e,i),m=f.type==ue.Text?f:null,g=p.type==ue.Text?p:null;if(m&&(e.lineWrapping||f.widgetLineBreaks)&&(m=fD(e,r,1,m)),g&&(e.lineWrapping||p.widgetLineBreaks)&&(g=fD(e,i,-1,g)),m&&g&&m.from==g.from&&m.to==g.to)return b(v(n.from,n.to,m));{let t=m?v(n.from,null,m):x(f,!1),r=g?v(null,n.to,g):x(p,!0),i=[];return(m||f).to<(g||p).from-(m&&g?1:0)||f.widgetLineBreaks>1&&t.bottom+e.defaultLineHeight/2<r.top?i.push(y(u,t.bottom,d,r.top)):t.bottom<r.top&&e.elementAtHeight((t.bottom+r.top)/2).type==ue.Text&&(t.bottom=r.top=(t.bottom+r.top)/2),b(t).concat(i).concat(b(r))}function y(e,n,r,i){return new fM(t,e-l.left,n-l.top,r-e,i-n)}function b({top:e,bottom:t,horizontal:n}){let r=[];for(let i=0;i<n.length;i+=2)r.push(y(n[i],e,n[i+1],t));return r}function v(t,n,r){let i=1e9,s=-1e9,a=[];function l(t,n,l,c,h){let f=e.coordsAtPos(t,t==r.to?-2:2),p=e.coordsAtPos(l,l==r.from?2:-2);f&&p&&(i=Math.min(f.top,p.top,i),s=Math.max(f.bottom,p.bottom,s),h==uf.LTR?a.push(o&&n?u:f.left,o&&c?d:p.right):a.push(!o&&c?u:p.left,!o&&n?d:f.right))}let c=t??r.from,h=n??r.to;for(let r of e.visibleRanges)if(r.to>c&&r.from<h)for(let i=Math.max(r.from,c),o=Math.min(r.to,h);;){let r=e.state.doc.lineAt(i);for(let s of e.bidiSpans(r)){let e=s.from+r.from,a=s.to+r.from;if(e>=o)break;a>i&&l(Math.max(e,i),null==t&&e<=c,Math.min(a,o),null==n&&a>=h,s.dir)}if((i=r.to+1)>=o)break}return 0==a.length&&l(c,null==t,h,null==n,e.textDirection),{top:i,bottom:s,horizontal:a}}function x(e,t){let n=a.top+(t?e.top:e.bottom);return{top:n,bottom:n,horizontal:[]}}}(e,t,n);{let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let i=f_(e);return[new fM(t,r.left-i.left,r.top-i.top,null,r.bottom-r.top)]}}}function f_(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==uf.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function fD(e,t,n,r){let i=e.coordsAtPos(t,2*n);if(!i)return r;let o=e.dom.getBoundingClientRect(),s=(i.top+i.bottom)/2,a=e.posAtCoords({x:o.left+1,y:s}),l=e.posAtCoords({x:o.right-1,y:s});return null==a||null==l?r:{from:Math.max(r.from,Math.min(a,l)),to:Math.min(r.to,Math.max(a,l))}}class fN{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(fR)!=e.state.facet(fR)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){!1!==this.layer.updateOnDocViewUpdate&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(fR);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((e,t)=>{var n;return n=this.drawn[t],!(e.constructor==n.constructor&&e.eq(n))})){let t=this.dom.firstChild,n=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[n].constructor&&r.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(r.draw(),t);for(;t;){let e=t.nextSibling;t.remove(),t=e}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}let fR=eP.define();function fP(e){return[uU.define(t=>new fN(t,e)),fR.of(e)]}let fj=!(hJ.ios&&hJ.webkit&&hJ.webkit_version<534),fI=eP.define({combine:e=>to(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function f$(e){return e.startState.facet(fI)!=e.state.facet(fI)}let fL=fP({above:!0,markers(e){let{state:t}=e,n=t.facet(fI),r=[];for(let i of t.selection.ranges){let o=i==t.selection.main;if(i.empty?!o||fj:n.drawRangeCursor){let t=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",n=i.empty?i:eD.cursor(i.head,i.head>i.anchor?-1:1);for(let i of fM.forRange(e,t,n))r.push(i)}}return r},update(e,t){e.transactions.some(e=>e.selection)&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");let n=f$(e);return n&&fq(e.state,t),e.docChanged||e.selectionSet||n},mount(e,t){fq(t.state,e)},class:"cm-cursorLayer"});function fq(e,t){t.style.animationDuration=e.facet(fI).cursorBlinkRate+"ms"}let fz=fP({above:!1,markers:e=>e.state.selection.ranges.map(t=>t.empty?[]:fM.forRange(e,"cm-selectionBackground",t)).reduce((e,t)=>e.concat(t)),update:(e,t)=>e.docChanged||e.selectionSet||e.viewportChanged||f$(e),class:"cm-selectionLayer"}),fB={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};fj&&(fB[".cm-line"].caretColor=fB[".cm-content"].caretColor="transparent !important");let fF=eQ.highest(fm.theme(fB)),fQ=e6.define({map:(e,t)=>null==e?null:t.mapPos(e)}),fV=ez.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce((e,t)=>t.is(fQ)?t.value:e,e))}),fW=uU.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let n=e.state.field(fV);null==n?null!=this.cursor&&(null===(t=this.cursor)||void 0===t||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(fV)!=n||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:e}=this,t=e.state.field(fV),n=null!=t&&e.coordsAtPos(t);if(!n)return null;let r=e.scrollDOM.getBoundingClientRect();return{left:n.left-r.left+e.scrollDOM.scrollLeft*e.scaleX,top:n.top-r.top+e.scrollDOM.scrollTop*e.scaleY,height:n.bottom-n.top}}drawCursor(e){if(this.cursor){let{scaleX:t,scaleY:n}=this.view;e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/n+"px",this.cursor.style.height=e.height/n+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(fV)!=e&&this.view.dispatch({effects:fQ.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function fU(e,t,n,r,i){t.lastIndex=0;for(let o=e.iterRange(n,r),s=n,a;!o.next().done;s+=o.value.length)if(!o.lineBreak)for(;a=t.exec(o.value);)i(s+a.index,a)}class fH{constructor(e){let{regexp:t,decoration:n,decorate:r,boundary:i,maxLength:o=1e3}=e;if(!t.global)throw RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(e,t,n,i)=>r(i,n,n+e[0].length,e,t);else if("function"==typeof n)this.addMatch=(e,t,r,i)=>{let o=n(e,t,r);o&&i(r,r+e[0].length,o)};else if(n)this.addMatch=(e,t,r,i)=>i(r,r+e[0].length,n);else throw RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=i,this.maxLength=o}createDeco(e){let t=new tu,n=t.add.bind(t);for(let{from:t,to:r}of function(e,t){let n=e.visibleRanges;if(1==n.length&&n[0].from==e.viewport.from&&n[0].to==e.viewport.to)return n;let r=[];for(let{from:i,to:o}of n)i=Math.max(e.state.doc.lineAt(i).from,i-t),o=Math.min(e.state.doc.lineAt(o).to,o+t),r.length&&r[r.length-1].to>=i?r[r.length-1].to=o:r.push({from:i,to:o});return r}(e,this.maxLength))fU(e.state.doc,this.regexp,t,r,(t,r)=>this.addMatch(r,e,t,n));return t.finish()}updateDeco(e,t){let n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((t,i,o,s)=>{s>=e.view.viewport.from&&o<=e.view.viewport.to&&(n=Math.min(o,n),r=Math.max(s,r))}),e.viewportMoved||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),n,r):t}updateRange(e,t,n,r){for(let i of e.visibleRanges){let o=Math.max(i.from,n),s=Math.min(i.to,r);if(s>o){let n=e.state.doc.lineAt(o),r=n.to<s?e.state.doc.lineAt(s):n,a=Math.max(i.from,n.from),l=Math.min(i.to,r.to);if(this.boundary){for(;o>n.from;o--)if(this.boundary.test(n.text[o-1-n.from])){a=o;break}for(;s<r.to;s++)if(this.boundary.test(r.text[s-r.from])){l=s;break}}let c=[],h,u=(e,t,n)=>c.push(n.range(e,t));if(n==r)for(this.regexp.lastIndex=a-n.from;(h=this.regexp.exec(n.text))&&h.index<l-n.from;)this.addMatch(h,e,h.index+n.from,u);else fU(e.state.doc,this.regexp,a,l,(t,n)=>this.addMatch(n,e,t,u));t=t.update({filterFrom:a,filterTo:l,filter:(e,t)=>e<a||t>l,add:c})}}return t}}let fG=null!=/x/.unicode?"gu":"g",fX=RegExp(`[\0-\b
-\x7f-\x9f\xad\u2028\u2029\uFEFF-]`,fG),fZ={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},fY=null,fJ=eP.define({combine(e){let t=to(e,{render:null,specialChars:fX,addSpecialChars:null});return(t.replaceTabs=!function(){var e;if(null==fY&&"u">typeof document&&document.body){let t=document.body.style;fY=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize)!=null}return fY||!1}())&&(t.specialChars=RegExp("	|"+t.specialChars.source,fG)),t.addSpecialChars&&(t.specialChars=RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,fG)),t}}),fK=null;class f0 extends h7{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){var t;let n=(t=this.code)>=32?"":10==t?"":String.fromCharCode(9216+t),r=e.state.phrase("Control character")+" "+(fZ[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,n);if(i)return i;let o=document.createElement("span");return o.textContent=n,o.title=r,o.setAttribute("aria-label",r),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class f1 extends h7{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}let f2=ut.line({class:"cm-activeLine"}),f5=uU.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,n=[];for(let r of e.state.selection.ranges){let i=e.lineBlockAt(r.head);i.from>t&&(n.push(f2.range(i.from)),t=i.from)}return ut.set(n)}},{decorations:e=>e.decorations});class f3 extends h7{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild("string"==typeof this.content?document.createTextNode(this.content):"function"==typeof this.content?this.content(e):this.content.cloneNode(!0)),"string"==typeof this.content?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?hy(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),r=hO(t[0],"rtl"!=n.direction),i=parseInt(n.lineHeight);return r.bottom-r.top>1.5*i?{left:r.left,right:r.right,top:r.top,bottom:r.top+i}:r}ignoreEvent(){return!1}}function f4(e,t){var n;let r;let i=e.posAtCoords({x:t.clientX,y:t.clientY},!1),o=e.state.doc.lineAt(i),s=i-o.from,a=s>2e3?-1:s==o.length?(n=t.clientX,(r=e.coordsAtPos(e.viewport.from))?Math.round(Math.abs((r.left-n)/e.defaultCharacterWidth)):-1):tk(o.text,e.state.tabSize,i-o.from);return{line:o.number,col:a,off:s}}let f6={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},f8={style:"cursor: crosshair"},f9="-10000px";class f7{constructor(e,t,n,r){this.facet=t,this.createTooltipView=n,this.removeTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(e=>e);let i=null;this.tooltipViews=this.tooltips.map(e=>i=n(e,i))}update(e,t){var n;let r=e.state.facet(this.facet),i=r.filter(e=>e);if(r===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let o=[],s=t?[]:null;for(let n=0;n<i.length;n++){let r=i[n],a=-1;if(r){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==r.create&&(a=e)}if(a<0)o[n]=this.createTooltipView(r,n?o[n-1]:null),s&&(s[n]=!!r.above);else{let r=o[n]=this.tooltipViews[a];s&&(s[n]=t[a]),r.update&&r.update(e)}}}for(let e of this.tooltipViews)0>o.indexOf(e)&&(this.removeTooltipView(e),null===(n=e.destroy)||void 0===n||n.call(e));return t&&(s.forEach((e,n)=>t[n]=e),t.length=s.length),this.input=r,this.tooltips=i,this.tooltipViews=o,!0}}function pe(e){let t=e.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}let pt=eP.define({combine:e=>{var t,n,r;return{position:hJ.ios?"absolute":(null===(t=e.find(e=>e.position))||void 0===t?void 0:t.position)||"fixed",parent:(null===(n=e.find(e=>e.parent))||void 0===n?void 0:n.parent)||null,tooltipSpace:(null===(r=e.find(e=>e.tooltipSpace))||void 0===r?void 0:r.tooltipSpace)||pe}}}),pn=new WeakMap,pr=uU.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=e.state.facet(pt);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new f7(e,pa,(e,t)=>this.createTooltip(e,t),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver)for(let e of(this.intersectionObserver.disconnect(),this.manager.tooltipViews))this.intersectionObserver.observe(e.dom)}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e,this.above);t&&this.observeIntersection();let n=t||e.geometryChanged,r=e.state.facet(pt);if(r.position!=this.position&&!this.madeAbsolute){for(let e of(this.position=r.position,this.manager.tooltipViews))e.dom.style.position=this.position;n=!0}if(r.parent!=this.parent){for(let e of(this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer(),this.manager.tooltipViews))this.container.appendChild(e.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(e,t){let n=e.create(this.view),r=t?t.dom:null;if(n.dom.classList.add("cm-tooltip"),e.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",n.dom.appendChild(e)}return n.dom.style.position=this.position,n.dom.style.top=f9,n.dom.style.left="0px",this.container.insertBefore(n.dom,r),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var e,t,n;for(let t of(this.view.win.removeEventListener("resize",this.measureSoon),this.manager.tooltipViews))t.dom.remove(),null===(e=t.destroy)||void 0===e||e.call(t);this.parent&&this.container.remove(),null===(t=this.resizeObserver)||void 0===t||t.disconnect(),null===(n=this.intersectionObserver)||void 0===n||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=1,t=1,n=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:e}=this.manager.tooltipViews[0];if(hJ.gecko)n=e.offsetParent!=this.container.ownerDocument.body;else if(e.style.top==f9&&"0px"==e.style.left){let t=e.getBoundingClientRect();n=Math.abs(t.top+1e4)>1||Math.abs(t.left)>1}}if(n||"absolute"==this.position){if(this.parent){let n=this.parent.getBoundingClientRect();n.width&&n.height&&(e=n.width/this.parent.offsetWidth,t=n.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState)}let r=this.view.scrollDOM.getBoundingClientRect(),i=u2(this.view);return{visible:{left:r.left+i.left,top:r.top+i.top,right:r.right-i.right,bottom:r.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((e,t)=>{let n=this.manager.tooltipViews[t];return n.getCoords?n.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(pt).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:n}}writeMeasure(e){var t;if(e.makeAbsolute)for(let e of(this.madeAbsolute=!0,this.position="absolute",this.manager.tooltipViews))e.dom.style.position="absolute";let{visible:n,space:r,scaleX:i,scaleY:o}=e,s=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:h}=c,u=e.pos[a],d=e.size[a];if(!u||!1!==l.clip&&(u.bottom<=Math.max(n.top,r.top)||u.top>=Math.min(n.bottom,r.bottom)||u.right<Math.max(n.left,r.left)-.1||u.left>Math.min(n.right,r.right)+.1)){h.style.top=f9;continue}let f=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=f?7:0,m=d.right-d.left,g=null!==(t=pn.get(c))&&void 0!==t?t:d.bottom-d.top,y=c.offset||ps,b=this.view.textDirection==uf.LTR,v=d.width>r.right-r.left?b?r.left:r.right-d.width:b?Math.max(r.left,Math.min(u.left-(f?14:0)+y.x,r.right-m)):Math.min(Math.max(r.left,u.left-m+(f?14:0)-y.x),r.right-m),x=this.above[a];!l.strictSide&&(x?u.top-g-p-y.y<r.top:u.bottom+g+p+y.y>r.bottom)&&x==r.bottom-u.bottom>u.top-r.top&&(x=this.above[a]=!x);let w=(x?u.top-r.top:r.bottom-u.bottom)-p;if(w<g&&!1!==c.resize){if(w<this.view.defaultLineHeight){h.style.top=f9;continue}pn.set(c,g),h.style.height=(g=w)/o+"px"}else h.style.height&&(h.style.height="");let k=x?u.top-g-p-y.y:u.bottom+p+y.y,O=v+m;if(!0!==c.overlap)for(let e of s)e.left<O&&e.right>v&&e.top<k+g&&e.bottom>k&&(k=x?e.top-g-2-p:e.bottom+p+2);if("absolute"==this.position?(h.style.top=(k-e.parent.top)/o+"px",pi(h,(v-e.parent.left)/i)):(h.style.top=k/o+"px",pi(h,v/i)),f){let e=u.left+(b?y.x:-y.x)-(v+14-7);f.style.left=e/i+"px"}!0!==c.overlap&&s.push({left:v,top:k,right:O,bottom:k+g}),h.classList.toggle("cm-tooltip-above",x),h.classList.toggle("cm-tooltip-below",!x),c.positioned&&c.positioned(e.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let e of this.manager.tooltipViews)e.dom.style.top=f9}},{eventObservers:{scroll(){this.maybeMeasure()}}});function pi(e,t){let n=parseInt(e.style.left,10);(isNaN(n)||Math.abs(t-n)>1)&&(e.style.left=t+"px")}let po=fm.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),ps={x:0,y:0},pa=eP.define({enables:[pr,po]}),pl=eP.define({combine:e=>e.reduce((e,t)=>e.concat(t),[])});class pc{static create(e){return new pc(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new f7(e,pl,(e,t)=>this.createHostedView(e,t),e=>e.dom.remove())}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)null===(e=t.destroy)||void 0===e||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let r=n[e];if(void 0!==r){if(void 0===t)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}let ph=pa.compute([pl],e=>{let t=e.facet(pl);return 0===t.length?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var t;return null!==(t=e.end)&&void 0!==t?t:e.pos})),create:pc.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class pu{constructor(e,t,n,r,i){this.view=e,this.source=t,this.field=n,this.setHover=r,this.hoverTime=i,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let r,i=1;if(n instanceof h1)r=n.posAtStart;else{if(null==(r=e.posAtCoords(t)))return;let n=e.coordsAtPos(r);if(!n||t.y<n.top||t.y>n.bottom||t.x<n.left-e.defaultCharacterWidth||t.x>n.right+e.defaultCharacterWidth)return;let o=e.bidiSpans(e.state.doc.lineAt(r)).find(e=>e.from<=r&&e.to>=r),s=o&&o.dir==uf.RTL?-1:1;i=t.x<n.left?-s:s}let o=this.source(e,r,i);if(null!=o&&o.then){let t=this.pending={pos:r};o.then(n=>{this.pending==t&&(this.pending=null,n&&!(Array.isArray(n)&&!n.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(n)?n:[n])}))},t=>uF(e.state,t,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(pr),t=e?e.manager.tooltips.findIndex(e=>e.create==pc.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:i}=this;if(r.length&&i&&!function(e,t){let{left:n,right:r,top:i,bottom:o}=e.getBoundingClientRect(),s;if(s=e.querySelector(".cm-tooltip-arrow")){let e=s.getBoundingClientRect();i=Math.min(e.top,i),o=Math.max(e.bottom,o)}return t.clientX>=n-4&&t.clientX<=r+4&&t.clientY>=i-4&&t.clientY<=o+4}(i.dom,e)||this.pending){let{pos:i}=r[0]||this.pending,o=null!==(n=null===(t=r[0])||void 0===t?void 0:t.end)&&void 0!==n?n:i;(i==o?this.view.posAtCoords(this.lastMove)==i:function(e,t,n,r,i,o){let s=e.scrollDOM.getBoundingClientRect(),a=e.documentTop+e.documentPadding.top+e.contentHeight;if(s.left>r||s.right<r||s.top>i||Math.min(s.bottom,a)<i)return!1;let l=e.posAtCoords({x:r,y:i},!1);return l>=t&&l<=n}(this.view,i,o,e.clientX,e.clientY))||(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:t}=this;t&&t.dom.contains(e.relatedTarget)?this.watchTooltipLeave(t.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function pd(e,t){let n=e.plugin(pr);if(!n)return null;let r=n.manager.tooltips.indexOf(t);return r<0?null:n.manager.tooltipViews[r]}let pf=e6.define(),pp=eP.define({combine(e){let t,n;for(let r of e)t=t||r.topContainer,n=n||r.bottomContainer;return{topContainer:t,bottomContainer:n}}});function pm(e,t){let n=e.plugin(pg),r=n?n.specs.indexOf(t):-1;return r>-1?n.panels[r]:null}let pg=uU.fromClass(class{constructor(e){this.input=e.state.facet(pv),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(t=>t(e));let t=e.state.facet(pp);for(let n of(this.top=new py(e,!0,t.topContainer),this.bottom=new py(e,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top)),this.panels))n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(e){let t=e.state.facet(pp);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new py(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new py(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=e.state.facet(pv);if(n!=this.input){let t=n.filter(e=>e),r=[],i=[],o=[],s=[];for(let n of t){let t=this.specs.indexOf(n),a;t<0?(a=n(e.view),s.push(a)):(a=this.panels[t]).update&&a.update(e),r.push(a),(a.top?i:o).push(a)}for(let e of(this.specs=t,this.panels=r,this.top.sync(i),this.bottom.sync(o),s))e.dom.classList.add("cm-panel"),e.mount&&e.mount()}else for(let t of this.panels)t.update&&t.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:e=>fm.scrollMargins.of(t=>{let n=t.plugin(e);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class py{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&0>e.indexOf(t)&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=pb(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=pb(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function pb(e){let t=e.nextSibling;return e.remove(),t}let pv=eP.define({enables:pg});class px extends ts{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}px.prototype.elementClass="",px.prototype.toDOM=void 0,px.prototype.mapMode=ew.TrackBefore,px.prototype.startSide=px.prototype.endSide=-1,px.prototype.point=!0;let pw=eP.define(),pk=eP.define(),pO={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>th.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},pS=eP.define(),pC=eP.define({combine:e=>e.some(e=>e)}),pT=uU.fromClass(class{constructor(e){for(let t of(this.view=e,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=e.state.facet(pS).map(t=>new p_(e,t)),this.gutters))this.dom.appendChild(t.dom);this.fixed=!e.state.facet(pC),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}update(e){if(this.updateGutters(e)){let t=this.prevViewport,n=e.view.viewport,r=Math.min(t.to,n.to)-Math.max(t.from,n.from);this.syncGutters(r<(n.to-n.from)*.8)}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(pC)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&this.dom.remove();let n=th.iter(this.view.state.facet(pw),this.view.viewport.from),r=[],i=this.gutters.map(e=>new pM(e,this.view.viewport,-this.view.documentPadding.top));for(let e of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(e.type)){let t=!0;for(let o of e.type)if(o.type==ue.Text&&t){for(let e of(pE(n,r,o.from),i))e.line(this.view,o,r);t=!1}else if(o.widget)for(let e of i)e.widget(this.view,o)}else if(e.type==ue.Text)for(let t of(pE(n,r,e.from),i))t.line(this.view,e,r);else if(e.widget)for(let t of i)t.widget(this.view,e);for(let e of i)e.finish();e&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){let t=e.startState.facet(pS),n=e.state.facet(pS),r=e.docChanged||e.heightChanged||e.viewportChanged||!th.eq(e.startState.facet(pw),e.state.facet(pw),e.view.viewport.from,e.view.viewport.to);if(t==n)for(let t of this.gutters)t.update(e)&&(r=!0);else{r=!0;let i=[];for(let r of n){let n=t.indexOf(r);n<0?i.push(new p_(this.view,r)):(this.gutters[n].update(e),i.push(this.gutters[n]))}for(let e of this.gutters)e.dom.remove(),0>i.indexOf(e)&&e.destroy();for(let e of i)this.dom.appendChild(e.dom);this.gutters=i}return r}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove()}},{provide:e=>fm.scrollMargins.of(t=>{let n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==uf.LTR?{left:n.dom.offsetWidth*t.scaleX}:{right:n.dom.offsetWidth*t.scaleX}:null})});function pA(e){return Array.isArray(e)?e:[e]}function pE(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}class pM{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=th.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:r}=this,i=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==r.elements.length){let t=new pD(e,o,i,n);r.elements.push(t),r.dom.appendChild(t.dom)}else r.elements[this.i].update(e,o,i,n);this.height=t.bottom,this.i++}line(e,t,n){let r=[];pE(this.cursor,r,t.from),n.length&&(r=r.concat(n));let i=this.gutter.config.lineMarker(e,t,r);i&&r.unshift(i);let o=this.gutter;(0!=r.length||o.config.renderEmptyElements)&&this.addElement(e,t,r)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t),r=n?[n]:null;for(let n of e.state.facet(pk)){let i=n(e,t.widget,t);i&&(r||(r=[])).push(i)}r&&this.addElement(e,t,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class p_{constructor(e,t){for(let n in this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),t.domEventHandlers)this.dom.addEventListener(n,r=>{let i=r.target,o;if(i!=this.dom&&this.dom.contains(i)){for(;i.parentNode!=this.dom;)i=i.parentNode;let e=i.getBoundingClientRect();o=(e.top+e.bottom)/2}else o=r.clientY;let s=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[n](e,s,r)&&r.preventDefault()});this.markers=pA(t.markers(e)),t.initialSpacer&&(this.spacer=new pD(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=pA(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let n=e.view.viewport;return!th.eq(this.markers,t,n.from,n.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}}class pD{constructor(e,t,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,r)}update(e,t,n,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let n="cm-gutterElement",r=this.dom.firstChild;for(let i=0,o=0;;){let s=o,a=i<t.length?t[i++]:null,l=!1;if(a){let e=a.elementClass;e&&(n+=" "+e);for(let e=o;e<this.markers.length;e++)if(this.markers[e].compare(a)){s=e,l=!0;break}}else s=this.markers.length;for(;o<s;){let e=this.markers[o++];if(e.toDOM){e.destroy(r);let t=r.nextSibling;r.remove(),r=t}}if(!a)break;a.toDOM&&(l?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),l&&o++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}let pN=eP.define(),pR=eP.define(),pP=eP.define({combine:e=>to(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let e in t){let r=n[e],i=t[e];n[e]=r?(e,t,n)=>r(e,t,n)||i(e,t,n):i}return n}})});class pj extends px{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function pI(e,t){return e.state.facet(pP).formatNumber(t,e.state)}let p$=pS.compute([pP],e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(pN),lineMarker:(e,t,n)=>n.some(e=>e.toDOM)?null:new pj(pI(e,e.state.doc.lineAt(t.from).number)),widgetMarker:(e,t,n)=>{for(let r of e.state.facet(pR)){let i=r(e,t,n);if(i)return i}return null},lineMarkerChange:e=>e.startState.facet(pP)!=e.state.facet(pP),initialSpacer:e=>new pj(pI(e,pL(e.state.doc.lines))),updateSpacer(e,t){let n=pI(t.view,pL(t.view.state.doc.lines));return n==e.number?e:new pj(n)},domEventHandlers:e.facet(pP).domEventHandlers}));function pL(e){let t=9;for(;t<e;)t=10*t+9;return t}let pq=new class extends px{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},pz=pw.compute(["selection"],e=>{let t=[],n=-1;for(let r of e.selection.ranges){let i=e.doc.lineAt(r.head).from;i>n&&(n=i,t.push(pq.range(i)))}return th.of(t)}),pB=0;class pF{constructor(e,t){this.from=e,this.to=t}}class pQ{constructor(e={}){this.id=pB++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=pU.match(e)),t=>{let n=e(t);return void 0===n?null:[this,n]}}}pQ.closedBy=new pQ({deserialize:e=>e.split(" ")}),pQ.openedBy=new pQ({deserialize:e=>e.split(" ")}),pQ.group=new pQ({deserialize:e=>e.split(" ")}),pQ.isolate=new pQ({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw RangeError("Invalid value for isolate: "+e);return e||"auto"}}),pQ.contextHash=new pQ({perNode:!0}),pQ.lookAhead=new pQ({perNode:!0}),pQ.mounted=new pQ({perNode:!0});class pV{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[pQ.mounted.id]}}let pW=Object.create(null),pU=class e{constructor(e,t,n,r=0){this.name=e,this.props=t,this.id=n,this.flags=r}static define(t){let n=t.props&&t.props.length?Object.create(null):pW,r=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),i=new e(t.name||"",n,t.id,r);if(t.props){for(let e of t.props)if(Array.isArray(e)||(e=e(i)),e){if(e[0].perNode)throw RangeError("Can't store a per-node prop on a node type");n[e[0].id]=e[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(pQ.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let r of n.split(" "))t[r]=e[n];return e=>{for(let n=e.prop(pQ.group),r=-1;r<(n?n.length:0);r++){let i=t[r<0?e.name:n[r]];if(i)return i}}}};pU.none=new pU("",Object.create(null),0,8);class pH{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let r=null;for(let t of e){let e=t(n);e&&(r||(r=Object.assign({},n.props)),r[e[0].id]=e[1])}t.push(r?new pU(n.name,r,n.id,n.flags):n)}return new pH(t)}}let pG=new WeakMap,pX=new WeakMap;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(d||(d={}));class pZ{constructor(e,t,n,r,i){if(this.type=e,this.children=t,this.positions=n,this.length=r,this.props=null,i&&i.length)for(let[e,t]of(this.props=Object.create(null),i))this.props["number"==typeof e?e:e.id]=t}toString(){let e=pV.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let n=e.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new p7(this.topNode,e)}cursorAt(e,t=0,n=0){let r=new p7(pG.get(this)||this.topNode);return r.moveTo(e,t),pG.set(this,r._tree),r}get topNode(){return new p2(this,0,0,null)}resolve(e,t=0){let n=p0(pG.get(this)||this.topNode,e,t,!1);return pG.set(this,n),n}resolveInner(e,t=0){let n=p0(pX.get(this)||this.topNode,e,t,!0);return pX.set(this,n),n}resolveStack(e,t=0){return function(e,t,n){let r=e.resolveInner(t,n),i=null;for(let e=r instanceof p2?r:r.context.parent;e;e=e.parent)if(e.index<0){let o=e.parent;(i||(i=[r])).push(o.resolve(t,n)),e=o}else{let o=pV.get(e.tree);if(o&&o.overlay&&o.overlay[0].from<=t&&o.overlay[o.overlay.length-1].to>=t){let s=new p2(o.tree,o.overlay[0].from+e.from,-1,e);(i||(i=[r])).push(p0(s,t,n,!1))}}return i?p8(i):r}(this,e,t)}iterate(e){let{enter:t,leave:n,from:r=0,to:i=this.length}=e,o=e.mode||0,s=(o&d.IncludeAnonymous)>0;for(let e=this.cursor(o|d.IncludeAnonymous);;){let o=!1;if(e.from<=i&&e.to>=r&&(!s&&e.type.isAnonymous||!1!==t(e))){if(e.firstChild())continue;o=!0}for(;o&&n&&(s||!e.type.isAnonymous)&&n(e),!e.nextSibling();){if(!e.parent())return;o=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:mr(pU.none,this.children,this.positions,0,this.children.length,0,this.length,(e,t,n)=>new pZ(this.type,e,t,n,this.propValues),e.makeTree||((e,t,n)=>new pZ(pU.none,e,t,n)))}static build(e){return function(e){var t;let{buffer:n,nodeSet:r,maxBufferLength:i=1024,reused:o=[],minRepeatType:s=r.types.length}=e,a=Array.isArray(n)?new pY(n,n.length):n,l=r.types,c=0,h=0;function u(e,t,n,i,o,s,a,l,c){let h=[],u=[];for(;e.length>i;)h.push(e.pop()),u.push(t.pop()+n-o);e.push(d(r.types[a],h,u,s-o,l-s,c)),t.push(o-n)}function d(e,t,n,r,i,o,s){if(o){let e=[pQ.contextHash,o];s=s?[e].concat(s):[e]}if(i>25){let e=[pQ.lookAhead,i];s=s?[e].concat(s):[e]}return new pZ(e,t,n,r,s)}let f=[],p=[];for(;a.pos>0;)!function e(t,n,f,p,m,g){let{id:y,start:b,end:v,size:x}=a,w=h,k=c;for(;x<0;)if(a.next(),-1==x){let e=o[y];f.push(e),p.push(b-t);return}else if(-3==x){c=y;return}else if(-4==x){h=y;return}else throw RangeError(`Unrecognized record size: ${x}`);let O=l[y],S,C,T=b-t;if(v-b<=i&&(C=function(e,t){let n=a.fork(),r=0,o=0,l=0,c=n.end-i,h={size:0,start:0,skip:0};e:for(let i=n.pos-e;n.pos>i;){let e=n.size;if(n.id==t&&e>=0){h.size=r,h.start=o,h.skip=l,l+=4,r+=4,n.next();continue}let a=n.pos-e;if(e<0||a<i||n.start<c)break;let u=n.id>=s?4:0,d=n.start;for(n.next();n.pos>a;){if(n.size<0){if(-3==n.size)u+=4;else break e}else n.id>=s&&(u+=4);n.next()}o=d,r+=e,l+=u}return(t<0||r==e)&&(h.size=r,h.start=o,h.skip=l),h.size>4?h:void 0}(a.pos-n,m))){let e=new Uint16Array(C.size-C.skip),n=a.pos-C.size,i=e.length;for(;a.pos>n;)i=function e(t,n,r){let{id:i,start:o,end:l,size:u}=a;if(a.next(),u>=0&&i<s){let s=r;if(u>4){let i=a.pos-(u-4);for(;a.pos>i;)r=e(t,n,r)}n[--r]=s,n[--r]=l-t,n[--r]=o-t,n[--r]=i}else -3==u?c=i:-4==u&&(h=i);return r}(C.start,e,i);S=new pJ(e,v-C.start,r),T=C.start-t}else{let t=a.pos-x;a.next();let n=[],o=[],l=y>=s?y:-1,c=0,h=v;for(;a.pos>t;)l>=0&&a.id==l&&a.size>=0?(a.end<=h-i&&(u(n,o,b,c,a.end,h,l,w,k),c=n.length,h=a.end),a.next()):g>2500?function(e,t,n,o){let s=[],l=0,c=-1;for(;a.pos>t;){let{id:e,start:t,end:n,size:r}=a;if(r>4)a.next();else{if(c>-1&&t<c)break;c<0&&(c=n-i),s.push(e,t,n),l++,a.next()}}if(l){let t=new Uint16Array(4*l),i=s[s.length-2];for(let e=s.length-3,n=0;e>=0;e-=3)t[n++]=s[e],t[n++]=s[e+1]-i,t[n++]=s[e+2]-i,t[n++]=n;n.push(new pJ(t,s[2]-i,r)),o.push(i-e)}}(b,t,n,o):e(b,t,n,o,l,g+1);if(l>=0&&c>0&&c<n.length&&u(n,o,b,c,b,h,l,w,k),n.reverse(),o.reverse(),l>-1&&c>0){let e=function(e,t){return(n,r,i)=>{let o=0,s=n.length-1,a,l;if(s>=0&&(a=n[s])instanceof pZ){if(!s&&a.type==e&&a.length==i)return a;(l=a.prop(pQ.lookAhead))&&(o=r[s]+a.length+l)}return d(e,n,r,i,o,t)}}(O,k);S=mr(O,n,o,0,n.length,0,v-b,e,e)}else S=d(O,n,o,v-b,w-v,k)}f.push(S),p.push(T)}(e.start||0,e.bufferStart||0,f,p,-1,0);let m=null!==(t=e.length)&&void 0!==t?t:f.length?p[0]+f[0].length:0;return new pZ(l[e.topID],f.reverse(),p.reverse(),m)}(e)}}pZ.empty=new pZ(pU.none,[],[],0);class pY{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new pY(this.buffer,this.index)}}class pJ{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return pU.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],i=r.name;if(/\W/.test(i)&&!r.isError&&(i=JSON.stringify(i)),n==(e+=4))return i;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return i+"("+o.join(",")+")"}findChild(e,t,n,r,i){let{buffer:o}=this,s=-1;for(let a=e;a!=t&&!(pK(i,r,o[a+1],o[a+2])&&(s=a,n>0));a=o[a+3]);return s}slice(e,t,n){let r=this.buffer,i=new Uint16Array(t-e),o=0;for(let s=e,a=0;s<t;){i[a++]=r[s++],i[a++]=r[s++]-n;let t=i[a++]=r[s++]-n;i[a++]=r[s++]-e,o=Math.max(o,t)}return new pJ(i,o,this.set)}}function pK(e,t,n,r){switch(e){case -2:return n<t;case -1:return r>=t&&n<t;case 0:return n<t&&r>t;case 1:return n<=t&&r>t;case 2:return r>t;case 4:return!0}}function p0(e,t,n,r){for(var i;e.from==e.to||(n<1?e.from>=t:e.from>t)||(n>-1?e.to<=t:e.to<t);){let t=!r&&e instanceof p2&&e.index<0?null:e.parent;if(!t)return e;e=t}let o=r?0:d.IgnoreOverlays;if(r)for(let r=e,s=r.parent;s;s=(r=s).parent)r instanceof p2&&r.index<0&&(null===(i=s.enter(t,n,o))||void 0===i?void 0:i.from)!=r.from&&(e=s);for(;;){let r=e.enter(t,n,o);if(!r)return e;e=r}}class p1{cursor(e=0){return new p7(this,e)}getChild(e,t=null,n=null){let r=p5(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return p5(this,e,t,n)}resolve(e,t=0){return p0(this,e,t,!1)}resolveInner(e,t=0){return p0(this,e,t,!0)}matchContext(e){return p3(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(n=t,t=e.prevSibling):t=e}return n}get node(){return this}get next(){return this.parent}}class p2 extends p1{constructor(e,t,n,r){super(),this._tree=e,this.from=t,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,r,i=0){for(let o=this;;){for(let{children:s,positions:a}=o._tree,l=t>0?s.length:-1;e!=l;e+=t){let l=s[e],c=a[e]+o.from;if(pK(r,n,c,c+l.length)){if(l instanceof pJ){if(i&d.ExcludeBuffers)continue;let s=l.findChild(0,l.buffer.length,t,n-c,r);if(s>-1)return new p6(new p4(o,l,e,c),null,s)}else if(i&d.IncludeAnonymous||!l.type.isAnonymous||me(l)){let s;if(!(i&d.IgnoreMounts)&&(s=pV.get(l))&&!s.overlay)return new p2(s.tree,c,e,o);let a=new p2(l,c,e,o);return i&d.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(t<0?l.children.length-1:0,t,n,r)}}}if(i&d.IncludeAnonymous||!o.type.isAnonymous||(e=o.index>=0?o.index+t:t<0?-1:o._parent._tree.children.length,!(o=o._parent)))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let r;if(!(n&d.IgnoreOverlays)&&(r=pV.get(this._tree))&&r.overlay){let n=e-this.from;for(let{from:e,to:i}of r.overlay)if((t>0?e<=n:e<n)&&(t<0?i>=n:i>n))return new p2(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function p5(e,t,n,r){let i=e.cursor(),o=[];if(!i.firstChild())return o;if(null!=n){for(let e=!1;!e;)if(e=i.type.is(n),!i.nextSibling())return o}for(;;){if(null!=r&&i.type.is(r))return o;if(i.type.is(t)&&o.push(i.node),!i.nextSibling())return null==r?o:[]}}function p3(e,t,n=t.length-1){for(let r=e;n>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(t[n]&&t[n]!=r.name)return!1;n--}}return!0}class p4{constructor(e,t,n,r){this.parent=e,this.buffer=t,this.index=n,this.start=r}}class p6 extends p1{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:r}=this.context,i=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,n);return i<0?null:new p6(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&d.ExcludeBuffers)return null;let{buffer:r}=this.context,i=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new p6(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new p6(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new p6(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,r=this.index+4,i=n.buffer[this.index+3];if(i>r){let o=n.buffer[this.index+1];e.push(n.slice(r,i,o)),t.push(0)}return new pZ(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function p8(e){if(!e.length)return null;let t=0,n=e[0];for(let r=1;r<e.length;r++){let i=e[r];(i.from>n.from||i.to<n.to)&&(n=i,t=r)}let r=n instanceof p2&&n.index<0?null:n.parent,i=e.slice();return r?i[t]=r:i.splice(t,1),new p9(i,n)}class p9{constructor(e,t){this.heads=e,this.node=t}get next(){return p8(this.heads)}}class p7{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof p2)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return!!e&&(e instanceof p2?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:r}=this.buffer,i=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?!(n&d.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&d.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&d.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let e=n<0?0:this.stack[n]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(e)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(r.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:n}=r)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let r=t+e,i=e<0?-1:n._tree.children.length;r!=i;r+=e){let e=n._tree.children[r];if(this.mode&d.IncludeAnonymous||e instanceof pJ||!e.type.isAnonymous||me(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,i=this.stack.length;i>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,n=i+1;break e}r=this.stack[--i]}for(let e=n;e<this.stack.length;e++)t=new p6(this.buffer,t,this.stack[e]);return this.bufferNode=new p6(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let r=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&t&&t(this),r=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return p3(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let r=e.length-1,i=this.stack.length-1;r>=0;i--){if(i<0)return p3(this._tree,e,r);let o=n[t.buffer[this.stack[i]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function me(e){return e.children.some(e=>e instanceof pJ||!e.type.isAnonymous||me(e))}let mt=new WeakMap;function mn(e,t){if(!e.isAnonymous||t instanceof pJ||t.type!=e)return 1;let n=mt.get(t);if(null==n){for(let r of(n=1,t.children)){if(r.type!=e||!(r instanceof pZ)){n=1;break}n+=mn(e,r)}mt.set(t,n)}return n}function mr(e,t,n,r,i,o,s,a,l){let c=0;for(let n=r;n<i;n++)c+=mn(e,t[n]);let h=Math.ceil(1.5*c/8),u=[],d=[];return function t(n,r,i,s,a){for(let c=i;c<s;){let i=c,f=r[c],p=mn(e,n[c]);for(c++;c<s;c++){let t=mn(e,n[c]);if(p+t>=h)break;p+=t}if(c==i+1){if(p>h){let e=n[i];t(e.children,e.positions,0,e.children.length,r[i]+a);continue}u.push(n[i])}else{let t=r[c-1]+n[c-1].length-f;u.push(mr(e,n,r,i,c,f,t,null,l))}d.push(f+a-o)}}(t,n,r,i,0),(a||l)(u,d,s)}class mi{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof p6?this.setBuffer(e.context.buffer,e.index,t):e instanceof p2&&this.map.set(e.tree,t)}get(e){return e instanceof p6?this.getBuffer(e.context.buffer,e.index):e instanceof p2?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class mo{constructor(e,t,n,r,i=!1,o=!1){this.from=e,this.to=t,this.tree=n,this.offset=r,this.open=(i?1:0)|(o?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],n=!1){let r=[new mo(0,e.length,e,0,!1,n)];for(let n of t)n.to>e.length&&r.push(n);return r}static applyChanges(e,t,n=128){if(!t.length)return e;let r=[],i=1,o=e.length?e[0]:null;for(let s=0,a=0,l=0;;s++){let c=s<t.length?t[s]:null,h=c?c.fromA:1e9;if(h-a>=n)for(;o&&o.from<h;){let t=o;if(a>=t.from||h<=t.to||l){let e=Math.max(t.from,a)-l,n=Math.min(t.to,h)-l;t=e>=n?null:new mo(e,n,t.tree,t.offset+l,s>0,!!c)}if(t&&r.push(t),o.to>h)break;o=i<e.length?e[i++]:null}if(!c)break;a=c.toA,l=c.toA-c.toB}return r}}let ms=class{startParse(e,t,n){return"string"==typeof e&&(e=new ma(e)),n=n?n.length?n.map(e=>new pF(e.from,e.to)):[new pF(0,0)]:[new pF(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let r=this.startParse(e,t,n);for(;;){let e=r.advance();if(e)return e}}};class ma{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new pQ({perNode:!0});let ml=0;class mc{constructor(e,t,n,r){this.name=e,this.set=t,this.base=n,this.modified=r,this.id=ml++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){if(e instanceof mc&&(t=e),null!=t&&t.base)throw Error("Can not derive from a modified tag");let n=new mc("string"==typeof e?e:"?",[],null,[]);if(n.set.push(n),t)for(let e of t.set)n.set.push(e);return n}static defineModifier(e){let t=new mu(e);return e=>e.modified.indexOf(t)>-1?e:mu.get(e.base||e,e.modified.concat(t).sort((e,t)=>e.id-t.id))}}let mh=0;class mu{constructor(e){this.name=e,this.instances=[],this.id=mh++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(n=>{var r;return n.base==e&&(r=n.modified,t.length==r.length&&t.every((e,t)=>e==r[t]))});if(n)return n;let r=[],i=new mc(e.name,r,e,t);for(let e of t)e.instances.push(i);let o=function(e){let t=[[]];for(let n=0;n<e.length;n++)for(let r=0,i=t.length;r<i;r++)t.push(t[r].concat(e[n]));return t.sort((e,t)=>t.length-e.length)}(t);for(let t of e.set)if(!t.modified.length)for(let e of o)r.push(mu.get(t,e));return i}}function md(e){let t=Object.create(null);for(let n in e){let r=e[n];for(let e of(Array.isArray(r)||(r=[r]),n.split(" ")))if(e){let n=[],i=2,o=e;for(let t=0;;){if("..."==o&&t>0&&t+3==e.length){i=1;break}let r=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!r)throw RangeError("Invalid path: "+e);if(n.push("*"==r[0]?"":'"'==r[0][0]?JSON.parse(r[0]):r[0]),(t+=r[0].length)==e.length)break;let s=e[t++];if(t==e.length&&"!"==s){i=0;break}if("/"!=s)throw RangeError("Invalid path: "+e);o=e.slice(t)}let s=n.length-1,a=n[s];if(!a)throw RangeError("Invalid path: "+e);let l=new mp(r,i,s>0?n.slice(0,s):null);t[a]=l.sort(t[a])}}return mf.add(t)}let mf=new pQ,mp=class{constructor(e,t,n,r){this.tags=e,this.mode=t,this.context=n,this.next=r}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};function mm(e,t){let n=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)n[e.id]=t.class;else n[t.tag.id]=t.class;let{scope:r,all:i=null}=t||{};return{style:e=>{let t=i;for(let r of e)for(let e of r.set){let r=n[e.id];if(r){t=t?t+" "+r:r;break}}return t},scope:r}}mp.empty=new mp([],2,null);class mg{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,r,i){let{type:o,from:s,to:a}=e;if(s>=n||a<=t)return;o.isTop&&(i=this.highlighters.filter(e=>!e.scope||e.scope(o)));let l=r,c=function(e){let t=e.type.prop(mf);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}(e)||mp.empty,h=function(e,t){let n=null;for(let r of e){let e=r.style(t);e&&(n=n?n+" "+e:e)}return n}(i,c.tags);if(h&&(l&&(l+=" "),l+=h,1==c.mode&&(r+=(r?" ":"")+h)),this.startSpan(Math.max(t,s),l),c.opaque)return;let u=e.tree&&e.tree.prop(pQ.mounted);if(u&&u.overlay){let o=e.node.enter(u.overlay[0].from+s,1),c=this.highlighters.filter(e=>!e.scope||e.scope(u.tree.type)),h=e.firstChild();for(let d=0,f=s;;d++){let p=d<u.overlay.length?u.overlay[d]:null,m=p?p.from+s:a,g=Math.max(t,f),y=Math.min(n,m);if(g<y&&h)for(;e.from<y&&(this.highlightRange(e,g,y,r,i),this.startSpan(Math.min(y,e.to),l),!(e.to>=m||!e.nextSibling())););if(!p||m>n)break;(f=p.to+s)>t&&(this.highlightRange(o.cursor(),Math.max(t,p.from+s),Math.min(n,f),"",c),this.startSpan(Math.min(n,f),l))}h&&e.parent()}else if(e.firstChild()){u&&(r="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,r,i),this.startSpan(Math.min(n,e.to),l)}while(e.nextSibling());e.parent()}}}let my=mc.define,mb=my(),mv=my(),mx=my(mv),mw=my(mv),mk=my(),mO=my(mk),mS=my(mk),mC=my(),mT=my(mC),mA=my(),mE=my(),mM=my(),m_=my(mM),mD=my(),mN={comment:mb,lineComment:my(mb),blockComment:my(mb),docComment:my(mb),name:mv,variableName:my(mv),typeName:mx,tagName:my(mx),propertyName:mw,attributeName:my(mw),className:my(mv),labelName:my(mv),namespace:my(mv),macroName:my(mv),literal:mk,string:mO,docString:my(mO),character:my(mO),attributeValue:my(mO),number:mS,integer:my(mS),float:my(mS),bool:my(mk),regexp:my(mk),escape:my(mk),color:my(mk),url:my(mk),keyword:mA,self:my(mA),null:my(mA),atom:my(mA),unit:my(mA),modifier:my(mA),operatorKeyword:my(mA),controlKeyword:my(mA),definitionKeyword:my(mA),moduleKeyword:my(mA),operator:mE,derefOperator:my(mE),arithmeticOperator:my(mE),logicOperator:my(mE),bitwiseOperator:my(mE),compareOperator:my(mE),updateOperator:my(mE),definitionOperator:my(mE),typeOperator:my(mE),controlOperator:my(mE),punctuation:mM,separator:my(mM),bracket:m_,angleBracket:my(m_),squareBracket:my(m_),paren:my(m_),brace:my(m_),content:mC,heading:mT,heading1:my(mT),heading2:my(mT),heading3:my(mT),heading4:my(mT),heading5:my(mT),heading6:my(mT),contentSeparator:my(mC),list:my(mC),quote:my(mC),emphasis:my(mC),strong:my(mC),link:my(mC),monospace:my(mC),strikethrough:my(mC),inserted:my(),deleted:my(),changed:my(),invalid:my(),meta:mD,documentMeta:my(mD),annotation:my(mD),processingInstruction:my(mD),definition:mc.defineModifier("definition"),constant:mc.defineModifier("constant"),function:mc.defineModifier("function"),standard:mc.defineModifier("standard"),local:mc.defineModifier("local"),special:mc.defineModifier("special")};for(let e in mN){let t=mN[e];t instanceof mc&&(t.name=e)}mm([{tag:mN.link,class:"tok-link"},{tag:mN.heading,class:"tok-heading"},{tag:mN.emphasis,class:"tok-emphasis"},{tag:mN.strong,class:"tok-strong"},{tag:mN.keyword,class:"tok-keyword"},{tag:mN.atom,class:"tok-atom"},{tag:mN.bool,class:"tok-bool"},{tag:mN.url,class:"tok-url"},{tag:mN.labelName,class:"tok-labelName"},{tag:mN.inserted,class:"tok-inserted"},{tag:mN.deleted,class:"tok-deleted"},{tag:mN.literal,class:"tok-literal"},{tag:mN.string,class:"tok-string"},{tag:mN.number,class:"tok-number"},{tag:[mN.regexp,mN.escape,mN.special(mN.string)],class:"tok-string2"},{tag:mN.variableName,class:"tok-variableName"},{tag:mN.local(mN.variableName),class:"tok-variableName tok-local"},{tag:mN.definition(mN.variableName),class:"tok-variableName tok-definition"},{tag:mN.special(mN.variableName),class:"tok-variableName2"},{tag:mN.definition(mN.propertyName),class:"tok-propertyName tok-definition"},{tag:mN.typeName,class:"tok-typeName"},{tag:mN.namespace,class:"tok-namespace"},{tag:mN.className,class:"tok-className"},{tag:mN.macroName,class:"tok-macroName"},{tag:mN.propertyName,class:"tok-propertyName"},{tag:mN.operator,class:"tok-operator"},{tag:mN.comment,class:"tok-comment"},{tag:mN.meta,class:"tok-meta"},{tag:mN.invalid,class:"tok-invalid"},{tag:mN.punctuation,class:"tok-punctuation"}]);let mR=new pQ,mP=new pQ;class mj{constructor(e,t,n=[],r=""){this.data=e,this.name=r,ti.prototype.hasOwnProperty("tree")||Object.defineProperty(ti.prototype,"tree",{get(){return mL(this)}}),this.parser=t,this.extension=[mH.of(this),ti.languageData.of((e,t,n)=>{let r=mI(e,t,n),i=r.type.prop(mR);if(!i)return[];let o=e.facet(i),s=r.type.prop(mP);if(s){let i=r.resolve(t-r.from,n);for(let t of s)if(t.test(i,e)){let n=e.facet(t.facet);return"replace"==t.type?n:n.concat(o)}}return o})].concat(n)}isActiveAt(e,t,n=-1){return mI(e,t,n).type.prop(mR)==this.data}findRegions(e){let t=e.facet(mH);if((null==t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],r=(e,t)=>{if(e.prop(mR)==this.data){n.push({from:t,to:t+e.length});return}let i=e.prop(pQ.mounted);if(i){if(i.tree.prop(mR)==this.data){if(i.overlay)for(let e of i.overlay)n.push({from:e.from+t,to:e.to+t});else n.push({from:t,to:t+e.length});return}if(i.overlay){let e=n.length;if(r(i.tree,i.overlay[0].from+t),n.length>e)return}}for(let n=0;n<e.children.length;n++){let i=e.children[n];i instanceof pZ&&r(i,e.positions[n]+t)}};return r(mL(e),0),n}get allowsNesting(){return!0}}function mI(e,t,n){let r=e.facet(mH),i=mL(e).topNode;if(!r||r.allowsNesting)for(let e=i;e;e=e.enter(t,n,d.ExcludeBuffers))e.type.isTop&&(i=e);return i}mj.setState=e6.define();class m$ extends mj{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){var t;let n=(t=e.languageData,eP.define({combine:t?e=>e.concat(t):void 0}));return new m$(n,e.parser.configure({props:[mR.add(e=>e.isTop?n:void 0)]}),e.name)}configure(e,t){return new m$(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function mL(e){let t=e.field(mj.state,!1);return t?t.tree:pZ.empty}class mq{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let mz=null,mB=class e{constructor(e,t,n=[],r,i,o,s,a){this.parser=e,this.state=t,this.fragments=n,this.tree=r,this.treeLen=i,this.viewport=o,this.skipped=s,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,n,r){return new e(t,n,[],pZ.empty,0,r,[],null)}startParse(){return this.parser.startParse(new mq(this.state.doc),this.fragments)}work(e,t){return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=pZ.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r){if(this.fragments=this.withoutTempSkipped(mo.addTree(r,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(n=this.parse.stoppedAt)&&void 0!==n?n:this.state.doc.length,this.tree=r,this.parse=null,!(this.treeLen<(t??this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(mo.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=mz;mz=this;try{return e()}finally{mz=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=mF(e,t.from,t.to);return e}changes(t,n){let{fragments:r,tree:i,treeLen:o,viewport:s,skipped:a}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges((t,n,r,i)=>e.push({fromA:t,toA:n,fromB:r,toB:i})),r=mo.applyChanges(r,e),i=pZ.empty,o=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length)for(let e of(a=[],this.skipped)){let n=t.mapPos(e.from,1),r=t.mapPos(e.to,-1);n<r&&a.push({from:n,to:r})}}return new e(this.parser,n,r,i,o,s,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let t=0;t<this.skipped.length;t++){let{from:n,to:r}=this.skipped[t];n<e.to&&r>e.from&&(this.fragments=mF(this.fragments,n,r),this.skipped.splice(t--,1))}return!(this.skipped.length>=t)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends ms{createParse(t,n,r){let i=r[0].from,o=r[r.length-1].to;return{parsedPos:i,advance(){let t=mz;if(t){for(let e of r)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=o,new pZ(pU.none,[],[],o-i)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return mz}};function mF(e,t,n){return mo.applyChanges(e,[{fromA:t,toA:n,fromB:t,toB:n}])}class mQ{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new mQ(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=mB.create(e.facet(mH).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new mQ(n)}}mj.state=ez.define({create:mQ.init,update(e,t){for(let e of t.effects)if(e.is(mj.setState))return e.value;return t.startState.facet(mH)!=t.state.facet(mH)?mQ.init(t.state):e.apply(t)}});let mV=e=>{let t=setTimeout(()=>e(),500);return()=>clearTimeout(t)};"u">typeof requestIdleCallback&&(mV=e=>{let t=-1,n=setTimeout(()=>{t=requestIdleCallback(e,{timeout:400})},100);return()=>t<0?clearTimeout(n):cancelIdleCallback(t)});let mW="u">typeof navigator&&!(null===(f=navigator.scheduling)||void 0===f)&&f.isInputPending?()=>navigator.scheduling.isInputPending():null,mU=uU.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(mj.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(mj.state);t.tree==t.context.tree&&t.context.isDone(e.doc.length)||(this.working=mV(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:r}}=this.view,i=n.field(mj.state);if(i.tree==i.context.tree&&i.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!mW?Math.max(25,e.timeRemaining()-5):1e9),s=i.context.treeLen<r&&n.doc.length>r+1e3,a=i.context.work(()=>mW&&mW()||Date.now()>o,r+(s?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(i.context.takeTree(),this.view.dispatch({effects:mj.setState.of(new mQ(i.context))})),this.chunkBudget>0&&!(a&&!s)&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(e=>uF(this.view.state,e)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),mH=eP.define({combine:e=>e.length?e[0]:null,enables:e=>[mj.state,mU,fm.contentAttributes.compute([e],t=>{let n=t.facet(e);return n&&n.name?{"data-language":n.name}:{}})]});class mG{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}let mX=eP.define(),mZ=eP.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function mY(e){let t=e.facet(mZ);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function mJ(e,t){let n="",r=e.tabSize,i=e.facet(mZ)[0];if("	"==i){for(;t>=r;)n+="	",t-=r;i=" "}for(let e=0;e<t;e++)n+=i;return n}function mK(e,t){for(let n of(e instanceof ti&&(e=new m0(e)),e.state.facet(mX))){let r=n(e,t);if(void 0!==r)return r}let n=mL(e.state);return n.length>=t?function(e,t,n){let r=t.resolveStack(n),i=t.resolveInner(n,-1).resolve(n,0).enterUnfinishedNodesBefore(n);if(i!=r.node){let e=[];for(let t=i;t&&!(t.from==r.node.from&&t.type==r.node.type);t=t.parent)e.push(t);for(let t=e.length-1;t>=0;t--)r={node:e[t],next:r}}return m2(r,e,n)}(e,n,t):null}class m0{constructor(e,t={}){this.state=e,this.options=t,this.unit=mY(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:i}=this.options;return null!=r&&r>=n.from&&r<=n.to?i&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(e,t);return n.slice(e-r,Math.min(n.length,e+100-r))}column(e,t=1){let{text:n,from:r}=this.lineAt(e,t),i=this.countColumn(n,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(i+=o-this.countColumn(n,n.search(/\S|$/))),i}countColumn(e,t=e.length){return tk(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:r}=this.lineAt(e,t),i=this.options.overrideIndentation;if(i){let e=i(r);if(e>-1)return e}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}let m1=new pQ;function m2(e,t,n){for(let r=e;r;r=r.next){let e=function(e){let t=e.type.prop(m1);if(t)return t;let n=e.firstChild,r;if(n&&(r=n.type.prop(pQ.closedBy))){let t=e.lastChild,n=t&&r.indexOf(t.name)>-1;return e=>m6(e,!0,1,void 0,n&&!(e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak)?t.from:void 0)}return null==e.parent?m5:null}(r.node);if(e)return e(m3.create(t,n,r))}return 0}function m5(){return 0}class m3 extends m0{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new m3(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(function(e,t){for(let n=t;n;n=n.parent)if(e==n)return!0;return!1}(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return m2(this.context.next,this.base,this.pos)}}function m4({closing:e,align:t=!0,units:n=1}){return r=>m6(r,t,n,e)}function m6(e,t,n,r,i){let o=e.textAfter,s=o.match(/^\s*/)[0].length,a=r&&o.slice(s,s+r.length)==r||i==e.pos+s,l=t?function(e){let t=e.node,n=t.childAfter(t.from),r=t.lastChild;if(!n)return null;let i=e.options.simulateBreak,o=e.state.doc.lineAt(n.from),s=null==i||i<=o.from?o.to:Math.min(o.to,i);for(let e=n.to;;){let i=t.childAfter(e);if(!i||i==r)return null;if(!i.type.isSkipped){if(i.from>=s)return null;let e=/^ */.exec(o.text.slice(n.to-o.from))[0].length;return{from:n.from,to:n.to+e}}e=i.to}}(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:e.unit*n)}let m8=eP.define(),m9=new pQ;function m7(e,t,n){for(let r of e.facet(m8)){let i=r(e,t,n);if(i)return i}return function(e,t,n){let r=mL(e);if(r.length<n)return null;let i=r.resolveStack(n,1),o=null;for(let s=i;s;s=s.next){let i=s.node;if(i.to<=n||i.from>n)continue;if(o&&i.from<t)break;let a=i.type.prop(m9);if(a&&(i.to<r.length-50||r.length==e.doc.length||!function(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}(i))){let r=a(i,e);r&&r.from<=n&&r.from>=t&&r.to>n&&(o=r)}}return o}(e,t,n)}function ge(e,t){let n=t.mapPos(e.from,1),r=t.mapPos(e.to,-1);return n>=r?void 0:{from:n,to:r}}let gt=e6.define({map:ge}),gn=e6.define({map:ge});function gr(e){let t=[];for(let{head:n}of e.state.selection.ranges)t.some(e=>e.from<=n&&e.to>=n)||t.push(e.lineBlockAt(n));return t}let gi=ez.define({create:()=>ut.none,update(e,t){for(let n of(e=e.map(t.changes),t.effects))if(n.is(gt)&&!function(e,t,n){let r=!1;return e.between(t,t,(e,i)=>{e==t&&i==n&&(r=!0)}),r}(e,n.value.from,n.value.to)){let{preparePlaceholder:r}=t.state.facet(gh),i=r?ut.replace({widget:new gf(r(t.state,n.value))}):gd;e=e.update({add:[i.range(n.value.from,n.value.to)]})}else n.is(gn)&&(e=e.update({filter:(e,t)=>n.value.from!=e||n.value.to!=t,filterFrom:n.value.from,filterTo:n.value.to}));if(t.selection){let n=!1,{head:r}=t.selection.main;e.between(r,r,(e,t)=>{e<r&&t>r&&(n=!0)}),n&&(e=e.update({filterFrom:r,filterTo:r,filter:(e,t)=>t<=r||e>=r}))}return e},provide:e=>fm.decorations.from(e),toJSON(e,t){let n=[];return e.between(0,t.doc.length,(e,t)=>{n.push(e,t)}),n},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw RangeError("Invalid JSON for fold state");let t=[];for(let n=0;n<e.length;){let r=e[n++],i=e[n++];if("number"!=typeof r||"number"!=typeof i)throw RangeError("Invalid JSON for fold state");t.push(gd.range(r,i))}return ut.set(t,!0)}});function go(e,t,n){var r;let i=null;return null===(r=e.field(gi,!1))||void 0===r||r.between(t,n,(e,t)=>{(!i||i.from>e)&&(i={from:e,to:t})}),i}function gs(e,t){return e.field(gi,!1)?t:t.concat(e6.appendConfig.of([gi,gg]))}function ga(e,t,n=!0){let r=e.state.doc.lineAt(t.from).number,i=e.state.doc.lineAt(t.to).number;return fm.announce.of(`${e.state.phrase(n?"Folded lines":"Unfolded lines")} ${r} ${e.state.phrase("to")} ${i}.`)}let gl=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e=>{for(let t of gr(e)){let n=m7(e.state,t.from,t.to);if(n)return e.dispatch({effects:gs(e.state,[gt.of(n),ga(e,n)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e=>{if(!e.state.field(gi,!1))return!1;let t=[];for(let n of gr(e)){let r=go(e.state,n.from,n.to);r&&t.push(gn.of(r),ga(e,r,!1))}return t.length&&e.dispatch({effects:t}),t.length>0}},{key:"Ctrl-Alt-[",run:e=>{let{state:t}=e,n=[];for(let r=0;r<t.doc.length;){let i=e.lineBlockAt(r),o=m7(t,i.from,i.to);o&&n.push(gt.of(o)),r=(o?e.lineBlockAt(o.to):i).to+1}return n.length&&e.dispatch({effects:gs(e.state,n)}),!!n.length}},{key:"Ctrl-Alt-]",run:e=>{let t=e.state.field(gi,!1);if(!t||!t.size)return!1;let n=[];return t.between(0,e.state.doc.length,(e,t)=>{n.push(gn.of({from:e,to:t}))}),e.dispatch({effects:n}),!0}}],gc={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},gh=eP.define({combine:e=>to(e,gc)});function gu(e,t){let{state:n}=e,r=n.facet(gh),i=t=>{let n=e.lineBlockAt(e.posAtDOM(t.target)),r=go(e.state,n.from,n.to);r&&e.dispatch({effects:gn.of(r)}),t.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(e,i,t);let o=document.createElement("span");return o.textContent=r.placeholderText,o.setAttribute("aria-label",n.phrase("folded code")),o.title=n.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=i,o}let gd=ut.replace({widget:new class extends h7{toDOM(e){return gu(e,null)}}});class gf extends h7{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return gu(e,this.value)}}let gp={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class gm extends px{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}let gg=fm.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class gy{constructor(e,t){let n;function r(e){let t=hi.newName();return(n||(n=Object.create(null)))["."+t]=e,t}this.specs=e;let i="string"==typeof t.all?t.all:t.all?r(t.all):void 0,o=t.scope;this.scope=o instanceof mj?e=>e.prop(mR)==o.data:o?e=>e==o:void 0,this.style=mm(e.map(e=>({tag:e.tag,class:e.class||r(Object.assign({},e,{tag:null}))})),{all:i}).style,this.module=n?new hi(n):null,this.themeType=t.themeType}static define(e,t){return new gy(e,t||{})}}let gb=eP.define(),gv=eP.define({combine:e=>e.length?[e[0]]:null});function gx(e){let t=e.facet(gb);return t.length?t:e.facet(gv)}function gw(e,t){let n=[gO],r;return e instanceof gy&&(e.module&&n.push(fm.styleModule.of(e.module)),r=e.themeType),null!=t&&t.fallback?n.push(gv.of(e)):r?n.push(gb.computeN([fm.darkTheme],t=>t.facet(fm.darkTheme)==("dark"==r)?[e]:[])):n.push(gb.of(e)),n}class gk{constructor(e){this.markCache=Object.create(null),this.tree=mL(e.state),this.decorations=this.buildDeco(e,gx(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=mL(e.state),n=gx(e.state),r=n!=gx(e.startState),{viewport:i}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<i.to&&!r&&t.type==this.tree.type&&o>=i.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=i.to)}buildDeco(e,t){if(!t||!this.tree.length)return ut.none;let n=new tu;for(let{from:r,to:i}of e.visibleRanges)!function(e,t,n,r=0,i=e.length){let o=new mg(r,Array.isArray(t)?t:[t],n);o.highlightRange(e.cursor(),r,i,"",o.highlighters),o.flush(i)}(this.tree,t,(e,t,r)=>{n.add(e,t,this.markCache[r]||(this.markCache[r]=ut.mark({class:r})))},r,i);return n.finish()}}let gO=eQ.high(uU.fromClass(gk,{decorations:e=>e.decorations})),gS=gy.define([{tag:mN.meta,color:"#404740"},{tag:mN.link,textDecoration:"underline"},{tag:mN.heading,textDecoration:"underline",fontWeight:"bold"},{tag:mN.emphasis,fontStyle:"italic"},{tag:mN.strong,fontWeight:"bold"},{tag:mN.strikethrough,textDecoration:"line-through"},{tag:mN.keyword,color:"#708"},{tag:[mN.atom,mN.bool,mN.url,mN.contentSeparator,mN.labelName],color:"#219"},{tag:[mN.literal,mN.inserted],color:"#164"},{tag:[mN.string,mN.deleted],color:"#a11"},{tag:[mN.regexp,mN.escape,mN.special(mN.string)],color:"#e40"},{tag:mN.definition(mN.variableName),color:"#00f"},{tag:mN.local(mN.variableName),color:"#30a"},{tag:[mN.typeName,mN.namespace],color:"#085"},{tag:mN.className,color:"#167"},{tag:[mN.special(mN.variableName),mN.macroName],color:"#256"},{tag:mN.definition(mN.propertyName),color:"#00c"},{tag:mN.comment,color:"#940"},{tag:mN.invalid,color:"#f00"}]),gC=fm.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),gT="()[]{}",gA=eP.define({combine:e=>to(e,{afterCursor:!0,brackets:gT,maxScanDistance:1e4,renderMatch:g_})}),gE=ut.mark({class:"cm-matchingBracket"}),gM=ut.mark({class:"cm-nonmatchingBracket"});function g_(e){let t=[],n=e.matched?gE:gM;return t.push(n.range(e.start.from,e.start.to)),e.end&&t.push(n.range(e.end.from,e.end.to)),t}let gD=[ez.define({create:()=>ut.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let n=[],r=t.state.facet(gA);for(let e of t.state.selection.ranges){if(!e.empty)continue;let i=gj(t.state,e.head,-1,r)||e.head>0&&gj(t.state,e.head-1,1,r)||r.afterCursor&&(gj(t.state,e.head,1,r)||e.head<t.state.doc.length&&gj(t.state,e.head+1,-1,r));i&&(n=n.concat(r.renderMatch(i,t.state)))}return ut.set(n,!0)},provide:e=>fm.decorations.from(e)}),gC],gN=new pQ;function gR(e,t,n){let r=e.prop(t<0?pQ.openedBy:pQ.closedBy);if(r)return r;if(1==e.name.length){let r=n.indexOf(e.name);if(r>-1&&r%2==(t<0?1:0))return[n[r+t]]}return null}function gP(e){let t=e.type.prop(gN);return t?t(e.node):e}function gj(e,t,n,r={}){let i=r.maxScanDistance||1e4,o=r.brackets||gT,s=mL(e),a=s.resolveInner(t,n);for(let e=a;e;e=e.parent){let r=gR(e.type,n,o);if(r&&e.from<e.to){let i=gP(e);if(i&&(n>0?t>=i.from&&t<i.to:t>i.from&&t<=i.to))return function(e,t,n,r,i,o,s){let a=r.parent,l={from:i.from,to:i.to},c=0,h=null==a?void 0:a.cursor();if(h&&(n<0?h.childBefore(r.from):h.childAfter(r.to)))do if(n<0?h.to<=r.from:h.from>=r.to){if(0==c&&o.indexOf(h.type.name)>-1&&h.from<h.to){let e=gP(h);return{start:l,end:e?{from:e.from,to:e.to}:void 0,matched:!0}}if(gR(h.type,n,s))c++;else if(gR(h.type,-n,s)){if(0==c){let e=gP(h);return{start:l,end:e&&e.from<e.to?{from:e.from,to:e.to}:void 0,matched:!1}}c--}}while(n<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}(0,0,n,e,i,r,o)}}return function(e,t,n,r,i,o,s){let a=n<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=s.indexOf(a);if(l<0||l%2==0!=n>0)return null;let c={from:n<0?t-1:t,to:n>0?t+1:t},h=e.doc.iterRange(t,n>0?e.doc.length:0),u=0;for(let e=0;!h.next().done&&e<=o;){let o=h.value;n<0&&(e+=o.length);let a=t+e*n;for(let e=n>0?0:o.length-1,t=n>0?o.length:-1;e!=t;e+=n){let t=s.indexOf(o[e]);if(!(t<0||r.resolveInner(a+e,1).type!=i)){if(t%2==0==n>0)u++;else{if(1==u)return{start:c,end:{from:a+e,to:a+e+1},matched:t>>1==l>>1};u--}}}n>0&&(e+=o.length)}return h.done?{start:c,matched:!1}:null}(e,t,n,s,a.type,i,o)}let gI=Object.create(null),g$=[pU.none],gL=[],gq=Object.create(null),gz=Object.create(null);for(let[e,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])gz[e]=function(e,t){let n=[];for(let r of t.split(" ")){let t=[];for(let n of r.split(".")){let r=e[n]||mN[n];r?"function"==typeof r?t.length?t=t.map(r):gB(n,`Modifier ${n} used at start of tag`):t.length?gB(n,`Tag ${n} used as modifier`):t=Array.isArray(r)?r:[r]:gB(n,`Unknown highlighting tag ${n}`)}for(let e of t)n.push(e)}if(!n.length)return 0;let r=t.replace(/ /g,"_"),i=r+" "+n.map(e=>e.id),o=gq[i];if(o)return o.id;let s=gq[i]=pU.define({id:g$.length,name:r,props:[md({[r]:n})]});return g$.push(s),s.id}(gI,t);function gB(e,t){gL.indexOf(e)>-1||(gL.push(e),console.warn(t))}function gF(e,t){return({state:n,dispatch:r})=>{if(n.readOnly)return!1;let i=e(t,n);return!!i&&(r(n.update(i)),!0)}}uf.RTL,uf.LTR;let gQ=gF(function(e,t,n=t.selection.ranges){let r=[],i=-1;for(let{from:e,to:o}of n){let n=r.length,s=1e9,a=gU(t,e).line;if(a){for(let n=e;n<=o;){let l=t.doc.lineAt(n);if(l.from>i&&(e==o||o>l.from)){i=l.from;let e=/^\s*/.exec(l.text)[0].length,t=e==l.length,n=l.text.slice(e,e+a.length)==a?e:-1;e<l.text.length&&e<s&&(s=e),r.push({line:l,comment:n,token:a,indent:e,empty:t,single:!1})}n=l.to+1}if(s<1e9)for(let e=n;e<r.length;e++)r[e].indent<r[e].line.text.length&&(r[e].indent=s);r.length==n+1&&(r[n].single=!0)}}if(2!=e&&r.some(e=>e.comment<0&&(!e.empty||e.single))){let e=[];for(let{line:t,token:n,indent:i,empty:o,single:s}of r)(s||!o)&&e.push({from:t.from+i,insert:n+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}if(1!=e&&r.some(e=>e.comment>=0)){let e=[];for(let{line:t,comment:n,token:i}of r)if(n>=0){let r=t.from+n,o=r+i.length;" "==t.text[o-t.from]&&o++,e.push({from:r,to:o})}return{changes:e}}return null},0),gV=gF(gH,0),gW=gF((e,t)=>gH(e,t,function(e){let t=[];for(let n of e.selection.ranges){let r=e.doc.lineAt(n.from),i=n.to<=r.to?r:e.doc.lineAt(n.to);i.from>r.from&&i.from==n.to&&(i=n.to==r.to+1?r:e.doc.lineAt(n.to-1));let o=t.length-1;o>=0&&t[o].to>r.from?t[o].to=i.to:t.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:i.to})}return t}(t)),0);function gU(e,t){let n=e.languageDataAt("commentTokens",t);return n.length?n[0]:{}}function gH(e,t,n=t.selection.ranges){let r=n.map(e=>gU(t,e.from).block);if(!r.every(e=>e))return null;let i=n.map((e,n)=>(function(e,{open:t,close:n},r,i){let o,s,a=e.sliceDoc(r-50,r),l=e.sliceDoc(i,i+50),c=/\s*$/.exec(a)[0].length,h=/^\s*/.exec(l)[0].length,u=a.length-c;if(a.slice(u-t.length,u)==t&&l.slice(h,h+n.length)==n)return{open:{pos:r-c,margin:c&&1},close:{pos:i+h,margin:h&&1}};i-r<=100?o=s=e.sliceDoc(r,i):(o=e.sliceDoc(r,r+50),s=e.sliceDoc(i-50,i));let d=/^\s*/.exec(o)[0].length,f=/\s*$/.exec(s)[0].length,p=s.length-f-n.length;return o.slice(d,d+t.length)==t&&s.slice(p,p+n.length)==n?{open:{pos:r+d+t.length,margin:/\s/.test(o.charAt(d+t.length))?1:0},close:{pos:i-f-n.length,margin:/\s/.test(s.charAt(p-1))?1:0}}:null})(t,r[n],e.from,e.to));if(2!=e&&!i.every(e=>e))return{changes:t.changes(n.map((e,t)=>i[t]?[]:[{from:e.from,insert:r[t].open+" "},{from:e.to,insert:" "+r[t].close}]))};if(1!=e&&i.some(e=>e)){let e=[];for(let t=0,n;t<i.length;t++)if(n=i[t]){let i=r[t],{open:o,close:s}=n;e.push({from:o.pos-i.open.length,to:o.pos+o.margin},{from:s.pos-s.margin,to:s.pos+i.close.length})}return{changes:e}}return null}let gG=e5.define(),gX=e5.define(),gZ=eP.define(),gY=eP.define({combine:e=>to(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,r)=>e(n,r)||t(n,r)})}),gJ=ez.define({create:()=>yt.empty,update(e,t){let n=t.state.facet(gY),r=t.annotation(gG);if(r){let i=g3.fromTransaction(t,r.selection),o=r.side,s=0==o?e.undone:e.done;return s=i?g4(s,s.length,n.minDepth,i):g9(s,t.startState.selection),new yt(0==o?r.rest:s,0==o?s:r.rest)}let i=t.annotation(gX);if(("full"==i||"before"==i)&&(e=e.isolate()),!1===t.annotation(e8.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let o=g3.fromTransaction(t),s=t.annotation(e8.time),a=t.annotation(e8.userEvent);return o?e=e.addChanges(o,s,a,n,t):t.selection&&(e=e.addSelection(t.startState.selection,s,a,n.newGroupDelay)),("full"==i||"after"==i)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}),fromJSON:e=>new yt(e.done.map(g3.fromJSON),e.undone.map(g3.fromJSON))});function gK(e,t){return function({state:n,dispatch:r}){if(!t&&n.readOnly)return!1;let i=n.field(gJ,!1);if(!i)return!1;let o=i.pop(e,n,t);return!!o&&(r(o),!0)}}let g0=gK(0,!1),g1=gK(1,!1),g2=gK(0,!0),g5=gK(1,!0);class g3{constructor(e,t,n,r,i){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=r,this.selectionsAfter=i}setSelAfter(e){return new g3(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(n=this.startSelection)||void 0===n?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new g3(e.changes&&eO.fromJSON(e.changes),[],e.mapped&&ek.fromJSON(e.mapped),e.startSelection&&eD.fromJSON(e.startSelection),e.selectionsAfter.map(eD.fromJSON))}static fromTransaction(e,t){let n=g8;for(let t of e.startState.facet(gZ)){let r=t(e);r.length&&(n=n.concat(r))}return!n.length&&e.changes.empty?null:new g3(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,g8)}static selection(e){return new g3(void 0,g8,void 0,void 0,e)}}function g4(e,t,n,r){let i=e.slice(t+1>n+20?t-n-1:0,t);return i.push(r),i}function g6(e,t){return e.length?t.length?e.concat(t):e:t}let g8=[];function g9(e,t){if(!e.length)return[g3.selection([t])];{let n=e[e.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-200));return r.length&&r[r.length-1].eq(t)?e:(r.push(t),g4(e,e.length-1,1e9,n.setSelAfter(r)))}}function g7(e,t){if(!e.length)return e;let n=e.length,r=g8;for(;n;){let i=function(e,t,n){let r=g6(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(t)):g8,n);if(!e.changes)return g3.selection(r);let i=e.changes.map(t),o=t.mapDesc(e.changes,!0),s=e.mapped?e.mapped.composeDesc(o):o;return new g3(i,e6.mapEffects(e.effects,t),s,e.startSelection.map(o),r)}(e[n-1],t,r);if(i.changes&&!i.changes.empty||i.effects.length){let t=e.slice(0,n);return t[n-1]=i,t}t=i.mapped,n--,r=i.selectionsAfter}return r.length?[g3.selection(r)]:g8}let ye=/^(input\.type|delete)($|\.)/,yt=class e{constructor(e,t,n=0,r){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new e(this.done,this.undone):this}addChanges(t,n,r,i,o){var s,a;let l,c,h=this.done,u=h[h.length-1];return new e(h=u&&u.changes&&!u.changes.empty&&t.changes&&(!r||ye.test(r))&&(!u.selectionsAfter.length&&n-this.prevTime<i.newGroupDelay&&i.joinToEvent(o,(s=u.changes,a=t.changes,l=[],c=!1,s.iterChangedRanges((e,t)=>l.push(e,t)),a.iterChangedRanges((e,t,n,r)=>{for(let e=0;e<l.length;){let t=l[e++],i=l[e++];r>=t&&n<=i&&(c=!0)}}),c))||"input.type.compose"==r)?g4(h,h.length-1,i.minDepth,new g3(t.changes.compose(u.changes),g6(e6.mapEffects(t.effects,u.changes),u.effects),u.mapped,u.startSelection,g8)):g4(h,h.length,i.minDepth,t),g8,n,r)}addSelection(t,n,r,i){var o;let s=this.done.length?this.done[this.done.length-1].selectionsAfter:g8;return s.length>0&&n-this.prevTime<i&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&(o=s[s.length-1]).ranges.length==t.ranges.length&&0===o.ranges.filter((e,n)=>e.empty!=t.ranges[n].empty).length?this:new e(g9(this.done,t),this.undone,n,r)}addMapping(t){return new e(g7(this.done,t),g7(this.undone,t),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=0==e?this.done:this.undone;if(0==r.length)return null;let i=r[r.length-1],o=i.selectionsAfter[0]||t.selection;if(n&&i.selectionsAfter.length){let n,s;return t.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:gG.of({side:e,rest:(n=r[r.length-1],(s=r.slice())[r.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),s),selection:o}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0})}if(!i.changes)return null;{let n=1==r.length?g8:r.slice(0,r.length-1);return i.mapped&&(n=g7(n,i.mapped)),t.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:gG.of({side:e,rest:n,selection:o}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}}};yt.empty=new yt(g8,g8);let yn=[{key:"Mod-z",run:g0,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:g1,preventDefault:!0},{linux:"Ctrl-Shift-z",run:g1,preventDefault:!0},{key:"Mod-u",run:g2,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:g5,preventDefault:!0}];function yr(e,t){return eD.create(e.ranges.map(t),e.mainIndex)}function yi(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function yo({state:e,dispatch:t},n){let r=yr(e.selection,n);return!r.eq(e.selection,!0)&&(t(yi(e,r)),!0)}function ys(e,t){return eD.cursor(t?e.to:e.from)}function ya(e,t){return yo(e,n=>n.empty?e.moveByChar(n,t):ys(n,t))}function yl(e){return e.textDirectionAt(e.state.selection.main.head)==uf.LTR}let yc=e=>ya(e,!yl(e)),yh=e=>ya(e,yl(e));function yu(e,t){return yo(e,n=>n.empty?e.moveByGroup(n,t):ys(n,t))}function yd(e,t,n){let r,i,o=mL(e).resolveInner(t.head),s=n?pQ.closedBy:pQ.openedBy;for(let r=t.head;;){let t=n?o.childAfter(r):o.childBefore(r);if(!t)break;!function(e,t,n){if(t.type.prop(n))return!0;let r=t.to-t.from;return r&&(r>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}(e,t,s)?r=n?t.to:t.from:o=t}return i=o.type.prop(s)&&(r=n?gj(e,o.from,1):gj(e,o.to,-1))&&r.matched?n?r.end.to:r.end.from:n?o.to:o.from,eD.cursor(i,n?-1:1)}function yf(e,t){return yo(e,n=>{if(!n.empty)return ys(n,t);let r=e.moveVertically(n,t);return r.head!=n.head?r:e.moveToLineBoundary(n,t)})}let yp=e=>yf(e,!1),ym=e=>yf(e,!0);function yg(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,n=0,r=0,i;if(t){for(let t of e.state.facet(fm.scrollMargins)){let i=t(e);null!=i&&i.top&&(n=Math.max(null==i?void 0:i.top,n)),null!=i&&i.bottom&&(r=Math.max(null==i?void 0:i.bottom,r))}i=e.scrollDOM.clientHeight-n-r}else i=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:r,selfScroll:t,height:Math.max(e.defaultLineHeight,i-5)}}function yy(e,t){let n,r=yg(e),{state:i}=e,o=yr(i.selection,n=>n.empty?e.moveVertically(n,t,r.height):ys(n,t));if(o.eq(i.selection))return!1;if(r.selfScroll){let t=e.coordsAtPos(i.selection.main.head),s=e.scrollDOM.getBoundingClientRect(),a=s.top+r.marginTop,l=s.bottom-r.marginBottom;t&&t.top>a&&t.bottom<l&&(n=fm.scrollIntoView(o.main.head,{y:"start",yMargin:t.top-a}))}return e.dispatch(yi(i,o),{effects:n}),!0}let yb=e=>yy(e,!1),yv=e=>yy(e,!0);function yx(e,t,n){let r=e.lineBlockAt(t.head),i=e.moveToLineBoundary(t,n);if(i.head==t.head&&i.head!=(n?r.to:r.from)&&(i=e.moveToLineBoundary(t,n,!1)),!n&&i.head==r.from&&r.length){let n=/^\s*/.exec(e.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;n&&t.head!=r.from+n&&(i=eD.cursor(r.from+n))}return i}function yw(e,t){let n=yr(e.state.selection,e=>{let n=t(e);return eD.range(e.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return!n.eq(e.state.selection)&&(e.dispatch(yi(e.state,n)),!0)}function yk(e,t){return yw(e,n=>e.moveByChar(n,t))}let yO=e=>yk(e,!yl(e)),yS=e=>yk(e,yl(e));function yC(e,t){return yw(e,n=>e.moveByGroup(n,t))}function yT(e,t){return yw(e,n=>e.moveVertically(n,t))}let yA=e=>yT(e,!1),yE=e=>yT(e,!0);function yM(e,t){return yw(e,n=>e.moveVertically(n,t,yg(e).height))}let y_=e=>yM(e,!1),yD=e=>yM(e,!0),yN=({state:e,dispatch:t})=>(t(yi(e,{anchor:0})),!0),yR=({state:e,dispatch:t})=>(t(yi(e,{anchor:e.doc.length})),!0),yP=({state:e,dispatch:t})=>(t(yi(e,{anchor:e.selection.main.anchor,head:0})),!0),yj=({state:e,dispatch:t})=>(t(yi(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0);function yI(e,t){if(e.state.readOnly)return!1;let n="delete.selection",{state:r}=e,i=r.changeByRange(r=>{let{from:i,to:o}=r;if(i==o){let s=t(r);s<i?(n="delete.backward",s=y$(e,s,!1)):s>i&&(n="delete.forward",s=y$(e,s,!0)),i=Math.min(i,s),o=Math.max(o,s)}else i=y$(e,i,!1),o=y$(e,o,!0);return i==o?{range:r}:{changes:{from:i,to:o},range:eD.cursor(i,i<r.head?-1:1)}});return!i.changes.empty&&(e.dispatch(r.update(i,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?fm.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function y$(e,t,n){if(e instanceof fm)for(let r of e.state.facet(fm.atomicRanges).map(t=>t(e)))r.between(t,t,(e,r)=>{e<t&&r>t&&(t=n?r:e)});return t}let yL=(e,t,n)=>yI(e,r=>{let i=r.from,{state:o}=e,s=o.doc.lineAt(i),a,l;if(n&&!t&&i>s.from&&i<s.from+200&&!/[^ \t]/.test(a=s.text.slice(0,i-s.from))){if("	"==a[a.length-1])return i-1;let e=tk(a,o.tabSize)%mY(o)||mY(o);for(let t=0;t<e&&" "==a[a.length-1-t];t++)i--;l=i}else(l=eg(s.text,i-s.from,t,t)+s.from)==i&&s.number!=(t?o.doc.lines:1)?l+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(s.text.slice(l-s.from,i-s.from))&&(l=eg(s.text,l-s.from,!1,!1)+s.from);return l}),yq=e=>yL(e,!1,!0),yz=e=>yL(e,!0,!1),yB=(e,t)=>yI(e,n=>{let r=n.head,{state:i}=e,o=i.doc.lineAt(r),s=i.charCategorizer(r);for(let e=null;;){if(r==(t?o.to:o.from)){r==n.head&&o.number!=(t?i.doc.lines:1)&&(r+=t?1:-1);break}let a=eg(o.text,r-o.from,t)+o.from,l=o.text.slice(Math.min(r,a)-o.from,Math.max(r,a)-o.from),c=s(l);if(null!=e&&c!=e)break;(" "!=l||r!=n.head)&&(e=c),r=a}return r}),yF=e=>yB(e,!1);function yQ(e){let t=[],n=-1;for(let r of e.selection.ranges){let i=e.doc.lineAt(r.from),o=e.doc.lineAt(r.to);if(r.empty||r.to!=o.from||(o=e.doc.lineAt(r.to-1)),n>=i.number){let e=t[t.length-1];e.to=o.to,e.ranges.push(r)}else t.push({from:i.from,to:o.to,ranges:[r]});n=o.number+1}return t}function yV(e,t,n){if(e.readOnly)return!1;let r=[],i=[];for(let t of yQ(e)){if(n?t.to==e.doc.length:0==t.from)continue;let o=e.doc.lineAt(n?t.to+1:t.from-1),s=o.length+1;if(n)for(let n of(r.push({from:t.to,to:o.to},{from:t.from,insert:o.text+e.lineBreak}),t.ranges))i.push(eD.range(Math.min(e.doc.length,n.anchor+s),Math.min(e.doc.length,n.head+s)));else for(let n of(r.push({from:o.from,to:t.from},{from:t.to,insert:e.lineBreak+o.text}),t.ranges))i.push(eD.range(n.anchor-s,n.head-s))}return!!r.length&&(t(e.update({changes:r,scrollIntoView:!0,selection:eD.create(i,e.selection.mainIndex),userEvent:"move.line"})),!0)}function yW(e,t,n){if(e.readOnly)return!1;let r=[];for(let t of yQ(e))n?r.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):r.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}let yU=yG(!1),yH=yG(!0);function yG(e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{let{from:r,to:i}=n,o=t.doc.lineAt(r),s=!e&&r==i&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n=mL(e).resolveInner(t),r=n.childBefore(t),i=n.childAfter(t),o;return r&&i&&r.to<=t&&i.from>=t&&(o=r.type.prop(pQ.closedBy))&&o.indexOf(i.name)>-1&&e.doc.lineAt(r.to).from==e.doc.lineAt(i.from).from&&!/\S/.test(e.sliceDoc(r.to,i.from))?{from:r.to,to:i.from}:null}(t,r);e&&(r=i=(i<=o.to?o:t.doc.lineAt(i)).to);let a=new m0(t,{simulateBreak:r,simulateDoubleBreak:!!s}),l=mK(a,r);for(null==l&&(l=tk(/^\s*/.exec(t.doc.lineAt(r).text)[0],t.tabSize));i<o.to&&/\s/.test(o.text[i-o.from]);)i++;s?{from:r,to:i}=s:r>o.from&&r<o.from+100&&!/\S/.test(o.text.slice(0,r))&&(r=o.from);let c=["",mJ(t,l)];return s&&c.push(mJ(t,a.lineIndent(o.from,-1))),{changes:{from:r,to:i,insert:ea.of(c)},range:eD.cursor(r+1+c[1].length)}});return n(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function yX(e,t){let n=-1;return e.changeByRange(r=>{let i=[];for(let o=r.from;o<=r.to;){let s=e.doc.lineAt(o);s.number>n&&(r.empty||r.to>s.from)&&(t(s,i,r),n=s.number),o=s.to+1}let o=e.changes(i);return{changes:i,range:eD.range(o.mapPos(r.anchor,1),o.mapPos(r.head,1))}})}let yZ=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(yX(e,(t,n)=>{n.push({from:t.from,insert:e.facet(mZ)})}),{userEvent:"input.indent"})),!0),yY=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(yX(e,(t,n)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let i=tk(r,e.tabSize),o=0,s=mJ(e,Math.max(0,i-mY(e)));for(;o<r.length&&o<s.length&&r.charCodeAt(o)==s.charCodeAt(o);)o++;n.push({from:t.from+o,to:t.from+r.length,insert:s.slice(o)})}),{userEvent:"delete.dedent"})),!0),yJ=[{key:"Ctrl-b",run:yc,shift:yO,preventDefault:!0},{key:"Ctrl-f",run:yh,shift:yS},{key:"Ctrl-p",run:yp,shift:yA},{key:"Ctrl-n",run:ym,shift:yE},{key:"Ctrl-a",run:e=>yo(e,t=>eD.cursor(e.lineBlockAt(t.head).from,1)),shift:e=>yw(e,t=>eD.cursor(e.lineBlockAt(t.head).from))},{key:"Ctrl-e",run:e=>yo(e,t=>eD.cursor(e.lineBlockAt(t.head).to,-1)),shift:e=>yw(e,t=>eD.cursor(e.lineBlockAt(t.head).to))},{key:"Ctrl-d",run:yz},{key:"Ctrl-h",run:yq},{key:"Ctrl-k",run:e=>yI(e,t=>{let n=e.lineBlockAt(t.head).to;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})},{key:"Ctrl-Alt-h",run:yF},{key:"Ctrl-o",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:ea.of(["",""])},range:eD.cursor(e.from)}));return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let n=t.from,r=e.doc.lineAt(n),i=n==r.from?n-1:eg(r.text,n-r.from,!1)+r.from,o=n==r.to?n+1:eg(r.text,n-r.from,!0)+r.from;return{changes:{from:i,to:o,insert:e.doc.slice(n,o).append(e.doc.slice(i,n))},range:eD.cursor(o)}});return!n.changes.empty&&(t(e.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:yv}],yK=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>yo(e,t=>yd(e.state,t,!yl(e))),shift:e=>yw(e,t=>yd(e.state,t,!yl(e)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>yo(e,t=>yd(e.state,t,yl(e))),shift:e=>yw(e,t=>yd(e.state,t,yl(e)))},{key:"Alt-ArrowUp",run:({state:e,dispatch:t})=>yV(e,t,!1)},{key:"Shift-Alt-ArrowUp",run:({state:e,dispatch:t})=>yW(e,t,!1)},{key:"Alt-ArrowDown",run:({state:e,dispatch:t})=>yV(e,t,!0)},{key:"Shift-Alt-ArrowDown",run:({state:e,dispatch:t})=>yW(e,t,!0)},{key:"Escape",run:({state:e,dispatch:t})=>{let n=e.selection,r=null;return n.ranges.length>1?r=eD.create([n.main]):n.main.empty||(r=eD.create([eD.cursor(n.main.head)])),!!r&&(t(yi(e,r)),!0)}},{key:"Mod-Enter",run:yH},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:t})=>{let n=yQ(e).map(({from:t,to:n})=>eD.range(t,Math.min(n+1,e.doc.length)));return t(e.update({selection:eD.create(n),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:t})=>{let n=yr(e.selection,t=>{let n=mL(e),r=n.resolveStack(t.from,1);if(t.empty){let e=n.resolveStack(t.from,-1);e.node.from>=r.node.from&&e.node.to<=r.node.to&&(r=e)}for(let e=r;e;e=e.next){let{node:n}=e;if((n.from<t.from&&n.to>=t.to||n.to>t.to&&n.from<=t.from)&&e.next)return eD.range(n.to,n.from)}return t});return!n.eq(e.selection)&&(t(yi(e,n)),!0)},preventDefault:!0},{key:"Mod-[",run:yY},{key:"Mod-]",run:yZ},{key:"Mod-Alt-\\",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=Object.create(null),r=new m0(e,{overrideIndentation:e=>n[e]??-1}),i=yX(e,(t,i,o)=>{let s=mK(r,t.from);if(null==s)return;/\S/.test(t.text)||(s=0);let a=/^\s*/.exec(t.text)[0],l=mJ(e,s);(a!=l||o.from<t.from+a.length)&&(n[t.from]=s,i.push({from:t.from,to:t.from+a.length,insert:l}))});return i.changes.empty||t(e.update(i,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,n=t.changes(yQ(t).map(({from:e,to:n})=>(e>0?e--:n<t.doc.length&&n++,{from:e,to:n}))),r=yr(t.selection,t=>{let n;if(e.lineWrapping){let r=e.lineBlockAt(t.head),i=e.coordsAtPos(t.head,t.assoc||1);i&&(n=r.bottom+e.documentTop-i.bottom+e.defaultLineHeight/2)}return e.moveVertically(t,!0,n)}).map(n);return e.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:e,dispatch:t})=>(function(e,t,n){let r=!1,i=yr(e.selection,t=>{let n=gj(e,t.head,-1)||gj(e,t.head,1)||t.head>0&&gj(e,t.head-1,1)||t.head<e.doc.length&&gj(e,t.head+1,-1);if(!n||!n.end)return t;r=!0;let i=n.start.from==t.head?n.end.to:n.end.from;return eD.cursor(i)});return!!r&&(t(yi(e,i)),!0)})(e,t)},{key:"Mod-/",run:e=>{let{state:t}=e,n=t.doc.lineAt(t.selection.main.from),r=gU(e.state,n.from);return r.line?gQ(e):!!r.block&&gW(e)}},{key:"Alt-A",run:gV},{key:"Ctrl-m",mac:"Shift-Alt-m",run:e=>(e.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:yc,shift:yO,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>yu(e,!yl(e)),shift:e=>yC(e,!yl(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>yo(e,t=>yx(e,t,!yl(e))),shift:e=>yw(e,t=>yx(e,t,!yl(e))),preventDefault:!0},{key:"ArrowRight",run:yh,shift:yS,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>yu(e,yl(e)),shift:e=>yC(e,yl(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>yo(e,t=>yx(e,t,yl(e))),shift:e=>yw(e,t=>yx(e,t,yl(e))),preventDefault:!0},{key:"ArrowUp",run:yp,shift:yA,preventDefault:!0},{mac:"Cmd-ArrowUp",run:yN,shift:yP},{mac:"Ctrl-ArrowUp",run:yb,shift:y_},{key:"ArrowDown",run:ym,shift:yE,preventDefault:!0},{mac:"Cmd-ArrowDown",run:yR,shift:yj},{mac:"Ctrl-ArrowDown",run:yv,shift:yD},{key:"PageUp",run:yb,shift:y_},{key:"PageDown",run:yv,shift:yD},{key:"Home",run:e=>yo(e,t=>yx(e,t,!1)),shift:e=>yw(e,t=>yx(e,t,!1)),preventDefault:!0},{key:"Mod-Home",run:yN,shift:yP},{key:"End",run:e=>yo(e,t=>yx(e,t,!0)),shift:e=>yw(e,t=>yx(e,t,!0)),preventDefault:!0},{key:"Mod-End",run:yR,shift:yj},{key:"Enter",run:yU,shift:yU},{key:"Mod-a",run:({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:yq,shift:yq},{key:"Delete",run:yz},{key:"Mod-Backspace",mac:"Alt-Backspace",run:yF},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>yB(e,!0)},{mac:"Mod-Backspace",run:e=>yI(e,t=>{let n=e.moveToLineBoundary(t,!1).head;return t.head>n?n:Math.max(0,t.head-1)})},{mac:"Mod-Delete",run:e=>yI(e,t=>{let n=e.moveToLineBoundary(t,!0).head;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})}].concat(yJ.map(e=>({mac:e.key,run:e.run,shift:e.shift})))),y0={key:"Tab",run:yZ,shift:yY};function y1(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];"string"==typeof i?e.setAttribute(r,i):null!=i&&(e[r]=i)}t++}for(;t<arguments.length;t++)!function e(t,n){if("string"==typeof n)t.appendChild(document.createTextNode(n));else if(null!=n){if(null!=n.nodeType)t.appendChild(n);else if(Array.isArray(n))for(var r=0;r<n.length;r++)e(t,n[r]);else throw RangeError("Unsupported child node: "+n)}}(e,arguments[t]);return e}let y2="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class y5{constructor(e,t,n=0,r=e.length,i,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,r),this.bufferStart=n,this.normalize=i?e=>i(y2(e)):y2,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return -1;this.bufferPos=0,this.buffer=this.iter.value}return ey(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=eb(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=ev(e);let r=this.normalize(t);if(r.length)for(let e=0,i=n;;e++){let o=r.charCodeAt(e),s=this.match(o,i,this.bufferPos+this.bufferStart);if(e==r.length-1){if(s)return this.value=s,this;break}i==n&&e<t.length&&t.charCodeAt(e)==o&&i++}}}match(e,t,n){let r=null;for(let t=0;t<this.matches.length;t+=2){let i=this.matches[t],o=!1;this.query.charCodeAt(i)==e&&(i==this.query.length-1?r={from:this.matches[t+1],to:n}:(this.matches[t]++,o=!0)),o||(this.matches.splice(t,2),t-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?r={from:t,to:n}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}"u">typeof Symbol&&(y5.prototype[Symbol.iterator]=function(){return this});let y3={from:-1,to:-1,match:/.*/.exec("")},y4="gm"+(null==/x/.unicode?"":"u");class y6{constructor(e,t,n,r=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=y3,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new y7(e,t,n,r,i);this.re=new RegExp(t,y4+(null!=n&&n.ignoreCase?"i":"")),this.test=null==n?void 0:n.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=be(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,r=n+t[0].length;if(this.matchPos=be(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}let y8=new WeakMap;class y9{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let r=y8.get(e);if(!r||r.from>=n||r.to<=t){let r=new y9(t,e.sliceString(t,n));return y8.set(e,r),r}if(r.from==t&&r.to==n)return r;let{text:i,from:o}=r;return o>t&&(i=e.sliceString(t,o)+i,o=t),r.to<n&&(i+=e.sliceString(r.to,n)),y8.set(e,new y9(o,i)),new y9(t,i.slice(t-o,n-o))}}class y7{constructor(e,t,n,r,i){this.text=e,this.to=i,this.done=!1,this.value=y3,this.matchPos=be(e,r),this.re=new RegExp(t,y4+(null!=n&&n.ignoreCase?"i":"")),this.test=null==n?void 0:n.test,this.flat=y9.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let e=this.flat.from+t.index,n=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,n,t)))return this.value={from:e,to:n,match:t},this.matchPos=be(this.text,n+(e==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=y9.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function be(e,t){if(t>=e.length)return t;let n=e.lineAt(t),r;for(;t<n.to&&(r=n.text.charCodeAt(t-n.from))>=56320&&r<57344;)t++;return t}function bt(e){let t=y1("input",{class:"cm-textfield",name:"line",value:String(e.state.doc.lineAt(e.state.selection.main.head).number)});function n(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!n)return;let{state:r}=e,i=r.doc.lineAt(r.selection.main.head),[,o,s,a,l]=n,c=a?+a.slice(1):0,h=s?+s:i.number;if(s&&l){let e=h/100;o&&(e=e*("-"==o?-1:1)+i.number/r.doc.lines),h=Math.round(r.doc.lines*e)}else s&&o&&(h=h*("-"==o?-1:1)+i.number);let u=r.doc.line(Math.max(1,Math.min(r.doc.lines,h))),d=eD.cursor(u.from+Math.max(0,Math.min(c,u.length)));e.dispatch({effects:[bn.of(!1),fm.scrollIntoView(d.from,{y:"center"})],selection:d}),e.focus()}return{dom:y1("form",{class:"cm-gotoLine",onkeydown:t=>{27==t.keyCode?(t.preventDefault(),e.dispatch({effects:bn.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),n())},onsubmit:e=>{e.preventDefault(),n()}},y1("label",e.state.phrase("Go to line"),": ",t)," ",y1("button",{class:"cm-button",type:"submit"},e.state.phrase("go")),y1("button",{name:"close",onclick:()=>{e.dispatch({effects:bn.of(!1)}),e.focus()},"aria-label":e.state.phrase("close"),type:"button"},["\xd7"]))}}"u">typeof Symbol&&(y6.prototype[Symbol.iterator]=y7.prototype[Symbol.iterator]=function(){return this});let bn=e6.define(),br=ez.define({create:()=>!0,update(e,t){for(let n of t.effects)n.is(bn)&&(e=n.value);return e},provide:e=>pv.from(e,e=>e?bt:null)}),bi=fm.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),bo={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},bs=eP.define({combine:e=>to(e,bo,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}),ba=ut.mark({class:"cm-selectionMatch"}),bl=ut.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function bc(e,t,n,r){return(0==n||e(t.sliceDoc(n-1,n))!=tn.Word)&&(r==t.doc.length||e(t.sliceDoc(r,r+1))!=tn.Word)}let bh=uU.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(bs),{state:n}=e,r=n.selection;if(r.ranges.length>1)return ut.none;let i=r.main,o,s=null;if(i.empty){if(!t.highlightWordAroundCursor)return ut.none;let e=n.wordAt(i.head);if(!e)return ut.none;s=n.charCategorizer(i.head),o=n.sliceDoc(e.from,e.to)}else{let e=i.to-i.from;if(e<t.minSelectionLength||e>200)return ut.none;if(t.wholeWords){var a,l,c;if(o=n.sliceDoc(i.from,i.to),!(bc(s=n.charCategorizer(i.head),n,i.from,i.to)&&(a=s,l=i.from,c=i.to,a(n.sliceDoc(l,l+1))==tn.Word&&a(n.sliceDoc(c-1,c))==tn.Word)))return ut.none}else if(!(o=n.sliceDoc(i.from,i.to)))return ut.none}let h=[];for(let r of e.visibleRanges){let e=new y5(n.doc,o,r.from,r.to);for(;!e.next().done;){let{from:r,to:o}=e.value;if((!s||bc(s,n,r,o))&&(i.empty&&r<=i.from&&o>=i.to?h.push(bl.range(r,o)):(r>=i.to||o<=i.from)&&h.push(ba.range(r,o)),h.length>t.maxMatches))return ut.none}}return ut.set(h)}},{decorations:e=>e.decorations}),bu=fm.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),bd=({state:e,dispatch:t})=>{let{selection:n}=e,r=eD.create(n.ranges.map(t=>e.wordAt(t.head)||eD.cursor(t.head)),n.mainIndex);return!r.eq(n)&&(t(e.update({selection:r})),!0)},bf=eP.define({combine:e=>to(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new bF(e),scrollToMatch:e=>fm.scrollIntoView(e)})});class bp{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,y4),!0}catch{return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(e,t)=>"n"==t?`
`:"r"==t?"\r":"t"==t?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new bw(this):new by(this)}getCursor(e,t=0,n){let r=e.doc?e:ti.create({doc:e});return null==n&&(n=r.doc.length),this.regexp?bb(this,r,t,n):bg(this,r,t,n)}}class bm{constructor(e){this.spec=e}}function bg(e,t,n,r){var i,o;return new y5(t.doc,e.unquoted,n,r,e.caseSensitive?void 0:e=>e.toLowerCase(),e.wholeWord?(i=t.doc,o=t.charCategorizer(t.selection.main.head),(e,t,n,r)=>((r>e||r+n.length<t)&&(r=Math.max(0,e-2),n=i.sliceString(r,Math.min(i.length,t+2))),(o(bv(n,e-r))!=tn.Word||o(bx(n,e-r))!=tn.Word)&&(o(bx(n,t-r))!=tn.Word||o(bv(n,t-r))!=tn.Word))):void 0)}class by extends bm{constructor(e){super(e)}nextMatch(e,t,n){let r=bg(this.spec,e,n,e.doc.length).nextOverlapping();if(r.done){let n=Math.min(e.doc.length,t+this.spec.unquoted.length);r=bg(this.spec,e,0,n).nextOverlapping()}return r.done||r.value.from==t&&r.value.to==n?null:r.value}prevMatchInRange(e,t,n){for(let r=n;;){let n=Math.max(t,r-1e4-this.spec.unquoted.length),i=bg(this.spec,e,n,r),o=null;for(;!i.nextOverlapping().done;)o=i.value;if(o)return o;if(n==t)return null;r-=1e4}}prevMatch(e,t,n){let r=this.prevMatchInRange(e,0,t);return r||(r=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=t||r.to!=n)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=bg(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let i=bg(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)r(i.value.from,i.value.to)}}function bb(e,t,n,r){var i;return new y6(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?(i=t.charCategorizer(t.selection.main.head),(e,t,n)=>!n[0].length||(i(bv(n.input,n.index))!=tn.Word||i(bx(n.input,n.index))!=tn.Word)&&(i(bx(n.input,n.index+n[0].length))!=tn.Word||i(bv(n.input,n.index+n[0].length))!=tn.Word)):void 0},n,r)}function bv(e,t){return e.slice(eg(e,t,!1),t)}function bx(e,t){return e.slice(t,eg(e,t))}class bw extends bm{nextMatch(e,t,n){let r=bb(this.spec,e,n,e.doc.length).next();return r.done&&(r=bb(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=1;;r++){let i=Math.max(t,n-1e4*r),o=bb(this.spec,e,i,n),s=null;for(;!o.next().done;)s=o.value;if(s&&(i==t||s.from>i+10))return s;if(i==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,n)=>{if("&"==n)return e.match[0];if("$"==n)return"$";for(let t=n.length;t>0;t--){let r=+n.slice(0,t);if(r>0&&r<e.match.length)return e.match[r]+n.slice(t)}return t})}matchAll(e,t){let n=bb(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let i=bb(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!i.next().done;)r(i.value.from,i.value.to)}}let bk=e6.define(),bO=e6.define(),bS=ez.define({create:e=>new bC(bI(e).create(),null),update(e,t){for(let n of t.effects)n.is(bk)?e=new bC(n.value.create(),e.panel):n.is(bO)&&(e=new bC(e.query,n.value?bj:null));return e},provide:e=>pv.from(e,e=>e.panel)});class bC{constructor(e,t){this.query=e,this.panel=t}}let bT=ut.mark({class:"cm-searchMatch"}),bA=ut.mark({class:"cm-searchMatch cm-searchMatch-selected"}),bE=uU.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(bS))}update(e){let t=e.state.field(bS);(t!=e.startState.field(bS)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return ut.none;let{view:n}=this,r=new tu;for(let t=0,i=n.visibleRanges,o=i.length;t<o;t++){let{from:s,to:a}=i[t];for(;t<o-1&&a>i[t+1].from-500;)a=i[++t].to;e.highlight(n.state,s,a,(e,t)=>{let i=n.state.selection.ranges.some(n=>n.from==e&&n.to==t);r.add(e,t,i?bA:bT)})}return r.finish()}},{decorations:e=>e.decorations});function bM(e){return t=>{let n=t.state.field(bS,!1);return n&&n.query.spec.valid?e(t,n):bq(t)}}let b_=bM((e,{query:t})=>{let{to:n}=e.state.selection.main,r=t.nextMatch(e.state,n,n);if(!r)return!1;let i=eD.single(r.from,r.to),o=e.state.facet(bf);return e.dispatch({selection:i,effects:[bW(e,r),o.scrollToMatch(i.main,e)],userEvent:"select.search"}),bL(e),!0}),bD=bM((e,{query:t})=>{let{state:n}=e,{from:r}=n.selection.main,i=t.prevMatch(n,r,r);if(!i)return!1;let o=eD.single(i.from,i.to),s=e.state.facet(bf);return e.dispatch({selection:o,effects:[bW(e,i),s.scrollToMatch(o.main,e)],userEvent:"select.search"}),bL(e),!0}),bN=bM((e,{query:t})=>{let n=t.matchAll(e.state,1e3);return!!n&&!!n.length&&(e.dispatch({selection:eD.create(n.map(e=>eD.range(e.from,e.to))),userEvent:"select.search.matches"}),!0)}),bR=bM((e,{query:t})=>{let{state:n}=e,{from:r,to:i}=n.selection.main;if(n.readOnly)return!1;let o=t.nextMatch(n,r,r);if(!o)return!1;let s=o,a=[],l,c,h=[];if(s.from==r&&s.to==i&&(c=n.toText(t.getReplacement(s)),a.push({from:s.from,to:s.to,insert:c}),s=t.nextMatch(n,s.from,s.to),h.push(fm.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(r).number)+"."))),s){let t=0==a.length||a[0].from>=o.to?0:o.to-o.from-c.length;l=eD.single(s.from-t,s.to-t),h.push(bW(e,s)),h.push(n.facet(bf).scrollToMatch(l.main,e))}return e.dispatch({changes:a,selection:l,effects:h,userEvent:"input.replace"}),!0}),bP=bM((e,{query:t})=>{if(e.state.readOnly)return!1;let n=t.matchAll(e.state,1e9).map(e=>{let{from:n,to:r}=e;return{from:n,to:r,insert:t.getReplacement(e)}});if(!n.length)return!1;let r=e.state.phrase("replaced $ matches",n.length)+".";return e.dispatch({changes:n,effects:fm.announce.of(r),userEvent:"input.replace.all"}),!0});function bj(e){return e.state.facet(bf).createPanel(e)}function bI(e,t){var n,r,i,o,s;let a=e.selection.main,l=a.empty||a.to>a.from+100?"":e.sliceDoc(a.from,a.to);if(t&&!l)return t;let c=e.facet(bf);return new bp({search:(null!==(n=null==t?void 0:t.literal)&&void 0!==n?n:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:null!==(r=null==t?void 0:t.caseSensitive)&&void 0!==r?r:c.caseSensitive,literal:null!==(i=null==t?void 0:t.literal)&&void 0!==i?i:c.literal,regexp:null!==(o=null==t?void 0:t.regexp)&&void 0!==o?o:c.regexp,wholeWord:null!==(s=null==t?void 0:t.wholeWord)&&void 0!==s?s:c.wholeWord})}function b$(e){let t=pm(e,bj);return t&&t.dom.querySelector("[main-field]")}function bL(e){let t=b$(e);t&&t==e.root.activeElement&&t.select()}let bq=e=>{let t=e.state.field(bS,!1);if(t&&t.panel){let n=b$(e);if(n&&n!=e.root.activeElement){let r=bI(e.state,t.query.spec);r.valid&&e.dispatch({effects:bk.of(r)}),n.focus(),n.select()}}else e.dispatch({effects:[bO.of(!0),t?bk.of(bI(e.state,t.query.spec)):e6.appendConfig.of(bH)]});return!0},bz=e=>{let t=e.state.field(bS,!1);if(!t||!t.panel)return!1;let n=pm(e,bj);return n&&n.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:bO.of(!1)}),!0},bB=[{key:"Mod-f",run:bq,scope:"editor search-panel"},{key:"F3",run:b_,shift:bD,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:b_,shift:bD,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:bz,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:e,dispatch:t})=>{let n=e.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:r,to:i}=n.main,o=[],s=0;for(let t=new y5(e.doc,e.sliceDoc(r,i));!t.next().done;){if(o.length>1e3)return!1;t.value.from==r&&(s=o.length),o.push(eD.range(t.value.from,t.value.to))}return t(e.update({selection:eD.create(o,s),userEvent:"select.search.matches"})),!0}},{key:"Mod-Alt-g",run:e=>{let t=pm(e,bt);if(!t){let n=[bn.of(!0)];null==e.state.field(br,!1)&&n.push(e6.appendConfig.of([br,bi])),e.dispatch({effects:n}),t=pm(e,bt)}return t&&t.dom.querySelector("input").select(),!0}},{key:"Mod-d",run:({state:e,dispatch:t})=>{let{ranges:n}=e.selection;if(n.some(e=>e.from===e.to))return bd({state:e,dispatch:t});let r=e.sliceDoc(n[0].from,n[0].to);if(e.selection.ranges.some(t=>e.sliceDoc(t.from,t.to)!=r))return!1;let i=function(e,t){let{main:n,ranges:r}=e.selection,i=e.wordAt(n.head),o=i&&i.from==n.from&&i.to==n.to;for(let n=!1,i=new y5(e.doc,t,r[r.length-1].to);;)if(i.next(),i.done){if(n)return null;i=new y5(e.doc,t,0,Math.max(0,r[r.length-1].from-1)),n=!0}else{if(n&&r.some(e=>e.from==i.value.from))continue;if(o){let t=e.wordAt(i.value.from);if(!t||t.from!=i.value.from||t.to!=i.value.to)continue}return i.value}}(e,r);return!!i&&(t(e.update({selection:e.selection.addRange(eD.range(i.from,i.to),!1),effects:fm.scrollIntoView(i.to)})),!0)},preventDefault:!0}];class bF{constructor(e){this.view=e;let t=this.query=e.state.field(bS).query.spec;function n(e,t,n){return y1("button",{class:"cm-button",name:e,onclick:t,type:"button"},n)}this.commit=this.commit.bind(this),this.searchField=y1("input",{value:t.search,placeholder:bQ(e,"Find"),"aria-label":bQ(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=y1("input",{value:t.replace,placeholder:bQ(e,"Replace"),"aria-label":bQ(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=y1("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=y1("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=y1("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=y1("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,n("next",()=>b_(e),[bQ(e,"next")]),n("prev",()=>bD(e),[bQ(e,"previous")]),n("select",()=>bN(e),[bQ(e,"all")]),y1("label",null,[this.caseField,bQ(e,"match case")]),y1("label",null,[this.reField,bQ(e,"regexp")]),y1("label",null,[this.wordField,bQ(e,"by word")]),...e.state.readOnly?[]:[y1("br"),this.replaceField,n("replace",()=>bR(e),[bQ(e,"replace")]),n("replaceAll",()=>bP(e),[bQ(e,"replace all")])],y1("button",{name:"close",onclick:()=>bz(e),"aria-label":bQ(e,"close"),type:"button"},["\xd7"])])}commit(){let e=new bp({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:bk.of(e)}))}keydown(e){var t,n;(t=this.view,n="search-panel",fE(fC(t.state),e,t,n))?e.preventDefault():13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?bD:b_)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),bR(this.view))}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(bk)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(bf).top}}function bQ(e,t){return e.state.phrase(t)}let bV=/[\s\.,:;?!]/;function bW(e,{from:t,to:n}){let r=e.state.doc.lineAt(t),i=e.state.doc.lineAt(n).to,o=Math.max(r.from,t-30),s=Math.min(i,n+30),a=e.state.sliceDoc(o,s);if(o!=r.from){for(let e=0;e<30;e++)if(!bV.test(a[e+1])&&bV.test(a[e])){a=a.slice(e);break}}if(s!=i){for(let e=a.length-1;e>a.length-30;e--)if(!bV.test(a[e-1])&&bV.test(a[e])){a=a.slice(0,e);break}}return fm.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${r.number}.`)}let bU=fm.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),bH=[bS,eQ.low(bE),bU];class bG{constructor(e,t,n,r){this.state=e,this.pos=t,this.explicit=n,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=mL(this.state).resolveInner(this.pos,-1);for(;t&&0>e.indexOf(t.name);)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),r=t.text.slice(n-t.from,this.pos-t.from),i=r.search(b0(e,!1));return i<0?null:{from:n+i,to:this.pos,text:r.slice(i)}}get aborted(){return null==this.abortListeners}addEventListener(e,t,n){"abort"==e&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function bX(e){let t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),`[${n?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function bZ(e){let t=e.map(e=>"string"==typeof e?{label:e}:e),[n,r]=t.every(e=>/^\w+$/.test(e.label))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),n=Object.create(null);for(let{label:r}of e){t[r[0]]=!0;for(let e=1;e<r.length;e++)n[r[e]]=!0}let r=bX(t)+bX(n)+"*$";return[RegExp("^"+r),new RegExp(r)]}(t);return e=>{let i=e.matchBefore(r);return i||e.explicit?{from:i?i.from:e.pos,options:t,validFor:n}:null}}function bY(e,t){return n=>{for(let t=mL(n.state).resolveInner(n.pos,-1);t;t=t.parent){if(e.indexOf(t.name)>-1)return null;if(t.type.isTop)break}return t(n)}}class bJ{constructor(e,t,n,r){this.completion=e,this.source=t,this.match=n,this.score=r}}function bK(e){return e.selection.main.from}function b0(e,t){var n;let{source:r}=e,i=t&&"^"!=r[0],o="$"!=r[r.length-1];return i||o?RegExp(`${i?"^":""}(?:${r})${o?"$":""}`,null!==(n=e.flags)&&void 0!==n?n:e.ignoreCase?"i":""):e}let b1=e5.define(),b2=new WeakMap;function b5(e){if(!Array.isArray(e))return e;let t=b2.get(e);return t||b2.set(e,t=bZ(e)),t}let b3=e6.define(),b4=e6.define();class b6{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=ey(e,t),r=ev(n);this.chars.push(n);let i=e.slice(t,t+r),o=i.toUpperCase();this.folded.push(ey(o==i?i.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(0==this.pattern.length)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:r,precise:i,byWord:o}=this;if(1==t.length){let r=ey(e,0),i=ev(r),o=i==e.length?0:-100;if(r!=t[0]){if(r!=n[0])return null;o+=-200}return this.ret(o,[0,i])}let s=e.indexOf(this.pattern);if(0==s)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,l=0;if(s<0){for(let i=0,o=Math.min(e.length,200);i<o&&l<a;){let o=ey(e,i);(o==t[l]||o==n[l])&&(r[l++]=i),i+=ev(o)}if(l<a)return null}let c=0,h=0,u=!1,d=0,f=-1,p=-1,m=/[a-z]/.test(e),g=!0;for(let r=0,l=Math.min(e.length,200),y=0;r<l&&h<a;){let l=ey(e,r);s<0&&(c<a&&l==t[c]&&(i[c++]=r),d<a&&(l==t[d]||l==n[d]?(0==d&&(f=r),p=r+1,d++):d=0));let b,v=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(b=eb(l))!=b.toLowerCase()?1:b!=b.toUpperCase()?2:0;(!r||1==v&&m||0==y&&0!=v)&&(t[h]==l||n[h]==l&&(u=!0)?o[h++]=r:o.length&&(g=!1)),y=v,r+=ev(l)}return h==a&&0==o[0]&&g?this.result(-100+(u?-200:0),o,e):d==a&&0==f?this.ret(-200-e.length+(p==e.length?0:-100),[0,p]):s>-1?this.ret(-700-e.length,[s,s+this.pattern.length]):d==a?this.ret(-900-e.length,[f,p]):h==a?this.result(-100+(u?-200:0)+-700+(g?0:-1100),o,e):2==t.length?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,n){let r=[],i=0;for(let e of t){let t=e+(this.astral?ev(ey(n,e)):1);i&&r[i-1]==e?r[i-1]=t:(r[i++]=e,r[i++]=t)}return this.ret(e-n.length,r)}}class b8{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return null==n?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}let b9=eP.define({combine:e=>to(e,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:ve,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>b7(e(n),t(n)),optionClass:(e,t)=>n=>b7(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})});function b7(e,t){return e?t?e+" "+t:e:t}function ve(e,t,n,r,i,o){let s=e.textDirection==uf.RTL,a=s,l=!1,c="top",h,u,d=t.left-i.left,f=i.right-t.right,p=r.right-r.left,m=r.bottom-r.top;if(a&&d<Math.min(p,f)?a=!1:!a&&f<Math.min(p,d)&&(a=!0),p<=(a?d:f))h=Math.max(i.top,Math.min(n.top,i.bottom-m))-t.top,u=Math.min(400,a?d:f);else{l=!0,u=Math.min(400,(s?t.right:i.right-t.left)-30);let e=i.bottom-t.bottom;e>=m||e>t.top?h=n.bottom-t.top:(c="bottom",h=t.bottom-n.top)}let g=(t.bottom-t.top)/o.offsetHeight,y=(t.right-t.left)/o.offsetWidth;return{style:`${c}: ${h/g}px; max-width: ${u/y}px`,class:"cm-completionInfo-"+(l?s?"left-narrow":"right-narrow":a?"left":"right")}}function vt(e,t,n){if(e<=n)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let e=Math.floor(t/n);return{from:e*n,to:(e+1)*n}}let r=Math.floor((e-t)/n);return{from:e-(r+1)*n,to:e-r*n}}class vn{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";let r=e.state.field(t),{options:i,selected:o}=r.open,s=e.state.facet(b9);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map(e=>"cm-completionIcon-"+e)),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,n,r){let i=document.createElement("span");i.className="cm-completionLabel";let o=e.displayLabel||e.label,s=0;for(let e=0;e<r.length;){let t=r[e++],n=r[e++];t>s&&i.appendChild(document.createTextNode(o.slice(s,t)));let a=i.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(o.slice(t,n))),a.className="cm-completionMatchedText",s=n}return s<o.length&&i.appendChild(document.createTextNode(o.slice(s))),i},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort((e,t)=>e.position-t.position).map(e=>e.render)}(s),this.optionClass=s.optionClass,this.tooltipClass=s.tooltipClass,this.range=vt(i.length,o,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",n=>{let{options:r}=e.state.field(t).open;for(let t=n.target,i;t&&t!=this.dom;t=t.parentNode)if("LI"==t.nodeName&&(i=/-(\d+)$/.exec(t.id))&&+i[1]<r.length){this.applyCompletion(e,r[+i[1]]),n.preventDefault();return}}),this.dom.addEventListener("focusout",t=>{let n=e.state.field(this.stateField,!1);n&&n.tooltip&&e.state.facet(b9).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:b4.of(null)})}),this.showOptions(i,r.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=r){let{options:i,selected:o,disabled:s}=n.open;r.open&&r.open.options==i||(this.range=vt(i.length,o,e.state.facet(b9).maxRenderedOptions),this.showOptions(i,n.id)),this.updateSel(),s!=(null===(t=r.open)||void 0===t?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!s)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let e of this.currentClass.split(" "))e&&this.dom.classList.remove(e);for(let e of t.split(" "))e&&this.dom.classList.add(e);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=vt(t.options.length,t.selected,this.view.state.facet(b9).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:r}=n;if(!r)return;let i="string"==typeof r?document.createTextNode(r):r(n);if(!i)return;"then"in i?i.then(t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t,n)}).catch(e=>uF(this.view.state,e,"completion info")):this.addInfoPane(i,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",null!=e.nodeType)n.appendChild(e),this.infoDestroy=null;else{let{dom:t,destroy:r}=e;n.appendChild(t),this.infoDestroy=r||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){var t,n;let r,i,o,s=null;for(let t=this.list.firstChild,n=this.range.from;t;t=t.nextSibling,n++)"LI"==t.nodeName&&t.id?n==e?t.hasAttribute("aria-selected")||(t.setAttribute("aria-selected","true"),s=t):t.hasAttribute("aria-selected")&&t.removeAttribute("aria-selected"):n--;return s&&(t=this.list,n=s,r=t.getBoundingClientRect(),i=n.getBoundingClientRect(),o=r.height/t.offsetHeight,i.top<r.top?t.scrollTop-=(r.top-i.top)/o:i.bottom>r.bottom&&(t.scrollTop+=(i.bottom-r.bottom)/o)),s}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),i=this.space;if(!i){let e=this.dom.ownerDocument.documentElement;i={left:0,top:0,right:e.clientWidth,bottom:e.clientHeight}}return r.top>Math.min(i.bottom,t.bottom)-10||r.bottom<Math.max(i.top,t.top)+10?null:this.view.state.facet(b9).positionInfo(this.view,t,r,n,i,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){let r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions")),r.addEventListener("mousedown",e=>{e.target==r&&e.preventDefault()});let i=null;for(let o=n.from;o<n.to;o++){let{completion:s,match:a}=e[o],{section:l}=s;if(l){let e="string"==typeof l?l:l.name;e!=i&&(o>n.from||0==n.from)&&((i=e,"string"!=typeof l&&l.header)?r.appendChild(l.header(l)):r.appendChild(document.createElement("completion-section")).textContent=e)}let c=r.appendChild(document.createElement("li"));c.id=t+"-"+o,c.setAttribute("role","option");let h=this.optionClass(s);for(let e of(h&&(c.className=h),this.optionContent)){let t=e(s,this.view.state,this.view,a);t&&c.appendChild(t)}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function vr(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}class vi{constructor(e,t,n,r,i,o){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=r,this.selected=i,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new vi(this.options,vl(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,r,i,o){if(r&&!o&&e.some(e=>e.isPending))return r.setDisabled();let s=function(e,t){let n=[],r=null,i=e=>{n.push(e);let{section:t}=e.completion;if(t){r||(r=[]);let e="string"==typeof t?t:t.name;r.some(t=>t.name==e)||r.push("string"==typeof t?{name:e}:t)}},o=t.facet(b9);for(let r of e)if(r.hasResult()){let e=r.result.getMatch;if(!1===r.result.filter)for(let t of r.result.options)i(new bJ(t,r.source,e?e(t):[],1e9-n.length));else{let n=t.sliceDoc(r.from,r.to),s,a=o.filterStrict?new b8(n):new b6(n);for(let t of r.result.options)if(s=a.match(t.label)){let n=t.displayLabel?e?e(t,s.matched):[]:s.matched;i(new bJ(t,r.source,n,s.score+(t.boost||0)))}}}if(r){let e=Object.create(null),t=0;for(let n of r.sort((e,t)=>{var n,r;return(null!==(n=e.rank)&&void 0!==n?n:1e9)-(null!==(r=t.rank)&&void 0!==r?r:1e9)||(e.name<t.name?-1:1)}))t-=1e5,e[n.name]=t;for(let t of n){let{section:n}=t.completion;n&&(t.score+=e["string"==typeof n?n:n.name])}}let s=[],a=null,l=o.compareCompletions;for(let e of n.sort((e,t)=>t.score-e.score||l(e.completion,t.completion))){let t=e.completion;a&&a.label==t.label&&a.detail==t.detail&&(null==a.type||null==t.type||a.type==t.type)&&a.apply==t.apply&&a.boost==t.boost?vr(e.completion)>vr(a)&&(s[s.length-1]=e):s.push(e),a=e.completion}return s}(e,t);if(!s.length)return r&&e.some(e=>e.isPending)?r.setDisabled():null;let a=t.facet(b9).selectOnOpen?0:-1;if(r&&r.selected!=a&&-1!=r.selected){let e=r.options[r.selected].completion;for(let t=0;t<s.length;t++)if(s[t].completion==e){a=t;break}}return new vi(s,vl(n,a),{pos:e.reduce((e,t)=>t.hasResult()?Math.min(e,t.from):e,1e8),create:vy,above:i.aboveCursor},r?r.timestamp:Date.now(),a,!1)}map(e){return new vi(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new vi(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class vo{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new vo(vc,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,n=t.facet(b9),r=(n.override||t.languageDataAt("autocomplete",bK(t)).map(b5)).map(t=>(this.active.find(e=>e.source==t)||new vu(t,this.active.some(e=>0!=e.state)?1:0)).update(e,n));r.length==this.active.length&&r.every((e,t)=>e==this.active[t])&&(r=this.active);let i=this.open,o=e.effects.some(e=>e.is(vf));for(let s of(i&&e.docChanged&&(i=i.map(e.changes)),e.selection||r.some(t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to))||!function(e,t){if(e==t)return!0;for(let n=0,r=0;;){for(;n<e.length&&!e[n].hasResult();)n++;for(;r<t.length&&!t[r].hasResult();)r++;let i=n==e.length,o=r==t.length;if(i||o)return i==o;if(e[n++].result!=t[r++].result)return!1}}(r,this.active)||o?i=vi.build(r,t,this.id,i,n,o):i&&i.disabled&&!r.some(e=>e.isPending)&&(i=null),!i&&r.every(e=>!e.isPending)&&r.some(e=>e.hasResult())&&(r=r.map(e=>e.hasResult()?new vu(e.source,0):e)),e.effects))s.is(vp)&&(i=i&&i.setSelected(s.value,this.id));return r==this.active&&i==this.open?this:new vo(r,this.id,i)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?vs:va}}let vs={"aria-autocomplete":"list"},va={};function vl(e,t){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(n["aria-activedescendant"]=e+"-"+t),n}let vc=[];function vh(e,t){if(e.isUserEvent("input.complete")){let n=e.annotation(b1);if(n&&t.activateOnCompletion(n))return 12}let n=e.isUserEvent("input.type");return n&&t.activateOnTyping?5:n?1:e.isUserEvent("delete.backward")?2:e.selection?8:e.docChanged?16:0}class vu{constructor(e,t,n=!1){this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return 1==this.state}update(e,t){let n=vh(e,t),r=this;for(let t of((8&n||16&n&&this.touches(e))&&(r=new vu(r.source,0)),4&n&&0==r.state&&(r=new vu(this.source,1)),r=r.updateFor(e,n),e.effects))if(t.is(b3))r=new vu(r.source,1,t.value);else if(t.is(b4))r=new vu(r.source,0);else if(t.is(vf))for(let e of t.value)e.source==r.source&&(r=e);return r}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(bK(e.state))}}class vd extends vu{constructor(e,t,n,r,i,o){super(e,3,t),this.limit=n,this.result=r,this.from=i,this.to=o}hasResult(){return!0}updateFor(e,t){var n;if(!(3&t))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let i=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),s=bK(e.state);if(s>o||!r||2&t&&(bK(e.startState)==this.from||s<this.limit))return new vu(this.source,4&t?1:0);let a=e.changes.mapPos(this.limit);return!function(e,t,n,r){if(!e)return!1;let i=t.sliceDoc(n,r);return"function"==typeof e?e(i,n,r,t):b0(e,!0).test(i)}(r.validFor,e.state,i,o)?r.update&&(r=r.update(r,i,o,new bG(e.state,s,!1)))?new vd(this.source,this.explicit,a,r,r.from,null!==(n=r.to)&&void 0!==n?n:bK(e.state)):new vu(this.source,1,this.explicit):new vd(this.source,this.explicit,a,r,i,o)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new vd(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new vu(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}let vf=e6.define({map:(e,t)=>e.map(e=>e.map(t))}),vp=e6.define(),vm=ez.define({create:()=>vo.start(),update:(e,t)=>e.update(t),provide:e=>[pa.from(e,e=>e.tooltip),fm.contentAttributes.from(e,e=>e.attrs)]});function vg(e,t){let n=t.completion.apply||t.completion.label,r=e.state.field(vm).active.find(e=>e.source==t.source);return r instanceof vd&&("string"==typeof n?e.dispatch(Object.assign(Object.assign({},function(e,t,n,r){let{main:i}=e.selection,o=n-i.from,s=r-i.from;return Object.assign(Object.assign({},e.changeByRange(a=>{if(a!=i&&n!=r&&e.sliceDoc(a.from+o,a.from+s)!=e.sliceDoc(n,r))return{range:a};let l=e.toText(t);return{changes:{from:a.from+o,to:r==i.from?a.to:a.from+s,insert:l},range:eD.cursor(a.from+o+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}(e.state,n,r.from,r.to)),{annotations:b1.of(t.completion)})):n(e,t.completion,r.from,r.to),!0)}let vy=e=>new vn(e,vm,vg);function vb(e,t="option"){return n=>{let r=n.state.field(vm,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<n.state.facet(b9).interactionDelay)return!1;let i=1,o;"page"==t&&(o=pd(n,r.open.tooltip))&&(i=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:s}=r.open.options,a=r.open.selected>-1?r.open.selected+i*(e?1:-1):e?0:s-1;return a<0?a="page"==t?0:s-1:a>=s&&(a="page"==t?s-1:0),n.dispatch({effects:vp.of(a)}),!0}}let vv=e=>!!e.state.field(vm,!1)&&(e.dispatch({effects:b3.of(!0)}),!0);class vx{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}let vw=uU.fromClass(class{constructor(e){for(let t of(this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0,e.state.field(vm).active))t.isPending&&this.startQuery(t)}update(e){let t=e.state.field(vm),n=e.state.facet(b9);if(!e.selectionSet&&!e.docChanged&&e.startState.field(vm)==t)return;let r=e.transactions.some(e=>{let t=vh(e,n);return 8&t||(e.selection||e.docChanged)&&!(3&t)});for(let t=0;t<this.running.length;t++){let n=this.running[t];if(r||n.context.abortOnDocChange&&e.docChanged||n.updates.length+e.transactions.length>50&&Date.now()-n.time>1e3){for(let e of n.context.abortListeners)try{e()}catch(e){uF(this.view.state,e)}n.context.abortListeners=null,this.running.splice(t--,1)}else n.updates.push(...e.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),e.transactions.some(e=>e.effects.some(e=>e.is(b3)))&&(this.pendingStart=!0);let i=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(e=>e.isPending&&!this.running.some(t=>t.active.source==e.source))?setTimeout(()=>this.startUpdate(),i):-1,0!=this.composing)for(let t of e.transactions)t.isUserEvent("input.type")?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:e}=this.view,t=e.field(vm);for(let e of t.active)e.isPending&&!this.running.some(t=>t.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(b9).updateSyncTime))}startQuery(e){let{state:t}=this.view,n=bK(t),r=new bG(t,n,e.explicit,this.view),i=new vx(e,r);this.running.push(i),Promise.resolve(e.source(r)).then(e=>{i.context.aborted||(i.done=e||null,this.scheduleAccept())},e=>{this.view.dispatch({effects:b4.of(null)}),uF(this.view.state,e)})}scheduleAccept(){this.running.every(e=>void 0!==e.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(b9).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],n=this.view.state.facet(b9),r=this.view.state.field(vm);for(let i=0;i<this.running.length;i++){let o=this.running[i];if(void 0===o.done)continue;if(this.running.splice(i--,1),o.done){let r=bK(o.updates.length?o.updates[0].startState:this.view.state),i=Math.min(r,o.done.from+(o.active.explicit?0:1)),s=new vd(o.active.source,o.active.explicit,i,o.done,o.done.from,null!==(e=o.done.to)&&void 0!==e?e:r);for(let e of o.updates)s=s.update(e,n);if(s.hasResult()){t.push(s);continue}}let s=r.active.find(e=>e.source==o.active.source);if(s&&s.isPending){if(null==o.done){let e=new vu(o.active.source,0);for(let t of o.updates)e=e.update(t,n);e.isPending||t.push(e)}else this.startQuery(s)}}(t.length||r.open&&r.open.disabled)&&this.view.dispatch({effects:vf.of(t)})}},{eventHandlers:{blur(e){let t=this.view.state.field(vm,!1);if(t&&t.tooltip&&this.view.state.facet(b9).closeOnBlur){let n=t.open&&pd(this.view,t.open.tooltip);n&&n.dom.contains(e.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:b4.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:b3.of(!1)}),20),this.composing=0}}}),vk="object"==typeof navigator&&/Win/.test(navigator.platform),vO=eQ.highest(fm.domEventHandlers({keydown(e,t){let n=t.state.field(vm,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||e.key.length>1||e.ctrlKey&&!(vk&&e.altKey)||e.metaKey)return!1;let r=n.open.options[n.open.selected],i=n.active.find(e=>e.source==r.source),o=r.completion.commitCharacters||i.result.commitCharacters;return o&&o.indexOf(e.key)>-1&&vg(t,r),!1}})),vS=fm.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11'"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class vC{constructor(e,t,n,r){this.field=e,this.line=t,this.from=n,this.to=r}}class vT{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,ew.TrackDel),n=e.mapPos(this.to,1,ew.TrackDel);return null==t||null==n?null:new vT(this.field,t,n)}}class vA{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],r=[t],i=e.doc.lineAt(t),o=/^\s*/.exec(i.text)[0];for(let i of this.lines){if(n.length){let n=o,s=/^\t*/.exec(i)[0].length;for(let t=0;t<s;t++)n+=e.facet(mZ);r.push(t+n.length-s),i=n+i.slice(s)}n.push(i),t+=i.length+1}return{text:n,ranges:this.fieldPositions.map(e=>new vT(e.field,r[e.line]+e.from,r[e.line]+e.to))}}static parse(e){let t=[],n=[],r=[],i;for(let o of e.split(/\r\n?|\n/)){for(;i=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let e=i[1]?+i[1]:null,s=i[2]||i[3]||"",a=-1,l=s.replace(/\\[{}]/g,e=>e[1]);for(let n=0;n<t.length;n++)(null!=e?t[n].seq==e:l&&t[n].name==l)&&(a=n);if(a<0){let n=0;for(;n<t.length&&(null==e||null!=t[n].seq&&t[n].seq<e);)n++;for(let i of(t.splice(n,0,{seq:e,name:l}),a=n,r))i.field>=a&&i.field++}r.push(new vC(a,n.length,i.index,i.index+l.length)),o=o.slice(0,i.index)+s+o.slice(i.index+i[0].length)}o=o.replace(/\\([{}])/g,(e,t,i)=>{for(let e of r)e.line==n.length&&e.from>i&&(e.from--,e.to--);return t}),n.push(o)}return new vA(n,r)}}let vE=ut.widget({widget:new class extends h7{toDOM(){let e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}ignoreEvent(){return!1}}}),vM=ut.mark({class:"cm-snippetField"});class v_{constructor(e,t){this.ranges=e,this.active=t,this.deco=ut.set(e.map(e=>(e.from==e.to?vE:vM).range(e.from,e.to)))}map(e){let t=[];for(let n of this.ranges){let r=n.map(e);if(!r)return null;t.push(r)}return new v_(t,this.active)}selectionInsideField(e){return e.ranges.every(e=>this.ranges.some(t=>t.field==this.active&&t.from<=e.from&&t.to>=e.to))}}let vD=e6.define({map:(e,t)=>e&&e.map(t)}),vN=e6.define(),vR=ez.define({create:()=>null,update(e,t){for(let n of t.effects){if(n.is(vD))return n.value;if(n.is(vN)&&e)return new v_(e.ranges,n.value)}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.selectionInsideField(t.selection)&&(e=null),e},provide:e=>fm.decorations.from(e,e=>e?e.deco:ut.none)});function vP(e,t){return eD.create(e.filter(e=>e.field==t).map(e=>eD.range(e.from,e.to)))}function vj(e){return({state:t,dispatch:n})=>{let r=t.field(vR,!1);if(!r||e<0&&0==r.active)return!1;let i=r.active+e,o=e>0&&!r.ranges.some(t=>t.field==i+e);return n(t.update({selection:vP(r.ranges,i),effects:vD.of(o?null:new v_(r.ranges,i)),scrollIntoView:!0})),!0}}let vI=[{key:"Tab",run:vj(1),shift:vj(-1)},{key:"Escape",run:({state:e,dispatch:t})=>!!e.field(vR,!1)&&(t(e.update({effects:vD.of(null)})),!0)}],v$=eP.define({combine:e=>e.length?e[0]:vI}),vL=eQ.highest(fO.compute([v$],e=>e.facet(v$)));function vq(e,t){let n;return Object.assign(Object.assign({},t),{apply:(n=vA.parse(e),(e,t,r,i)=>{let{text:o,ranges:s}=n.instantiate(e.state,r),{main:a}=e.state.selection,l={changes:{from:r,to:i==a.from?a.to:i,insert:ea.of(o)},scrollIntoView:!0,annotations:t?[b1.of(t),e8.userEvent.of("input.complete")]:void 0};if(s.length&&(l.selection=vP(s,0)),s.some(e=>e.field>0)){let t=new v_(s,0),n=l.effects=[vD.of(t)];void 0===e.state.field(vR,!1)&&n.push(e6.appendConfig.of([vR,vL,vz,vS]))}e.dispatch(e.state.update(l))})})}let vz=fm.domEventHandlers({mousedown(e,t){let n=t.state.field(vR,!1),r;if(!n||null==(r=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;let i=n.ranges.find(e=>e.from<=r&&e.to>=r);return!!i&&i.field!=n.active&&(t.dispatch({selection:vP(n.ranges,i.field),effects:vD.of(n.ranges.some(e=>e.field>i.field)?new v_(n.ranges,i.field):null),scrollIntoView:!0}),!0)}}),vB={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},vF=e6.define({map:(e,t)=>t.mapPos(e,-1,ew.TrackAfter)??void 0}),vQ=new class extends ts{};vQ.startSide=1,vQ.endSide=-1;let vV=ez.define({create:()=>th.empty,update(e,t){if(e=e.map(t.changes),t.selection){let n=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:e=>e>=n.from&&e<=n.to})}for(let n of t.effects)n.is(vF)&&(e=e.update({add:[vQ.range(n.value,n.value+1)]}));return e}}),vW="()[]{}<>\xab\xbb\xbb\xab";function vU(e){for(let t=0;t<vW.length;t+=2)if(vW.charCodeAt(t)==e)return vW.charAt(t+1);return eb(e<128?e:e+1)}function vH(e,t){return e.languageDataAt("closeBrackets",t)[0]||vB}let vG="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),vX=fm.inputHandler.of((e,t,n,r)=>{if((vG?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let i=e.state.selection.main;if(r.length>2||2==r.length&&1==ev(ey(r,0))||t!=i.from||n!=i.to)return!1;let o=function(e,t){let n=vH(e,e.selection.main.head),r=n.brackets||vB.brackets;for(let i of r){let o=vU(ey(i,0));if(t==i)return o==i?function(e,t,n,r){let i=r.stringPrefixes||vB.stringPrefixes,o=null,s=e.changeByRange(r=>{if(!r.empty)return{changes:[{insert:t,from:r.from},{insert:t,from:r.to}],effects:vF.of(r.to+t.length),range:eD.range(r.anchor+t.length,r.head+t.length)};let s=r.head,a=vJ(e.doc,s),l;if(a==t){if(vK(e,s))return{changes:{insert:t+t,from:s},effects:vF.of(s+t.length),range:eD.cursor(s+t.length)};if(vY(e,s)){let r=n&&e.sliceDoc(s,s+3*t.length)==t+t+t?t+t+t:t;return{changes:{from:s,to:s+r.length,insert:r},range:eD.cursor(s+r.length)}}}else{if(n&&e.sliceDoc(s-2*t.length,s)==t+t&&(l=v0(e,s-2*t.length,i))>-1&&vK(e,l))return{changes:{insert:t+t+t+t,from:s},effects:vF.of(s+t.length),range:eD.cursor(s+t.length)};if(e.charCategorizer(s)(a)!=tn.Word&&v0(e,s,i)>-1&&!function(e,t,n,r){let i=mL(e).resolveInner(t,-1),o=r.reduce((e,t)=>Math.max(e,t.length),0);for(let s=0;s<5;s++){let s=e.sliceDoc(i.from,Math.min(i.to,i.from+n.length+o)),a=s.indexOf(n);if(!a||a>-1&&r.indexOf(s.slice(0,a))>-1){let t=i.firstChild;for(;t&&t.from==i.from&&t.to-t.from>n.length+a;){if(e.sliceDoc(t.to-n.length,t.to)==n)return!1;t=t.firstChild}return!0}let l=i.to==t&&i.parent;if(!l)break;i=l}return!1}(e,s,t,i))return{changes:{insert:t+t,from:s},effects:vF.of(s+t.length),range:eD.cursor(s+t.length)}}return{range:o=r}});return o?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}(e,i,r.indexOf(i+i+i)>-1,n):function(e,t,n,r){let i=null,o=e.changeByRange(o=>{if(!o.empty)return{changes:[{insert:t,from:o.from},{insert:n,from:o.to}],effects:vF.of(o.to+t.length),range:eD.range(o.anchor+t.length,o.head+t.length)};let s=vJ(e.doc,o.head);return!s||/\s/.test(s)||r.indexOf(s)>-1?{changes:{insert:t+n,from:o.head},effects:vF.of(o.head+t.length),range:eD.cursor(o.head+t.length)}:{range:i=o}});return i?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}(e,i,o,n.before||vB.before);if(t==o&&vY(e,e.selection.main.from))return function(e,t,n){let r=null,i=e.changeByRange(t=>t.empty&&vJ(e.doc,t.head)==n?{changes:{from:t.head,to:t.head+n.length,insert:n},range:eD.cursor(t.head+n.length)}:r={range:t});return r?null:e.update(i,{scrollIntoView:!0,userEvent:"input.type"})}(e,0,o)}return null}(e.state,r);return!!o&&(e.dispatch(o),!0)}),vZ=[{key:"Backspace",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=vH(e,e.selection.main.head).brackets||vB.brackets,r=null,i=e.changeByRange(t=>{if(t.empty){let r=function(e,t){let n=e.sliceString(t-2,t);return ev(ey(n,0))==n.length?n:n.slice(1)}(e.doc,t.head);for(let i of n)if(i==r&&vJ(e.doc,t.head)==vU(ey(i,0)))return{changes:{from:t.head-i.length,to:t.head+i.length},range:eD.cursor(t.head-i.length)}}return{range:r=t}});return r||t(e.update(i,{scrollIntoView:!0,userEvent:"delete.backward"})),!r}}];function vY(e,t){let n=!1;return e.field(vV).between(0,e.doc.length,e=>{e==t&&(n=!0)}),n}function vJ(e,t){let n=e.sliceString(t,t+2);return n.slice(0,ev(ey(n,0)))}function vK(e,t){let n=mL(e).resolveInner(t+1);return n.parent&&n.from==t}function v0(e,t,n){let r=e.charCategorizer(t);if(r(e.sliceDoc(t-1,t))!=tn.Word)return t;for(let i of n){let n=t-i.length;if(e.sliceDoc(n,t)==i&&r(e.sliceDoc(n-1,n))!=tn.Word)return n}return -1}let v1=[{key:"Ctrl-Space",run:vv},{mac:"Alt-`",run:vv},{key:"Escape",run:e=>{let t=e.state.field(vm,!1);return!!(t&&t.active.some(e=>0!=e.state))&&(e.dispatch({effects:b4.of(null)}),!0)}},{key:"ArrowDown",run:vb(!0)},{key:"ArrowUp",run:vb(!1)},{key:"PageDown",run:vb(!0,"page")},{key:"PageUp",run:vb(!1,"page")},{key:"Enter",run:e=>{let t=e.state.field(vm,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(b9).interactionDelay)&&vg(e,t.open.options[t.open.selected])}}],v2=eQ.highest(fO.computeN([b9],e=>e.facet(b9).defaultKeymap?[v1]:[]));class v5{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class v3{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let r=e,i=n.facet(xr).markerFilter;i&&(r=i(r,n));let o=e.slice().sort((e,t)=>e.from-t.from||e.to-t.to),s=new tu,a=[],l=0;for(let e=0;;){let t,r,i=e==o.length?null:o[e];if(!i&&!a.length)break;for(a.length?(t=l,r=a.reduce((e,t)=>Math.min(e,t.to),i&&i.from>t?i.from:1e8)):(t=i.from,r=i.to,a.push(i),e++);e<o.length;){let n=o[e];if(n.from==t&&(n.to>n.from||n.to==t))a.push(n),e++,r=Math.min(n.to,r);else{r=Math.min(n.from,r);break}}let c=function(e){let t="hint",n=1;for(let i of e){var r;let e="error"==(r=i.severity)?4:"warning"==r?3:"info"==r?2:1;e>n&&(n=e,t=i.severity)}return t}(a);if(a.some(e=>e.from==e.to||e.from==e.to-1&&n.doc.lineAt(e.from).to==e.from))s.add(t,t,ut.widget({widget:new xs(c),diagnostics:a.slice()}));else{let e=a.reduce((e,t)=>t.markClass?e+" "+t.markClass:e,"");s.add(t,r,ut.mark({class:"cm-lintRange cm-lintRange-"+c+e,diagnostics:a.slice(),inclusiveEnd:a.some(e=>e.to>r)}))}l=r;for(let e=0;e<a.length;e++)a[e].to<=l&&a.splice(e--,1)}let c=s.finish();return new v3(c,t,v4(c))}}function v4(e,t=null,n=0){let r=null;return e.between(n,1e9,(e,n,{spec:i})=>{if(!(t&&0>i.diagnostics.indexOf(t))){if(r){if(0>i.diagnostics.indexOf(r.diagnostic))return!1;r=new v5(r.from,n,r.diagnostic)}else r=new v5(e,n,t||i.diagnostics[0])}}),r}let v6=e6.define(),v8=e6.define(),v9=e6.define(),v7=ez.define({create:()=>new v3(ut.none,null,null),update(e,t){if(t.docChanged&&e.diagnostics.size){let n=e.diagnostics.map(t.changes),r=null,i=e.panel;if(e.selected){let i=t.changes.mapPos(e.selected.from,1);r=v4(n,e.selected.diagnostic,i)||v4(n,null,i)}!n.size&&i&&t.state.facet(xr).autoPanel&&(i=null),e=new v3(n,i,r)}for(let n of t.effects)if(n.is(v6)){let r=t.state.facet(xr).autoPanel?n.value.length?xl.open:null:e.panel;e=v3.init(n.value,r,t.state)}else n.is(v8)?e=new v3(e.diagnostics,n.value?xl.open:null,e.selected):n.is(v9)&&(e=new v3(e.diagnostics,e.panel,n.value));return e},provide:e=>[pv.from(e,e=>e.panel),fm.decorations.from(e,e=>e.diagnostics)]}),xe=ut.mark({class:"cm-lintRange cm-lintRange-active"}),xt=e=>{let t=e.state.field(v7,!1);return!!t&&!!t.panel&&(e.dispatch({effects:v8.of(!1)}),!0)},xn=[{key:"Mod-Shift-m",run:e=>{let t=e.state.field(v7,!1);t&&t.panel||e.dispatch({effects:function(e,t){return e.field(v7,!1)?t:t.concat(e6.appendConfig.of(xu))}(e.state,[v8.of(!0)])});let n=pm(e,xl.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:e=>{let t=e.state.field(v7,!1);if(!t)return!1;let n=e.state.selection.main,r=t.diagnostics.iter(n.to+1);return(!!r.value||!!(r=t.diagnostics.iter(0)).value&&(r.from!=n.from||r.to!=n.to))&&(e.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)}}],xr=eP.define({combine:e=>Object.assign({sources:e.map(e=>e.source).filter(e=>null!=e)},to(e.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))});function xi(e){let t=[];if(e)e:for(let{name:n}of e){for(let e=0;e<n.length;e++){let r=n[e];if(/[a-zA-Z]/.test(r)&&!t.some(e=>e.toLowerCase()==r.toLowerCase())){t.push(r);continue e}}t.push("")}return t}function xo(e,t,n){var r;let i=n?xi(t.actions):[];return y1("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},y1("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(e):t.message),null===(r=t.actions)||void 0===r?void 0:r.map((n,r)=>{let o=!1,s=r=>{if(r.preventDefault(),o)return;o=!0;let i=v4(e.state.field(v7).diagnostics,t);i&&n.apply(e,i.from,i.to)},{name:a}=n,l=i[r]?a.indexOf(i[r]):-1,c=l<0?a:[a.slice(0,l),y1("u",a.slice(l,l+1)),a.slice(l+1)];return y1("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":` Action: ${a}${l<0?"":` (access key "${i[r]})"`}.`},c)}),t.source&&y1("div",{class:"cm-diagnosticSource"},t.source))}class xs extends h7{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return y1("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class xa{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(0xffffffff*Math.random()).toString(16),this.dom=xo(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class xl{constructor(e){this.view=e,this.items=[],this.list=y1("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t=>{if(27==t.keyCode)xt(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65)||!(t.keyCode<=90)||!(this.selectedIndex>=0))return;let{diagnostic:n}=this.items[this.selectedIndex],r=xi(n.actions);for(let i=0;i<r.length;i++)if(r[i].toUpperCase().charCodeAt(0)==t.keyCode){let t=v4(this.view.state.field(v7).diagnostics,n);t&&n.actions[i].apply(e,t.from,t.to)}}t.preventDefault()},onclick:e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)}}),this.dom=y1("div",{class:"cm-panel-lint"},this.list,y1("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>xt(this.view)},"\xd7")),this.update()}get selectedIndex(){let e=this.view.state.field(v7).selected;if(!e)return -1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return -1}update(){let{diagnostics:e,selected:t}=this.view.state.field(v7),n=0,r=!1,i=null,o=new Set;for(e.between(0,this.view.state.doc.length,(e,s,{spec:a})=>{for(let e of a.diagnostics){if(o.has(e))continue;o.add(e);let s=-1,a;for(let t=n;t<this.items.length;t++)if(this.items[t].diagnostic==e){s=t;break}s<0?(a=new xa(this.view,e),this.items.splice(n,0,a),r=!0):(a=this.items[s],s>n&&(this.items.splice(n,s-n),r=!0)),t&&a.diagnostic==t.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),i=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();0==this.items.length&&(this.items.push(new xa(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),i?(this.list.setAttribute("aria-activedescendant",i.id),this.view.requestMeasure({key:this,read:()=>({sel:i.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{let n=t.height/this.list.offsetHeight;e.top<t.top?this.list.scrollTop-=(t.top-e.top)/n:e.bottom>t.bottom&&(this.list.scrollTop+=(e.bottom-t.bottom)/n)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=v4(this.view.state.field(v7).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:v9.of(t)})}static open(e){return new xl(e)}}function xc(e){return function(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}let xh=fm.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:xc("#d11")},".cm-lintRange-warning":{backgroundImage:xc("orange")},".cm-lintRange-info":{backgroundImage:xc("#999")},".cm-lintRange-hint":{backgroundImage:xc("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),xu=[v7,fm.decorations.compute([v7],e=>{let{selected:t,panel:n}=e.field(v7);return t&&n&&t.from!=t.to?ut.set([xe.range(t.from,t.to)]):ut.none}),function(e,t={}){let n=e6.define(),r=ez.define({create:()=>[],update(e,r){if(e.length&&(t.hideOnChange&&(r.docChanged||r.selection)?e=[]:t.hideOn&&(e=e.filter(e=>!t.hideOn(r,e))),r.docChanged)){let t=[];for(let n of e){let e=r.changes.mapPos(n.pos,-1,ew.TrackDel);if(null!=e){let i=Object.assign(Object.create(null),n);i.pos=e,null!=i.end&&(i.end=r.changes.mapPos(i.end)),t.push(i)}}e=t}for(let t of r.effects)t.is(n)&&(e=t.value),t.is(pf)&&(e=[]);return e},provide:e=>pl.from(e)});return{active:r,extension:[r,uU.define(i=>new pu(i,e,r,n,t.hoverTime||300)),ph]}}(function(e,t,n){let{diagnostics:r}=e.state.field(v7),i,o=-1,s=-1;r.between(t-(n<0?1:0),t+(n>0?1:0),(e,r,{spec:a})=>{if(t>=e&&t<=r&&(e==r||(t>e||n>0)&&(t<r||n<0)))return i=a.diagnostics,o=e,s=r,!1});let a=e.state.facet(xr).tooltipFilter;return i&&a&&(i=a(i,e.state)),i?{pos:o,end:s,above:e.state.doc.lineAt(o).to<s,create:()=>({dom:y1("ul",{class:"cm-tooltip-lint"},i.map(t=>xo(e,t,!1)))})}:null},{hideOn:function(e,t){let n=t.pos,r=t.end||n,i=e.state.facet(xr).hideOn(e,n,r);if(null!=i)return i;let o=e.startState.doc.lineAt(t.pos);return!!(e.effects.some(e=>e.is(v6))||e.changes.touchesRange(o.from,Math.max(o.to,r)))}}),xh];var xd=function(e){let t;void 0===e&&(e={});var{crosshairCursor:n=!1}=e,r=[];!1!==e.closeBracketsKeymap&&(r=r.concat(vZ)),!1!==e.defaultKeymap&&(r=r.concat(yK)),!1!==e.searchKeymap&&(r=r.concat(bB)),!1!==e.historyKeymap&&(r=r.concat(yn)),!1!==e.foldKeymap&&(r=r.concat(gl)),!1!==e.completionKeymap&&(r=r.concat(v1)),!1!==e.lintKeymap&&(r=r.concat(xn));var i=[];return!1!==e.lineNumbers&&i.push(function(e={}){return[pP.of(e),[pT],p$]}()),!1!==e.highlightActiveLineGutter&&i.push(pz),!1!==e.highlightSpecialChars&&i.push(function(e={}){return[fJ.of(e),fK||(fK=uU.fromClass(class{constructor(e){this.view=e,this.decorations=ut.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(fJ)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new fH({regexp:e.specialChars,decoration:(t,n,r)=>{let{doc:i}=n.state,o=ey(t[0],0);if(9==o){let e=i.lineAt(r),t=n.state.tabSize,o=tk(e.text,t,r-e.from);return ut.replace({widget:new f1((t-o%t)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[o]||(this.decorationCache[o]=ut.replace({widget:new f0(e,o)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(fJ);e.startState.facet(fJ)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))]}()),!1!==e.history&&i.push(function(e={}){return[gJ,gY.of(e),fm.domEventHandlers({beforeinput(e,t){let n="historyUndo"==e.inputType?g0:"historyRedo"==e.inputType?g1:null;return!!n&&(e.preventDefault(),n(t))}})]}()),!1!==e.foldGutter&&i.push(function(e={}){var t;let n=Object.assign(Object.assign({},gp),e),r=new gm(n,!0),i=new gm(n,!1),o=uU.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(mH)!=e.state.facet(mH)||e.startState.field(gi,!1)!=e.state.field(gi,!1)||mL(e.startState)!=mL(e.state)||n.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new tu;for(let n of e.viewportLineBlocks){let o=go(e.state,n.from,n.to)?i:m7(e.state,n.from,n.to)?r:null;o&&t.add(n.from,n.from,o)}return t.finish()}}),{domEventHandlers:s}=n;return[o,(t={class:"cm-foldGutter",markers(e){var t;return(null===(t=e.plugin(o))||void 0===t?void 0:t.markers)||th.empty},initialSpacer:()=>new gm(n,!1),domEventHandlers:Object.assign(Object.assign({},s),{click:(e,t,n)=>{if(s.click&&s.click(e,t,n))return!0;let r=go(e.state,t.from,t.to);if(r)return e.dispatch({effects:gn.of(r)}),!0;let i=m7(e.state,t.from,t.to);return!!i&&(e.dispatch({effects:gt.of(i)}),!0)}})},[[pT],pS.of(Object.assign(Object.assign({},pO),t))]),[gi,gg]]}()),!1!==e.drawSelection&&i.push(function(e={}){return[fI.of(e),fL,fz,fF,u$.of(!0)]}()),!1!==e.dropCursor&&i.push([fV,fW]),!1!==e.allowMultipleSelections&&i.push(ti.allowMultipleSelections.of(!0)),!1!==e.indentOnInput&&i.push(ti.transactionFilter.of(e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let n=e.newDoc,{head:r}=e.newSelection.main,i=n.lineAt(r);if(r>i.from+200)return e;let o=n.sliceString(i.from,r);if(!t.some(e=>e.test(o)))return e;let{state:s}=e,a=-1,l=[];for(let{head:e}of s.selection.ranges){let t=s.doc.lineAt(e);if(t.from==a)continue;a=t.from;let n=mK(s,t.from);if(null==n)continue;let r=/^\s*/.exec(t.text)[0],i=mJ(s,n);r!=i&&l.push({from:t.from,to:t.from+r.length,insert:i})}return l.length?[e,{changes:l,sequential:!0}]:e})),!1!==e.syntaxHighlighting&&i.push(gw(gS,{fallback:!0})),!1!==e.bracketMatching&&i.push(function(e={}){return[gA.of(e),gD]}()),!1!==e.closeBrackets&&i.push([vX,vV]),!1!==e.autocompletion&&i.push(function(e={}){return[vO,vm,b9.of(e),vw,v2,vS]}()),!1!==e.rectangularSelection&&i.push((t=e=>e.altKey&&0==e.button,fm.mouseSelectionStyle.of((e,n)=>{let r,i;return t(n)?(r=f4(e,n),i=e.state.selection,r?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(r.line).from),n=e.state.doc.lineAt(t);r={line:n.number,col:r.col,off:Math.min(r.off,n.length)},i=i.map(e.changes)}},get(t,n,o){let s=f4(e,t);if(!s)return i;let a=function(e,t,n){let r=Math.min(t.line,n.line),i=Math.max(t.line,n.line),o=[];if(t.off>2e3||n.off>2e3||t.col<0||n.col<0){let s=Math.min(t.off,n.off),a=Math.max(t.off,n.off);for(let t=r;t<=i;t++){let n=e.doc.line(t);n.length<=a&&o.push(eD.range(n.from+s,n.to+a))}}else{let s=Math.min(t.col,n.col),a=Math.max(t.col,n.col);for(let t=r;t<=i;t++){let n=e.doc.line(t),r=tO(n.text,s,e.tabSize,!0);if(r<0)o.push(eD.cursor(n.to));else{let t=tO(n.text,a,e.tabSize);o.push(eD.range(n.from+r,n.from+t))}}}return o}(e.state,r,s);return a.length?o?eD.create(a.concat(i.ranges)):eD.create(a):i}}:null):null}))),!1!==n&&i.push(function(e={}){let[t,n]=f6[e.key||"Alt"],r=uU.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==t||n(e))},keyup(e){e.keyCode!=t&&n(e)||this.set(!1)},mousemove(e){this.set(n(e))}}});return[r,fm.contentAttributes.of(e=>{var t;return!(null===(t=e.plugin(r))||void 0===t)&&t.isDown?f8:null})]}()),!1!==e.highlightActiveLine&&i.push(f5),!1!==e.highlightSelectionMatches&&i.push([bu,bh]),e.tabSize&&"number"==typeof e.tabSize&&i.push(mZ.of(" ".repeat(e.tabSize))),i.concat([fO.of(r.flat())]).filter(Boolean)};let xf="#e06c75",xp="#abb2bf",xm="#7d8799",xg="#d19a66",xy="#2c313a",xb="#282c34",xv="#353a42",xx="#528bff",xw=[fm.theme({"&":{color:xp,backgroundColor:xb},".cm-content":{caretColor:xx},".cm-cursor, .cm-dropCursor":{borderLeftColor:xx},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:xp},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:xb,color:xm,border:"none"},".cm-activeLineGutter":{backgroundColor:xy},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:xv},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:xv,borderBottomColor:xv},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:xy,color:xp}}},{dark:!0}),gw(gy.define([{tag:mN.keyword,color:"#c678dd"},{tag:[mN.name,mN.deleted,mN.character,mN.propertyName,mN.macroName],color:xf},{tag:[mN.function(mN.variableName),mN.labelName],color:"#61afef"},{tag:[mN.color,mN.constant(mN.name),mN.standard(mN.name)],color:xg},{tag:[mN.definition(mN.name),mN.separator],color:xp},{tag:[mN.typeName,mN.className,mN.number,mN.changed,mN.annotation,mN.modifier,mN.self,mN.namespace],color:"#e5c07b"},{tag:[mN.operator,mN.operatorKeyword,mN.url,mN.escape,mN.regexp,mN.link,mN.special(mN.string)],color:"#56b6c2"},{tag:[mN.meta,mN.comment],color:xm},{tag:mN.strong,fontWeight:"bold"},{tag:mN.emphasis,fontStyle:"italic"},{tag:mN.strikethrough,textDecoration:"line-through"},{tag:mN.link,color:xm,textDecoration:"underline"},{tag:mN.heading,fontWeight:"bold",color:xf},{tag:[mN.atom,mN.bool,mN.special(mN.variableName)],color:xg},{tag:[mN.processingInstruction,mN.string,mN.inserted],color:"#98c379"},{tag:mN.invalid,color:"#ffffff"}]))];var xk=fm.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),xO=function(e){void 0===e&&(e={});var{indentWithTab:t=!0,editable:n=!0,readOnly:r=!1,theme:i="light",placeholder:o="",basicSetup:s=!0}=e,a=[];switch(t&&a.unshift(fO.of([y0])),s&&("boolean"==typeof s?a.unshift(xd()):a.unshift(xd(s))),o&&a.unshift(uU.fromClass(class{constructor(e){this.view=e,this.placeholder=o?ut.set([ut.widget({widget:new f3(o),side:1}).range(0)]):ut.none}get decorations(){return this.view.state.doc.length?ut.none:this.placeholder}},{decorations:e=>e.decorations})),i){case"light":a.push(xk);break;case"dark":a.push(xw);break;case"none":break;default:a.push(i)}return!1===n&&a.push(fm.editable.of(!1)),r&&a.push(ti.readOnly.of(!0)),[...a]},xS=e=>({line:e.state.doc.lineAt(e.state.selection.main.from),lineCount:e.state.doc.lines,lineBreak:e.state.lineBreak,length:e.state.doc.length,readOnly:e.state.readOnly,tabSize:e.state.tabSize,selection:e.state.selection,selectionAsSingle:e.state.selection.asSingle().main,ranges:e.state.selection.ranges,selectionCode:e.state.sliceDoc(e.state.selection.main.from,e.state.selection.main.to),selections:e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to)),selectedText:e.state.selection.ranges.some(e=>!e.empty)}),xC=e5.define(),xT=[],xA=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],xE=(0,C.forwardRef)((e,t)=>{var{className:n,value:r="",selection:i,extensions:o=[],onChange:s,onStatistics:a,onCreateEditor:l,onUpdate:c,autoFocus:h,theme:u="light",height:d,minHeight:f,maxHeight:p,width:m,minWidth:g,maxWidth:y,basicSetup:b,placeholder:v,indentWithTab:x,editable:w,readOnly:k,root:O,initialState:T}=e,A=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,xA),E=(0,C.useRef)(null),{state:M,view:_,container:D}=function(e){var{value:t,selection:n,onChange:r,onStatistics:i,onCreateEditor:o,onUpdate:s,extensions:a=xT,autoFocus:l,theme:c="light",height:h=null,minHeight:u=null,maxHeight:d=null,width:f=null,minWidth:p=null,maxWidth:m=null,placeholder:g="",editable:y=!0,readOnly:b=!1,indentWithTab:v=!0,basicSetup:x=!0,root:w,initialState:k}=e,[O,S]=(0,C.useState)(),[T,A]=(0,C.useState)(),[E,M]=(0,C.useState)(),_=fm.theme({"&":{height:h,minHeight:u,maxHeight:d,width:f,minWidth:p,maxWidth:m},"& .cm-scroller":{height:"100% !important"}}),D=[fm.updateListener.of(e=>{e.docChanged&&"function"==typeof r&&!e.transactions.some(e=>e.annotation(xC))&&r(e.state.doc.toString(),e),i&&i(xS(e))}),_,...xO({theme:c,editable:y,readOnly:b,placeholder:g,indentWithTab:v,basicSetup:x})];return s&&"function"==typeof s&&D.push(fm.updateListener.of(s)),D=D.concat(a),(0,C.useEffect)(()=>{if(O&&!E){var e={doc:t,selection:n,extensions:D},r=k?ti.fromJSON(k.json,e,k.fields):ti.create(e);if(M(r),!T){var i=new fm({state:r,parent:O,root:w});A(i),o&&o(i,r)}}return()=>{T&&(M(void 0),A(void 0))}},[O,E]),(0,C.useEffect)(()=>S(e.container),[e.container]),(0,C.useEffect)(()=>()=>{T&&(T.destroy(),A(void 0))},[T]),(0,C.useEffect)(()=>{l&&T&&T.focus()},[l,T]),(0,C.useEffect)(()=>{T&&T.dispatch({effects:e6.reconfigure.of(D)})},[c,a,h,u,d,f,p,m,g,y,b,v,x,r,s]),(0,C.useEffect)(()=>{if(void 0!==t){var e=T?T.state.doc.toString():"";T&&t!==e&&T.dispatch({changes:{from:0,to:e.length,insert:t||""},annotations:[xC.of(!0)]})}},[t,T]),{state:E,setState:M,view:T,setView:A,container:O,setContainer:S}}({container:E.current,root:O,value:r,autoFocus:h,theme:u,height:d,minHeight:f,maxHeight:p,width:m,minWidth:g,maxWidth:y,basicSetup:b,placeholder:v,indentWithTab:x,editable:w,readOnly:k,selection:i,onChange:s,onStatistics:a,onCreateEditor:l,onUpdate:c,extensions:o,initialState:T});if((0,C.useImperativeHandle)(t,()=>({editor:E.current,state:M,view:_}),[E,D,M,_]),"string"!=typeof r)throw Error("value must be typeof string but got "+typeof r);var N="string"==typeof u?"cm-theme-"+u:"cm-theme";return S.j.jsx("div",he({ref:E,className:""+N+(n?" "+n:"")},A))});xE.displayName="CodeMirror";class xM{constructor(e,t,n,r,i,o,s,a,l,c=0,h){this.p=e,this.stack=t,this.state=n,this.reducePos=r,this.pos=i,this.score=o,this.buffer=s,this.bufferBase=a,this.curContext=l,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let r=e.parser.context;return new xM(e,[],t,n,n,0,[],0,r?new x_(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,r=65535&e,{parser:i}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let s=i.dynamicPrecedence(r);if(s&&(this.score+=s),0==n){this.pushState(i.getGoto(this.state,r,!0),this.reducePos),r<i.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(r,this.reducePos);return}let a=this.stack.length-(n-1)*3-(262144&e?6:0),l=a?this.stack[a-2]:this.p.ranges[0].from,c=this.reducePos-l;c>=2e3&&!(!(null===(t=this.p.parser.nodeSet.types[r])||void 0===t)&&t.isAnonymous)&&(l==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=l,this.p.lastBigReductionSize=c));let h=a?this.stack[a-1]:0,u=this.bufferBase+this.buffer.length-h;if(r<i.minRepeatTerm||131072&e){let e=i.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,l,e,u+4,!0)}if(262144&e)this.state=this.stack[a];else{let e=this.stack[a-3];this.state=i.getGoto(e,r,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(r,l)}storeNode(e,t,n,r=4,i=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,r=this.buffer.length;if(0==r&&e.parent&&(r=e.bufferBase-e.parent.bufferBase,e=e.parent),r>0&&0==e.buffer[r-4]&&e.buffer[r-1]>-1){if(t==n)return;if(e.buffer[r-2]>=t){e.buffer[r-2]=n;return}}}if(i&&this.pos!=n){let i=this.buffer.length;if(i>0&&0!=this.buffer[i-4]){let e=!1;for(let t=i;t>0&&this.buffer[t-2]>n;t-=4)if(this.buffer[t-1]>=0){e=!0;break}if(e)for(;i>0&&this.buffer[i-2]>n;)this.buffer[i]=this.buffer[i-4],this.buffer[i+1]=this.buffer[i-3],this.buffer[i+2]=this.buffer[i-2],this.buffer[i+3]=this.buffer[i-1],i-=4,r>4&&(r-=4)}this.buffer[i]=e,this.buffer[i+1]=t,this.buffer[i+2]=n,this.buffer[i+3]=r}else this.buffer.push(e,t,n,r)}shift(e,t,n,r){if(131072&e)this.pushState(65535&e,this.pos);else if(262144&e)this.pos=r,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,r,4);else{let{parser:i}=this.p;(r>this.pos||t<=i.maxNode)&&(this.pos=r,i.stateFlag(e,1)||(this.reducePos=r)),this.pushState(e,n),this.shiftContext(t,n),t<=i.maxNode&&this.buffer.push(t,n,r,4)}}apply(e,t,n,r){65536&e?this.reduce(e):this.shift(e,t,n,r)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new xM(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new xD(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==n)return!1;if(!(65536&n))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let r=0,i;r<t.length;r+=2)(i=t[r+1])!=this.state&&this.p.parser.hasAction(i,e)&&n.push(t[r],i);if(this.stack.length<120)for(let e=0;n.length<8&&e<t.length;e+=2){let r=t[e+1];n.some((e,t)=>1&t&&e==r)||n.push(t[e],r)}t=n}let n=[];for(let e=0;e<t.length&&n.length<4;e+=2){let r=t[e+1];if(r==this.state)continue;let i=this.split();i.pushState(r,this.pos),i.storeNode(0,i.pos,i.pos,4,!0),i.shiftContext(t[e],this.pos),i.reducePos=this.pos,i.score-=200,n.push(i)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(65536&t))return!1;if(!e.validAction(this.state,t)){let n=t>>19,r=65535&t,i=this.stack.length-3*n;if(i<0||0>e.getGoto(this.stack[i],r,!1)){let e=this.findForcedReduction();if(null==e)return!1;t=e}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(r,i)=>{if(!t.includes(r))return t.push(r),e.allActions(r,t=>{if(!(393216&t)){if(65536&t){let n=(t>>19)-i;if(n>1){let r=65535&t,i=this.stack.length-3*n;if(i>=0&&e.getGoto(this.stack[i],r,!1)>=0)return n<<19|65536|r}}else{let e=n(t,i+1);if(null!=e)return e}}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new x_(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class x_{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class xD{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e>>19;0==t?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(t-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],65535&e,!0);this.state=n}}class xN{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new xN(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new xN(this.stack,this.pos,this.index)}}function xR(e,t=Uint16Array){if("string"!=typeof e)return e;let n=null;for(let r=0,i=0;r<e.length;){let o=0;for(;;){let t=e.charCodeAt(r++),n=!1;if(126==t){o=65535;break}t>=92&&t--,t>=34&&t--;let i=t-32;if(i>=46&&(i-=46,n=!0),o+=i,n)break;o*=46}n?n[i++]=o:n=new t(o)}return n}class xP{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}let xj=new xP;class xI{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=xj,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,r=this.rangeIndex,i=this.pos+e;for(;i<n.from;){if(!r)return null;let e=this.ranges[--r];i-=n.from-e.to,n=e}for(;t<0?i>n.to:i>=n.to;){if(r==this.ranges.length-1)return null;let e=this.ranges[++r];i+=e.from-n.to,n=e}return i}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,r;if(t>=0&&t<this.chunk.length)n=this.pos+e,r=this.chunk.charCodeAt(t);else{let t=this.resolveOffset(e,1);if(null==t)return -1;if((n=t)>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let e=this.rangeIndex,t=this.range;for(;t.to<=n;)t=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>t.to&&(this.chunk2=this.chunk2.slice(0,t.to-n)),r=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),r}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(null==n||n<this.token.start)throw RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=xj,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(n+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return n}}class x${constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;!function(e,t,n,r,i,o){let s=0,a=1<<r,{dialect:l}=n.p.parser;e:for(;a&e[s];){let n=e[s+1];for(let r=s+3;r<n;r+=2)if((e[r+1]&a)>0){let n=e[r];if(l.allows(n)&&(-1==t.token.value||t.token.value==n||function(e,t,n,r){let i=xq(n,r,t);return i<0||xq(n,r,e)<i}(n,t.token.value,i,o))){t.acceptToken(n);break}}let r=t.next,c=0,h=e[s+2];if(t.next<0&&h>c&&65535==e[n+3*h-3]){s=e[n+3*h-1];continue}for(;c<h;){let i=c+h>>1,o=n+i+(i<<1),a=e[o],l=e[o+1]||65536;if(r<a)h=i;else if(r>=l)c=i+1;else{s=e[o+2],t.advance();continue e}}break}}(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}x$.prototype.contextual=x$.prototype.fallback=x$.prototype.extend=!1,x$.prototype.fallback=x$.prototype.extend=!1;class xL{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function xq(e,t,n){for(let r=t,i;65535!=(i=e[r]);r++)if(i==n)return r-t;return -1}let xz="u">typeof A&&A.env&&/\bparse\b/.test(A.env.LOG),xB=null;function xF(e,t,n){let r=e.cursor(d.IncludeAnonymous);for(r.moveTo(t);;)if(!(n<0?r.childBefore(t):r.childAfter(t)))for(;;){if((n<0?r.to<t:r.from>t)&&!r.type.isError)return n<0?Math.max(0,Math.min(r.to-1,t-25)):Math.min(e.length,Math.max(r.from+1,t+25));if(n<0?r.prevSibling():r.nextSibling())break;if(!r.parent())return n<0?0:e.length}}class xQ{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?xF(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?xF(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],r=this.index[t];if(r==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let i=n.children[r],o=this.start[t]+n.positions[r];if(o>e)return this.nextStart=o,null;if(i instanceof pZ){if(o==e){if(o<this.safeFrom)return null;let e=o+i.length;if(e<=this.safeTo){let t=i.prop(pQ.lookAhead);if(!t||e+t<this.fragment.to)return i}}this.index[t]++,o+i.length>=Math.max(this.safeFrom,e)&&(this.trees.push(i),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+i.length}}}class xV{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(e=>new xP)}getActions(e){let t=0,n=null,{parser:r}=e.p,{tokenizers:i}=r,o=r.stateSlot(e.state,3),s=e.curContext?e.curContext.hash:0,a=0;for(let r=0;r<i.length;r++){if(!(1<<r&o))continue;let l=i[r],c=this.tokens[r];if(!(n&&!l.fallback)&&((l.contextual||c.start!=e.pos||c.mask!=o||c.context!=s)&&(this.updateCachedToken(c,l,e),c.mask=o,c.context=s),c.lookAhead>c.end+25&&(a=Math.max(c.lookAhead,a)),0!=c.value)){let r=t;if(c.extended>-1&&(t=this.addActions(e,c.extended,c.end,t)),t=this.addActions(e,c.value,c.end,t),!l.extend&&(n=c,t>r))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),n||e.pos!=this.stream.end||((n=new xP).value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new xP,{pos:n,p:r}=e;return t.start=n,t.end=Math.min(n+1,r.stream.end),t.value=n==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,n){let r=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(r,e),n),e.value>-1){let{parser:t}=n.p;for(let r=0;r<t.specialized.length;r++)if(t.specialized[r]==e.value){let i=t.specializers[r](this.stream.read(e.start,e.end),n);if(i>=0&&n.p.parser.dialect.allows(i>>1)){1&i?e.extended=i>>1:e.value=i>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,t,n,r){for(let t=0;t<r;t+=3)if(this.actions[t]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=n,r}addActions(e,t,n,r){let{state:i}=e,{parser:o}=e.p,{data:s}=o;for(let e=0;e<2;e++)for(let a=o.stateSlot(i,e?2:1);;a+=3){if(65535==s[a]){if(1==s[a+1])a=xY(s,a+2);else{0==r&&2==s[a+1]&&(r=this.putAction(xY(s,a+2),t,n,r));break}}s[a]==t&&(r=this.putAction(xY(s,a+1),t,n,r))}return r}}class xW{constructor(e,t,n,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new xI(t,r),this.tokens=new xV(e,this.stream),this.topTerm=e.top[1];let{from:i}=r[0];this.stacks=[xM.start(this,e.top[0],i)],this.fragments=n.length&&this.stream.end-i>4*e.bufferLength?new xQ(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],r,i;if(this.bigReductionCount>300&&1==e.length){let[t]=e;for(;t.forceReduce()&&t.stack.length&&t.stack[t.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let s=e[o];for(;;){if(this.tokens.mainToken=null,s.pos>t)n.push(s);else{if(this.advanceStack(s,n,e))continue;{r||(r=[],i=[]),r.push(s);let e=this.tokens.getMainToken(s);i.push(e.value,e.end)}}break}}if(!n.length){let e=r&&function(e){let t=null;for(let n of e){let e=n.p.stoppedAt;(n.pos==n.p.stream.end||null!=e&&n.pos>e)&&n.p.parser.stateFlag(n.state,2)&&(!t||t.score<n.score)&&(t=n)}return t}(r);if(e)return xz&&console.log("Finish with "+this.stackID(e)),this.stackToTree(e);if(this.parser.strict)throw xz&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&r){let e=null!=this.stoppedAt&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,i,n);if(e)return xz&&console.log("Force-finish "+this.stackID(e)),this.stackToTree(e.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(n.length>e)for(n.sort((e,t)=>t.score-e.score);n.length>e;)n.pop();n.some(e=>e.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let e=0;e<n.length-1;e++){let t=n[e];for(let r=e+1;r<n.length;r++){let i=n[r];if(t.sameState(i)||t.buffer.length>500&&i.buffer.length>500){if((t.score-i.score||t.buffer.length-i.buffer.length)>0)n.splice(r--,1);else{n.splice(e--,1);continue e}}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let e=1;e<n.length;e++)n[e].pos<this.minStackPos&&(this.minStackPos=n[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let r=e.pos,{parser:i}=this,o=xz?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,n=t?e.curContext.hash:0;for(let s=this.fragments.nodeAt(r);s;){let r=this.parser.nodeSet.types[s.type.id]==s.type?i.getGoto(e.state,s.type.id):-1;if(r>-1&&s.length&&(!t||(s.prop(pQ.contextHash)||0)==n))return e.useNode(s,r),xz&&console.log(o+this.stackID(e)+` (via reuse of ${i.getName(s.type.id)})`),!0;if(!(s instanceof pZ)||0==s.children.length||s.positions[0]>0)break;let a=s.children[0];if(a instanceof pZ&&0==s.positions[0])s=a;else break}}let s=i.stateSlot(e.state,4);if(s>0)return e.reduce(s),xz&&console.log(o+this.stackID(e)+` (via always-reduce ${i.getName(65535&s)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let s=0;s<a.length;){let l=a[s++],c=a[s++],h=a[s++],u=s==a.length||!n,d=u?e:e.split(),f=this.tokens.mainToken;if(d.apply(l,c,f?f.start:d.pos,h),xz&&console.log(o+this.stackID(d)+` (via ${65536&l?`reduce of ${i.getName(65535&l)}`:"shift"} for ${i.getName(c)} @ ${r}${d==e?"":", split"})`),u)return!0;d.pos>r?t.push(d):n.push(d)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return xU(e,t),!0}}runRecovery(e,t,n){let r=null,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=t[o<<1],l=t[(o<<1)+1],c=xz?this.stackID(s)+" -> ":"";if(s.deadEnd&&(i||(i=!0,s.restart(),xz&&console.log(c+this.stackID(s)+" (restarted)"),this.advanceFully(s,n))))continue;let h=s.split(),u=c;for(let e=0;h.forceReduce()&&e<10&&(xz&&console.log(u+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,n));e++)xz&&(u=this.stackID(h)+" -> ");for(let e of s.recoverByInsert(a))xz&&console.log(c+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,n);this.stream.end>s.pos?(l==s.pos&&(l++,a=0),s.recoverByDelete(a,l),xz&&console.log(c+this.stackID(s)+` (via recover-delete ${this.parser.getName(a)})`),xU(s,n)):(!r||r.score<s.score)&&(r=s)}return r}stackToTree(e){return e.close(),pZ.build({buffer:xN.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(xB||(xB=new WeakMap)).get(e);return t||xB.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function xU(e,t){for(let n=0;n<t.length;n++){let r=t[n];if(r.pos==e.pos&&r.sameState(e)){t[n].score<e.score&&(t[n]=e);return}}t.push(e)}class xH{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||0==this.disabled[e]}}let xG=e=>e;class xX{constructor(e){this.start=e.start,this.shift=e.shift||xG,this.reduce=e.reduce||xG,this.reuse=e.reuse||xG,this.hash=e.hash||(()=>0),this.strict=!1!==e.strict}}class xZ extends ms{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let n=0;n<e.repeatNodeCount;n++)t.push("");let n=Object.keys(e.topRules).map(t=>e.topRules[t][1]),r=[];for(let e=0;e<t.length;e++)r.push([]);function i(e,t,n){r[e].push([t,t.deserialize(String(n))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=pQ[e]);for(let n=1;n<t.length;){let r=t[n++];if(r>=0)i(r,e,t[n++]);else{let o=t[n+-r];for(let s=-r;s>0;s--)i(t[n++],e,o);n++}}}this.nodeSet=new pH(t.map((t,i)=>pU.define({name:i>=this.minRepeatTerm?void 0:t,id:i,props:r[i],top:n.indexOf(i)>-1,error:0==i,skipped:e.skippedNodes&&e.skippedNodes.indexOf(i)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=1024;let o=xR(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let e=0;e<this.specializerSpecs.length;e++)this.specialized[e]=this.specializerSpecs[e].term;this.specializers=this.specializerSpecs.map(xJ),this.states=xR(e.states,Uint32Array),this.data=xR(e.stateData),this.goto=xR(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(e=>"number"==typeof e?new x$(o,e):e),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let r=new xW(this,e,t,n);for(let i of this.wrappers)r=i(r,e,t,n);return r}getGoto(e,t,n=!1){let r=this.goto;if(t>=r[0])return -1;for(let i=r[t+1];;){let t=r[i++],o=1&t,s=r[i++];if(o&&n)return s;for(let n=i+(t>>1);i<n;i++)if(r[i]==e)return s;if(o)return -1}}hasAction(e,t){let n=this.data;for(let r=0;r<2;r++)for(let i=this.stateSlot(e,r?2:1),o;;i+=3){if(65535==(o=n[i])){if(1==n[i+1])o=n[i=xY(n,i+2)];else{if(2==n[i+1])return xY(n,i+2);break}}if(o==t||0==o)return xY(n,i+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,e=>e==t||null)}allActions(e,t){let n=this.stateSlot(e,4),r=n?t(n):void 0;for(let n=this.stateSlot(e,1);null==r;n+=3){if(65535==this.data[n]){if(1==this.data[n+1])n=xY(this.data,n+2);else break}r=t(xY(this.data,n+1))}return r}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1==this.data[n+1])n=xY(this.data,n+2);else break}if(!(1&this.data[n+2])){let e=this.data[n+1];t.some((t,n)=>1&n&&t==e)||t.push(this.data[n],e)}}return t}configure(e){let t=Object.assign(Object.create(xZ.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(t=>{let n=e.tokenizers.find(e=>e.from==t);return n?n.to:t})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,r)=>{let i=e.specializers.find(e=>e.from==n.external);if(!i)return n;let o=Object.assign(Object.assign({},n),{external:i.to});return t.specializers[r]=xJ(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let r of e.split(" ")){let e=t.indexOf(r);e>=0&&(n[e]=!0)}let r=null;for(let e=0;e<t.length;e++)if(!n[e])for(let n=this.dialects[t[e]],i;65535!=(i=this.data[n++]);)(r||(r=new Uint8Array(this.maxTerm+1)))[i]=1;return new xH(e,n,r)}static deserialize(e){return new xZ(e)}}function xY(e,t){return e[t]|e[t+1]<<16}function xJ(e){if(e.external){let t=e.extend?1:0;return(n,r)=>e.external(n,r)<<1|t}return e.get}let xK=new Set([25,49,50,263,65,130,56,57,238,62,63,72,73,77,60,61,151,152,155,112]);function x0(e){return 10==e||13==e}function x1(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}let x2=new xL((e,t)=>{let n;if(e.next<0)e.acceptToken(199);else if(t.context.flags&x3)x0(e.next)&&e.acceptToken(198,1);else if(((n=e.peek(-1))<0||x0(n))&&t.canShift(197)){let t=0;for(;32==e.next||9==e.next;)e.advance(),t++;(10==e.next||13==e.next||35==e.next)&&e.acceptToken(197,-t)}else x0(e.next)&&e.acceptToken(196,1)},{contextual:!0}),x5=new xL((e,t)=>{let n=t.context;if(n.flags)return;let r=e.peek(-1);if(10==r||13==r){let t=0,r=0;for(;;){if(32==e.next)t++;else if(9==e.next)t+=8-t%8;else break;e.advance(),r++}t!=n.indent&&10!=e.next&&13!=e.next&&35!=e.next&&(t<n.indent?e.acceptToken(195,-r):e.acceptToken(194))}}),x3=1;function x4(e,t,n){this.parent=e,this.indent=t,this.flags=n,this.hash=(e?e.hash+e.hash<<8:0)+t+(t<<4)+n+(n<<6)}let x6=new x4(null,0,0),x8=new Map([[241,0],[242,4],[243,8],[244,12],[245,16],[246,20],[247,24],[248,28],[249,32],[250,36],[251,40],[252,44],[253,48],[254,52],[255,56],[256,60]].map(([e,t])=>[e,2|t])),x9=new xX({start:x6,reduce:(e,t,n,r)=>e.flags&x3&&xK.has(t)||(71==t||72==t)&&2&e.flags?e.parent:e,shift:(e,t,n,r)=>194==t?new x4(e,function(e){let t=0;for(let n=0;n<e.length;n++)t+=9==e.charCodeAt(n)?8-t%8:1;return t}(r.read(r.pos,n.pos)),0):195==t?e.parent:24==t||55==t||59==t||3==t?new x4(e,0,x3):x8.has(t)?new x4(e,0,x8.get(t)|e.flags&x3):e,hash:e=>e.hash}),x7=new xL(e=>{for(let t=0;t<5;t++){if(e.next!="print".charCodeAt(t))return;e.advance()}if(!/\w/.test(String.fromCharCode(e.next)))for(let t=0;;t++){let n=e.peek(t);if(!(32==n||9==n)){40!=n&&46!=n&&10!=n&&13!=n&&35!=n&&e.acceptToken(1);return}}}),we=new xL((e,t)=>{let{flags:n}=t.context,r=4&n?34:39,i=(8&n)>0,o=!(16&n),s=(32&n)>0,a=e.pos;for(;!(e.next<0);)if(s&&123==e.next){if(123==e.peek(1))e.advance(2);else{if(e.pos==a){e.acceptToken(3,1);return}break}}else if(o&&92==e.next){if(e.pos==a){e.advance();let t=e.next;t>=0&&(e.advance(),function(e,t){if(111==t)for(let t=0;t<2&&e.next>=48&&e.next<=55;t++)e.advance();else if(120==t)for(let t=0;t<2&&x1(e.next);t++)e.advance();else if(117==t)for(let t=0;t<4&&x1(e.next);t++)e.advance();else if(85==t)for(let t=0;t<8&&x1(e.next);t++)e.advance();else if(78==t&&123==e.next){for(e.advance();e.next>=0&&125!=e.next&&39!=e.next&&34!=e.next&&10!=e.next;)e.advance();125==e.next&&e.advance()}}(e,t)),e.acceptToken(2);return}break}else if(e.next!=r||i&&(e.peek(1)!=r||e.peek(2)!=r)){if(10==e.next){if(i)e.advance();else if(e.pos==a){e.acceptToken(201);return}break}e.advance()}else{if(e.pos==a){e.acceptToken(201,i?3:1);return}break}e.pos>a&&e.acceptToken(200)}),wt=md({'async "*" "**" FormatConversion FormatSpec':mN.modifier,"for while if elif else try except finally return raise break continue with pass assert await yield match case":mN.controlKeyword,"in not and or is del":mN.operatorKeyword,"from def class global nonlocal lambda":mN.definitionKeyword,import:mN.moduleKeyword,"with as print":mN.keyword,Boolean:mN.bool,None:mN.null,VariableName:mN.variableName,"CallExpression/VariableName":mN.function(mN.variableName),"FunctionDefinition/VariableName":mN.function(mN.definition(mN.variableName)),"ClassDefinition/VariableName":mN.definition(mN.className),PropertyName:mN.propertyName,"CallExpression/MemberExpression/PropertyName":mN.function(mN.propertyName),Comment:mN.lineComment,Number:mN.number,String:mN.string,FormatString:mN.special(mN.string),Escape:mN.escape,UpdateOp:mN.updateOperator,"ArithOp!":mN.arithmeticOperator,BitOp:mN.bitwiseOperator,CompareOp:mN.compareOperator,AssignOp:mN.definitionOperator,Ellipsis:mN.punctuation,At:mN.meta,"( )":mN.paren,"[ ]":mN.squareBracket,"{ }":mN.brace,".":mN.derefOperator,", ;":mN.separator}),wn={__proto__:null,await:44,or:54,and:56,in:60,not:62,is:64,if:70,else:72,lambda:76,yield:94,from:96,async:102,for:104,None:162,True:164,False:164,del:178,pass:182,break:186,continue:190,return:194,raise:202,import:206,as:208,global:212,nonlocal:214,assert:218,type:223,elif:236,while:240,try:246,except:248,finally:250,with:254,def:258,class:268,match:279,case:285},wr=xZ.deserialize({version:14,states:"##jO`QeOOP$}OSOOO&WQtO'#HUOOQS'#Co'#CoOOQS'#Cp'#CpO'vQdO'#CnO*UQtO'#HTOOQS'#HU'#HUOOQS'#DU'#DUOOQS'#HT'#HTO*rQdO'#D_O+VQdO'#DfO+gQdO'#DjO+zOWO'#DuO,VOWO'#DvO.[QtO'#GuOOQS'#Gu'#GuO'vQdO'#GtO0ZQtO'#GtOOQS'#Eb'#EbO0rQdO'#EcOOQS'#Gs'#GsO0|QdO'#GrOOQV'#Gr'#GrO1XQdO'#FYOOQS'#G^'#G^O1^QdO'#FXOOQV'#IS'#ISOOQV'#Gq'#GqOOQV'#Fq'#FqQ`QeOOO'vQdO'#CqO1lQdO'#C}O1sQdO'#DRO2RQdO'#HYO2cQtO'#EVO'vQdO'#EWOOQS'#EY'#EYOOQS'#E['#E[OOQS'#E^'#E^O2wQdO'#E`O3_QdO'#EdO3rQdO'#EfO3zQtO'#EfO1XQdO'#EiO0rQdO'#ElO1XQdO'#EnO0rQdO'#EtO0rQdO'#EwO4VQdO'#EyO4^QdO'#FOO4iQdO'#EzO0rQdO'#FOO1XQdO'#FQO1XQdO'#FVO4nQdO'#F[P4uOdO'#GpPOOO)CBd)CBdOOQS'#Ce'#CeOOQS'#Cf'#CfOOQS'#Cg'#CgOOQS'#Ch'#ChOOQS'#Ci'#CiOOQS'#Cj'#CjOOQS'#Cl'#ClO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO5TQdO'#DoOOQS,5:Y,5:YO5hQdO'#HdOOQS,5:],5:]O5uQ!fO,5:]O5zQtO,59YO1lQdO,59bO1lQdO,59bO1lQdO,59bO8jQdO,59bO8oQdO,59bO8vQdO,59jO8}QdO'#HTO:TQdO'#HSOOQS'#HS'#HSOOQS'#D['#D[O:lQdO,59aO'vQdO,59aO:zQdO,59aOOQS,59y,59yO;PQdO,5:RO'vQdO,5:ROOQS,5:Q,5:QO;_QdO,5:QO;dQdO,5:XO'vQdO,5:XO'vQdO,5:VOOQS,5:U,5:UO;uQdO,5:UO;zQdO,5:WOOOW'#Fy'#FyO<POWO,5:aOOQS,5:a,5:aO<[QdO'#HwOOOW'#Dw'#DwOOOW'#Fz'#FzO<lOWO,5:bOOQS,5:b,5:bOOQS'#F}'#F}O<zQtO,5:iO?lQtO,5=`O@VQ#xO,5=`O@vQtO,5=`OOQS,5:},5:}OA_QeO'#GWOBqQdO,5;^OOQV,5=^,5=^OB|QtO'#IPOCkQdO,5;tOOQS-E:[-E:[OOQV,5;s,5;sO4dQdO'#FQOOQV-E9o-E9oOCsQtO,59]OEzQtO,59iOFeQdO'#HVOFpQdO'#HVO1XQdO'#HVOF{QdO'#DTOGTQdO,59mOGYQdO'#HZO'vQdO'#HZO0rQdO,5=tOOQS,5=t,5=tO0rQdO'#EROOQS'#ES'#ESOGwQdO'#GPOHXQdO,58|OHXQdO,58|O*xQdO,5:oOHgQtO'#H]OOQS,5:r,5:rOOQS,5:z,5:zOHzQdO,5;OOI]QdO'#IOO1XQdO'#H}OOQS,5;Q,5;QOOQS'#GT'#GTOIqQtO,5;QOJPQdO,5;QOJUQdO'#IQOOQS,5;T,5;TOJdQdO'#H|OOQS,5;W,5;WOJuQdO,5;YO4iQdO,5;`O4iQdO,5;cOJ}QtO'#ITO'vQdO'#ITOKXQdO,5;eO4VQdO,5;eO0rQdO,5;jO1XQdO,5;lOK^QeO'#EuOLjQgO,5;fO!!kQdO'#IUO4iQdO,5;jO!!vQdO,5;lO!#OQdO,5;qO!#ZQtO,5;vO'vQdO,5;vPOOO,5=[,5=[P!#bOSO,5=[P!#jOdO,5=[O!&bQtO1G.jO!&iQtO1G.jO!)YQtO1G.jO!)dQtO1G.jO!+}QtO1G.jO!,bQtO1G.jO!,uQdO'#HcO!-TQtO'#GuO0rQdO'#HcO!-_QdO'#HbOOQS,5:Z,5:ZO!-gQdO,5:ZO!-lQdO'#HeO!-wQdO'#HeO!.[QdO,5>OOOQS'#Ds'#DsOOQS1G/w1G/wOOQS1G.|1G.|O!/[QtO1G.|O!/cQtO1G.|O1lQdO1G.|O!0OQdO1G/UOOQS'#DZ'#DZO0rQdO,59tOOQS1G.{1G.{O!0VQdO1G/eO!0gQdO1G/eO!0oQdO1G/fO'vQdO'#H[O!0tQdO'#H[O!0yQtO1G.{O!1ZQdO,59iO!2aQdO,5=zO!2qQdO,5=zO!2yQdO1G/mO!3OQtO1G/mOOQS1G/l1G/lO!3`QdO,5=uO!4VQdO,5=uO0rQdO1G/qO!4tQdO1G/sO!4yQtO1G/sO!5ZQtO1G/qOOQS1G/p1G/pOOQS1G/r1G/rOOOW-E9w-E9wOOQS1G/{1G/{O!5kQdO'#HxO0rQdO'#HxO!5|QdO,5>cOOOW-E9x-E9xOOQS1G/|1G/|OOQS-E9{-E9{O!6[Q#xO1G2zO!6{QtO1G2zO'vQdO,5<jOOQS,5<j,5<jOOQS-E9|-E9|OOQS,5<r,5<rOOQS-E:U-E:UOOQV1G0x1G0xO1XQdO'#GRO!7dQtO,5>kOOQS1G1`1G1`O!8RQdO1G1`OOQS'#DV'#DVO0rQdO,5=qOOQS,5=q,5=qO!8WQdO'#FrO!8cQdO,59oO!8kQdO1G/XO!8uQtO,5=uOOQS1G3`1G3`OOQS,5:m,5:mO!9fQdO'#GtOOQS,5<k,5<kOOQS-E9}-E9}O!9wQdO1G.hOOQS1G0Z1G0ZO!:VQdO,5=wO!:gQdO,5=wO0rQdO1G0jO0rQdO1G0jO!:xQdO,5>jO!;ZQdO,5>jO1XQdO,5>jO!;lQdO,5>iOOQS-E:R-E:RO!;qQdO1G0lO!;|QdO1G0lO!<RQdO,5>lO!<aQdO,5>lO!<oQdO,5>hO!=VQdO,5>hO!=hQdO'#EpO0rQdO1G0tO!=sQdO1G0tO!=xQgO1G0zO!AvQgO1G0}O!EqQdO,5>oO!E{QdO,5>oO!FTQtO,5>oO0rQdO1G1PO!F_QdO1G1PO4iQdO1G1UO!!vQdO1G1WOOQV,5;a,5;aO!FdQfO,5;aO!FiQgO1G1QO!JjQdO'#GZO4iQdO1G1QO4iQdO1G1QO!JzQdO,5>pO!KXQdO,5>pO1XQdO,5>pOOQV1G1U1G1UO!KaQdO'#FSO!KrQ!fO1G1WO!KzQdO1G1WOOQV1G1]1G1]O4iQdO1G1]O!LPQdO1G1]O!LXQdO'#F^OOQV1G1b1G1bO!#ZQtO1G1bPOOO1G2v1G2vP!L^OSO1G2vOOQS,5=},5=}OOQS'#Dp'#DpO0rQdO,5=}O!LfQdO,5=|O!LyQdO,5=|OOQS1G/u1G/uO!MRQdO,5>PO!McQdO,5>PO!MkQdO,5>PO!NOQdO,5>PO!N`QdO,5>POOQS1G3j1G3jOOQS7+$h7+$hO!8kQdO7+$pO#!RQdO1G.|O#!YQdO1G.|OOQS1G/`1G/`OOQS,5<`,5<`O'vQdO,5<`OOQS7+%P7+%PO#!aQdO7+%POOQS-E9r-E9rOOQS7+%Q7+%QO#!qQdO,5=vO'vQdO,5=vOOQS7+$g7+$gO#!vQdO7+%PO##OQdO7+%QO##TQdO1G3fOOQS7+%X7+%XO##eQdO1G3fO##mQdO7+%XOOQS,5<_,5<_O'vQdO,5<_O##rQdO1G3aOOQS-E9q-E9qO#$iQdO7+%]OOQS7+%_7+%_O#$wQdO1G3aO#%fQdO7+%_O#%kQdO1G3gO#%{QdO1G3gO#&TQdO7+%]O#&YQdO,5>dO#&sQdO,5>dO#&sQdO,5>dOOQS'#Dx'#DxO#'UO&jO'#DzO#'aO`O'#HyOOOW1G3}1G3}O#'fQdO1G3}O#'nQdO1G3}O#'yQ#xO7+(fO#(jQtO1G2UP#)TQdO'#GOOOQS,5<m,5<mOOQS-E:P-E:POOQS7+&z7+&zOOQS1G3]1G3]OOQS,5<^,5<^OOQS-E9p-E9pOOQS7+$s7+$sO#)bQdO,5=`O#){QdO,5=`O#*^QtO,5<aO#*qQdO1G3cOOQS-E9s-E9sOOQS7+&U7+&UO#+RQdO7+&UO#+aQdO,5<nO#+uQdO1G4UOOQS-E:Q-E:QO#,WQdO1G4UOOQS1G4T1G4TOOQS7+&W7+&WO#,iQdO7+&WOOQS,5<p,5<pO#,tQdO1G4WOOQS-E:S-E:SOOQS,5<l,5<lO#-SQdO1G4SOOQS-E:O-E:OO1XQdO'#EqO#-jQdO'#EqO#-uQdO'#IRO#-}QdO,5;[OOQS7+&`7+&`O0rQdO7+&`O#.SQgO7+&fO!JmQdO'#GXO4iQdO7+&fO4iQdO7+&iO#2QQtO,5<tO'vQdO,5<tO#2[QdO1G4ZOOQS-E:W-E:WO#2fQdO1G4ZO4iQdO7+&kO0rQdO7+&kOOQV7+&p7+&pO!KrQ!fO7+&rO!KzQdO7+&rO`QeO1G0{OOQV-E:X-E:XO4iQdO7+&lO4iQdO7+&lOOQV,5<u,5<uO#2nQdO,5<uO!JmQdO,5<uOOQV7+&l7+&lO#2yQgO7+&lO#6tQdO,5<vO#7PQdO1G4[OOQS-E:Y-E:YO#7^QdO1G4[O#7fQdO'#IWO#7tQdO'#IWO1XQdO'#IWOOQS'#IW'#IWO#8PQdO'#IVOOQS,5;n,5;nO#8XQdO,5;nO0rQdO'#FUOOQV7+&r7+&rO4iQdO7+&rOOQV7+&w7+&wO4iQdO7+&wO#8^QfO,5;xOOQV7+&|7+&|POOO7+(b7+(bO#8cQdO1G3iOOQS,5<c,5<cO#8qQdO1G3hOOQS-E9u-E9uO#9UQdO,5<dO#9aQdO,5<dO#9tQdO1G3kOOQS-E9v-E9vO#:UQdO1G3kO#:^QdO1G3kO#:nQdO1G3kO#:UQdO1G3kOOQS<<H[<<H[O#:yQtO1G1zOOQS<<Hk<<HkP#;WQdO'#FtO8vQdO1G3bO#;eQdO1G3bO#;jQdO<<HkOOQS<<Hl<<HlO#;zQdO7+)QOOQS<<Hs<<HsO#<[QtO1G1yP#<{QdO'#FsO#=YQdO7+)RO#=jQdO7+)RO#=rQdO<<HwO#=wQdO7+({OOQS<<Hy<<HyO#>nQdO,5<bO'vQdO,5<bOOQS-E9t-E9tOOQS<<Hw<<HwOOQS,5<g,5<gO0rQdO,5<gO#>sQdO1G4OOOQS-E9y-E9yO#?^QdO1G4OO<[QdO'#H{OOOO'#D{'#D{OOOO'#F|'#F|O#?oO&jO,5:fOOOW,5>e,5>eOOOW7+)i7+)iO#?zQdO7+)iO#@SQdO1G2zO#@mQdO1G2zP'vQdO'#FuO0rQdO<<IpO1XQdO1G2YP1XQdO'#GSO#AOQdO7+)pO#AaQdO7+)pOOQS<<Ir<<IrP1XQdO'#GUP0rQdO'#GQOOQS,5;],5;]O#ArQdO,5>mO#BQQdO,5>mOOQS1G0v1G0vOOQS<<Iz<<IzOOQV-E:V-E:VO4iQdO<<JQOOQV,5<s,5<sO4iQdO,5<sOOQV<<JQ<<JQOOQV<<JT<<JTO#BYQtO1G2`P#BdQdO'#GYO#BkQdO7+)uO#BuQgO<<JVO4iQdO<<JVOOQV<<J^<<J^O4iQdO<<J^O!KrQ!fO<<J^O#FpQgO7+&gOOQV<<JW<<JWO#FzQgO<<JWOOQV1G2a1G2aO1XQdO1G2aO#JuQdO1G2aO4iQdO<<JWO1XQdO1G2bP0rQdO'#G[O#KQQdO7+)vO#K_QdO7+)vOOQS'#FT'#FTO0rQdO,5>rO#KgQdO,5>rOOQS,5>r,5>rO#KrQdO,5>qO#LTQdO,5>qOOQS1G1Y1G1YOOQS,5;p,5;pOOQV<<Jc<<JcO#L]QdO1G1dOOQS7+)T7+)TP#LbQdO'#FwO#LrQdO1G2OO#MVQdO1G2OO#MgQdO1G2OP#MrQdO'#FxO#NPQdO7+)VO#NaQdO7+)VO#NaQdO7+)VO#NiQdO7+)VO#NyQdO7+(|O8vQdO7+(|OOQSAN>VAN>VO$ dQdO<<LmOOQSAN>cAN>cO0rQdO1G1|O$ tQtO1G1|P$!OQdO'#FvOOQS1G2R1G2RP$!]QdO'#F{O$!jQdO7+)jO$#TQdO,5>gOOOO-E9z-E9zOOOW<<MT<<MTO$#cQdO7+(fOOQSAN?[AN?[OOQS7+'t7+'tO$#|QdO<<M[OOQS,5<q,5<qO$$_QdO1G4XOOQS-E:T-E:TOOQVAN?lAN?lOOQV1G2_1G2_O4iQdOAN?qO$$mQgOAN?qOOQVAN?xAN?xO4iQdOAN?xOOQV<<JR<<JRO4iQdOAN?rO4iQdO7+'{OOQV7+'{7+'{O1XQdO7+'{OOQVAN?rAN?rOOQS7+'|7+'|O$(hQdO<<MbOOQS1G4^1G4^O0rQdO1G4^OOQS,5<w,5<wO$(uQdO1G4]OOQS-E:Z-E:ZOOQU'#G_'#G_O$)WQfO7+'OO$)cQdO'#F_O$*jQdO7+'jO$*zQdO7+'jOOQS7+'j7+'jO$+VQdO<<LqO$+gQdO<<LqO$+gQdO<<LqO$+oQdO'#H^OOQS<<Lh<<LhO$+yQdO<<LhOOQS7+'h7+'hOOQS'#D|'#D|OOOO1G4R1G4RO$,dQdO1G4RO$,lQdO1G4RP!=hQdO'#GVOOQVG25]G25]O4iQdOG25]OOQVG25dG25dOOQVG25^G25^OOQV<<Kg<<KgO4iQdO<<KgOOQS7+)x7+)xP$,wQdO'#G]OOQU-E:]-E:]OOQV<<Jj<<JjO$-kQtO'#FaOOQS'#Fc'#FcO$-{QdO'#FbO$.mQdO'#FbOOQS'#Fb'#FbO$.rQdO'#IYO$)cQdO'#FiO$)cQdO'#FiO$/ZQdO'#FjO$)cQdO'#FkO$/bQdO'#IZOOQS'#IZ'#IZO$0PQdO,5;yOOQS<<KU<<KUO$0XQdO<<KUO$0iQdOANB]O$0yQdOANB]O$1RQdO'#H_OOQS'#H_'#H_O1sQdO'#DcO$1lQdO,5=xOOQSANBSANBSOOOO7+)m7+)mO$2TQdO7+)mOOQVLD*wLD*wOOQVANARANARO5uQ!fO'#GaO$2]QtO,5<SO$)cQdO'#FmOOQS,5<W,5<WOOQS'#Fd'#FdO$2}QdO,5;|O$3SQdO,5;|OOQS'#Fg'#FgO$)cQdO'#G`O$3tQdO,5<QO$4`QdO,5>tO$4pQdO,5>tO1XQdO,5<PO$5RQdO,5<TO$5WQdO,5<TO$)cQdO'#I[O$5]QdO'#I[O$5bQdO,5<UOOQS,5<V,5<VO'vQdO'#FpOOQU1G1e1G1eO4iQdO1G1eOOQSAN@pAN@pO$5gQdOG27wO$5wQdO,59}OOQS1G3d1G3dOOOO<<MX<<MXOOQS,5<{,5<{OOQS-E:_-E:_O$5|QtO'#FaO$6TQdO'#I]O$6cQdO'#I]O$6kQdO,5<XOOQS1G1h1G1hO$6pQdO1G1hO$6uQdO,5<zOOQS-E:^-E:^O$7aQdO,5=OO$7xQdO1G4`OOQS-E:b-E:bOOQS1G1k1G1kOOQS1G1o1G1oO$8YQdO,5>vO$)cQdO,5>vOOQS1G1p1G1pO$8hQtO,5<[OOQU7+'P7+'PO$+oQdO1G/iO$)cQdO,5<YO$8oQdO,5>wO$8vQdO,5>wOOQS1G1s1G1sOOQS7+'S7+'SP$)cQdO'#GdO$9OQdO1G4bO$9YQdO1G4bO$9bQdO1G4bOOQS7+%T7+%TO$9pQdO1G1tO$:OQtO'#FaO$:VQdO,5<}OOQS,5<},5<}O$:eQdO1G4cOOQS-E:a-E:aO$)cQdO,5<|O$:lQdO,5<|O$:qQdO7+)|OOQS-E:`-E:`O$:{QdO7+)|O$)cQdO,5<ZP$)cQdO'#GcO$;TQdO1G2hO$)cQdO1G2hP$;cQdO'#GbO$;jQdO<<MhO$;tQdO1G1uO$<SQdO7+(SO8vQdO'#C}O8vQdO,59bO8vQdO,59bO8vQdO,59bO$<bQtO,5=`O8vQdO1G.|O0rQdO1G/XO0rQdO7+$pP$<uQdO'#GOO'vQdO'#GtO$=SQdO,59bO$=XQdO,59bO$=`QdO,59mO$=eQdO1G/UO1sQdO'#DRO8vQdO,59j",stateData:"$>O~O%cOS%^OSSOS%]PQ~OPdOVaOfoOhYOopOs!POvqO!PrO!Q{O!T!SO!U!RO!XZO!][O!h`O!r`O!s`O!t`O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO#l!QO#o!TO#s!UO#u!VO#z!WO#}hO$P!XO%oRO%pRO%tSO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O~O%]!YO~OV!aO_!aOa!bOh!iO!X!kO!f!mO%j![O%k!]O%l!^O%m!_O%n!_O%o!`O%p!`O%q!aO%r!aO%s!aO~Ok%xXl%xXm%xXn%xXo%xXp%xXs%xXz%xX{%xX!x%xX#g%xX%[%xX%_%xX%z%xXg%xX!T%xX!U%xX%{%xX!W%xX![%xX!Q%xX#[%xXt%xX!m%xX~P%SOfoOhYO!XZO!][O!h`O!r`O!s`O!t`O%oRO%pRO%tSO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O~Oz%wX{%wX#g%wX%[%wX%_%wX%z%wX~Ok!pOl!qOm!oOn!oOo!rOp!sOs!tO!x%wX~P)pOV!zOg!|Oo0cOv0qO!PrO~P'vOV#OOo0cOv0qO!W#PO~P'vOV#SOa#TOo0cOv0qO![#UO~P'vOQ#XO%`#XO%a#ZO~OQ#^OR#[O%`#^O%a#`O~OV%iX_%iXa%iXh%iXk%iXl%iXm%iXn%iXo%iXp%iXs%iXz%iX!X%iX!f%iX%j%iX%k%iX%l%iX%m%iX%n%iX%o%iX%p%iX%q%iX%r%iX%s%iXg%iX!T%iX!U%iX~O&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O{%iX!x%iX#g%iX%[%iX%_%iX%z%iX%{%iX!W%iX![%iX!Q%iX#[%iXt%iX!m%iX~P,eOz#dO{%hX!x%hX#g%hX%[%hX%_%hX%z%hX~Oo0cOv0qO~P'vO#g#gO%[#iO%_#iO~O%uWO~O!T#nO#u!VO#z!WO#}hO~OopO~P'vOV#sOa#tO%uWO{wP~OV#xOo0cOv0qO!Q#yO~P'vO{#{O!x$QO%z#|O#g!yX%[!yX%_!yX~OV#xOo0cOv0qO#g#SX%[#SX%_#SX~P'vOo0cOv0qO#g#WX%[#WX%_#WX~P'vOh$WO%uWO~O!f$YO!r$YO%uWO~OV$eO~P'vO!U$gO#s$hO#u$iO~O{$jO~OV$qO~P'vOS$sO%[$rO%_$rO%c$tO~OV$}Oa$}Og%POo0cOv0qO~P'vOo0cOv0qO{%SO~P'vO&Y%UO~Oa!bOh!iO!X!kO!f!mOVba_bakbalbambanbaobapbasbazba{ba!xba#gba%[ba%_ba%jba%kba%lba%mba%nba%oba%pba%qba%rba%sba%zbagba!Tba!Uba%{ba!Wba![ba!Qba#[batba!mba~On%ZO~Oo%ZO~P'vOo0cO~P'vOk0eOl0fOm0dOn0dOo0mOp0nOs0rOg%wX!T%wX!U%wX%{%wX!W%wX![%wX!Q%wX#[%wX!m%wX~P)pO%{%]Og%vXz%vX!T%vX!U%vX!W%vX{%vX~Og%_Oz%`O!T%dO!U%cO~Og%_O~Oz%gO!T%dO!U%cO!W&SX~O!W%kO~Oz%lO{%nO!T%dO!U%cO![%}X~O![%rO~O![%sO~OQ#XO%`#XO%a%uO~OV%wOo0cOv0qO!PrO~P'vOQ#^OR#[O%`#^O%a%zO~OV!qa_!qaa!qah!qak!qal!qam!qan!qao!qap!qas!qaz!qa{!qa!X!qa!f!qa!x!qa#g!qa%[!qa%_!qa%j!qa%k!qa%l!qa%m!qa%n!qa%o!qa%p!qa%q!qa%r!qa%s!qa%z!qag!qa!T!qa!U!qa%{!qa!W!qa![!qa!Q!qa#[!qat!qa!m!qa~P#yOz%|O{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~P%SOV&OOopOvqO{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~P'vOz%|O{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~OPdOVaOopOvqO!PrO!Q{O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO#g$zX%[$zX%_$zX~P'vO#g#gO%[&TO%_&TO~O!f&UOh&sX%[&sXz&sX#[&sX#g&sX%_&sX#Z&sXg&sX~Oh!iO%[&WO~Okealeameaneaoeapeaseazea{ea!xea#gea%[ea%_ea%zeagea!Tea!Uea%{ea!Wea![ea!Qea#[eatea!mea~P%SOsqazqa{qa#gqa%[qa%_qa%zqa~Ok!pOl!qOm!oOn!oOo!rOp!sO!xqa~PEcO%z&YOz%yX{%yX~O%uWOz%yX{%yX~Oz&]O{wX~O{&_O~Oz%lO#g%}X%[%}X%_%}Xg%}X{%}X![%}X!m%}X%z%}X~OV0lOo0cOv0qO!PrO~P'vO%z#|O#gUa%[Ua%_Ua~Oz&hO#g&PX%[&PX%_&PXn&PX~P%SOz&kO!Q&jO#g#Wa%[#Wa%_#Wa~Oz&lO#[&nO#g&rX%[&rX%_&rXg&rX~O!f$YO!r$YO#Z&qO%uWO~O#Z&qO~Oz&sO#g&tX%[&tX%_&tX~Oz&uO#g&pX%[&pX%_&pX{&pX~O!X&wO%z&xO~Oz&|On&wX~P%SOn'PO~OPdOVaOopOvqO!PrO!Q{O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO%['UO~P'vOt'YO#p'WO#q'XOP#naV#naf#nah#nao#nas#nav#na!P#na!Q#na!T#na!U#na!X#na!]#na!h#na!r#na!s#na!t#na!{#na!}#na#P#na#R#na#T#na#X#na#Z#na#^#na#_#na#a#na#c#na#l#na#o#na#s#na#u#na#z#na#}#na$P#na%X#na%o#na%p#na%t#na%u#na&Z#na&[#na&]#na&^#na&_#na&`#na&a#na&b#na&c#na&d#na&e#na&f#na&g#na&h#na&i#na&j#na%Z#na%_#na~Oz'ZO#[']O{&xX~Oh'_O!X&wO~Oh!iO{$jO!X&wO~O{'eO~P%SO%['hO%_'hO~OS'iO%['hO%_'hO~OV!aO_!aOa!bOh!iO!X!kO!f!mO%l!^O%m!_O%n!_O%o!`O%p!`O%q!aO%r!aO%s!aOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~O%k!]O~P!#uO%kWi~P!#uOV!aO_!aOa!bOh!iO!X!kO!f!mO%o!`O%p!`O%q!aO%r!aO%s!aOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%kWi%lWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~O%m!_O%n!_O~P!&pO%mWi%nWi~P!&pOa!bOh!iO!X!kO!f!mOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%kWi%lWi%mWi%nWi%oWi%pWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~OV!aO_!aO%q!aO%r!aO%s!aO~P!)nOVWi_Wi%qWi%rWi%sWi~P!)nO!T%dO!U%cOg&VXz&VX~O%z'kO%{'kO~P,eOz'mOg&UX~Og'oO~Oz'pO{'rO!W&XX~Oo0cOv0qOz'pO{'sO!W&XX~P'vO!W'uO~Om!oOn!oOo!rOp!sOkjisjizji{ji!xji#gji%[ji%_ji%zji~Ol!qO~P!.aOlji~P!.aOk0eOl0fOm0dOn0dOo0mOp0nO~Ot'wO~P!/jOV'|Og'}Oo0cOv0qO~P'vOg'}Oz(OO~Og(QO~O!U(SO~Og(TOz(OO!T%dO!U%cO~P%SOk0eOl0fOm0dOn0dOo0mOp0nOgqa!Tqa!Uqa%{qa!Wqa![qa!Qqa#[qatqa!mqa~PEcOV'|Oo0cOv0qO!W&Sa~P'vOz(WO!W&Sa~O!W(XO~Oz(WO!T%dO!U%cO!W&Sa~P%SOV(]Oo0cOv0qO![%}a#g%}a%[%}a%_%}ag%}a{%}a!m%}a%z%}a~P'vOz(^O![%}a#g%}a%[%}a%_%}ag%}a{%}a!m%}a%z%}a~O![(aO~Oz(^O!T%dO!U%cO![%}a~P%SOz(dO!T%dO!U%cO![&Ta~P%SOz(gO{&lX![&lX!m&lX%z&lX~O{(kO![(mO!m(nO%z(jO~OV&OOopOvqO{%hi!x%hi#g%hi%[%hi%_%hi%z%hi~P'vOz(pO{%hi!x%hi#g%hi%[%hi%_%hi%z%hi~O!f&UOh&sa%[&saz&sa#[&sa#g&sa%_&sa#Z&sag&sa~O%[(uO~OV#sOa#tO%uWO~Oz&]O{wa~OopOvqO~P'vOz(^O#g%}a%[%}a%_%}ag%}a{%}a![%}a!m%}a%z%}a~P%SOz(zO#g%hX%[%hX%_%hX%z%hX~O%z#|O#gUi%[Ui%_Ui~O#g&Pa%[&Pa%_&Pan&Pa~P'vOz(}O#g&Pa%[&Pa%_&Pan&Pa~O%uWO#g&ra%[&ra%_&rag&ra~Oz)SO#g&ra%[&ra%_&rag&ra~Og)VO~OV)WOh$WO%uWO~O#Z)XO~O%uWO#g&ta%[&ta%_&ta~Oz)ZO#g&ta%[&ta%_&ta~Oo0cOv0qO#g&pa%[&pa%_&pa{&pa~P'vOz)^O#g&pa%[&pa%_&pa{&pa~OV)`Oa)`O%uWO~O%z)eO~Ot)hO#j)gOP#hiV#hif#hih#hio#his#hiv#hi!P#hi!Q#hi!T#hi!U#hi!X#hi!]#hi!h#hi!r#hi!s#hi!t#hi!{#hi!}#hi#P#hi#R#hi#T#hi#X#hi#Z#hi#^#hi#_#hi#a#hi#c#hi#l#hi#o#hi#s#hi#u#hi#z#hi#}#hi$P#hi%X#hi%o#hi%p#hi%t#hi%u#hi&Z#hi&[#hi&]#hi&^#hi&_#hi&`#hi&a#hi&b#hi&c#hi&d#hi&e#hi&f#hi&g#hi&h#hi&i#hi&j#hi%Z#hi%_#hi~Ot)iOP#kiV#kif#kih#kio#kis#kiv#ki!P#ki!Q#ki!T#ki!U#ki!X#ki!]#ki!h#ki!r#ki!s#ki!t#ki!{#ki!}#ki#P#ki#R#ki#T#ki#X#ki#Z#ki#^#ki#_#ki#a#ki#c#ki#l#ki#o#ki#s#ki#u#ki#z#ki#}#ki$P#ki%X#ki%o#ki%p#ki%t#ki%u#ki&Z#ki&[#ki&]#ki&^#ki&_#ki&`#ki&a#ki&b#ki&c#ki&d#ki&e#ki&f#ki&g#ki&h#ki&i#ki&j#ki%Z#ki%_#ki~OV)kOn&wa~P'vOz)lOn&wa~Oz)lOn&wa~P%SOn)pO~O%Y)tO~Ot)wO#p'WO#q)vOP#niV#nif#nih#nio#nis#niv#ni!P#ni!Q#ni!T#ni!U#ni!X#ni!]#ni!h#ni!r#ni!s#ni!t#ni!{#ni!}#ni#P#ni#R#ni#T#ni#X#ni#Z#ni#^#ni#_#ni#a#ni#c#ni#l#ni#o#ni#s#ni#u#ni#z#ni#}#ni$P#ni%X#ni%o#ni%p#ni%t#ni%u#ni&Z#ni&[#ni&]#ni&^#ni&_#ni&`#ni&a#ni&b#ni&c#ni&d#ni&e#ni&f#ni&g#ni&h#ni&i#ni&j#ni%Z#ni%_#ni~OV)zOo0cOv0qO{$jO~P'vOo0cOv0qO{&xa~P'vOz*OO{&xa~OV*SOa*TOg*WO%q*UO%uWO~O{$jO&{*YO~Oh'_O~Oh!iO{$jO~O%[*_O~O%[*aO%_*aO~OV$}Oa$}Oo0cOv0qOg&Ua~P'vOz*dOg&Ua~Oo0cOv0qO{*gO!W&Xa~P'vOz*hO!W&Xa~Oo0cOv0qOz*hO{*kO!W&Xa~P'vOo0cOv0qOz*hO!W&Xa~P'vOz*hO{*kO!W&Xa~Om0dOn0dOo0mOp0nOgjikjisjizji!Tji!Uji%{ji!Wji{ji![ji#gji%[ji%_ji!Qji#[jitji!mji%zji~Ol0fO~P!NkOlji~P!NkOV'|Og*pOo0cOv0qO~P'vOn*rO~Og*pOz*tO~Og*uO~OV'|Oo0cOv0qO!W&Si~P'vOz*vO!W&Si~O!W*wO~OV(]Oo0cOv0qO![%}i#g%}i%[%}i%_%}ig%}i{%}i!m%}i%z%}i~P'vOz*zO!T%dO!U%cO![&Ti~Oz*}O![%}i#g%}i%[%}i%_%}ig%}i{%}i!m%}i%z%}i~O![+OO~Oa+QOo0cOv0qO![&Ti~P'vOz*zO![&Ti~O![+SO~OV+UOo0cOv0qO{&la![&la!m&la%z&la~P'vOz+VO{&la![&la!m&la%z&la~O!]+YO&n+[O![!nX~O![+^O~O{(kO![+_O~O{(kO![+_O!m+`O~OV&OOopOvqO{%hq!x%hq#g%hq%[%hq%_%hq%z%hq~P'vOz$ri{$ri!x$ri#g$ri%[$ri%_$ri%z$ri~P%SOV&OOopOvqO~P'vOV&OOo0cOv0qO#g%ha%[%ha%_%ha%z%ha~P'vOz+aO#g%ha%[%ha%_%ha%z%ha~Oz$ia#g$ia%[$ia%_$ian$ia~P%SO#g&Pi%[&Pi%_&Pin&Pi~P'vOz+dO#g#Wq%[#Wq%_#Wq~O#[+eOz$va#g$va%[$va%_$vag$va~O%uWO#g&ri%[&ri%_&rig&ri~Oz+gO#g&ri%[&ri%_&rig&ri~OV+iOh$WO%uWO~O%uWO#g&ti%[&ti%_&ti~Oo0cOv0qO#g&pi%[&pi%_&pi{&pi~P'vO{#{Oz#eX!W#eX~Oz+mO!W&uX~O!W+oO~Ot+rO#j)gOP#hqV#hqf#hqh#hqo#hqs#hqv#hq!P#hq!Q#hq!T#hq!U#hq!X#hq!]#hq!h#hq!r#hq!s#hq!t#hq!{#hq!}#hq#P#hq#R#hq#T#hq#X#hq#Z#hq#^#hq#_#hq#a#hq#c#hq#l#hq#o#hq#s#hq#u#hq#z#hq#}#hq$P#hq%X#hq%o#hq%p#hq%t#hq%u#hq&Z#hq&[#hq&]#hq&^#hq&_#hq&`#hq&a#hq&b#hq&c#hq&d#hq&e#hq&f#hq&g#hq&h#hq&i#hq&j#hq%Z#hq%_#hq~On$|az$|a~P%SOV)kOn&wi~P'vOz+yOn&wi~Oz,TO{$jO#[,TO~O#q,VOP#nqV#nqf#nqh#nqo#nqs#nqv#nq!P#nq!Q#nq!T#nq!U#nq!X#nq!]#nq!h#nq!r#nq!s#nq!t#nq!{#nq!}#nq#P#nq#R#nq#T#nq#X#nq#Z#nq#^#nq#_#nq#a#nq#c#nq#l#nq#o#nq#s#nq#u#nq#z#nq#}#nq$P#nq%X#nq%o#nq%p#nq%t#nq%u#nq&Z#nq&[#nq&]#nq&^#nq&_#nq&`#nq&a#nq&b#nq&c#nq&d#nq&e#nq&f#nq&g#nq&h#nq&i#nq&j#nq%Z#nq%_#nq~O#[,WOz%Oa{%Oa~Oo0cOv0qO{&xi~P'vOz,YO{&xi~O{#{O%z,[Og&zXz&zX~O%uWOg&zXz&zX~Oz,`Og&yX~Og,bO~O%Y,eO~O!T%dO!U%cOg&Viz&Vi~OV$}Oa$}Oo0cOv0qOg&Ui~P'vO{,hOz$la!W$la~Oo0cOv0qO{,iOz$la!W$la~P'vOo0cOv0qO{*gO!W&Xi~P'vOz,lO!W&Xi~Oo0cOv0qOz,lO!W&Xi~P'vOz,lO{,oO!W&Xi~Og$hiz$hi!W$hi~P%SOV'|Oo0cOv0qO~P'vOn,qO~OV'|Og,rOo0cOv0qO~P'vOV'|Oo0cOv0qO!W&Sq~P'vOz$gi![$gi#g$gi%[$gi%_$gig$gi{$gi!m$gi%z$gi~P%SOV(]Oo0cOv0qO~P'vOa+QOo0cOv0qO![&Tq~P'vOz,sO![&Tq~O![,tO~OV(]Oo0cOv0qO![%}q#g%}q%[%}q%_%}qg%}q{%}q!m%}q%z%}q~P'vO{,uO~OV+UOo0cOv0qO{&li![&li!m&li%z&li~P'vOz,zO{&li![&li!m&li%z&li~O!]+YO&n+[O![!na~O{(kO![,}O~OV&OOo0cOv0qO#g%hi%[%hi%_%hi%z%hi~P'vOz-OO#g%hi%[%hi%_%hi%z%hi~O%uWO#g&rq%[&rq%_&rqg&rq~Oz-RO#g&rq%[&rq%_&rqg&rq~OV)`Oa)`O%uWO!W&ua~Oz-TO!W&ua~On$|iz$|i~P%SOV)kO~P'vOV)kOn&wq~P'vOt-XOP#myV#myf#myh#myo#mys#myv#my!P#my!Q#my!T#my!U#my!X#my!]#my!h#my!r#my!s#my!t#my!{#my!}#my#P#my#R#my#T#my#X#my#Z#my#^#my#_#my#a#my#c#my#l#my#o#my#s#my#u#my#z#my#}#my$P#my%X#my%o#my%p#my%t#my%u#my&Z#my&[#my&]#my&^#my&_#my&`#my&a#my&b#my&c#my&d#my&e#my&f#my&g#my&h#my&i#my&j#my%Z#my%_#my~O%Z-]O%_-]O~P`O#q-^OP#nyV#nyf#nyh#nyo#nys#nyv#ny!P#ny!Q#ny!T#ny!U#ny!X#ny!]#ny!h#ny!r#ny!s#ny!t#ny!{#ny!}#ny#P#ny#R#ny#T#ny#X#ny#Z#ny#^#ny#_#ny#a#ny#c#ny#l#ny#o#ny#s#ny#u#ny#z#ny#}#ny$P#ny%X#ny%o#ny%p#ny%t#ny%u#ny&Z#ny&[#ny&]#ny&^#ny&_#ny&`#ny&a#ny&b#ny&c#ny&d#ny&e#ny&f#ny&g#ny&h#ny&i#ny&j#ny%Z#ny%_#ny~Oz-aO{$jO#[-aO~Oo0cOv0qO{&xq~P'vOz-dO{&xq~O%z,[Og&zaz&za~OV*SOa*TO%q*UO%uWOg&ya~Oz-hOg&ya~O$S-lO~OV$}Oa$}Oo0cOv0qO~P'vOo0cOv0qO{-mOz$li!W$li~P'vOo0cOv0qOz$li!W$li~P'vO{-mOz$li!W$li~Oo0cOv0qO{*gO~P'vOo0cOv0qO{*gO!W&Xq~P'vOz-pO!W&Xq~Oo0cOv0qOz-pO!W&Xq~P'vOs-sO!T%dO!U%cOg&Oq!W&Oq![&Oqz&Oq~P!/jOa+QOo0cOv0qO![&Ty~P'vOz$ji![$ji~P%SOa+QOo0cOv0qO~P'vOV+UOo0cOv0qO~P'vOV+UOo0cOv0qO{&lq![&lq!m&lq%z&lq~P'vO{(kO![-xO!m-yO%z-wO~OV&OOo0cOv0qO#g%hq%[%hq%_%hq%z%hq~P'vO%uWO#g&ry%[&ry%_&ryg&ry~OV)`Oa)`O%uWO!W&ui~Ot-}OP#m!RV#m!Rf#m!Rh#m!Ro#m!Rs#m!Rv#m!R!P#m!R!Q#m!R!T#m!R!U#m!R!X#m!R!]#m!R!h#m!R!r#m!R!s#m!R!t#m!R!{#m!R!}#m!R#P#m!R#R#m!R#T#m!R#X#m!R#Z#m!R#^#m!R#_#m!R#a#m!R#c#m!R#l#m!R#o#m!R#s#m!R#u#m!R#z#m!R#}#m!R$P#m!R%X#m!R%o#m!R%p#m!R%t#m!R%u#m!R&Z#m!R&[#m!R&]#m!R&^#m!R&_#m!R&`#m!R&a#m!R&b#m!R&c#m!R&d#m!R&e#m!R&f#m!R&g#m!R&h#m!R&i#m!R&j#m!R%Z#m!R%_#m!R~Oo0cOv0qO{&xy~P'vOV*SOa*TO%q*UO%uWOg&yi~O$S-lO%Z.VO%_.VO~OV.aOh._O!X.^O!].`O!h.YO!s.[O!t.[O%p.XO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O~Oo0cOv0qOz$lq!W$lq~P'vO{.fOz$lq!W$lq~Oo0cOv0qO{*gO!W&Xy~P'vOz.gO!W&Xy~Oo0cOv.kO~P'vOs-sO!T%dO!U%cOg&Oy!W&Oy![&Oyz&Oy~P!/jO{(kO![.nO~O{(kO![.nO!m.oO~OV*SOa*TO%q*UO%uWO~Oh.tO!f.rOz$TX#[$TX%j$TXg$TX~Os$TX{$TX!W$TX![$TX~P$-VO%o.vO%p.vOs$UXz$UX{$UX#[$UX%j$UX!W$UXg$UX![$UX~O!h.xO~Oz.|O#[/OO%j.yOs&|X{&|X!W&|Xg&|X~Oa/RO~P$)oOh.tOs&}Xz&}X{&}X#[&}X%j&}X!W&}Xg&}X![&}X~Os/VO{$jO~Oo0cOv0qOz$ly!W$ly~P'vOo0cOv0qO{*gO!W&X!R~P'vOz/ZO!W&X!R~Og&RXs&RX!T&RX!U&RX!W&RX![&RXz&RX~P!/jOs-sO!T%dO!U%cOg&Qa!W&Qa![&Qaz&Qa~O{(kO![/^O~O!f.rOh$[as$[az$[a{$[a#[$[a%j$[a!W$[ag$[a![$[a~O!h/eO~O%o.vO%p.vOs$Uaz$Ua{$Ua#[$Ua%j$Ua!W$Uag$Ua![$Ua~O%j.yOs$Yaz$Ya{$Ya#[$Ya!W$Yag$Ya![$Ya~Os&|a{&|a!W&|ag&|a~P$)cOz/jOs&|a{&|a!W&|ag&|a~O!W/mO~Og/mO~O{/oO~O![/pO~Oo0cOv0qO{*gO!W&X!Z~P'vO{/sO~O%z/tO~P$-VOz/uO#[/OO%j.yOg'PX~Oz/uOg'PX~Og/wO~O!h/xO~O#[/OOs%Saz%Sa{%Sa%j%Sa!W%Sag%Sa![%Sa~O#[/OO%j.yOs%Waz%Wa{%Wa!W%Wag%Wa~Os&|i{&|i!W&|ig&|i~P$)cOz/zO#[/OO%j.yO!['Oa~O{$da~P%SOg'Pa~P$)cOz0SOg'Pa~Oa0UO!['Oi~P$)oOz0WO!['Oi~Oz0WO#[/OO%j.yO!['Oi~O#[/OO%j.yOg$biz$bi~O%z0ZO~P$-VO#[/OO%j.yOg%Vaz%Va~Og'Pi~P$)cO{0^O~Oa0UO!['Oq~P$)oOz0`O!['Oq~O#[/OO%j.yOz%Ui![%Ui~Oa0UO~P$)oOa0UO!['Oy~P$)oO#[/OO%j.yOg$ciz$ci~O#[/OO%j.yOz%Uq![%Uq~Oz+aO#g%ha%[%ha%_%ha%z%ha~P%SOV&OOo0cOv0qO~P'vOn0hO~Oo0hO~P'vO{0iO~Ot0jO~P!/jO&]&Z&j&h&i&g&f&d&e&c&b&`&a&_&^&[%u~",goto:"!=l'QPPPPPP'RP'Z*s+]+v,b,}-kP.YP'Z.y.y'ZPPP'Z2cPPPPPP2c5VPP5VP7g7p=xPP={>m>pPP'Z'ZPP?PPP'Z'ZPP'Z'Z'Z'Z'Z?T?}'ZP@QP@WD_G{HPPHSH^Hb'ZPPPHeHn'RP'R'RP'RP'RP'RP'RP'R'R'RP'RPP'RPP'RP'RPHtIQIYPIaIgPIaPIaIaPPPIaPKuPLOLYL`KuPIaLiPIaPLpLvPLzM`M}NhLzLzNnN{LzLzLzLz! a! g! j! o! r! |!!S!!`!!r!!x!#S!#Y!#v!#|!$S!$^!$d!$j!$|!%W!%^!%d!%n!%t!%z!&Q!&W!&^!&h!&n!&x!'O!'X!'_!'n!'v!(Q!(XPPPPPPPPPPP!(_!(b!(h!(q!({!)WPPPPPPPPPPPP!-z!/`!3`!6pPP!6x!7X!7b!8Z!8Q!8d!8j!8m!8p!8s!8{!9lPPPPPPPPPPPPPPPPP!9o!9s!9yP!:_!:c!:o!:x!;U!;l!;o!;r!;x!<O!<U!<XP!<a!<j!=f!=i]eOn#g$j)t,P'}`OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0r}!cQ#c#p$R$d$p%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0g!P!dQ#c#p$R$d$p$u%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0g!R!eQ#c#p$R$d$p$u$v%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0g!T!fQ#c#p$R$d$p$u$v$w%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0g!V!gQ#c#p$R$d$p$u$v$w$x%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0g!X!hQ#c#p$R$d$p$u$v$w$x$y%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0g!]!hQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0g'}TOTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0r&cVOYZ[dnprxy}!P!Q!U!i!k!o!p!q!s!t#[#d#g#y#{#}$Q$h$j$}%S%Z%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/Z/s0c0d0e0f0h0i0j0k0n0r%mXOYZ[dnrxy}!P!Q!U!i!k#[#d#g#y#{#}$Q$h$j$}%S%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,s,u,w,y,z-O-d-f-m-p.f.g/Z0i0j0kQ#vqQ/[.kR0o0q't`OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rh#jhz{$W$Z&l&q)S)X+f+g-RW#rq&].k0qQ$]|Q$a!OQ$n!VQ$o!WW$|!i'm*d,gS&[#s#tQ'S$iQ(s&UQ)U&nU)Y&s)Z+jW)a&w+m-T-{Q*Q']W*R'_,`-h.TQ+l)`S,_*S*TQ-Q+eQ-_,TQ-c,WQ.R-al.W-l.^._.a.z.|/R/j/o/t/y0U0Z0^Q/S.`Q/a.tQ/l/OU0P/u0S0[X0V/z0W0_0`R&Z#r!_!wYZ!P!Q!k%S%`%g'p'r's(O(W)g*g*h*k*q*t*v,h,i,k,l,o-m-p.f.g/ZR%^!vQ!{YQ%x#[Q&d#}Q&g$QR,{+YT.j-s/s![!jQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0gQ&X#kQ'c$oR*^'dR'l$|Q%V!mR/_.r'|_OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rS#a_#b!P.[-l.^._.`.a.t.z.|/R/j/o/t/u/y/z0S0U0W0Z0[0^0_0`'|_OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rT#a_#bT#^^#_R(o%xa(l%x(n(o+`,{-y-z.oT+[(k+]R-z,{Q$PsQ+l)aR,^*RX#}s$O$P&fQ&y$aQ'a$nQ'd$oR)s'SQ)b&wV-S+m-T-{ZgOn$j)t,PXkOn)t,PQ$k!TQ&z$bQ&{$cQ'^$mQ'b$oQ)q'RQ)x'WQ){'XQ)|'YQ*Z'`S*]'c'dQ+s)gQ+u)hQ+v)iQ+z)oS+|)r*[Q,Q)vQ,R)wS,S)y)zQ,d*^Q-V+rQ-W+tQ-Y+{S-Z+},OQ-`,UQ-b,VQ-|-XQ.O-[Q.P-^Q.Q-_Q.p-}Q.q.RQ/W.dR/r/XWkOn)t,PR#mjQ'`$nS)r'S'aR,O)sQ,]*RR-f,^Q*['`Q+})rR-[,OZiOjn)t,PQ'f$pR*`'gT-j,e-ku.c-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^t.c-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^Q/S.`X0V/z0W0_0`!P.Z-l.^._.`.a.t.z.|/R/j/o/t/u/y/z0S0U0W0Z0[0^0_0`Q.w.YR/f.xg.z.].{/b/i/n/|0O0Q0]0a0bu.b-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^X.u.W.b/a0PR/c.tV0R/u0S0[R/X.dQnOS#on,PR,P)tQ&^#uR(x&^S%m#R#wS(_%m(bT(b%p&`Q%a!yQ%h!}W(P%a%h(U(YQ(U%eR(Y%jQ&i$RR)O&iQ(e%qQ*{(`T+R(e*{Q'n%OR*e'nS'q%R%SY*i'q*j,m-q.hU*j'r's'tU,m*k*l*mS-q,n,oR.h-rQ#Y]R%t#YQ#_^R%y#_Q(h%vS+W(h+XR+X(iQ+](kR,|+]Q#b_R%{#bQ#ebQ%}#cW&Q#e%}({+bQ({&cR+b0gQ$OsS&e$O&fR&f$PQ&v$_R)_&vQ&V#jR(t&VQ&m$VS)T&m+hR+h)UQ$Z{R&p$ZQ&t$]R)[&tQ+n)bR-U+nQ#hfR&S#hQ)f&zR+q)fQ&}$dS)m&})nR)n'OQ'V$kR)u'VQ'[$lS*P'[,ZR,Z*QQ,a*VR-i,aWjOn)t,PR#ljQ-k,eR.U-kd.{.]/b/i/n/|0O0Q0]0a0bR/h.{U.s.W/a0PR/`.sQ/{/nS0X/{0YR0Y/|S/v/b/cR0T/vQ.}.]R/k.}R!ZPXmOn)t,PWlOn)t,PR'T$jYfOn$j)t,PR&R#g[sOn#g$j)t,PR&d#}&bQOYZ[dnprxy}!P!Q!U!i!k!o!p!q!s!t#[#d#g#y#{#}$Q$h$j$}%S%Z%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/Z/s0c0d0e0f0h0i0j0k0n0rQ!nTQ#caQ#poU$Rt%c(SS$d!R$gQ$p!XQ$u!cQ$v!dQ$w!eQ$x!fQ$y!gQ$z!hQ%e!zQ%j#OQ%p#SQ%q#TQ&`#xQ'O$eQ'g$qQ(q&OU(|&h(}+cW)j&|)l+x+yQ*o'|Q*x(]Q+w)kQ,v+QQ/q/VR0g0lQ!yYQ!}ZQ$b!PQ$c!QQ%R!kQ't%S^'{%`%g(O(W*q*t*v^*f'p*h,k,l-p.g/ZQ*l'rQ*m'sQ+t)gQ,j*gQ,n*kQ-n,hQ-o,iQ-r,oQ.e-mR/Y.f[bOn#g$j)t,P!^!vYZ!P!Q!k%S%`%g'p'r's(O(W)g*g*h*k*q*t*v,h,i,k,l,o-m-p.f.g/ZQ#R[Q#fdS#wrxQ$UyW$_}$Q'P)pS$l!U$hW${!i'm*d,gS%v#[+Y`&P#d%|(p(r(z+a-O0kQ&a#yQ&b#{Q&c#}Q'j$}Q'z%^W([%l(^*y*}Q(`%nQ(i%wQ(v&ZS(y&_0iQ)P&jQ)Q&kU)]&u)^+kQ)d&xQ)y'WY)}'Z*O,X,Y-dQ*b'lS*n'w0jW+P(d*z,s,wW+T(g+V,y,zQ+p)eQ,U)zQ,c*YQ,x+UQ-P+dQ-e,]Q-v,uR.S-fhUOn#d#g$j%|&_'w(p(r)t,P%S!uYZ[drxy}!P!Q!U!i!k#[#y#{#}$Q$h$}%S%^%`%g%l%n%w&Z&j&k&u&x'P'W'Z'l'm'p'r's(O(W(^(d(g(z)^)e)g)p)z*O*Y*d*g*h*k*q*t*v*y*z*}+U+V+Y+a+d+k,X,Y,],g,h,i,k,l,o,s,u,w,y,z-O-d-f-m-p.f.g/Z0i0j0kQ#qpW%W!o!s0d0nQ%X!pQ%Y!qQ%[!tQ%f0cS'v%Z0hQ'x0eQ'y0fQ,p*rQ-u,qS.i-s/sR0p0rU#uq.k0qR(w&][cOn#g$j)t,PZ!xY#[#}$Q+YQ#W[Q#zrR$TxQ%b!yQ%i!}Q%o#RQ'j${Q(V%eQ(Z%jQ(c%pQ(f%qQ*|(`Q,f*bQ-t,pQ.m-uR/].lQ$StQ(R%cR*s(SQ.l-sR/}/sR#QZR#V[R%Q!iQ%O!iV*c'm*d,g!]!lQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v/q0gR%T!kT#]^#_Q%x#[R,{+YQ(m%xS+_(n(oQ,}+`Q-x,{S.n-y-zR/^.oT+Z(k+]Q$`}Q&g$QQ)o'PR+{)pQ$XzQ)W&qR+i)XQ$XzQ&o$WQ)W&qR+i)XQ#khW$Vz$W&q)XQ$[{Q&r$ZZ)R&l)S+f+g-RR$^|R)c&wXlOn)t,PQ$f!RR'Q$gQ$m!UR'R$hR*X'_Q*V'_V-g,`-h.TQ.d-lQ/P.^R/Q._U.]-l.^._Q/U.aQ/b.tQ/g.zU/i.|/j/yQ/n/RQ/|/oQ0O/tU0Q/u0S0[Q0]0UQ0a0ZR0b0^R/T.`R/d.t",nodeNames:" print Escape { Comment Script AssignStatement * BinaryExpression BitOp BitOp BitOp BitOp ArithOp ArithOp @ ArithOp ** UnaryExpression ArithOp BitOp AwaitExpression await ) ( ParenthesizedExpression BinaryExpression or and CompareOp in not is UnaryExpression ConditionalExpression if else LambdaExpression lambda ParamList VariableName AssignOp , : NamedExpression AssignOp YieldExpression yield from TupleExpression ComprehensionExpression async for LambdaExpression ] [ ArrayExpression ArrayComprehensionExpression } { DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression CallExpression ArgList AssignOp MemberExpression . PropertyName Number String FormatString FormatReplacement FormatSelfDoc FormatConversion FormatSpec FormatReplacement FormatSelfDoc ContinuedString Ellipsis None Boolean TypeDef AssignOp UpdateStatement UpdateOp ExpressionStatement DeleteStatement del PassStatement pass BreakStatement break ContinueStatement continue ReturnStatement return YieldStatement PrintStatement RaiseStatement raise ImportStatement import as ScopeStatement global nonlocal AssertStatement assert TypeDefinition type TypeParamList TypeParam StatementGroup ; IfStatement Body elif WhileStatement while ForStatement TryStatement try except finally WithStatement with FunctionDefinition def ParamList AssignOp TypeDef ClassDefinition class DecoratedStatement Decorator At MatchStatement match MatchBody MatchClause case CapturePattern LiteralPattern ArithOp ArithOp AsPattern OrPattern LogicOp AttributePattern SequencePattern MappingPattern StarPattern ClassPattern PatternArgList KeywordPattern KeywordPattern Guard",maxTerm:277,context:x9,nodeProps:[["isolate",-5,4,71,72,73,77,""],["group",-15,6,85,87,88,90,92,94,96,98,99,100,102,105,108,110,"Statement Statement",-22,8,18,21,25,40,49,50,56,57,60,61,62,63,64,67,70,71,72,79,80,81,82,"Expression",-10,114,116,119,121,122,126,128,133,135,138,"Statement",-9,143,144,147,148,150,151,152,153,154,"Pattern"],["openedBy",23,"(",54,"[",58,"{"],["closedBy",24,")",55,"]",59,"}"]],propSources:[wt],skippedNodes:[0,4],repeatNodeCount:34,tokenData:"!2|~R!`OX%TXY%oY[%T[]%o]p%Tpq%oqr'ars)Yst*xtu%Tuv,dvw-hwx.Uxy/tyz0[z{0r{|2S|}2p}!O3W!O!P4_!P!Q:Z!Q!R;k!R![>_![!]Do!]!^Es!^!_FZ!_!`Gk!`!aHX!a!b%T!b!cIf!c!dJU!d!eK^!e!hJU!h!i!#f!i!tJU!t!u!,|!u!wJU!w!x!.t!x!}JU!}#O!0S#O#P&o#P#Q!0j#Q#R!1Q#R#SJU#S#T%T#T#UJU#U#VK^#V#YJU#Y#Z!#f#Z#fJU#f#g!,|#g#iJU#i#j!.t#j#oJU#o#p!1n#p#q!1s#q#r!2a#r#s!2f#s$g%T$g;'SJU;'S;=`KW<%lOJU`%YT&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T`%lP;=`<%l%To%v]&n`%c_OX%TXY%oY[%T[]%o]p%Tpq%oq#O%T#O#P&o#P#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To&tX&n`OY%TYZ%oZ]%T]^%o^#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc'f[&n`O!_%T!_!`([!`#T%T#T#U(r#U#f%T#f#g(r#g#h(r#h#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc(cTmR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc(yT!mR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk)aV&n`&[ZOr%Trs)vs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk){V&n`Or%Trs*bs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk*iT&n`&^ZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To+PZS_&n`OY*xYZ%TZ]*x]^%T^#o*x#o#p+r#p#q*x#q#r+r#r;'S*x;'S;=`,^<%lO*x_+wTS_OY+rZ]+r^;'S+r;'S;=`,W<%lO+r_,ZP;=`<%l+ro,aP;=`<%l*xj,kV%rQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj-XT!xY&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj-oV%lQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk.]V&n`&ZZOw%Twx.rx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk.wV&n`Ow%Twx/^x#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk/eT&n`&]ZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk/{ThZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc0cTgR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk0yXVZ&n`Oz%Tz{1f{!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk1mVaR&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk2ZV%oZ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc2wTzR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To3_W%pZ&n`O!_%T!_!`-Q!`!a3w!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Td4OT&{S&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk4fX!fQ&n`O!O%T!O!P5R!P!Q%T!Q![6T![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk5WV&n`O!O%T!O!P5m!P#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk5tT!rZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti6[a!hX&n`O!Q%T!Q![6T![!g%T!g!h7a!h!l%T!l!m9s!m#R%T#R#S6T#S#X%T#X#Y7a#Y#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti7fZ&n`O{%T{|8X|}%T}!O8X!O!Q%T!Q![8s![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti8^V&n`O!Q%T!Q![8s![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti8z]!hX&n`O!Q%T!Q![8s![!l%T!l!m9s!m#R%T#R#S8s#S#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti9zT!hX&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk:bX%qR&n`O!P%T!P!Q:}!Q!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj;UV%sQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti;ro!hX&n`O!O%T!O!P=s!P!Q%T!Q![>_![!d%T!d!e?q!e!g%T!g!h7a!h!l%T!l!m9s!m!q%T!q!rA]!r!z%T!z!{Bq!{#R%T#R#S>_#S#U%T#U#V?q#V#X%T#X#Y7a#Y#^%T#^#_9s#_#c%T#c#dA]#d#l%T#l#mBq#m#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti=xV&n`O!Q%T!Q![6T![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti>fc!hX&n`O!O%T!O!P=s!P!Q%T!Q![>_![!g%T!g!h7a!h!l%T!l!m9s!m#R%T#R#S>_#S#X%T#X#Y7a#Y#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti?vY&n`O!Q%T!Q!R@f!R!S@f!S#R%T#R#S@f#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti@mY!hX&n`O!Q%T!Q!R@f!R!S@f!S#R%T#R#S@f#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiAbX&n`O!Q%T!Q!YA}!Y#R%T#R#SA}#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiBUX!hX&n`O!Q%T!Q!YA}!Y#R%T#R#SA}#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiBv]&n`O!Q%T!Q![Co![!c%T!c!iCo!i#R%T#R#SCo#S#T%T#T#ZCo#Z#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiCv]!hX&n`O!Q%T!Q![Co![!c%T!c!iCo!i#R%T#R#SCo#S#T%T#T#ZCo#Z#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%ToDvV{_&n`O!_%T!_!`E]!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TcEdT%{R&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkEzT#gZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkFbXmR&n`O!^%T!^!_F}!_!`([!`!a([!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TjGUV%mQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkGrV%zZ&n`O!_%T!_!`([!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkH`WmR&n`O!_%T!_!`([!`!aHx!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TjIPV%nQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkIoV_Q#}P&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%ToJ_]&n`&YS%uZO!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUoKZP;=`<%lJUoKge&n`&YS%uZOr%Trs)Ysw%Twx.Ux!Q%T!Q![JU![!c%T!c!tJU!t!uLx!u!}JU!}#R%T#R#SJU#S#T%T#T#fJU#f#gLx#g#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUoMRa&n`&YS%uZOr%TrsNWsw%Twx! vx!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUkN_V&n`&`ZOr%TrsNts#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkNyV&n`Or%Trs! `s#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk! gT&n`&bZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk! }V&n`&_ZOw%Twx!!dx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!!iV&n`Ow%Twx!#Ox#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!#VT&n`&aZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!#oe&n`&YS%uZOr%Trs!%Qsw%Twx!&px!Q%T!Q![JU![!c%T!c!tJU!t!u!(`!u!}JU!}#R%T#R#SJU#S#T%T#T#fJU#f#g!(`#g#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!%XV&n`&dZOr%Trs!%ns#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!%sV&n`Or%Trs!&Ys#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!&aT&n`&fZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!&wV&n`&cZOw%Twx!'^x#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!'cV&n`Ow%Twx!'xx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!(PT&n`&eZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!(ia&n`&YS%uZOr%Trs!)nsw%Twx!+^x!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!)uV&n`&hZOr%Trs!*[s#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!*aV&n`Or%Trs!*vs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!*}T&n`&jZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!+eV&n`&gZOw%Twx!+zx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!,PV&n`Ow%Twx!,fx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!,mT&n`&iZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!-Vi&n`&YS%uZOr%TrsNWsw%Twx! vx!Q%T!Q![JU![!c%T!c!dJU!d!eLx!e!hJU!h!i!(`!i!}JU!}#R%T#R#SJU#S#T%T#T#UJU#U#VLx#V#YJU#Y#Z!(`#Z#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUo!.}a&n`&YS%uZOr%Trs)Ysw%Twx.Ux!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!0ZT!XZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc!0qT!WR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj!1XV%kQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T~!1sO!]~k!1zV%jR&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T~!2fO![~i!2mT%tX&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T",tokenizers:[x7,x5,x2,we,0,1,2,3,4],topRules:{Script:[0,5]},specialized:[{term:221,get:e=>wn[e]||-1}],tokenPrec:7664}),wi=new mi,wo=new Set(["Script","Body","FunctionDefinition","ClassDefinition","LambdaExpression","ForStatement","MatchClause"]);function ws(e){return(t,n,r)=>{if(r)return!1;let i=t.node.getChild("VariableName");return i&&n(i,e),!0}}let wa={FunctionDefinition:ws("function"),ClassDefinition:ws("class"),ForStatement(e,t,n){if(n){for(let n=e.node.firstChild;n;n=n.nextSibling)if("VariableName"==n.name)t(n,"variable");else if("in"==n.name)break}},ImportStatement(e,t){var n,r;let{node:i}=e,o=(null===(n=i.firstChild)||void 0===n?void 0:n.name)=="from";for(let e=i.getChild("import");e;e=e.nextSibling)"VariableName"==e.name&&(null===(r=e.nextSibling)||void 0===r?void 0:r.name)!="as"&&t(e,o?"variable":"namespace")},AssignStatement(e,t){for(let n=e.node.firstChild;n;n=n.nextSibling)if("VariableName"==n.name)t(n,"variable");else if(":"==n.name||"AssignOp"==n.name)break},ParamList(e,t){for(let n=null,r=e.node.firstChild;r;r=r.nextSibling)"VariableName"!=r.name||n&&/\*|AssignOp/.test(n.name)||t(r,"variable"),n=r},CapturePattern:ws("variable"),AsPattern:ws("variable"),__proto__:null},wl=/^[\w\xa1-\uffff][\w\d\xa1-\uffff]*$/,wc=["String","FormatString","Comment","PropertyName"];function wh(e){let t=mL(e.state).resolveInner(e.pos,-1);if(wc.indexOf(t.name)>-1)return null;let n="VariableName"==t.name||t.to-t.from<20&&wl.test(e.state.sliceDoc(t.from,t.to));if(!n&&!e.explicit)return null;let r=[];for(let n=t;n;n=n.parent)wo.has(n.name)&&(r=r.concat(function e(t,n){let r=wi.get(n);if(r)return r;let i=[],o=!0;function s(e,n){let r=t.sliceString(e.from,e.to);i.push({label:r,type:n})}return n.cursor(d.IncludeAnonymous).iterate(n=>{if(n.name){let e=wa[n.name];if(e&&e(n,s,o)||!o&&wo.has(n.name))return!1;o=!1}else if(n.to-n.from>8192){for(let r of e(t,n.node))i.push(r);return!1}}),wi.set(n,i),i}(e.state.doc,n)));return{options:r,from:n?t.from:e.pos,validFor:wl}}let wu=["__annotations__","__builtins__","__debug__","__doc__","__import__","__name__","__loader__","__package__","__spec__","False","None","True"].map(e=>({label:e,type:"constant"})).concat(["ArithmeticError","AssertionError","AttributeError","BaseException","BlockingIOError","BrokenPipeError","BufferError","BytesWarning","ChildProcessError","ConnectionAbortedError","ConnectionError","ConnectionRefusedError","ConnectionResetError","DeprecationWarning","EOFError","Ellipsis","EncodingWarning","EnvironmentError","Exception","FileExistsError","FileNotFoundError","FloatingPointError","FutureWarning","GeneratorExit","IOError","ImportError","ImportWarning","IndentationError","IndexError","InterruptedError","IsADirectoryError","KeyError","KeyboardInterrupt","LookupError","MemoryError","ModuleNotFoundError","NameError","NotADirectoryError","NotImplemented","NotImplementedError","OSError","OverflowError","PendingDeprecationWarning","PermissionError","ProcessLookupError","RecursionError","ReferenceError","ResourceWarning","RuntimeError","RuntimeWarning","StopAsyncIteration","StopIteration","SyntaxError","SyntaxWarning","SystemError","SystemExit","TabError","TimeoutError","TypeError","UnboundLocalError","UnicodeDecodeError","UnicodeEncodeError","UnicodeError","UnicodeTranslateError","UnicodeWarning","UserWarning","ValueError","Warning","ZeroDivisionError"].map(e=>({label:e,type:"type"}))).concat(["bool","bytearray","bytes","classmethod","complex","float","frozenset","int","list","map","memoryview","object","range","set","staticmethod","str","super","tuple","type"].map(e=>({label:e,type:"class"}))).concat(["abs","aiter","all","anext","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dict","dir","divmod","enumerate","eval","exec","exit","filter","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","license","locals","max","min","next","oct","open","ord","pow","print","property","quit","repr","reversed","round","setattr","slice","sorted","sum","vars","zip"].map(e=>({label:e,type:"function"}))),wd=[vq("def ${name}(${params}):\n	${}",{label:"def",detail:"function",type:"keyword"}),vq("for ${name} in ${collection}:\n	${}",{label:"for",detail:"loop",type:"keyword"}),vq("while ${}:\n	${}",{label:"while",detail:"loop",type:"keyword"}),vq("try:\n	${}\nexcept ${error}:\n	${}",{label:"try",detail:"/ except block",type:"keyword"}),vq(`if \${}:
	
`,{label:"if",detail:"block",type:"keyword"}),vq("if ${}:\n	${}\nelse:\n	${}",{label:"if",detail:"/ else block",type:"keyword"}),vq("class ${name}:\n	def __init__(self, ${params}):\n			${}",{label:"class",detail:"definition",type:"keyword"}),vq("import ${module}",{label:"import",detail:"statement",type:"keyword"}),vq("from ${module} import ${names}",{label:"from",detail:"import",type:"keyword"})],wf=bY(wc,bZ(wu.concat(wd)));function wp(e){let{node:t,pos:n}=e,r=e.lineIndent(n,-1),i=null;for(;;){let o=t.childBefore(n);if(o){if("Comment"==o.name)n=o.from;else if("Body"==o.name||"MatchBody"==o.name)e.baseIndentFor(o)+e.unit<=r&&(i=o),t=o;else if("MatchClause"==o.name)t=o;else if(o.type.is("Statement"))t=o;else break}else break}return i}function wm(e,t){let n=e.baseIndentFor(t),r=e.lineAt(e.pos,-1),i=r.from+r.text.length;return/^\s*($|#)/.test(r.text)&&e.node.to<i+100&&!/\S/.test(e.state.sliceDoc(i,e.node.to))&&e.lineIndent(e.pos,-1)<=n||/^\s*(else:|elif |except |finally:|case\s+[^=:]+:)/.test(e.textAfter)&&e.lineIndent(e.pos,-1)>n?null:n+e.unit}let wg=m$.define({name:"python",parser:wr.configure({props:[m1.add({Body:e=>{var t;let n=wp(e);return null!==(t=wm(e,n||e.node))&&void 0!==t?t:e.continue()},MatchBody:e=>{var t;let n=wp(e);return null!==(t=wm(e,n||e.node))&&void 0!==t?t:e.continue()},IfStatement:e=>/^\s*(else:|elif )/.test(e.textAfter)?e.baseIndent:e.continue(),"ForStatement WhileStatement":e=>/^\s*else:/.test(e.textAfter)?e.baseIndent:e.continue(),TryStatement:e=>/^\s*(except |finally:|else:)/.test(e.textAfter)?e.baseIndent:e.continue(),MatchStatement:e=>/^\s*case /.test(e.textAfter)?e.baseIndent+e.unit:e.continue(),"TupleExpression ComprehensionExpression ParamList ArgList ParenthesizedExpression":m4({closing:")"}),"DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression":m4({closing:"}"}),"ArrayExpression ArrayComprehensionExpression":m4({closing:"]"}),"String FormatString":()=>null,Script:e=>{var t;let n=wp(e);return null!==(t=n&&wm(e,n))&&void 0!==t?t:e.continue()}}),m9.add({"ArrayExpression DictionaryExpression SetExpression TupleExpression":function(e){let t=e.firstChild,n=e.lastChild;return t&&t.to<n.from?{from:t.to,to:n.type.isError?e.to:n.from}:null},Body:(e,t)=>({from:e.from+1,to:e.to-(e.to==t.doc.length?0:1)})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"'''",'"""'],stringPrefixes:["f","fr","rf","r","u","b","br","rb","F","FR","RF","R","U","B","BR","RB"]},commentTokens:{line:"#"},indentOnInput:/^\s*([\}\]\)]|else:|elif |except |finally:|case\s+[^:]*:?)$/}});function wy(e){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57}function wb(e,t,n){for(let r=!1;;){if(e.next<0)return;if(e.next==t&&!r){e.advance();return}r=n&&!r&&92==e.next,e.advance()}}function wv(e,t){for(;!(95!=e.next&&!wy(e.next));)null!=t&&(t+=String.fromCharCode(e.next)),e.advance();return t}function wx(e,t){for(;48==e.next||49==e.next;)e.advance();t&&e.next==t&&e.advance()}function ww(e,t){for(;;){if(46==e.next){if(t)break;t=!0}else if(e.next<48||e.next>57)break;e.advance()}if(69==e.next||101==e.next)for(e.advance(),(43==e.next||45==e.next)&&e.advance();e.next>=48&&e.next<=57;)e.advance()}function wk(e){for(;!(e.next<0||10==e.next);)e.advance()}function wO(e,t){for(let n=0;n<t.length;n++)if(t.charCodeAt(n)==e)return!0;return!1}let wS=` 	\r
`;function wC(e,t,n){let r=Object.create(null);for(let t of(r.true=r.false=5,r.null=r.unknown=6,e.split(" ")))t&&(r[t]=20);for(let e of t.split(" "))e&&(r[e]=21);for(let e of(n||"").split(" "))e&&(r[e]=24);return r}let wT={backslashEscapes:!1,hashComments:!1,spaceAfterDashes:!1,slashComments:!1,doubleQuotedStrings:!1,doubleDollarQuotedStrings:!1,unquotedBitLiterals:!1,treatBitsAsBytes:!1,charSetCasts:!1,plsqlQuotingMechanism:!1,operatorChars:"*+-%<>!=&|~^/",specialVar:"?",identifierQuotes:'"',caseInsensitiveIdentifiers:!1,words:wC("absolute action add after all allocate alter and any are as asc assertion at authorization before begin between both breadth by call cascade cascaded case cast catalog check close collate collation column commit condition connect connection constraint constraints constructor continue corresponding count create cross cube current current_date current_default_transform_group current_transform_group_for_type current_path current_role current_time current_timestamp current_user cursor cycle data day deallocate declare default deferrable deferred delete depth deref desc describe descriptor deterministic diagnostics disconnect distinct do domain drop dynamic each else elseif end end-exec equals escape except exception exec execute exists exit external fetch first for foreign found from free full function general get global go goto grant group grouping handle having hold hour identity if immediate in indicator initially inner inout input insert intersect into is isolation join key language last lateral leading leave left level like limit local localtime localtimestamp locator loop map match method minute modifies module month names natural nesting new next no none not of old on only open option or order ordinality out outer output overlaps pad parameter partial path prepare preserve primary prior privileges procedure public read reads recursive redo ref references referencing relative release repeat resignal restrict result return returns revoke right role rollback rollup routine row rows savepoint schema scroll search second section select session session_user set sets signal similar size some space specific specifictype sql sqlexception sqlstate sqlwarning start state static system_user table temporary then timezone_hour timezone_minute to trailing transaction translation treat trigger under undo union unique unnest until update usage user using value values view when whenever where while with without work write year zone ","array binary bit boolean char character clob date decimal double float int integer interval large national nchar nclob numeric object precision real smallint time timestamp varchar varying ")};function wA(e){return new xL(t=>{var n,r;let{next:i}=t;if(t.advance(),wO(i,wS)){for(;wO(t.next,wS);)t.advance();t.acceptToken(36)}else if(36==i&&e.doubleDollarQuotedStrings){let e=wv(t,"");36==t.next&&(t.advance(),function(e,t){e:for(;;){if(e.next<0)return;if(36==e.next){e.advance();for(let n=0;n<t.length;n++){if(e.next!=t.charCodeAt(n))continue e;e.advance()}if(36==e.next){e.advance();return}}else e.advance()}}(t,e),t.acceptToken(3))}else if(39==i||34==i&&e.doubleQuotedStrings)wb(t,i,e.backslashEscapes),t.acceptToken(3);else if(35==i&&e.hashComments||47==i&&47==t.next&&e.slashComments)wk(t),t.acceptToken(1);else if(45!=i||45!=t.next||e.spaceAfterDashes&&32!=t.peek(1)){if(47==i&&42==t.next){t.advance();for(let e=1;;){let n=t.next;if(t.next<0)break;if(t.advance(),42==n&&47==t.next){if(e--,t.advance(),!e)break}else 47==n&&42==t.next&&(e++,t.advance())}t.acceptToken(2)}else if((101==i||69==i)&&39==t.next)t.advance(),wb(t,39,!0),t.acceptToken(3);else if((110==i||78==i)&&39==t.next&&e.charSetCasts)t.advance(),wb(t,39,e.backslashEscapes),t.acceptToken(3);else if(95==i&&e.charSetCasts)for(let n=0;;n++){if(39==t.next&&n>1){t.advance(),wb(t,39,e.backslashEscapes),t.acceptToken(3);break}if(!wy(t.next))break;t.advance()}else if(e.plsqlQuotingMechanism&&(113==i||81==i)&&39==t.next&&t.peek(1)>0&&!wO(t.peek(1),wS)){let e=t.peek(1);t.advance(2),function(e,t){let n="[{<(".indexOf(String.fromCharCode(t)),r=n<0?t:"]}>)".charCodeAt(n);for(;;){if(e.next<0)return;if(e.next==r&&39==e.peek(1)){e.advance(2);return}e.advance()}}(t,e),t.acceptToken(3)}else if(40==i)t.acceptToken(7);else if(41==i)t.acceptToken(8);else if(123==i)t.acceptToken(9);else if(125==i)t.acceptToken(10);else if(91==i)t.acceptToken(11);else if(93==i)t.acceptToken(12);else if(59==i)t.acceptToken(13);else if(e.unquotedBitLiterals&&48==i&&98==t.next)t.advance(),wx(t),t.acceptToken(22);else if((98==i||66==i)&&(39==t.next||34==t.next)){let n=t.next;t.advance(),e.treatBitsAsBytes?(wb(t,n,e.backslashEscapes),t.acceptToken(23)):(wx(t,n),t.acceptToken(22))}else if(48==i&&(120==t.next||88==t.next)||(120==i||88==i)&&39==t.next){let e=39==t.next;for(t.advance();(r=t.next)>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70;)t.advance();e&&39==t.next&&t.advance(),t.acceptToken(4)}else if(46==i&&t.next>=48&&t.next<=57)ww(t,!0),t.acceptToken(4);else if(46==i)t.acceptToken(14);else if(i>=48&&i<=57)ww(t,!1),t.acceptToken(4);else if(wO(i,e.operatorChars)){for(;wO(t.next,e.operatorChars);)t.advance();t.acceptToken(15)}else if(wO(i,e.specialVar))t.next==i&&t.advance(),function(e){if(39==e.next||34==e.next||96==e.next){let t=e.next;e.advance(),wb(e,t,!1)}else wv(e)}(t),t.acceptToken(17);else if(wO(i,e.identifierQuotes))wb(t,i,!1),t.acceptToken(19);else if(58==i||44==i)t.acceptToken(16);else if(wy(i)){let r=wv(t,String.fromCharCode(i));t.acceptToken(46==t.next||46==t.peek(-r.length-1)?18:null!==(n=e.words[r.toLowerCase()])&&void 0!==n?n:18)}}else wk(t),t.acceptToken(1)})}let wE=wA(wT),wM=xZ.deserialize({version:14,states:"%vQ]QQOOO#wQRO'#DSO$OQQO'#CwO%eQQO'#CxO%lQQO'#CyO%sQQO'#CzOOQQ'#DS'#DSOOQQ'#C}'#C}O'UQRO'#C{OOQQ'#Cv'#CvOOQQ'#C|'#C|Q]QQOOQOQQOOO'`QQO'#DOO(xQRO,59cO)PQQO,59cO)UQQO'#DSOOQQ,59d,59dO)cQQO,59dOOQQ,59e,59eO)jQQO,59eOOQQ,59f,59fO)qQQO,59fOOQQ-E6{-E6{OOQQ,59b,59bOOQQ-E6z-E6zOOQQ,59j,59jOOQQ-E6|-E6|O+VQRO1G.}O+^QQO,59cOOQQ1G/O1G/OOOQQ1G/P1G/POOQQ1G/Q1G/QP+kQQO'#C}O+rQQO1G.}O)PQQO,59cO,PQQO'#Cw",stateData:",[~OtOSPOSQOS~ORUOSUOTUOUUOVROXSOZTO]XO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O^]ORvXSvXTvXUvXVvXXvXZvX]vX_vX`vXavXbvXcvXdvXevXfvXgvXhvX~OsvX~P!jOa_Ob_Oc_O~ORUOSUOTUOUUOVROXSOZTO^tO_UO`UOa`Ob`Oc`OdUOeUOfUOgUOhUO~OWaO~P$ZOYcO~P$ZO[eO~P$ZORUOSUOTUOUUOVROXSOZTO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O]hOsoX~P%zOajObjOcjO~O^]ORkaSkaTkaUkaVkaXkaZka]ka_ka`kaakabkackadkaekafkagkahka~Oska~P'kO^]O~OWvXYvX[vX~P!jOWnO~P$ZOYoO~P$ZO[pO~P$ZO^]ORkiSkiTkiUkiVkiXkiZki]ki_ki`kiakibkickidkiekifkigkihki~Oski~P)xOWkaYka[ka~P'kO]hO~P$ZOWkiYki[ki~P)xOasObsOcsO~O",goto:"#hwPPPPPPPPPPPPPPPPPPPPPPPPPPx||||!Y!^!d!xPPP#[TYOZeUORSTWZbdfqT[OZQZORiZSWOZQbRQdSQfTZgWbdfqQ^PWk^lmrQl_Qm`RrseVORSTWZbdfq",nodeNames:" LineComment BlockComment String Number Bool Null ( ) { } [ ] ; . Operator Punctuation SpecialVar Identifier QuotedIdentifier Keyword Type Bits Bytes Builtin Script Statement CompositeIdentifier Parens Braces Brackets Statement",maxTerm:38,nodeProps:[["isolate",-4,1,2,3,19,""]],skippedNodes:[0,1,2],repeatNodeCount:3,tokenData:"RORO",tokenizers:[0,wE],topRules:{Script:[0,25]},tokenPrec:0});function w_(e){let t=e.cursor().moveTo(e.from,-1);for(;/Comment/.test(t.name);)t.moveTo(t.from,-1);return t.node}function wD(e,t){let n=e.sliceString(t.from,t.to),r=/^([`'"])(.*)\1$/.exec(n);return r?r[2]:n}function wN(e){return e&&("Identifier"==e.name||"QuotedIdentifier"==e.name)}function wR(e,t){for(let n=[];;){if(!t||"."!=t.name)return n;let r=w_(t);if(!wN(r))return n;n.unshift(wD(e,r)),t=w_(r)}}let wP=new Set("where group having order union intersect except all distinct limit offset fetch for".split(" ")),wj=/^\w*$/,wI=/^[`'"]?\w*[`'"]?$/;function w$(e){return e.self&&"string"==typeof e.self.label}class wL{constructor(e,t){this.idQuote=e,this.idCaseInsensitive=t,this.list=[],this.children=void 0}child(e){let t=this.children||(this.children=Object.create(null));return t[e]||(e&&!this.list.some(t=>t.label==e)&&this.list.push(wq(e,"type",this.idQuote,this.idCaseInsensitive)),t[e]=new wL(this.idQuote,this.idCaseInsensitive))}maybeChild(e){return this.children?this.children[e]:null}addCompletion(e){let t=this.list.findIndex(t=>t.label==e.label);t>-1?this.list[t]=e:this.list.push(e)}addCompletions(e){for(let t of e)this.addCompletion("string"==typeof t?wq(t,"property",this.idQuote,this.idCaseInsensitive):t)}addNamespace(e){Array.isArray(e)?this.addCompletions(e):w$(e)?this.addNamespace(e.children):this.addNamespaceObject(e)}addNamespaceObject(e){for(let t of Object.keys(e)){let n=e[t],r=null,i=t.replace(/\\?\./g,e=>"."==e?"\0":e).split("\0"),o=this;w$(n)&&(r=n.self,n=n.children);for(let e=0;e<i.length;e++)r&&e==i.length-1&&o.addCompletion(r),o=o.child(i[e].replace(/\\\./g,"."));o.addNamespace(n)}}}function wq(e,t,n,r){return RegExp("^[a-z_][a-z_\\d]*$",r?"i":"").test(e)?{label:e,type:t}:{label:e,type:t,apply:n+e+n}}let wz=wM.configure({props:[m1.add({Statement:function({except:e,units:t=1}={}){return n=>{let r=e&&e.test(n.textAfter);return n.baseIndent+(r?0:t*n.unit)}}()}),m9.add({Statement:(e,t)=>({from:Math.min(e.from+100,t.doc.lineAt(e.from).to),to:e.to}),BlockComment:e=>({from:e.from+2,to:e.to-2})}),md({Keyword:mN.keyword,Type:mN.typeName,Builtin:mN.standard(mN.name),Bits:mN.number,Bytes:mN.string,Bool:mN.bool,Null:mN.null,Number:mN.number,String:mN.string,Identifier:mN.name,QuotedIdentifier:mN.special(mN.string),SpecialVar:mN.special(mN.name),LineComment:mN.lineComment,BlockComment:mN.blockComment,Operator:mN.operator,"Semi Punctuation":mN.punctuation,"( )":mN.paren,"{ }":mN.brace,"[ ]":mN.squareBracket})]});class wB{constructor(e,t,n){this.dialect=e,this.language=t,this.spec=n}get extension(){return this.language.extension}static define(e){let t=function(e,t,n,r){let i={};for(let t in wT)i[t]=(e.hasOwnProperty(t)?e:wT)[t];return t&&(i.words=wC(t,n||"",r)),i}(e,e.keywords,e.types,e.builtin),n=m$.define({name:"sql",parser:wz.configure({tokenizers:[{from:wE,to:wA(t)}]}),languageData:{commentTokens:{line:"--",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]}}});return new wB(t,n,e)}}function wF(e,t){return{label:e,type:t,boost:-1}}function wQ(e={}){var t,n,r,i,o,s,a;let l,c,h=e.dialect||wV;return new mG(h.language,[e.schema?(e.dialect||wV).language.data.of({autocomplete:e.schema?(t=e.schema,n=e.tables,r=e.schemas,i=e.defaultTable,o=e.defaultSchema,l=new wL((null===(a=null==(s=e.dialect||wV)?void 0:s.spec.identifierQuotes)||void 0===a?void 0:a[0])||'"',!!(null!=s&&s.spec.caseInsensitiveIdentifiers)),c=o?l.child(o):null,l.addNamespace(t),n&&(c||l).addCompletions(n),r&&l.addCompletions(r),c&&l.addCompletions(c.list),i&&l.addCompletions((c||l).child(i).list),e=>{var t,n,r;let o,s;let{parents:a,from:h,quoted:u,empty:d,aliases:f}=(t=e.state,n=e.pos,o=mL(t).resolveInner(n,-1),s=function(e,t){let n;for(let e=t;!n;e=e.parent){if(!e)return null;"Statement"==e.name&&(n=e)}let r=null;for(let t=n.firstChild,i=!1,o=null;t;t=t.nextSibling){let n="Keyword"==t.name?e.sliceString(t.from,t.to).toLowerCase():null,s=null;if(i){if("as"==n&&o&&wN(t.nextSibling))s=wD(e,t.nextSibling);else{if(n&&wP.has(n))break;o&&wN(t)&&(s=wD(e,t))}}else i="from"==n;s&&(r||(r=Object.create(null)),r[s]=function(e,t){if("CompositeIdentifier"==t.name){let n=[];for(let r=t.firstChild;r;r=r.nextSibling)wN(r)&&n.push(wD(e,r));return n}return[wD(e,t)]}(e,o)),o=/Identifier$/.test(t.name)?t:null}return r}(t.doc,o),"Identifier"==o.name||"QuotedIdentifier"==o.name||"Keyword"==o.name?{from:o.from,quoted:"QuotedIdentifier"==o.name?t.doc.sliceString(o.from,o.from+1):null,parents:wR(t.doc,w_(o)),aliases:s}:"."==o.name?{from:n,quoted:null,parents:wR(t.doc,o),aliases:s}:{from:n,quoted:null,parents:[],empty:!0,aliases:s});if(d&&!e.explicit)return null;f&&1==a.length&&(a=f[a[0]]||a);let p=l;for(let e of a){for(;!p.children||!p.children[e];)if(p==l&&c)p=c;else{if(p!=c||!i)return null;p=p.child(i)}let t=p.maybeChild(e);if(!t)return null;p=t}let m=u&&e.state.sliceDoc(e.pos,e.pos+1)==u,g=p.list;return p==l&&f&&(g=g.concat(Object.keys(f).map(e=>({label:e,type:"constant"})))),{from:h,to:m?e.pos+1:void 0,options:(r=g,u?r.map(e=>Object.assign(Object.assign({},e),{label:e.label[0]==u?e.label:u+e.label+u,apply:void 0})):r),validFor:u?wI:wj}}):()=>null}):[],h.language.data.of({autocomplete:function(e,t=!1,n){var r,i;return r=e.dialect.words,i=n||wF,bY(["QuotedIdentifier","SpecialVar","String","LineComment","BlockComment","."],bZ(Object.keys(r).map(e=>{var n;return i(t?e.toUpperCase():e,21==(n=r[e])?"type":20==n?"keyword":"variable")})))}(h,e.upperCaseKeywords,e.keywordCompletion)})])}let wV=wB.define({});class wW extends C.Component{constructor(e){super(e),this.state={hasError:!1,errorInfo:null,error:null,maybeOldAnalysis:e.maybeOldAnalysis}}static getDerivedStateFromError(e){return console.log(e),{hasError:!0}}componentDidCatch(e,t){console.log(e,t),this.setState({hasError:!0,errorInfo:t,error:e})}render(){return this.state.hasError?S.j.jsx("div",{className:"error-boundary-ctr dark:bg-gray-800 dark:text-gray-300",children:this.props.maybeOldAnalysis?S.j.jsx("p",{className:"text-rose-500 dark:text-rose-400",children:"You might need to re run this analysis for the latest version of the UI."}):S.j.jsx("p",{className:"dark:text-gray-300",children:this.props.customErrorMessage||"Something went wrong."})}):this.props.children}}function wU({code:e=null,language:t="sql",updateProp:n=null,className:r="",handleEdit:i,editable:o=!0}){let[s,a]=(0,C.useState)(e||""),l=(0,C.useRef)(null),[c,h]=(0,C.useState)(!1);(0,C.useEffect)(()=>{let e=()=>{h(!!document.querySelector(".dark"))};e();let t=new MutationObserver(e);t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"],subtree:!0,childList:!0}),window.addEventListener("storage",e);let n=window.matchMedia("(prefers-color-scheme: dark)");return n.addEventListener("change",e),()=>{t.disconnect(),window.removeEventListener("storage",e),n.removeEventListener("change",e)}},[]),(0,C.useEffect)(()=>{a(e||"")},[e]);let u=e=>{e&&(a(e),i(n,e))},d=e=>{u(e)};return S.j.jsx(wW,{children:S.j.jsx(S.j.Fragment,{children:S.j.jsx(xE,{extensions:["python"===t?new mG(wg,[wg.data.of({autocomplete:wh}),wg.data.of({autocomplete:wf})]):wQ(),fm.lineWrapping],basicSetup:{lineNumbers:!1},theme:c?"dark":"light",className:(0,S.t)("language-"+t,"dark:prose-invert [&_.cm-editor]:dark:!bg-gray-800 [&_.cm-scroller]:dark:!bg-gray-800 [&_.cm-gutters]:dark:!bg-gray-800 [&_.cm-tooltip]:dark:!bg-gray-700 [&_.cm-tooltip]:dark:!border-gray-600 [&_.cm-activeLine]:dark:!bg-gray-700/50 [&_.cm-activeLineGutter]:dark:!bg-gray-700/50",r),value:s,onChange:e=>{d(e)},editable:o,ref:l})})})}function wH(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let wG=wH(),wX=/[&<>"']/,wZ=RegExp(wX.source,"g"),wY=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,wJ=RegExp(wY.source,"g"),wK={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},w0=e=>wK[e];function w1(e,t){if(t){if(wX.test(e))return e.replace(wZ,w0)}else if(wY.test(e))return e.replace(wJ,w0);return e}let w2=/(^|[^\[])\^/g;function w5(e,t){let n="string"==typeof e?e:e.source;t=t||"";let r={replace:(e,t)=>{let i="string"==typeof t?t:t.source;return i=i.replace(w2,"$1"),n=n.replace(e,i),r},getRegex:()=>new RegExp(n,t)};return r}function w3(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}let w4={exec:()=>null};function w6(e,t){let n=e.replace(/\|/g,(e,t,n)=>{let r=!1,i=t;for(;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),t){if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("")}for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function w8(e,t,n){let r=e.length;if(0===r)return"";let i=0;for(;i<r&&e.charAt(r-i-1)===t;)i++;return e.slice(0,r-i)}function w9(e,t,n,r){let i=t.href,o=t.title?w1(t.title):null,s=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;let e={type:"link",raw:n,href:i,title:o,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:i,title:o,text:w1(s)}}class w7{constructor(e){D(this,"options"),D(this,"rules"),D(this,"lexer"),this.options=e||wG}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let e=t[0].replace(/^(?: {1,4}| {0,3}\t)/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:w8(e,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let e=t[0],n=function(e,t){let n=e.match(/^(\s+)(?:```)/);if(null===n)return t;let r=n[1];return t.split(`
`).map(e=>{let t=e.match(/^\s+/);if(null===t)return e;let[n]=t;return n.length>=r.length?e.slice(r.length):e}).join(`
`)}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){let t=w8(e,"#");(this.options.pedantic||!t||/ $/.test(t))&&(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:w8(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let e=w8(t[0],`
`).split(`
`),n="",r="",i=[];for(;e.length>0;){let t,o=!1,s=[];for(t=0;t<e.length;t++)if(/^ {0,3}>/.test(e[t]))s.push(e[t]),o=!0;else if(o)break;else s.push(e[t]);e=e.slice(t);let a=s.join(`
`),l=a.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");n=n?`${n}
${a}`:a,r=r?`${r}
${l}`:l;let c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,i,!0),this.lexer.state.top=c,0===e.length)break;let h=i[i.length-1];if((null==h?void 0:h.type)==="code")break;if((null==h?void 0:h.type)==="blockquote"){let t=h.raw+`
`+e.join(`
`),o=this.blockquote(t);i[i.length-1]=o,n=n.substring(0,n.length-h.raw.length)+o.raw,r=r.substring(0,r.length-h.text.length)+o.text;break}if((null==h?void 0:h.type)==="list"){let t=h.raw+`
`+e.join(`
`),o=this.list(t);i[i.length-1]=o,n=n.substring(0,n.length-h.raw.length)+o.raw,r=r.substring(0,r.length-h.raw.length)+o.raw,e=t.substring(i[i.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:i,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,i={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let o=RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),s=!1;for(;e;){let n=!1,r="",a="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;r=t[0],e=e.substring(r.length);let l=t[2].split(`
`,1)[0].replace(/^\t+/,e=>" ".repeat(3*e.length)),c=e.split(`
`,1)[0],h=!l.trim(),u=0;if(this.options.pedantic?(u=2,a=l.trimStart()):h?u=t[1].length+1:(u=(u=t[2].search(/[^ ]/))>4?1:u,a=l.slice(u),u+=t[1].length),h&&/^[ \t]*$/.test(c)&&(r+=c+`
`,e=e.substring(c.length+1),n=!0),!n){let t=RegExp(`^ {0,${Math.min(3,u-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),n=RegExp(`^ {0,${Math.min(3,u-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),i=RegExp(`^ {0,${Math.min(3,u-1)}}(?:\`\`\`|~~~)`),o=RegExp(`^ {0,${Math.min(3,u-1)}}#`),s=RegExp(`^ {0,${Math.min(3,u-1)}}<(?:[a-z].*>|!--)`,"i");for(;e;){let d;let f=e.split(`
`,1)[0];if(c=f,d=this.options.pedantic?c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  "):c.replace(/\t/g,"    "),i.test(c)||o.test(c)||s.test(c)||t.test(c)||n.test(c))break;if(d.search(/[^ ]/)>=u||!c.trim())a+=`
`+d.slice(u);else{if(h||l.replace(/\t/g,"    ").search(/[^ ]/)>=4||i.test(l)||o.test(l)||n.test(l))break;a+=`
`+c}h||c.trim()||(h=!0),r+=f+`
`,e=e.substring(f.length+1),l=d.slice(u)}}i.loose||(s?i.loose=!0:/\n[ \t]*\n[ \t]*$/.test(r)&&(s=!0));let d=null,f;this.options.gfm&&(d=/^\[[ xX]\] /.exec(a))&&(f="[ ] "!==d[0],a=a.replace(/^\[[ xX]\] +/,"")),i.items.push({type:"list_item",raw:r,task:!!d,checked:f,loose:!1,text:a,tokens:[]}),i.raw+=r}i.items[i.items.length-1].raw=i.items[i.items.length-1].raw.trimEnd(),i.items[i.items.length-1].text=i.items[i.items.length-1].text.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){let t=i.items[e].tokens.filter(e=>"space"===e.type),n=t.length>0&&t.some(e=>/\n.*\n/.test(e.raw));i.loose=n}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let e=t[1].toLowerCase().replace(/\s+/g," "),n=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;let n=w6(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),i=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let e of r)/^ *-+: *$/.test(e)?o.align.push("right"):/^ *:-+: *$/.test(e)?o.align.push("center"):/^ *:-+ *$/.test(e)?o.align.push("left"):o.align.push(null);for(let e=0;e<n.length;e++)o.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:o.align[e]});for(let e of i)o.rows.push(w6(e,o.header.length).map((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:o.align[t]})));return o}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let e=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:w1(t[1])}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;let t=w8(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{let e=function(e,t){if(-1===e.indexOf(")"))return -1;let n=0;for(let t=0;t<e.length;t++)if("\\"===e[t])t++;else if("("===e[t])n++;else if(")"===e[t]&&--n<0)return t;return -1}(t[2],"()");if(e>-1){let n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){let e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),w9(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=t[(n[2]||n[1]).replace(/\s+/g," ").toLowerCase()];if(!e){let e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return w9(n,e,n[0],this.lexer)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(/[\p{L}\p{N}]/u))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let n=[...r[0]].length-1,i,o,s=n,a=0,l="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=l.exec(t));){if(!(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6]))continue;if(o=[...i].length,r[3]||r[4]){s+=o;continue}if((r[5]||r[6])&&n%3&&!((n+o)%3)){a+=o;continue}if((s-=o)>0)continue;o=Math.min(o,o+s+a);let t=[...r[0]][0].length,l=e.slice(0,n+r.index+t+o);if(Math.min(n,o)%2){let e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}let c=l.slice(2,-2);return{type:"strong",raw:l,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," "),n=/[^ ]/.test(e),r=/^ /.test(e)&&/ $/.test(e);return n&&r&&(e=e.substring(1,e.length-1)),e=w1(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let e,n;return n="@"===t[2]?"mailto:"+(e=w1(t[1])):e=w1(t[1]),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){var t;let n;if(n=this.rules.inline.url.exec(e)){let e,r;if("@"===n[2])r="mailto:"+(e=w1(n[0]));else{let i;do i=n[0],n[0]=(null==(t=this.rules.inline._backpedal.exec(n[0]))?void 0:t[0])??"";while(i!==n[0]);e=w1(n[0]),r="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let e;return e=this.lexer.state.inRawBlock?t[0]:w1(t[0]),{type:"text",raw:t[0],text:e}}}}let ke=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,kt=/(?:[*+-]|\d{1,9}[.)])/,kn=w5(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,kt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),kr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ki=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ko=w5(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ki).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ks=w5(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,kt).getRegex(),ka="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",kl=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,kc=w5("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",kl).replace("tag",ka).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),kh=w5(kr).replace("hr",ke).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ka).getRegex(),ku={blockquote:w5(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",kh).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:ko,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:ke,html:kc,lheading:kn,list:ks,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:kh,table:w4,text:/^[^\n]+/},kd=w5("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ke).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ka).getRegex(),kf={...ku,table:kd,paragraph:w5(kr).replace("hr",ke).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",kd).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ka).getRegex()},kp={...ku,html:w5(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",kl).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:w4,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:w5(kr).replace("hr",ke).replace("heading",` *#{1,6} *[^
]`).replace("lheading",kn).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},km=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,kg=/^( {2,}|\\)\n(?!\s*$)/,ky="\\p{P}\\p{S}",kb=w5(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,ky).getRegex(),kv=w5(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,ky).getRegex(),kx=w5("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,ky).getRegex(),kw=w5("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,ky).getRegex(),kk=w5(/\\([punct])/,"gu").replace(/punct/g,ky).getRegex(),kO=w5(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),kS=w5(kl).replace("(?:--\x3e|$)","--\x3e").getRegex(),kC=w5("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",kS).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),kT=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,kA=w5(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",kT).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),kE=w5(/^!?\[(label)\]\[(ref)\]/).replace("label",kT).replace("ref",ki).getRegex(),kM=w5(/^!?\[(ref)\](?:\[\])?/).replace("ref",ki).getRegex(),k_=w5("reflink|nolink(?!\\()","g").replace("reflink",kE).replace("nolink",kM).getRegex(),kD={_backpedal:w4,anyPunctuation:kk,autolink:kO,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:kg,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:w4,emStrongLDelim:kv,emStrongRDelimAst:kx,emStrongRDelimUnd:kw,escape:km,link:kA,nolink:kM,punctuation:kb,reflink:kE,reflinkSearch:k_,tag:kC,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:w4},kN={...kD,link:w5(/^!?\[(label)\]\((.*?)\)/).replace("label",kT).getRegex(),reflink:w5(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",kT).getRegex()},kR={...kD,escape:w5(km).replace("])","~|])").getRegex(),url:w5(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},kP={...kR,br:w5(kg).replace("{2,}","*").getRegex(),text:w5(kR.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},kj={normal:ku,gfm:kf,pedantic:kp},kI={normal:kD,gfm:kR,breaks:kP,pedantic:kN};class k${constructor(e){D(this,"tokens"),D(this,"options"),D(this,"state"),D(this,"tokenizer"),D(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||wG,this.options.tokenizer=this.options.tokenizer||new w7,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={block:kj.normal,inline:kI.normal};this.options.pedantic?(t.block=kj.pedantic,t.inline=kI.pedantic):this.options.gfm&&(t.block=kj.gfm,this.options.breaks?t.inline=kI.breaks:t.inline=kI.gfm),this.tokenizer.rules=t}static get rules(){return{block:kj,inline:kI}}static lex(e,t){return new k$(t).lex(e)}static lexInline(e,t){return new k$(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){let r,i,o;for(this.options.pedantic&&(e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),1===r.raw.length&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),(i=t[t.length-1])&&("paragraph"===i.type||"text"===i.type)?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if((r=this.tokenizer.fences(e))||(r=this.tokenizer.heading(e))||(r=this.tokenizer.hr(e))||(r=this.tokenizer.blockquote(e))||(r=this.tokenizer.list(e))||(r=this.tokenizer.html(e))){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),(i=t[t.length-1])&&("paragraph"===i.type||"text"===i.type)?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if((r=this.tokenizer.table(e))||(r=this.tokenizer.lheading(e))){e=e.substring(r.raw.length),t.push(r);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let t,n=1/0,r=e.slice(1);this.options.extensions.startBlock.forEach(e=>{"number"==typeof(t=e.call({lexer:this},r))&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(o=e.substring(0,n+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){i=t[t.length-1],n&&(null==i?void 0:i.type)==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),n=o.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),(i=t[t.length-1])&&"text"===i.type?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,r,i,o=e,s,a,l;if(this.tokens.links){let e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(o));)e.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(o));)o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.anyPunctuation.exec(o));)o=o.slice(0,s.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(a||(l=""),a=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),(r=t[t.length-1])&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),(r=t[t.length-1])&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if((n=this.tokenizer.emStrong(e,o,l))||(n=this.tokenizer.codespan(e))||(n=this.tokenizer.br(e))||(n=this.tokenizer.del(e))||(n=this.tokenizer.autolink(e))||!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}if(i=e,this.options.extensions&&this.options.extensions.startInline){let t,n=1/0,r=e.slice(1);this.options.extensions.startInline.forEach(e=>{"number"==typeof(t=e.call({lexer:this},r))&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(i=e.substring(0,n+1))}if(n=this.tokenizer.inlineText(i)){e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(l=n.raw.slice(-1)),a=!0,(r=t[t.length-1])&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw Error(t)}}return t}}class kL{constructor(e){D(this,"options"),D(this,"parser"),this.options=e||wG}space(e){return""}code({text:e,lang:t,escaped:n}){var r;let i=null==(r=(t||"").match(/^\S*/))?void 0:r[0],o=e.replace(/\n$/,"")+`
`;return i?'<pre><code class="language-'+w1(i)+'">'+(n?o:w1(o,!0))+`</code></pre>
`:"<pre><code>"+(n?o:w1(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let t=0;t<e.items.length;t++){let n=e.items[t];r+=this.listitem(n)}let i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+`>
`+r+"</"+i+`>
`}listitem(e){let t="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&"paragraph"===e.tokens[0].type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" "}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let r="";for(let t=0;t<e.rows.length;t++){let i=e.rows[t];n="";for(let e=0;e<i.length;e++)n+=this.tablecell(i[e]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),i=w3(e);if(null===i)return r;let o='<a href="'+(e=i)+'"';return t&&(o+=' title="'+t+'"'),o+=">"+r+"</a>"}image({href:e,title:t,text:n}){let r=w3(e);if(null===r)return n;e=r;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${t}"`),i+=">"}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class kq{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class kz{constructor(e){D(this,"options"),D(this,"renderer"),D(this,"textRenderer"),this.options=e||wG,this.options.renderer=this.options.renderer||new kL,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new kq}static parse(e,t){return new kz(t).parse(e)}static parseInline(e,t){return new kz(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){let i=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){let e=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==e||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(i.type)){n+=e||"";continue}}switch(i.type){case"space":n+=this.renderer.space(i);continue;case"hr":n+=this.renderer.hr(i);continue;case"heading":n+=this.renderer.heading(i);continue;case"code":n+=this.renderer.code(i);continue;case"table":n+=this.renderer.table(i);continue;case"blockquote":n+=this.renderer.blockquote(i);continue;case"list":n+=this.renderer.list(i);continue;case"html":n+=this.renderer.html(i);continue;case"paragraph":n+=this.renderer.paragraph(i);continue;case"text":{let o=i,s=this.renderer.text(o);for(;r+1<e.length&&"text"===e[r+1].type;)o=e[++r],s+=`
`+this.renderer.text(o);t?n+=this.renderer.paragraph({type:"paragraph",raw:s,text:s,tokens:[{type:"text",raw:s,text:s}]}):n+=s;continue}default:{let e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw Error(e)}}}return n}parseInline(e,t){t=t||this.renderer;let n="";for(let r=0;r<e.length;r++){let i=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){let e=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){n+=e||"";continue}}switch(i.type){case"escape":case"text":n+=t.text(i);break;case"html":n+=t.html(i);break;case"link":n+=t.link(i);break;case"image":n+=t.image(i);break;case"strong":n+=t.strong(i);break;case"em":n+=t.em(i);break;case"codespan":n+=t.codespan(i);break;case"br":n+=t.br(i);break;case"del":n+=t.del(i);break;default:{let e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw Error(e)}}}return n}}class kB{constructor(e){D(this,"options"),D(this,"block"),this.options=e||wG}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?k$.lex:k$.lexInline}provideParser(){return this.block?kz.parse:kz.parseInline}}D(kB,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class kF{constructor(...e){D(this,"defaults",wH()),D(this,"options",this.setOptions),D(this,"parse",this.parseMarkdown(!0)),D(this,"parseInline",this.parseMarkdown(!1)),D(this,"Parser",kz),D(this,"Renderer",kL),D(this,"TextRenderer",kq),D(this,"Lexer",k$),D(this,"Tokenizer",w7),D(this,"Hooks",kB),this.use(...e)}walkTokens(e,t){var n,r;let i=[];for(let o of e)switch(i=i.concat(t.call(this,o)),o.type){case"table":for(let e of o.header)i=i.concat(this.walkTokens(e.tokens,t));for(let e of o.rows)for(let n of e)i=i.concat(this.walkTokens(n.tokens,t));break;case"list":i=i.concat(this.walkTokens(o.items,t));break;default:{let e=o;null!=(r=null==(n=this.defaults.extensions)?void 0:n.childTokens)&&r[e.type]?this.defaults.extensions.childTokens[e.type].forEach(n=>{let r=e[n].flat(1/0);i=i.concat(this.walkTokens(r,t))}):e.tokens&&(i=i.concat(this.walkTokens(e.tokens,t)))}}return i}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(e=>{let n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach(e=>{if(!e.name)throw Error("extension name required");if("renderer"in e){let n=t.renderers[e.name];n?t.renderers[e.name]=function(...t){let r=e.renderer.apply(this,t);return!1===r&&(r=n.apply(this,t)),r}:t.renderers[e.name]=e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw Error("extension level must be 'block' or 'inline'");let n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)}),n.extensions=t),e.renderer){let t=this.defaults.renderer||new kL(this.defaults);for(let n in e.renderer){if(!(n in t))throw Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;let r=e.renderer[n],i=t[n];t[n]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){let t=this.defaults.tokenizer||new w7(this.defaults);for(let n in e.tokenizer){if(!(n in t))throw Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;let r=e.tokenizer[n],i=t[n];t[n]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){let t=this.defaults.hooks||new kB;for(let n in e.hooks){if(!(n in t))throw Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;let r=e.hooks[n],i=t[n];kB.passThroughHooks.has(n)?t[n]=e=>{if(this.defaults.async)return Promise.resolve(r.call(t,e)).then(e=>i.call(t,e));let n=r.call(t,e);return i.call(t,n)}:t[n]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){let t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return k$.lex(e,t??this.defaults)}parser(e,t){return kz.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},i={...this.defaults,...r},o=this.onError(!!i.silent,!!i.async);if(!0===this.defaults.async&&!1===r.async)return o(Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||null===t)return o(Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return o(Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);let s=i.hooks?i.hooks.provideLexer():e?k$.lex:k$.lexInline,a=i.hooks?i.hooks.provideParser():e?kz.parse:kz.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then(e=>s(e,i)).then(e=>i.hooks?i.hooks.processAllTokens(e):e).then(e=>i.walkTokens?Promise.all(this.walkTokens(e,i.walkTokens)).then(()=>e):e).then(e=>a(e,i)).then(e=>i.hooks?i.hooks.postprocess(e):e).catch(o);try{i.hooks&&(t=i.hooks.preprocess(t));let e=s(t,i);i.hooks&&(e=i.hooks.processAllTokens(e)),i.walkTokens&&this.walkTokens(e,i.walkTokens);let n=a(e,i);return i.hooks&&(n=i.hooks.postprocess(n)),n}catch(e){return o(e)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let e="<p>An error occurred:</p><pre>"+w1(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}}let kQ=new kF;function kV(e,t){return kQ.parse(e,t)}kV.options=kV.setOptions=function(e){return kQ.setOptions(e),kV.defaults=kQ.defaults,wG=kV.defaults,kV},kV.getDefaults=wH,kV.defaults=wG,kV.use=function(...e){return kQ.use(...e),kV.defaults=kQ.defaults,wG=kV.defaults,kV},kV.walkTokens=function(e,t){return kQ.walkTokens(e,t)},kV.parseInline=kQ.parseInline,kV.Parser=kz,kV.parser=kz.parse,kV.Renderer=kL,kV.TextRenderer=kq,kV.Lexer=k$,kV.lexer=k$.lex,kV.Tokenizer=w7,kV.Hooks=kB,kV.parse=kV,kV.options,kV.setOptions,kV.use,kV.walkTokens,kV.parseInline,kz.parse,k$.lex;var kW={},kU={},kH={},kG={},kX={};Object.defineProperty(kX,"__esModule",{value:!0}),kX.default=new Uint16Array('<\xd5\0\0\0\0\0\0EMabcfglmnoprstu\\bfms\x7f\x84\x8b\x90\x95\x98\xa6\xb3\xb9\xc8\xcflig\xc6P&cute\xc1reve;iyx}rc\xc2;r;\uD835\uDD04rave\xc0pha;acr;d;gp\x9d\xa1on;f;\uD835\uDD38plyFunction;ing\xc5cs\xbe\xc3r;\uD835\uDC9Cign;ilde\xc3ml\xc4aceforsu\xe5\xfb\xfecr\xea\xf2kslash;\xf6\xf8;ed;y;crtause;noullis;a;r;\uD835\uDD05pf;\uD835\uDD39eve;c\xf2mpeq;HOacdefhilorsucy;PY\xa9cpyute;;italDifferentialD;leys;aeioron;dil\xc7rc;nint;ot;dnilla;terDot;\xf2i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;\uD835\uDC9Ep;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;\uD835\uDD07afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;\uD835\uDD3B;DEot;qual;bleCDLRUVontourIntegra\xeco\0\0\xbbnArrow;eoftARTrrow;ightArrow;e\xe5ngLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;\uD835\uDC9Frok;NTacdfglmopqstuxG;H\xd0cute\xc9aiyron;rc\xca;ot;r;\uD835\uDD08rave\xc8ement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;\uD835\uDD3Csilon;uail;Tilde;librium;cir;m;a;ml\xcbipsts;onentialE;cfiosy;r;\uD835\uDD09lled\0\0mallSquare;erySmallSquare;\0\0\0f;\uD835\uDD3DAll;riertrf;c\xf2JTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;\uD835\uDD0A;pf;\uD835\uDD3EeaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;\uD835\uDCA2;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ct\xf2rok;mpownHum\xf0qual;EJOacdfgmnostucy;lig;cy;cute\xcdiyrc\xce;ot;r;rave\xcc;apcgr;inaryI;lie\xf3\0;egrral;section;isibleCTomma;imes;gpton;f;\uD835\uDD40a;cr;ilde;\0cy;l\xcfcfosuiyrc;;r;\uD835\uDD0Dpf;\uD835\uDD41\0r;\uD835\uDCA5rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;\uD835\uDD0Epf;\uD835\uDD42cr;\uD835\uDCA6JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ight\xe1sEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;\uD835\uDD0F;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftaright\xe1ight\xe1f;\uD835\uDD43erLReftArrow;ightArrow;cht\xf2;rok;;acefiosup;y;dliumSpace;lintrf;r;\uD835\uDD10nusPlus;pf;\uD835\uDD44c\xf2;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicn\xeberyThi\xeetedGLreaterGreate\xf2essLes\xf3Line;r;\uD835\uDD11Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;\uD835\uDCA9ilde\xd1;Eacdfgmoprstuvlig;cute\xd3iyrc\xd4;blac;r;\uD835\uDD12rave\xd2aeicr;ga;cron;pf;\uD835\uDD46enCurlyDQoubleQuote;uote;;clr;\uD835\uDCAAash\xd8ide\xd5es;ml\xd6erBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;\uD835\uDD13i;;usMinus;ipncareplan\xe5f;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;\uD835\uDCAB;UfosOT"r;\uD835\uDD14pf;cr;\uD835\uDCACBEacefhiorsuarr;G\xaecnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;r\xbbo;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;\uD835\uDD16ortDLRUownArrow\xbbeftArrow\xbbightArrow\xbbpArrow;gma;allCircle;pf;\uD835\uDD4A\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;\uD835\uDCAEar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th\xe1;;esrset;Equal;et\xbbHRSacfhiorsORN\xdeADE;Hccy;y;bu;;aeyron;dil;;r;\uD835\uDD17ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;\uD835\uDD4BipleDot;ctr;\uD835\uDCAFrok;\0\0\0\0\0\0\0crute\xdar;ocir;r\0y;ve;iyrc\xdb;blac;r;\uD835\uDD18rave\xd9acr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;\uD835\uDD4CADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;own\xe1erLReftArrow;ightArrow;i;lon;ing;cr;\uD835\uDCB0ilde;ml\xdcDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;\uD835\uDD19pf;\uD835\uDD4Dcr;\uD835\uDCB1dash;cefosirc;dge;r;\uD835\uDD1Apf;\uD835\uDD4Ecr;\uD835\uDCB2fiosr;\uD835\uDD1B;pf;\uD835\uDD4Fcr;\uD835\uDCB3AIUacfosucy;cy;cy;cute\xddiyrc;;r;\uD835\uDD1Cpf;\uD835\uDD50cr;\uD835\uDCB4ml;Hacdefoscy;cute;ayron;;ot;\0oWidt\xe8a;r;pf;cr;\uD835\uDCB5\0\0\0\0\0\0\0cute\xe1reve;;Ediuy;;rc\xe2te\xb4;lig\xe6;r\xb2;\uD835\uDD1Erave\xe0epfpsym;\xe8ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;e\xbbsd;a;;;;;;;;t;vb;d;pth;\xbb\xb9arr;gpon;f;\uD835\uDD52;Eaeiop;cir;;d;s;rox;e\xf1ing\xe5ctyr;\uD835\uDCB6;mp;e\xf1ilde\xe3ml\xe4cionin\xf4nt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;ge\xbbrk;tbrk;oy;quo;cmprtaus;eptyv;s\xe9no\xf5ahw;;een;r;\uD835\uDD1Fgcostuvwaiu\xf0rc;p\xbbdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;e\xe5\xe5arow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;\uD835\uDD53;tom\xbbtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbar\xa6ceior;\uD835\uDCB7mi;m;el;bh;sub;l;et\xbbp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;\xeeaeiu\0s;on;dil\xe7rc;ps;sm;ot;dmnil\xb8ptyv;t\xa2;er\xe4r;\uD835\uDD20ceiy;ck;mark\xbb;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd\xbb;st;irc;ash;nint;id;cir;ubs;uit\xbb\0on;e;q\xc7\xc6\0\0a;t;;fl\xeeemxent\xbbe\xf3\0;dot;n\xf4fry;\uD835\uDD54o\xe4\xa9;sr;aorr;ss;cur;\uD835\uDCB8bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0re\xe3u\xe3ee;edge;en\xa4earrowlreft\xbbight\xbbe\xe4cionin\xf4nt;lcty;AHabcdefhijlorstuwzr\xf2ar;glrsger;eth;\xf2h;v\xbbarow;a\xe3ayron;;;aogrr;tseq;glm\xb0ta;ptyv;irsht;;\uD835\uDD21arlr\xbb\xbbaegsvm;osnd;suit;amma;in;;iode\xf7;ontimes;n\xf8cy;c\0\0rn;op;lptuwlar;f;\uD835\uDD55;empsq;dot;inus;lus;quare;blebarwedg\xe5\xfanadhownarrow\xf3arpoonlref\xf4igh\xf4karo\xf7\0\0rn;op;cotry;\uD835\uDCB9;l;rok;drot;i;fahr\xf2a\xf2angle;ciy;grarr;DacdefglmnopqrstuxDoo\xf4csute\xe9ter;aioyron;r;c\xealon;;ot;Drot;;\uD835\uDD22;rsave\xe8;dot;;ilsnters;;;dot;apscr;ty;svet\xbbp1;;;gs;p;gpon;f;\uD835\uDD56alsr;sl;us;i;lvon\xbb;csuviorc\xbb\0\0\xedantgltr\xbbess\xbbaeils;st;v;DD;parsl;Daot;rr;cdir;o\xf4ah;\xf0mrl\xebo;cipl;s\xf4eoctatio\xeenential\xe5\0\0\0\0\0\0\0llingdotse\xf1y;male;ilrlig;\0\0g;ig;;\uD835\uDD23lig;lig;fjaltt;ig;ns;of;\0f;\uD835\uDD57ak;v;artint;aocs\0\0\xbd;\xbc;;;\0;;\0\0\xbe;;5;\0;;8;l;wn;cr;\uD835\uDCBBEabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan\xf4;cdlc;ot;o;l;;es;r;\uD835\uDD24;gmel;cy;;Eaj;;;Eaes;p;prox\xbb;q;qim;pf;\uD835\uDD58cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pro\xf8r;qlqles\xf3i\xedenrtneqq;\xc5Aabcefkosyr\xf2ilmrrs\xf0f\xbbil\xf4drcy;;cwir;;ar;irc;alrrts;uit\xbblip;con;r;\uD835\uDD25sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;\uD835\uDD59bar;cltr;\uD835\uDCBDas\xe8rok;bpull;hen\xbb\0\0\0\0\0\0cute\xed;iyrc\xee;cxy;cl\xa1fr;\uD835\uDD26rave\xec;inoinnt;t;fin;ta;lig;aopcgtr;elpin\xe5ar\xf4h;f;ed;;cfotare;in;tie;do\xf4;celpal;grer\xf3\xe3arhk;rod;cgpty;on;f;\uD835\uDD5Aa;uest\xbfcir;\uD835\uDCBEn;Edsv;ot;;v;;ilde;\0cy;l\xefcfmosuiyrc;;r;\uD835\uDD27ath;pf;\uD835\uDD5B\0r;\uD835\uDCBFrcy;kcy;acfghjosppa;v;eydil;;r;\uD835\uDD28reen;cy;cy;pf;\uD835\uDD5Ccr;\uD835\uDCC0ABEHabcdefghjlmnoprstuvartr\xf2\xf2ail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;ra\xeebda;g;dl;\xe5;uo\xabr;bfhlpst;fs;s;\xebp;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;\xec\xe2;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;ta\xe9arpoonduown\xbbp\xbbeftarrows;ightahsrrow;sarpoon\xf3quigarro\xf7hreetimes;;qslan\xf4;cdgsc;ot;o;r;;es;adegsppro\xf8ot;qgq\xf4gt\xf2\xf4i\xedilrsht;;\uD835\uDD29;E;rdu;l;lk;cy;;achtr\xf2orne\xf2ard;ri;iodot;ust;ache\xbbEaes;p;prox\xbb;q;qim;abnoptwznrg;r;r\xebglmreftaright\xe1apsto;ight\xe1parrowlref\xf4ight;aflr;;\uD835\uDD5Dus;imes;st;\xe1;efnge\xbbar;lt;achmtr\xf2orne\xf2ar;d;;ri;achiqtquo;r;\uD835\uDCC1m;eg;;buo;r;rok;<;cdhilqrci;r;re\xe5mes;arr;uest;Piar;;efrdushar;har;enrtneqq;\xc5DacdefhilnopsuDot;clprr\xafet;;ese\xbb;sto;dluow\xeeef\xf4\xf0ker;oymma;;ash;asuredangle\xbbr;\uD835\uDD2Ao;cdnro\xb5;acds\xf4ir;ot\xb7us;bd;u;p;\xf2\xf0dpels;f;\uD835\uDD5Ectr;\uD835\uDCC2pos\xbb;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptla\xbbute;g;;Eiop;d;s;ro\xf8ur;al;s\0p\xa0mp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;ui\xf6eiar;\xedist;sr;\uD835\uDD2BEest;qs;qslan\xf4i\xed;r\xbbAapr\xf2rr;ar;;sv;d;cy;AEadestr\xf2;rr;r;;fqstarrro\xf7ightarro\xf7;qslan\xf4;s\xbbi\xed;ri;ei\xe4ptf;\uD835\uDD5F\xac;inn;Edv;ot;;;i;v;;aorr;astlle\xecl;;lint;;ceu\xe5;c;e\xf1Aaitr\xf2rr;cw;;ghtarrow\xbbri;echimpqu;ceru\xe5;\uD835\uDCC3ort\0\0ar\xe1m;e;qsubp\xe5\xe5bcp;Ees;et;eq;qc;e\xf1;Ees;et;eq;qgilr\xeclde\xf1\xe7ianglelreft;e\xf1ight;e\xf1;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csute\xf3iyr;c\xf4;abioslac;v;old;lig;crir;;\uD835\uDD2C\0\0\0n;ave\xf2;bmar;acitr\xf2irr;oss;n\xe5;aeicr;ga;cdnron;;pf;\uD835\uDD60aelr;rp;;adiosvr\xf2;efmr;of\xbb\xaa\xbagof;r;lope;;clo\xf2ash\xf8l;ide\xf5es;as;ml\xf6bar;\0\0\0\0\0\0\0\0\0r;ast\xb6;lle\xec\0\0m;;y;rcimptnt;od;il;enk;r;\uD835\uDD2Dimo;v;ma\xf4ne;;tvchfork\xbb;aunckk;h;\xf6s;abcdemstcir;ir;ou;;n\xb1im;wo;ipuntint;f;\uD835\uDD61nd\xa3;Eaceinosu;p;u\xe5;c;acensppro\xf8urlye\xf1\xf1aespprox;qq;im;i\xedme;sEas\xf0dfpalslar;ine;urf;;t\xefrel;cir;\uD835\uDCC5;ncsp;fiopsur;\uD835\uDD2Epf;\uD835\uDD62rime;cr;\uD835\uDCC6aeoteirnion\xf3nt;st;e\xf1\xf4ABHabcdefhilmnoprstuxartr\xf2\xf2ail;ar\xf2ar;cdenqrteu;te;i\xe3mptyv;g;del;;\xe5uo\xbbr;abcfhlpstwp;;fs;;s;\xeb\xf0l;im;l;;aiil;o;nal\xf3abrr\xf2rk;akcek;;es;ldu;;aeuyron;diil;\xec\xe2;clqsa;dhar;uo;rh;acgl;ipsn\xe5ar\xf4t;ilrsht;;\uD835\uDD2Faordu\xbb;l;;v;gnshtahlrstrrow;ta\xe9arpoonduow\xeep\xbbeftahrrow\xf3arpoon\xf3ightarrows;quigarro\xf7hreetimes;g;ingdotse\xf1ahmr\xf2a\xf2;oust;ache\xbbmid;abptnrg;r;r\xebaflr;;\uD835\uDD63us;imes;apr;gt;olint;ar\xf2achqquo;r;\uD835\uDCC7buo;rhirre\xe5mes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu\xef;Eaceinpsy;\0;on;u\xe5;dil;rc;Eas;p;im;olint;i\xed;ot;be;Aacmstxrr;rhr\xeb;ot\xa7i;war;min\xf0nu\xf3\xf1t;r;o\uD835\uDD30acoyrp;hycy;;rt\0\0i\xe4ara\xec\xadgmma;fv;;deglnprot;;q;E;;E;e;lus;arr;ar\xf2aeitlslsetm\xe9hp;parsl;dle;;e;s;flptcy;;b;ar;f;\uD835\uDD64adres;uit\xbbcsuaup;s;p;s;ubp;eset;e\xf1;eset;e\xf1;afr\xbbar\xf2cemtr;\uD835\uDCC8tm\xee\xf1i\xecar\xe6arr;fanighteppsilo\xeeh\xe9s\xbbbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acensppro\xf8urlye\xf1\xf1aesppro\xf8q\xf1g;123;Edehlmnps\xb9\xb2\xb3;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr\xeb;owar;lig\xdf\0\0\0\0\0\0\0\0\0\0\0\0get;;r\xebaeyron;dil;;lrec;r;\uD835\uDD31eiko\0e4fa;svym;cnkasppro\xf8im\xbbs\xf0as\xf0rn\xfees\xd7;bd;ar;;eps\xe1;bcfot;ir;;o\uD835\uDD65rk;\xe1rime;aipd\xe5adempstngle;dlqrown\xbbeft;e\xf1;ight;e\xf1ot;inus;lus;b;ime;ezium;chtry;\uD835\uDCC9;cy;rok;iox\xf4headlreftarro\xf7ightarrow\xbbAHabcdfghlmoprstuwr\xf2ar;crute\xfa\xf2r\0y;ve;iyrc\xfb;abhr\xf2lac;a\xf2irsht;;\uD835\uDD32rave\xf9rlr\xbb\xbblk;ct\0\0rn;er\xbbop;ri;alcr;\xa8gpon;f;\uD835\uDD66adhlsuown\xe1arpoonlref\xf4igh\xf4i;hl\xbbon\xbbparrows;cit\0\0rn;er\xbbop;ng;ri;cr;\uD835\uDCCAdirot;lde;i;f\xbbamr\xf2l\xfcangle;ABDacdeflnoprszr\xf2ar;v;as\xe8nrgrt;eknprstapp\xe1othin\xe7hirop\xf4;h\xefiugm\xe1bpsetneq;q;setneq;q;hret\xe1ianglelreft\xbbight\xbby;ash\xbbelr;bear;q;lip;bta\xf2r;\uD835\uDD33tr\xe9subp\xbb\xbbpf;\uD835\uDD67ro\xf0tr\xe9cur;\uD835\uDCCBbpnEe\xbbnEe\xbbigzag;cefoprsirc;dibgar;e;q;erp;r;\uD835\uDD34pf;\uD835\uDD68;eat\xe8cr;\uD835\uDCCC\0\0\0\0\0\0\0tr\xe9r;\uD835\uDD35Aar\xf2r\xf2;Aar\xf2r\xf2a\xf0is;dptfl;\uD835\uDD69im\xe5Aar\xf2r\xf2cqr;\uD835\uDCCDptr\xe9acefiosucuyte\xfd;iyrc;;n\xa5r;\uD835\uDD36cy;pf;\uD835\uDD6Acr;\uD835\uDCCEcmy;l\xffacdefhioswcute;ayron;;ot;ettr\xe6a;r;\uD835\uDD37cy;grarr;pf;\uD835\uDD6Bcr;\uD835\uDCCFjn;j;'.split("").map(function(e){return e.charCodeAt(0)}));var kZ={};Object.defineProperty(kZ,"__esModule",{value:!0}),kZ.default=new Uint16Array("aglq	\x15\x18\x1b\x0f\0\0\x12p;os;t;t;uot;".split("").map(function(e){return e.charCodeAt(0)}));var kY={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.replaceCodePoint=e.fromCodePoint=void 0;var t,n=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function r(e){var t;return e>=55296&&e<=57343||e>1114111?65533:null!==(t=n.get(e))&&void 0!==t?t:e}e.fromCodePoint=null!==(t=String.fromCodePoint)&&void 0!==t?t:function(e){var t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),t+=String.fromCharCode(e)},e.replaceCodePoint=r,e.default=function(t){return(0,e.fromCodePoint)(r(t))}}(kY),function(e){var t,n,r,i,o,s,a,l,c=S.a1&&S.a1.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),h=S.a1&&S.a1.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=S.a1&&S.a1.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&c(t,e,n);return h(t,e),t},d=S.a1&&S.a1.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.decodeXML=e.decodeHTMLStrict=e.decodeHTMLAttribute=e.decodeHTML=e.determineBranch=e.EntityDecoder=e.DecodingMode=e.BinTrieFlags=e.fromCodePoint=e.replaceCodePoint=e.decodeCodePoint=e.xmlDecodeTree=e.htmlDecodeTree=void 0;var f=d(kX);e.htmlDecodeTree=f.default;var p=d(kZ);e.xmlDecodeTree=p.default;var m=u(kY);function g(e){return e>=n.ZERO&&e<=n.NINE}e.decodeCodePoint=m.default,Object.defineProperty(e,"replaceCodePoint",{enumerable:!0,get:function(){return kY.replaceCodePoint}}),Object.defineProperty(e,"fromCodePoint",{enumerable:!0,get:function(){return kY.fromCodePoint}}),(t=n||(n={}))[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z",(i=r=e.BinTrieFlags||(e.BinTrieFlags={}))[i.VALUE_LENGTH=49152]="VALUE_LENGTH",i[i.BRANCH_LENGTH=16256]="BRANCH_LENGTH",i[i.JUMP_TABLE=127]="JUMP_TABLE",(o=a||(a={}))[o.EntityStart=0]="EntityStart",o[o.NumericStart=1]="NumericStart",o[o.NumericDecimal=2]="NumericDecimal",o[o.NumericHex=3]="NumericHex",o[o.NamedEntity=4]="NamedEntity",(s=l=e.DecodingMode||(e.DecodingMode={}))[s.Legacy=0]="Legacy",s[s.Strict=1]="Strict",s[s.Attribute=2]="Attribute";var y=function(){function e(e,t,n){this.decodeTree=e,this.emitCodePoint=t,this.errors=n,this.state=a.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=l.Strict}return e.prototype.startEntity=function(e){this.decodeMode=e,this.state=a.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},e.prototype.write=function(e,t){switch(this.state){case a.EntityStart:return e.charCodeAt(t)===n.NUM?(this.state=a.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=a.NamedEntity,this.stateNamedEntity(e,t));case a.NumericStart:return this.stateNumericStart(e,t);case a.NumericDecimal:return this.stateNumericDecimal(e,t);case a.NumericHex:return this.stateNumericHex(e,t);case a.NamedEntity:return this.stateNamedEntity(e,t)}},e.prototype.stateNumericStart=function(e,t){return t>=e.length?-1:(32|e.charCodeAt(t))===n.LOWER_X?(this.state=a.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=a.NumericDecimal,this.stateNumericDecimal(e,t))},e.prototype.addToNumericResult=function(e,t,n,r){if(t!==n){var i=n-t;this.result=this.result*Math.pow(r,i)+parseInt(e.substr(t,i),r),this.consumed+=i}},e.prototype.stateNumericHex=function(e,t){for(var r=t;t<e.length;){var i,o=e.charCodeAt(t);if(!g(o)&&(!((i=o)>=n.UPPER_A)||!(i<=n.UPPER_F))&&(!(i>=n.LOWER_A)||!(i<=n.LOWER_F)))return this.addToNumericResult(e,r,t,16),this.emitNumericEntity(o,3);t+=1}return this.addToNumericResult(e,r,t,16),-1},e.prototype.stateNumericDecimal=function(e,t){for(var n=t;t<e.length;){var r=e.charCodeAt(t);if(!g(r))return this.addToNumericResult(e,n,t,10),this.emitNumericEntity(r,2);t+=1}return this.addToNumericResult(e,n,t,10),-1},e.prototype.emitNumericEntity=function(e,t){var r;if(this.consumed<=t)return null===(r=this.errors)||void 0===r||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===n.SEMI)this.consumed+=1;else if(this.decodeMode===l.Strict)return 0;return this.emitCodePoint((0,m.replaceCodePoint)(this.result),this.consumed),this.errors&&(e!==n.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},e.prototype.stateNamedEntity=function(e,t){for(var i=this.decodeTree,o=i[this.treeIndex],s=(o&r.VALUE_LENGTH)>>14;t<e.length;t++,this.excess++){var a=e.charCodeAt(t);if(this.treeIndex=v(i,o,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return 0===this.result||this.decodeMode===l.Attribute&&(0===s||function(e){var t;return e===n.EQUALS||(t=e)>=n.UPPER_A&&t<=n.UPPER_Z||t>=n.LOWER_A&&t<=n.LOWER_Z||g(t)}(a))?0:this.emitNotTerminatedNamedEntity();if(0!=(s=((o=i[this.treeIndex])&r.VALUE_LENGTH)>>14)){if(a===n.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==l.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return -1},e.prototype.emitNotTerminatedNamedEntity=function(){var e,t=this.result,n=(this.decodeTree[t]&r.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,n,this.consumed),null===(e=this.errors)||void 0===e||e.missingSemicolonAfterCharacterReference(),this.consumed},e.prototype.emitNamedEntityData=function(e,t,n){var i=this.decodeTree;return this.emitCodePoint(1===t?i[e]&~r.VALUE_LENGTH:i[e+1],n),3===t&&this.emitCodePoint(i[e+2],n),n},e.prototype.end=function(){var e;switch(this.state){case a.NamedEntity:return 0!==this.result&&(this.decodeMode!==l.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case a.NumericDecimal:return this.emitNumericEntity(0,2);case a.NumericHex:return this.emitNumericEntity(0,3);case a.NumericStart:return null===(e=this.errors)||void 0===e||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case a.EntityStart:return 0}},e}();function b(e){var t="",n=new y(e,function(e){return t+=(0,m.fromCodePoint)(e)});return function(e,r){for(var i=0,o=0;(o=e.indexOf("&",o))>=0;){t+=e.slice(i,o),n.startEntity(r);var s=n.write(e,o+1);if(s<0){i=o+n.end();break}i=o+s,o=0===s?i+1:i}var a=t+e.slice(i);return t="",a}}function v(e,t,n,i){var o=(t&r.BRANCH_LENGTH)>>7,s=t&r.JUMP_TABLE;if(0===o)return 0!==s&&i===s?n:-1;if(s){var a=i-s;return a<0||a>=o?-1:e[n+a]-1}for(var l=n,c=l+o-1;l<=c;){var h=l+c>>>1,u=e[h];if(u<i)l=h+1;else{if(!(u>i))return e[h+o];c=h-1}}return -1}e.EntityDecoder=y,e.determineBranch=v;var x=b(f.default),w=b(p.default);e.decodeHTML=function(e,t){return void 0===t&&(t=l.Legacy),x(e,t)},e.decodeHTMLAttribute=function(e){return x(e,l.Attribute)},e.decodeHTMLStrict=function(e){return x(e,l.Strict)},e.decodeXML=function(e){return w(e,l.Strict)}}(kG),function(e){function t(e){return e===s.Space||e===s.NewLine||e===s.Tab||e===s.FormFeed||e===s.CarriageReturn}function n(e){return e===s.Slash||e===s.Gt||t(e)}function r(e){return e>=s.Zero&&e<=s.Nine}Object.defineProperty(e,"__esModule",{value:!0}),e.QuoteType=void 0,(a=s||(s={}))[a.Tab=9]="Tab",a[a.NewLine=10]="NewLine",a[a.FormFeed=12]="FormFeed",a[a.CarriageReturn=13]="CarriageReturn",a[a.Space=32]="Space",a[a.ExclamationMark=33]="ExclamationMark",a[a.Number=35]="Number",a[a.Amp=38]="Amp",a[a.SingleQuote=39]="SingleQuote",a[a.DoubleQuote=34]="DoubleQuote",a[a.Dash=45]="Dash",a[a.Slash=47]="Slash",a[a.Zero=48]="Zero",a[a.Nine=57]="Nine",a[a.Semi=59]="Semi",a[a.Lt=60]="Lt",a[a.Eq=61]="Eq",a[a.Gt=62]="Gt",a[a.Questionmark=63]="Questionmark",a[a.UpperA=65]="UpperA",a[a.LowerA=97]="LowerA",a[a.UpperF=70]="UpperF",a[a.LowerF=102]="LowerF",a[a.UpperZ=90]="UpperZ",a[a.LowerZ=122]="LowerZ",a[a.LowerX=120]="LowerX",a[a.OpeningSquareBracket=91]="OpeningSquareBracket",(l=i||(i={}))[l.Text=1]="Text",l[l.BeforeTagName=2]="BeforeTagName",l[l.InTagName=3]="InTagName",l[l.InSelfClosingTag=4]="InSelfClosingTag",l[l.BeforeClosingTagName=5]="BeforeClosingTagName",l[l.InClosingTagName=6]="InClosingTagName",l[l.AfterClosingTagName=7]="AfterClosingTagName",l[l.BeforeAttributeName=8]="BeforeAttributeName",l[l.InAttributeName=9]="InAttributeName",l[l.AfterAttributeName=10]="AfterAttributeName",l[l.BeforeAttributeValue=11]="BeforeAttributeValue",l[l.InAttributeValueDq=12]="InAttributeValueDq",l[l.InAttributeValueSq=13]="InAttributeValueSq",l[l.InAttributeValueNq=14]="InAttributeValueNq",l[l.BeforeDeclaration=15]="BeforeDeclaration",l[l.InDeclaration=16]="InDeclaration",l[l.InProcessingInstruction=17]="InProcessingInstruction",l[l.BeforeComment=18]="BeforeComment",l[l.CDATASequence=19]="CDATASequence",l[l.InSpecialComment=20]="InSpecialComment",l[l.InCommentLike=21]="InCommentLike",l[l.BeforeSpecialS=22]="BeforeSpecialS",l[l.SpecialStartSequence=23]="SpecialStartSequence",l[l.InSpecialTag=24]="InSpecialTag",l[l.BeforeEntity=25]="BeforeEntity",l[l.BeforeNumericEntity=26]="BeforeNumericEntity",l[l.InNamedEntity=27]="InNamedEntity",l[l.InNumericEntity=28]="InNumericEntity",l[l.InHexEntity=29]="InHexEntity",(c=o=e.QuoteType||(e.QuoteType={}))[c.NoValue=0]="NoValue",c[c.Unquoted=1]="Unquoted",c[c.Single=2]="Single",c[c.Double=3]="Double";var i,o,s,a,l,c,h={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},u=function(){function e(e,t){var n=e.xmlMode,r=void 0!==n&&n,o=e.decodeEntities;this.cbs=t,this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=r,this.decodeEntities=void 0===o||o,this.entityTrie=r?kG.xmlDecodeTree:kG.htmlDecodeTree}return e.prototype.reset=function(){this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},e.prototype.write=function(e){this.offset+=this.buffer.length,this.buffer=e,this.parse()},e.prototype.end=function(){this.running&&this.finish()},e.prototype.pause=function(){this.running=!1},e.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},e.prototype.getIndex=function(){return this.index},e.prototype.getSectionStart=function(){return this.sectionStart},e.prototype.stateText=function(e){e===s.Lt||!this.decodeEntities&&this.fastForwardTo(s.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=i.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&e===s.Amp&&(this.state=i.BeforeEntity)},e.prototype.stateSpecialStartSequence=function(e){var t=this.sequenceIndex===this.currentSequence.length;if(t?n(e):(32|e)===this.currentSequence[this.sequenceIndex]){if(!t){this.sequenceIndex++;return}}else this.isSpecial=!1;this.sequenceIndex=0,this.state=i.InTagName,this.stateInTagName(e)},e.prototype.stateInSpecialTag=function(e){if(this.sequenceIndex===this.currentSequence.length){if(e===s.Gt||t(e)){var n=this.index-this.currentSequence.length;if(this.sectionStart<n){var r=this.index;this.index=n,this.cbs.ontext(this.sectionStart,n),this.index=r}this.isSpecial=!1,this.sectionStart=n+2,this.stateInClosingTagName(e);return}this.sequenceIndex=0}(32|e)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:0===this.sequenceIndex?this.currentSequence===h.TitleEnd?this.decodeEntities&&e===s.Amp&&(this.state=i.BeforeEntity):this.fastForwardTo(s.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(e===s.Lt)},e.prototype.stateCDATASequence=function(e){e===h.Cdata[this.sequenceIndex]?++this.sequenceIndex===h.Cdata.length&&(this.state=i.InCommentLike,this.currentSequence=h.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=i.InDeclaration,this.stateInDeclaration(e))},e.prototype.fastForwardTo=function(e){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===e)return!0;return this.index=this.buffer.length+this.offset-1,!1},e.prototype.stateInCommentLike=function(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===h.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=i.Text):0===this.sequenceIndex?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},e.prototype.isTagStartChar=function(e){return this.xmlMode?!n(e):e>=s.LowerA&&e<=s.LowerZ||e>=s.UpperA&&e<=s.UpperZ},e.prototype.startSpecial=function(e,t){this.isSpecial=!0,this.currentSequence=e,this.sequenceIndex=t,this.state=i.SpecialStartSequence},e.prototype.stateBeforeTagName=function(e){if(e===s.ExclamationMark)this.state=i.BeforeDeclaration,this.sectionStart=this.index+1;else if(e===s.Questionmark)this.state=i.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(e)){var t=32|e;this.sectionStart=this.index,this.xmlMode||t!==h.TitleEnd[2]?this.state=this.xmlMode||t!==h.ScriptEnd[2]?i.InTagName:i.BeforeSpecialS:this.startSpecial(h.TitleEnd,3)}else e===s.Slash?this.state=i.BeforeClosingTagName:(this.state=i.Text,this.stateText(e))},e.prototype.stateInTagName=function(e){n(e)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e))},e.prototype.stateBeforeClosingTagName=function(e){t(e)||(e===s.Gt?this.state=i.Text:(this.state=this.isTagStartChar(e)?i.InClosingTagName:i.InSpecialComment,this.sectionStart=this.index))},e.prototype.stateInClosingTagName=function(e){(e===s.Gt||t(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterClosingTagName,this.stateAfterClosingTagName(e))},e.prototype.stateAfterClosingTagName=function(e){(e===s.Gt||this.fastForwardTo(s.Gt))&&(this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1)},e.prototype.stateBeforeAttributeName=function(e){e===s.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=i.InSpecialTag,this.sequenceIndex=0):this.state=i.Text,this.baseState=this.state,this.sectionStart=this.index+1):e===s.Slash?this.state=i.InSelfClosingTag:t(e)||(this.state=i.InAttributeName,this.sectionStart=this.index)},e.prototype.stateInSelfClosingTag=function(e){e===s.Gt?(this.cbs.onselfclosingtag(this.index),this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1,this.isSpecial=!1):t(e)||(this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e))},e.prototype.stateInAttributeName=function(e){(e===s.Eq||n(e))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterAttributeName,this.stateAfterAttributeName(e))},e.prototype.stateAfterAttributeName=function(e){e===s.Eq?this.state=i.BeforeAttributeValue:e===s.Slash||e===s.Gt?(this.cbs.onattribend(o.NoValue,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e)):t(e)||(this.cbs.onattribend(o.NoValue,this.index),this.state=i.InAttributeName,this.sectionStart=this.index)},e.prototype.stateBeforeAttributeValue=function(e){e===s.DoubleQuote?(this.state=i.InAttributeValueDq,this.sectionStart=this.index+1):e===s.SingleQuote?(this.state=i.InAttributeValueSq,this.sectionStart=this.index+1):t(e)||(this.sectionStart=this.index,this.state=i.InAttributeValueNq,this.stateInAttributeValueNoQuotes(e))},e.prototype.handleInAttributeValue=function(e,t){e===t||!this.decodeEntities&&this.fastForwardTo(t)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(t===s.DoubleQuote?o.Double:o.Single,this.index),this.state=i.BeforeAttributeName):this.decodeEntities&&e===s.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},e.prototype.stateInAttributeValueDoubleQuotes=function(e){this.handleInAttributeValue(e,s.DoubleQuote)},e.prototype.stateInAttributeValueSingleQuotes=function(e){this.handleInAttributeValue(e,s.SingleQuote)},e.prototype.stateInAttributeValueNoQuotes=function(e){t(e)||e===s.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(o.Unquoted,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e)):this.decodeEntities&&e===s.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},e.prototype.stateBeforeDeclaration=function(e){e===s.OpeningSquareBracket?(this.state=i.CDATASequence,this.sequenceIndex=0):this.state=e===s.Dash?i.BeforeComment:i.InDeclaration},e.prototype.stateInDeclaration=function(e){(e===s.Gt||this.fastForwardTo(s.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},e.prototype.stateInProcessingInstruction=function(e){(e===s.Gt||this.fastForwardTo(s.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},e.prototype.stateBeforeComment=function(e){e===s.Dash?(this.state=i.InCommentLike,this.currentSequence=h.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=i.InDeclaration},e.prototype.stateInSpecialComment=function(e){(e===s.Gt||this.fastForwardTo(s.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=i.Text,this.sectionStart=this.index+1)},e.prototype.stateBeforeSpecialS=function(e){var t=32|e;t===h.ScriptEnd[3]?this.startSpecial(h.ScriptEnd,4):t===h.StyleEnd[3]?this.startSpecial(h.StyleEnd,4):(this.state=i.InTagName,this.stateInTagName(e))},e.prototype.stateBeforeEntity=function(e){this.entityExcess=1,this.entityResult=0,e===s.Number?this.state=i.BeforeNumericEntity:e===s.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=i.InNamedEntity,this.stateInNamedEntity(e))},e.prototype.stateInNamedEntity=function(e){if(this.entityExcess+=1,this.trieIndex=(0,kG.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,e),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var t=this.trieCurrent&kG.BinTrieFlags.VALUE_LENGTH;if(t){var n=(t>>14)-1;if(this.allowLegacyEntity()||e===s.Semi){var r=this.index-this.entityExcess+1;r>this.sectionStart&&this.emitPartial(this.sectionStart,r),this.entityResult=this.trieIndex,this.trieIndex+=n,this.entityExcess=0,this.sectionStart=this.index+1,0===n&&this.emitNamedEntity()}else this.trieIndex+=n}},e.prototype.emitNamedEntity=function(){if(this.state=this.baseState,0!==this.entityResult)switch((this.entityTrie[this.entityResult]&kG.BinTrieFlags.VALUE_LENGTH)>>14){case 1:this.emitCodePoint(this.entityTrie[this.entityResult]&~kG.BinTrieFlags.VALUE_LENGTH);break;case 2:this.emitCodePoint(this.entityTrie[this.entityResult+1]);break;case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}},e.prototype.stateBeforeNumericEntity=function(e){(32|e)===s.LowerX?(this.entityExcess++,this.state=i.InHexEntity):(this.state=i.InNumericEntity,this.stateInNumericEntity(e))},e.prototype.emitNumericEntity=function(e){var t=this.index-this.entityExcess-1;t+2+ +(this.state===i.InHexEntity)!==this.index&&(t>this.sectionStart&&this.emitPartial(this.sectionStart,t),this.sectionStart=this.index+Number(e),this.emitCodePoint((0,kG.replaceCodePoint)(this.entityResult))),this.state=this.baseState},e.prototype.stateInNumericEntity=function(e){e===s.Semi?this.emitNumericEntity(!0):r(e)?(this.entityResult=10*this.entityResult+(e-s.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},e.prototype.stateInHexEntity=function(e){e===s.Semi?this.emitNumericEntity(!0):r(e)?(this.entityResult=16*this.entityResult+(e-s.Zero),this.entityExcess++):e>=s.UpperA&&e<=s.UpperF||e>=s.LowerA&&e<=s.LowerF?(this.entityResult=16*this.entityResult+((32|e)-s.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},e.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===i.Text||this.baseState===i.InSpecialTag)},e.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===i.Text||this.state===i.InSpecialTag&&0===this.sequenceIndex?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===i.InAttributeValueDq||this.state===i.InAttributeValueSq||this.state===i.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},e.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},e.prototype.parse=function(){for(;this.shouldContinue();){var e=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case i.Text:this.stateText(e);break;case i.SpecialStartSequence:this.stateSpecialStartSequence(e);break;case i.InSpecialTag:this.stateInSpecialTag(e);break;case i.CDATASequence:this.stateCDATASequence(e);break;case i.InAttributeValueDq:this.stateInAttributeValueDoubleQuotes(e);break;case i.InAttributeName:this.stateInAttributeName(e);break;case i.InCommentLike:this.stateInCommentLike(e);break;case i.InSpecialComment:this.stateInSpecialComment(e);break;case i.BeforeAttributeName:this.stateBeforeAttributeName(e);break;case i.InTagName:this.stateInTagName(e);break;case i.InClosingTagName:this.stateInClosingTagName(e);break;case i.BeforeTagName:this.stateBeforeTagName(e);break;case i.AfterAttributeName:this.stateAfterAttributeName(e);break;case i.InAttributeValueSq:this.stateInAttributeValueSingleQuotes(e);break;case i.BeforeAttributeValue:this.stateBeforeAttributeValue(e);break;case i.BeforeClosingTagName:this.stateBeforeClosingTagName(e);break;case i.AfterClosingTagName:this.stateAfterClosingTagName(e);break;case i.BeforeSpecialS:this.stateBeforeSpecialS(e);break;case i.InAttributeValueNq:this.stateInAttributeValueNoQuotes(e);break;case i.InSelfClosingTag:this.stateInSelfClosingTag(e);break;case i.InDeclaration:this.stateInDeclaration(e);break;case i.BeforeDeclaration:this.stateBeforeDeclaration(e);break;case i.BeforeComment:this.stateBeforeComment(e);break;case i.InProcessingInstruction:this.stateInProcessingInstruction(e);break;case i.InNamedEntity:this.stateInNamedEntity(e);break;case i.BeforeEntity:this.stateBeforeEntity(e);break;case i.InHexEntity:this.stateInHexEntity(e);break;case i.InNumericEntity:this.stateInNumericEntity(e);break;default:this.stateBeforeNumericEntity(e)}this.index++}this.cleanup()},e.prototype.finish=function(){this.state===i.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},e.prototype.handleTrailingData=function(){var e=this.buffer.length+this.offset;this.state===i.InCommentLike?this.currentSequence===h.CdataEnd?this.cbs.oncdata(this.sectionStart,e,0):this.cbs.oncomment(this.sectionStart,e,0):this.state===i.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===i.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===i.InTagName||this.state===i.BeforeAttributeName||this.state===i.BeforeAttributeValue||this.state===i.AfterAttributeName||this.state===i.InAttributeName||this.state===i.InAttributeValueSq||this.state===i.InAttributeValueDq||this.state===i.InAttributeValueNq||this.state===i.InClosingTagName||this.cbs.ontext(this.sectionStart,e)},e.prototype.emitPartial=function(e,t){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribdata(e,t):this.cbs.ontext(e,t)},e.prototype.emitCodePoint=function(e){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribentity(e):this.cbs.ontextentity(e)},e}();e.default=u}(kH);var kJ=S.a1&&S.a1.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),kK=S.a1&&S.a1.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),k0=S.a1&&S.a1.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&kJ(t,e,n);return kK(t,e),t};Object.defineProperty(kU,"__esModule",{value:!0}),kU.Parser=void 0;var k1=k0(kH),k2=new Set(["input","option","optgroup","select","button","datalist","textarea"]),k5=new Set(["p"]),k3=new Set(["thead","tbody"]),k4=new Set(["dd","dt"]),k6=new Set(["rt","rp"]),k8=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",k5],["h1",k5],["h2",k5],["h3",k5],["h4",k5],["h5",k5],["h6",k5],["select",k2],["input",k2],["output",k2],["button",k2],["datalist",k2],["textarea",k2],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",k4],["dt",k4],["address",k5],["article",k5],["aside",k5],["blockquote",k5],["details",k5],["div",k5],["dl",k5],["fieldset",k5],["figcaption",k5],["figure",k5],["footer",k5],["form",k5],["header",k5],["hr",k5],["main",k5],["nav",k5],["ol",k5],["pre",k5],["section",k5],["table",k5],["ul",k5],["rt",k6],["rp",k6],["tbody",k3],["tfoot",k3]]),k9=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),k7=new Set(["math","svg"]),Oe=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),Ot=/\s|\//,On=function(){function e(e,t){var n,r,i,o,s;void 0===t&&(t={}),this.options=t,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=e??{},this.lowerCaseTagNames=null!==(n=t.lowerCaseTags)&&void 0!==n?n:!t.xmlMode,this.lowerCaseAttributeNames=null!==(r=t.lowerCaseAttributeNames)&&void 0!==r?r:!t.xmlMode,this.tokenizer=new(null!==(i=t.Tokenizer)&&void 0!==i?i:k1.default)(this.options,this),null===(s=(o=this.cbs).onparserinit)||void 0===s||s.call(o,this)}return e.prototype.ontext=function(e,t){var n,r,i=this.getSlice(e,t);this.endIndex=t-1,null===(r=(n=this.cbs).ontext)||void 0===r||r.call(n,i),this.startIndex=t},e.prototype.ontextentity=function(e){var t,n,r=this.tokenizer.getSectionStart();this.endIndex=r-1,null===(n=(t=this.cbs).ontext)||void 0===n||n.call(t,(0,kG.fromCodePoint)(e)),this.startIndex=r},e.prototype.isVoidElement=function(e){return!this.options.xmlMode&&k9.has(e)},e.prototype.onopentagname=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);this.lowerCaseTagNames&&(n=n.toLowerCase()),this.emitOpenTag(n)},e.prototype.emitOpenTag=function(e){this.openTagStart=this.startIndex,this.tagname=e;var t,n,r,i,o=!this.options.xmlMode&&k8.get(e);if(o)for(;this.stack.length>0&&o.has(this.stack[this.stack.length-1]);){var s=this.stack.pop();null===(n=(t=this.cbs).onclosetag)||void 0===n||n.call(t,s,!0)}this.isVoidElement(e)||(this.stack.push(e),k7.has(e)?this.foreignContext.push(!0):Oe.has(e)&&this.foreignContext.push(!1)),null===(i=(r=this.cbs).onopentagname)||void 0===i||i.call(r,e),this.cbs.onopentag&&(this.attribs={})},e.prototype.endOpenTag=function(e){var t,n;this.startIndex=this.openTagStart,this.attribs&&(null===(n=(t=this.cbs).onopentag)||void 0===n||n.call(t,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},e.prototype.onopentagend=function(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1},e.prototype.onclosetag=function(e,t){this.endIndex=t;var n,r,i,o,s,a,l=this.getSlice(e,t);if(this.lowerCaseTagNames&&(l=l.toLowerCase()),(k7.has(l)||Oe.has(l))&&this.foreignContext.pop(),this.isVoidElement(l))this.options.xmlMode||"br"!==l||(null===(r=(n=this.cbs).onopentagname)||void 0===r||r.call(n,"br"),null===(o=(i=this.cbs).onopentag)||void 0===o||o.call(i,"br",{},!0),null===(a=(s=this.cbs).onclosetag)||void 0===a||a.call(s,"br",!1));else{var c=this.stack.lastIndexOf(l);if(-1!==c){if(this.cbs.onclosetag)for(var h=this.stack.length-c;h--;)this.cbs.onclosetag(this.stack.pop(),0!==h);else this.stack.length=c}else this.options.xmlMode||"p"!==l||(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=t+1},e.prototype.onselfclosingtag=function(e){this.endIndex=e,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)},e.prototype.closeCurrentTag=function(e){var t,n,r=this.tagname;this.endOpenTag(e),this.stack[this.stack.length-1]===r&&(null===(n=(t=this.cbs).onclosetag)||void 0===n||n.call(t,r,!e),this.stack.pop())},e.prototype.onattribname=function(e,t){this.startIndex=e;var n=this.getSlice(e,t);this.attribname=this.lowerCaseAttributeNames?n.toLowerCase():n},e.prototype.onattribdata=function(e,t){this.attribvalue+=this.getSlice(e,t)},e.prototype.onattribentity=function(e){this.attribvalue+=(0,kG.fromCodePoint)(e)},e.prototype.onattribend=function(e,t){var n,r;this.endIndex=t,null===(r=(n=this.cbs).onattribute)||void 0===r||r.call(n,this.attribname,this.attribvalue,e===k1.QuoteType.Double?'"':e===k1.QuoteType.Single?"'":e===k1.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},e.prototype.getInstructionName=function(e){var t=e.search(Ot),n=t<0?e:e.substr(0,t);return this.lowerCaseTagNames&&(n=n.toLowerCase()),n},e.prototype.ondeclaration=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){var r=this.getInstructionName(n);this.cbs.onprocessinginstruction("!".concat(r),"!".concat(n))}this.startIndex=t+1},e.prototype.onprocessinginstruction=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){var r=this.getInstructionName(n);this.cbs.onprocessinginstruction("?".concat(r),"?".concat(n))}this.startIndex=t+1},e.prototype.oncomment=function(e,t,n){var r,i,o,s;this.endIndex=t,null===(i=(r=this.cbs).oncomment)||void 0===i||i.call(r,this.getSlice(e,t-n)),null===(s=(o=this.cbs).oncommentend)||void 0===s||s.call(o),this.startIndex=t+1},e.prototype.oncdata=function(e,t,n){this.endIndex=t;var r,i,o,s,a,l,c,h,u,d,f=this.getSlice(e,t-n);this.options.xmlMode||this.options.recognizeCDATA?(null===(i=(r=this.cbs).oncdatastart)||void 0===i||i.call(r),null===(s=(o=this.cbs).ontext)||void 0===s||s.call(o,f),null===(l=(a=this.cbs).oncdataend)||void 0===l||l.call(a)):(null===(h=(c=this.cbs).oncomment)||void 0===h||h.call(c,"[CDATA[".concat(f,"]]")),null===(d=(u=this.cbs).oncommentend)||void 0===d||d.call(u)),this.startIndex=t+1},e.prototype.onend=function(){var e,t;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var n=this.stack.length;n>0;this.cbs.onclosetag(this.stack[--n],!0));}null===(t=(e=this.cbs).onend)||void 0===t||t.call(e)},e.prototype.reset=function(){var e,t,n,r;null===(t=(e=this.cbs).onreset)||void 0===t||t.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,null===(r=(n=this.cbs).onparserinit)||void 0===r||r.call(n,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},e.prototype.parseComplete=function(e){this.reset(),this.end(e)},e.prototype.getSlice=function(e,t){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var n=this.buffers[0].slice(e-this.bufferOffset,t-this.bufferOffset);t-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),n+=this.buffers[0].slice(0,t-this.bufferOffset);return n},e.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},e.prototype.write=function(e){var t,n;if(this.ended){null===(n=(t=this.cbs).onerror)||void 0===n||n.call(t,Error(".write() after done!"));return}this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++)},e.prototype.end=function(e){var t,n;if(this.ended){null===(n=(t=this.cbs).onerror)||void 0===n||n.call(t,Error(".end() after done!"));return}e&&this.write(e),this.ended=!0,this.tokenizer.end()},e.prototype.pause=function(){this.tokenizer.pause()},e.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},e.prototype.parseChunk=function(e){this.write(e)},e.prototype.done=function(e){this.end(e)},e}();kU.Parser=On;var Or={},Oi={};!function(e){var t,n;Object.defineProperty(e,"__esModule",{value:!0}),e.Doctype=e.CDATA=e.Tag=e.Style=e.Script=e.Comment=e.Directive=e.Text=e.Root=e.isTag=e.ElementType=void 0,(n=t=e.ElementType||(e.ElementType={})).Root="root",n.Text="text",n.Directive="directive",n.Comment="comment",n.Script="script",n.Style="style",n.Tag="tag",n.CDATA="cdata",n.Doctype="doctype",e.isTag=function(e){return e.type===t.Tag||e.type===t.Script||e.type===t.Style},e.Root=t.Root,e.Text=t.Text,e.Directive=t.Directive,e.Comment=t.Comment,e.Script=t.Script,e.Style=t.Style,e.Tag=t.Tag,e.CDATA=t.CDATA,e.Doctype=t.Doctype}(Oi);var Oo={},Os=S.a1&&S.a1.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oa=S.a1&&S.a1.__assign||function(){return(Oa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.cloneNode=Oo.hasChildren=Oo.isDocument=Oo.isDirective=Oo.isComment=Oo.isText=Oo.isCDATA=Oo.isTag=Oo.Element=Oo.Document=Oo.CDATA=Oo.NodeWithChildren=Oo.ProcessingInstruction=Oo.Comment=Oo.Text=Oo.DataNode=Oo.Node=void 0;var Ol=function(){function e(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent},set:function(e){this.parent=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return this.prev},set:function(e){this.prev=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this.next},set:function(e){this.next=e},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(e){return void 0===e&&(e=!1),OO(this,e)},e}();Oo.Node=Ol;var Oc=function(e){function t(t){var n=e.call(this)||this;return n.data=t,n}return Os(t,e),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.data},set:function(e){this.data=e},enumerable:!1,configurable:!0}),t}(Ol);Oo.DataNode=Oc;var Oh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Oi.ElementType.Text,t}return Os(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),t}(Oc);Oo.Text=Oh;var Ou=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Oi.ElementType.Comment,t}return Os(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),t}(Oc);Oo.Comment=Ou;var Od=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name=t,r.type=Oi.ElementType.Directive,r}return Os(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),t}(Oc);Oo.ProcessingInstruction=Od;var Of=function(e){function t(t){var n=e.call(this)||this;return n.children=t,n}return Os(t,e),Object.defineProperty(t.prototype,"firstChild",{get:function(){var e;return null!==(e=this.children[0])&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.children},set:function(e){this.children=e},enumerable:!1,configurable:!0}),t}(Ol);Oo.NodeWithChildren=Of;var Op=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Oi.ElementType.CDATA,t}return Os(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),t}(Of);Oo.CDATA=Op;var Om=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Oi.ElementType.Root,t}return Os(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),t}(Of);Oo.Document=Om;var Og=function(e){function t(t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i="script"===t?Oi.ElementType.Script:"style"===t?Oi.ElementType.Style:Oi.ElementType.Tag);var o=e.call(this,r)||this;return o.name=t,o.attribs=n,o.type=i,o}return Os(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){var e=this;return Object.keys(this.attribs).map(function(t){var n,r;return{name:t,value:e.attribs[t],namespace:null===(n=e["x-attribsNamespace"])||void 0===n?void 0:n[t],prefix:null===(r=e["x-attribsPrefix"])||void 0===r?void 0:r[t]}})},enumerable:!1,configurable:!0}),t}(Of);function Oy(e){return(0,Oi.isTag)(e)}function Ob(e){return e.type===Oi.ElementType.CDATA}function Ov(e){return e.type===Oi.ElementType.Text}function Ox(e){return e.type===Oi.ElementType.Comment}function Ow(e){return e.type===Oi.ElementType.Directive}function Ok(e){return e.type===Oi.ElementType.Root}function OO(e,t){if(void 0===t&&(t=!1),Ov(e))n=new Oh(e.data);else if(Ox(e))n=new Ou(e.data);else if(Oy(e)){var n,r=t?OS(e.children):[],i=new Og(e.name,Oa({},e.attribs),r);r.forEach(function(e){return e.parent=i}),null!=e.namespace&&(i.namespace=e.namespace),e["x-attribsNamespace"]&&(i["x-attribsNamespace"]=Oa({},e["x-attribsNamespace"])),e["x-attribsPrefix"]&&(i["x-attribsPrefix"]=Oa({},e["x-attribsPrefix"])),n=i}else if(Ob(e)){var r=t?OS(e.children):[],o=new Op(r);r.forEach(function(e){return e.parent=o}),n=o}else if(Ok(e)){var r=t?OS(e.children):[],s=new Om(r);r.forEach(function(e){return e.parent=s}),e["x-mode"]&&(s["x-mode"]=e["x-mode"]),n=s}else if(Ow(e)){var a=new Od(e.name,e.data);null!=e["x-name"]&&(a["x-name"]=e["x-name"],a["x-publicId"]=e["x-publicId"],a["x-systemId"]=e["x-systemId"]),n=a}else throw Error("Not implemented yet: ".concat(e.type));return n.startIndex=e.startIndex,n.endIndex=e.endIndex,null!=e.sourceCodeLocation&&(n.sourceCodeLocation=e.sourceCodeLocation),n}function OS(e){for(var t=e.map(function(e){return OO(e,!0)}),n=1;n<t.length;n++)t[n].prev=t[n-1],t[n-1].next=t[n];return t}Oo.Element=Og,Oo.isTag=Oy,Oo.isCDATA=Ob,Oo.isText=Ov,Oo.isComment=Ox,Oo.isDirective=Ow,Oo.isDocument=Ok,Oo.hasChildren=function(e){return Object.prototype.hasOwnProperty.call(e,"children")},Oo.cloneNode=OO,function(e){var t=S.a1&&S.a1.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=S.a1&&S.a1.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.DomHandler=void 0,n(Oo,e);var r={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},i=function(){function e(e,t,n){this.dom=[],this.root=new Oo.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,"function"==typeof t&&(n=t,t=r),"object"==typeof e&&(t=e,e=void 0),this.callback=e??null,this.options=t??r,this.elementCB=n??null}return e.prototype.onparserinit=function(e){this.parser=e},e.prototype.onreset=function(){this.dom=[],this.root=new Oo.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},e.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},e.prototype.onerror=function(e){this.handleCallback(e)},e.prototype.onclosetag=function(){this.lastNode=null;var e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)},e.prototype.onopentag=function(e,t){var n=this.options.xmlMode?Oi.ElementType.Tag:void 0,r=new Oo.Element(e,t,void 0,n);this.addNode(r),this.tagStack.push(r)},e.prototype.ontext=function(e){var t=this.lastNode;if(t&&t.type===Oi.ElementType.Text)t.data+=e,this.options.withEndIndices&&(t.endIndex=this.parser.endIndex);else{var n=new Oo.Text(e);this.addNode(n),this.lastNode=n}},e.prototype.oncomment=function(e){if(this.lastNode&&this.lastNode.type===Oi.ElementType.Comment){this.lastNode.data+=e;return}var t=new Oo.Comment(e);this.addNode(t),this.lastNode=t},e.prototype.oncommentend=function(){this.lastNode=null},e.prototype.oncdatastart=function(){var e=new Oo.Text(""),t=new Oo.CDATA([e]);this.addNode(t),e.parent=t,this.lastNode=e},e.prototype.oncdataend=function(){this.lastNode=null},e.prototype.onprocessinginstruction=function(e,t){var n=new Oo.ProcessingInstruction(e,t);this.addNode(n)},e.prototype.handleCallback=function(e){if("function"==typeof this.callback)this.callback(e,this.dom);else if(e)throw e},e.prototype.addNode=function(e){var t=this.tagStack[this.tagStack.length-1],n=t.children[t.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),t.children.push(e),n&&(e.prev=n,n.next=e),e.parent=t,this.lastNode=null},e}();e.DomHandler=i,e.default=i}(Or);var OC={},OT={},OA={},OE={},OM={},O_={};function OD(e){for(var t=1;t<e.length;t++)e[t][0]+=e[t-1][0]+1;return e}Object.defineProperty(O_,"__esModule",{value:!0}),O_.default=new Map(OD([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(OD([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(OD([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(OD([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var ON={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.escapeText=e.escapeAttribute=e.escapeUTF8=e.escape=e.encodeXML=e.getCodePoint=e.xmlReplacer=void 0,e.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var t=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);function n(n){for(var r,i="",o=0;null!==(r=e.xmlReplacer.exec(n));){var s=r.index,a=n.charCodeAt(s),l=t.get(a);void 0!==l?(i+=n.substring(o,s)+l,o=s+1):(i+="".concat(n.substring(o,s),"&#x").concat((0,e.getCodePoint)(n,s).toString(16),";"),o=e.xmlReplacer.lastIndex+=+((64512&a)==55296))}return i+n.substr(o)}function r(e,t){return function(n){for(var r,i=0,o="";r=e.exec(n);)i!==r.index&&(o+=n.substring(i,r.index)),o+=t.get(r[0].charCodeAt(0)),i=r.index+1;return o+n.substring(i)}}e.getCodePoint=null!=String.prototype.codePointAt?function(e,t){return e.codePointAt(t)}:function(e,t){return(64512&e.charCodeAt(t))==55296?(e.charCodeAt(t)-55296)*1024+e.charCodeAt(t+1)-56320+65536:e.charCodeAt(t)},e.encodeXML=n,e.escape=n,e.escapeUTF8=r(/[&<>'"]/g,t),e.escapeAttribute=r(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),e.escapeText=r(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))}(ON);var OR=S.a1&&S.a1.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(OM,"__esModule",{value:!0}),OM.encodeNonAsciiHTML=OM.encodeHTML=void 0;var OP=OR(O_),Oj=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function OI(e,t){for(var n,r="",i=0;null!==(n=e.exec(t));){var o=n.index;r+=t.substring(i,o);var s=t.charCodeAt(o),a=OP.default.get(s);if("object"==typeof a){if(o+1<t.length){var l=t.charCodeAt(o+1),c="number"==typeof a.n?a.n===l?a.o:void 0:a.n.get(l);if(void 0!==c){r+=c,i=e.lastIndex+=1;continue}}a=a.v}if(void 0!==a)r+=a,i=o+1;else{var h=(0,ON.getCodePoint)(t,o);r+="&#x".concat(h.toString(16),";"),i=e.lastIndex+=+(h!==s)}}return r+t.substr(i)}OM.encodeHTML=function(e){return OI(Oj,e)},OM.encodeNonAsciiHTML=function(e){return OI(ON.xmlReplacer,e)},function(e){var t,n,r,i;function o(e,t){if(void 0===t&&(t=n.XML),("number"==typeof t?t:t.level)===n.HTML){var r="object"==typeof t?t.mode:void 0;return(0,kG.decodeHTML)(e,r)}return(0,kG.decodeXML)(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.decodeXMLStrict=e.decodeHTML5Strict=e.decodeHTML4Strict=e.decodeHTML5=e.decodeHTML4=e.decodeHTMLAttribute=e.decodeHTMLStrict=e.decodeHTML=e.decodeXML=e.DecodingMode=e.EntityDecoder=e.encodeHTML5=e.encodeHTML4=e.encodeNonAsciiHTML=e.encodeHTML=e.escapeText=e.escapeAttribute=e.escapeUTF8=e.escape=e.encodeXML=e.encode=e.decodeStrict=e.decode=e.EncodingMode=e.EntityLevel=void 0,(r=n=e.EntityLevel||(e.EntityLevel={}))[r.XML=0]="XML",r[r.HTML=1]="HTML",(i=t=e.EncodingMode||(e.EncodingMode={}))[i.UTF8=0]="UTF8",i[i.ASCII=1]="ASCII",i[i.Extensive=2]="Extensive",i[i.Attribute=3]="Attribute",i[i.Text=4]="Text",e.decode=o,e.decodeStrict=function(e,t){void 0===t&&(t=n.XML);var r,i="number"==typeof t?{level:t}:t;return null!==(r=i.mode)&&void 0!==r||(i.mode=kG.DecodingMode.Strict),o(e,i)},e.encode=function(e,r){void 0===r&&(r=n.XML);var i="number"==typeof r?{level:r}:r;return i.mode===t.UTF8?(0,ON.escapeUTF8)(e):i.mode===t.Attribute?(0,ON.escapeAttribute)(e):i.mode===t.Text?(0,ON.escapeText)(e):i.level===n.HTML?i.mode===t.ASCII?(0,OM.encodeNonAsciiHTML)(e):(0,OM.encodeHTML)(e):(0,ON.encodeXML)(e)},Object.defineProperty(e,"encodeXML",{enumerable:!0,get:function(){return ON.encodeXML}}),Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return ON.escape}}),Object.defineProperty(e,"escapeUTF8",{enumerable:!0,get:function(){return ON.escapeUTF8}}),Object.defineProperty(e,"escapeAttribute",{enumerable:!0,get:function(){return ON.escapeAttribute}}),Object.defineProperty(e,"escapeText",{enumerable:!0,get:function(){return ON.escapeText}}),Object.defineProperty(e,"encodeHTML",{enumerable:!0,get:function(){return OM.encodeHTML}}),Object.defineProperty(e,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return OM.encodeNonAsciiHTML}}),Object.defineProperty(e,"encodeHTML4",{enumerable:!0,get:function(){return OM.encodeHTML}}),Object.defineProperty(e,"encodeHTML5",{enumerable:!0,get:function(){return OM.encodeHTML}}),Object.defineProperty(e,"EntityDecoder",{enumerable:!0,get:function(){return kG.EntityDecoder}}),Object.defineProperty(e,"DecodingMode",{enumerable:!0,get:function(){return kG.DecodingMode}}),Object.defineProperty(e,"decodeXML",{enumerable:!0,get:function(){return kG.decodeXML}}),Object.defineProperty(e,"decodeHTML",{enumerable:!0,get:function(){return kG.decodeHTML}}),Object.defineProperty(e,"decodeHTMLStrict",{enumerable:!0,get:function(){return kG.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTMLAttribute",{enumerable:!0,get:function(){return kG.decodeHTMLAttribute}}),Object.defineProperty(e,"decodeHTML4",{enumerable:!0,get:function(){return kG.decodeHTML}}),Object.defineProperty(e,"decodeHTML5",{enumerable:!0,get:function(){return kG.decodeHTML}}),Object.defineProperty(e,"decodeHTML4Strict",{enumerable:!0,get:function(){return kG.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML5Strict",{enumerable:!0,get:function(){return kG.decodeHTMLStrict}}),Object.defineProperty(e,"decodeXMLStrict",{enumerable:!0,get:function(){return kG.decodeXML}})}(OE);var O$={};Object.defineProperty(O$,"__esModule",{value:!0}),O$.attributeNames=O$.elementNames=void 0,O$.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(e){return[e.toLowerCase(),e]})),O$.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(e){return[e.toLowerCase(),e]}));var OL=S.a1&&S.a1.__assign||function(){return(OL=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Oq=S.a1&&S.a1.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),Oz=S.a1&&S.a1.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),OB=S.a1&&S.a1.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&Oq(t,e,n);return Oz(t,e),t};Object.defineProperty(OA,"__esModule",{value:!0}),OA.render=void 0;var OF=OB(Oi),OQ=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function OV(e){return e.replace(/"/g,"&quot;")}var OW=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function OU(e,t){void 0===t&&(t={});for(var n=("length"in e)?e:[e],r="",i=0;i<n.length;i++)r+=function(e,t){switch(e.type){case OF.Root:return OU(e.children,t);case OF.Doctype:case OF.Directive:return"<".concat(e.data,">");case OF.Comment:return"\x3c!--".concat(e.data,"--\x3e");case OF.CDATA:return"<![CDATA[".concat(e.children[0].data,"]]>");case OF.Script:case OF.Style:case OF.Tag:return function(e,t){"foreign"===t.xmlMode&&(e.name=null!==(n=O$.elementNames.get(e.name))&&void 0!==n?n:e.name,e.parent&&OH.has(e.parent.name)&&(t=OL(OL({},t),{xmlMode:!1}))),!t.xmlMode&&OG.has(e.name)&&(t=OL(OL({},t),{xmlMode:"foreign"}));var n,r="<".concat(e.name),i=function(e,t){var n;if(e){var r=(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)===!1?OV:t.xmlMode||"utf8"!==t.encodeEntities?OE.encodeXML:OE.escapeAttribute;return Object.keys(e).map(function(n){var i,o,s=null!==(i=e[n])&&void 0!==i?i:"";return"foreign"===t.xmlMode&&(n=null!==(o=O$.attributeNames.get(n))&&void 0!==o?o:n),t.emptyAttrs||t.xmlMode||""!==s?"".concat(n,'="').concat(r(s),'"'):n}).join(" ")}}(e.attribs,t);return i&&(r+=" ".concat(i)),0===e.children.length&&(t.xmlMode?!1!==t.selfClosingTags:t.selfClosingTags&&OW.has(e.name))?(t.xmlMode||(r+=" "),r+="/>"):(r+=">",e.children.length>0&&(r+=OU(e.children,t)),(t.xmlMode||!OW.has(e.name))&&(r+="</".concat(e.name,">"))),r}(e,t);case OF.Text:return function(e,t){var n,r=e.data||"";return(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)===!1||!t.xmlMode&&e.parent&&OQ.has(e.parent.name)||(r=t.xmlMode||"utf8"!==t.encodeEntities?(0,OE.encodeXML)(r):(0,OE.escapeText)(r)),r}(e,t)}}(n[i],t);return r}OA.render=OU,OA.default=OU;var OH=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),OG=new Set(["svg","math"]),OX=S.a1&&S.a1.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(OT,"__esModule",{value:!0}),OT.getOuterHTML=OY,OT.getInnerHTML=function(e,t){return(0,Or.hasChildren)(e)?e.children.map(function(e){return OY(e,t)}).join(""):""},OT.getText=function e(t){return Array.isArray(t)?t.map(e).join(""):(0,Or.isTag)(t)?"br"===t.name?`
`:e(t.children):(0,Or.isCDATA)(t)?e(t.children):(0,Or.isText)(t)?t.data:""},OT.textContent=function e(t){return Array.isArray(t)?t.map(e).join(""):(0,Or.hasChildren)(t)&&!(0,Or.isComment)(t)?e(t.children):(0,Or.isText)(t)?t.data:""},OT.innerText=function e(t){return Array.isArray(t)?t.map(e).join(""):(0,Or.hasChildren)(t)&&(t.type===Oi.ElementType.Tag||(0,Or.isCDATA)(t))?e(t.children):(0,Or.isText)(t)?t.data:""};var OZ=OX(OA);function OY(e,t){return(0,OZ.default)(e,t)}var OJ={};function OK(e){return(0,Or.hasChildren)(e)?e.children:[]}function O0(e){return e.parent||null}Object.defineProperty(OJ,"__esModule",{value:!0}),OJ.getChildren=OK,OJ.getParent=O0,OJ.getSiblings=function(e){var t=O0(e);if(null!=t)return OK(t);for(var n=[e],r=e.prev,i=e.next;null!=r;)n.unshift(r),r=r.prev;for(;null!=i;)n.push(i),i=i.next;return n},OJ.getAttributeValue=function(e,t){var n;return null===(n=e.attribs)||void 0===n?void 0:n[t]},OJ.hasAttrib=function(e,t){return null!=e.attribs&&Object.prototype.hasOwnProperty.call(e.attribs,t)&&null!=e.attribs[t]},OJ.getName=function(e){return e.name},OJ.nextElementSibling=function(e){for(var t=e.next;null!==t&&!(0,Or.isTag)(t);)t=t.next;return t},OJ.prevElementSibling=function(e){for(var t=e.prev;null!==t&&!(0,Or.isTag)(t);)t=t.prev;return t};var O1={};function O2(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){var t=e.parent.children,n=t.lastIndexOf(e);n>=0&&t.splice(n,1)}e.next=null,e.prev=null,e.parent=null}Object.defineProperty(O1,"__esModule",{value:!0}),O1.removeElement=O2,O1.replaceElement=function(e,t){var n=t.prev=e.prev;n&&(n.next=t);var r=t.next=e.next;r&&(r.prev=t);var i=t.parent=e.parent;if(i){var o=i.children;o[o.lastIndexOf(e)]=t,e.parent=null}},O1.appendChild=function(e,t){if(O2(t),t.next=null,t.parent=e,e.children.push(t)>1){var n=e.children[e.children.length-2];n.next=t,t.prev=n}else t.prev=null},O1.append=function(e,t){O2(t);var n=e.parent,r=e.next;if(t.next=r,t.prev=e,e.next=t,t.parent=n,r){if(r.prev=t,n){var i=n.children;i.splice(i.lastIndexOf(r),0,t)}}else n&&n.children.push(t)},O1.prependChild=function(e,t){if(O2(t),t.parent=e,t.prev=null,1!==e.children.unshift(t)){var n=e.children[1];n.prev=t,t.next=n}else t.next=null},O1.prepend=function(e,t){O2(t);var n=e.parent;if(n){var r=n.children;r.splice(r.indexOf(e),0,t)}e.prev&&(e.prev.next=t),t.parent=n,t.prev=e.prev,t.next=e,e.prev=t};var O5={};function O3(e,t,n,r){for(var i=[],o=[Array.isArray(t)?t:[t]],s=[0];;){if(s[0]>=o[0].length){if(1===s.length)return i;o.shift(),s.shift();continue}var a=o[0][s[0]++];if(e(a)&&(i.push(a),--r<=0))return i;n&&(0,Or.hasChildren)(a)&&a.children.length>0&&(s.unshift(0),o.unshift(a.children))}}Object.defineProperty(O5,"__esModule",{value:!0}),O5.filter=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),O3(e,Array.isArray(t)?t:[t],n,r)},O5.find=O3,O5.findOneChild=function(e,t){return t.find(e)},O5.findOne=function e(t,n,r){void 0===r&&(r=!0);for(var i=Array.isArray(n)?n:[n],o=0;o<i.length;o++){var s=i[o];if((0,Or.isTag)(s)&&t(s))return s;if(r&&(0,Or.hasChildren)(s)&&s.children.length>0){var a=e(t,s.children,!0);if(a)return a}}return null},O5.existsOne=function e(t,n){return(Array.isArray(n)?n:[n]).some(function(n){return(0,Or.isTag)(n)&&t(n)||(0,Or.hasChildren)(n)&&e(t,n.children)})},O5.findAll=function(e,t){for(var n=[],r=[Array.isArray(t)?t:[t]],i=[0];;){if(i[0]>=r[0].length){if(1===r.length)return n;r.shift(),i.shift();continue}var o=r[0][i[0]++];(0,Or.isTag)(o)&&e(o)&&n.push(o),(0,Or.hasChildren)(o)&&o.children.length>0&&(i.unshift(0),r.unshift(o.children))}};var O4={};Object.defineProperty(O4,"__esModule",{value:!0}),O4.testElement=function(e,t){var n=O7(e);return!n||n(t)},O4.getElements=function(e,t,n,r){void 0===r&&(r=1/0);var i=O7(e);return i?(0,O5.filter)(i,t,n,r):[]},O4.getElementById=function(e,t,n){return void 0===n&&(n=!0),Array.isArray(t)||(t=[t]),(0,O5.findOne)(O8("id",e),t,n)},O4.getElementsByTagName=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),(0,O5.filter)(O6.tag_name(e),t,n,r)},O4.getElementsByClassName=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),(0,O5.filter)(O8("class",e),t,n,r)},O4.getElementsByTagType=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),(0,O5.filter)(O6.tag_type(e),t,n,r)};var O6={tag_name:function(e){return"function"==typeof e?function(t){return(0,Or.isTag)(t)&&e(t.name)}:"*"===e?Or.isTag:function(t){return(0,Or.isTag)(t)&&t.name===e}},tag_type:function(e){return"function"==typeof e?function(t){return e(t.type)}:function(t){return t.type===e}},tag_contains:function(e){return"function"==typeof e?function(t){return(0,Or.isText)(t)&&e(t.data)}:function(t){return(0,Or.isText)(t)&&t.data===e}}};function O8(e,t){return"function"==typeof t?function(n){return(0,Or.isTag)(n)&&t(n.attribs[e])}:function(n){return(0,Or.isTag)(n)&&n.attribs[e]===t}}function O9(e,t){return function(n){return e(n)||t(n)}}function O7(e){var t=Object.keys(e).map(function(t){var n=e[t];return Object.prototype.hasOwnProperty.call(O6,t)?O6[t](n):O8(t,n)});return 0===t.length?null:t.reduce(O9)}var Se={};function St(e,t){var n=[],r=[];if(e===t)return 0;for(var i=(0,Or.hasChildren)(e)?e:e.parent;i;)n.unshift(i),i=i.parent;for(i=(0,Or.hasChildren)(t)?t:t.parent;i;)r.unshift(i),i=i.parent;for(var o=Math.min(n.length,r.length),s=0;s<o&&n[s]===r[s];)s++;if(0===s)return p.DISCONNECTED;var a=n[s-1],l=a.children,c=n[s],h=r[s];return l.indexOf(c)>l.indexOf(h)?a===t?p.FOLLOWING|p.CONTAINED_BY:p.FOLLOWING:a===e?p.PRECEDING|p.CONTAINS:p.PRECEDING}Object.defineProperty(Se,"__esModule",{value:!0}),Se.DocumentPosition=void 0,Se.removeSubsets=function(e){for(var t=e.length;--t>=0;){var n=e[t];if(t>0&&e.lastIndexOf(n,t-1)>=0){e.splice(t,1);continue}for(var r=n.parent;r;r=r.parent)if(e.includes(r)){e.splice(t,1);break}}return e},Se.compareDocumentPosition=St,Se.uniqueSort=function(e){return(e=e.filter(function(e,t,n){return!n.includes(e,t+1)})).sort(function(e,t){var n=St(e,t);return n&p.PRECEDING?-1:n&p.FOLLOWING?1:0}),e},function(e){e[e.DISCONNECTED=1]="DISCONNECTED",e[e.PRECEDING=2]="PRECEDING",e[e.FOLLOWING=4]="FOLLOWING",e[e.CONTAINS=8]="CONTAINS",e[e.CONTAINED_BY=16]="CONTAINED_BY"}(p||(Se.DocumentPosition=p={}));var Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.getFeed=function(e){var t,n,r,i,o,s,a,l,c,h,u=Ss(Sc,e);return u?"feed"===u.name?(n=u.children,r={type:"atom",items:(0,O4.getElementsByTagName)("entry",n).map(function(e){var t,n=e.children,r={media:So(n)};Sl(r,"id","id",n),Sl(r,"title","title",n);var i=null===(t=Ss("link",n))||void 0===t?void 0:t.attribs.href;i&&(r.link=i);var o=Sa("summary",n)||Sa("content",n);o&&(r.description=o);var s=Sa("updated",n);return s&&(r.pubDate=new Date(s)),r})},Sl(r,"id","id",n),Sl(r,"title","title",n),(i=null===(t=Ss("link",n))||void 0===t?void 0:t.attribs.href)&&(r.link=i),Sl(r,"description","subtitle",n),(o=Sa("updated",n))&&(r.updated=new Date(o)),Sl(r,"author","email",n,!0),r):(l=null!==(a=null===(s=Ss("channel",u.children))||void 0===s?void 0:s.children)&&void 0!==a?a:[],c={type:u.name.substr(0,3),id:"",items:(0,O4.getElementsByTagName)("item",u.children).map(function(e){var t=e.children,n={media:So(t)};Sl(n,"id","guid",t),Sl(n,"title","title",t),Sl(n,"link","link",t),Sl(n,"description","description",t);var r=Sa("pubDate",t)||Sa("dc:date",t);return r&&(n.pubDate=new Date(r)),n})},Sl(c,"title","title",l),Sl(c,"link","link",l),Sl(c,"description","description",l),(h=Sa("lastBuildDate",l))&&(c.updated=new Date(h)),Sl(c,"author","managingEditor",l,!0),c):null};var Sr=["url","type","lang"],Si=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function So(e){return(0,O4.getElementsByTagName)("media:content",e).map(function(e){for(var t=e.attribs,n={medium:t.medium,isDefault:!!t.isDefault},r=0;r<Sr.length;r++){var i=Sr[r];t[i]&&(n[i]=t[i])}for(var o=0;o<Si.length;o++){var i=Si[o];t[i]&&(n[i]=parseInt(t[i],10))}return t.expression&&(n.expression=t.expression),n})}function Ss(e,t){return(0,O4.getElementsByTagName)(e,t,!0,1)[0]}function Sa(e,t,n){return void 0===n&&(n=!1),(0,OT.textContent)((0,O4.getElementsByTagName)(e,t,n,1)).trim()}function Sl(e,t,n,r,i){void 0===i&&(i=!1);var o=Sa(n,r,i);o&&(e[t]=o)}function Sc(e){return"rss"===e||"feed"===e||"rdf:RDF"===e}!function(e){var t=S.a1&&S.a1.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=S.a1&&S.a1.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.hasChildren=e.isDocument=e.isComment=e.isText=e.isCDATA=e.isTag=void 0,n(OT,e),n(OJ,e),n(O1,e),n(O5,e),n(O4,e),n(Se,e),n(Sn,e),Object.defineProperty(e,"isTag",{enumerable:!0,get:function(){return Or.isTag}}),Object.defineProperty(e,"isCDATA",{enumerable:!0,get:function(){return Or.isCDATA}}),Object.defineProperty(e,"isText",{enumerable:!0,get:function(){return Or.isText}}),Object.defineProperty(e,"isComment",{enumerable:!0,get:function(){return Or.isComment}}),Object.defineProperty(e,"isDocument",{enumerable:!0,get:function(){return Or.isDocument}}),Object.defineProperty(e,"hasChildren",{enumerable:!0,get:function(){return Or.hasChildren}})}(OC),function(e){var t=S.a1&&S.a1.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=S.a1&&S.a1.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=S.a1&&S.a1.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&t(r,e,i);return n(r,e),r},i=S.a1&&S.a1.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};function o(e,t){var n=new Or.DomHandler(void 0,t);return new kU.Parser(n,t).end(e),n.root}function s(e,t){return o(e,t).children}Object.defineProperty(e,"__esModule",{value:!0}),e.DomUtils=e.parseFeed=e.getFeed=e.ElementType=e.Tokenizer=e.createDomStream=e.parseDOM=e.parseDocument=e.DefaultHandler=e.DomHandler=e.Parser=void 0,Object.defineProperty(e,"Parser",{enumerable:!0,get:function(){return kU.Parser}}),Object.defineProperty(e,"DomHandler",{enumerable:!0,get:function(){return Or.DomHandler}}),Object.defineProperty(e,"DefaultHandler",{enumerable:!0,get:function(){return Or.DomHandler}}),e.parseDocument=o,e.parseDOM=s,e.createDomStream=function(e,t,n){var r=new Or.DomHandler(e,t,n);return new kU.Parser(r,t)},Object.defineProperty(e,"Tokenizer",{enumerable:!0,get:function(){return i(kH).default}}),e.ElementType=r(Oi),Object.defineProperty(e,"getFeed",{enumerable:!0,get:function(){return OC.getFeed}});var a={xmlMode:!0};e.parseFeed=function(e,t){return void 0===t&&(t=a),(0,OC.getFeed)(s(e,t))},e.DomUtils=r(OC)}(kW);var Sh={};function Su(e){return"[object Object]"===Object.prototype.toString.call(e)}Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.isPlainObject=function(e){var t,n;return!1!==Su(e)&&(void 0===(t=e.constructor)||!(!1===Su(n=t.prototype)||!1===n.hasOwnProperty("isPrototypeOf")))};var Sd=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==Sf},Sf="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function Sp(e,t){return!1!==t.clone&&t.isMergeableObject(e)?Sb(Array.isArray(e)?[]:{},e,t):e}function Sm(e,t,n){return e.concat(t).map(function(e){return Sp(e,n)})}function Sg(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function Sy(e,t){try{return t in e}catch{return!1}}function Sb(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||Sm,n.isMergeableObject=n.isMergeableObject||Sd,n.cloneUnlessOtherwiseSpecified=Sp;var r,i,o=Array.isArray(t);return o===Array.isArray(e)?o?n.arrayMerge(e,t,n):(i={},(r=n).isMergeableObject(e)&&Sg(e).forEach(function(t){i[t]=Sp(e[t],r)}),Sg(t).forEach(function(n){Sy(e,n)&&!(Object.hasOwnProperty.call(e,n)&&Object.propertyIsEnumerable.call(e,n))||(Sy(e,n)&&r.isMergeableObject(t[n])?i[n]=(function(e,t){if(!t.customMerge)return Sb;var n=t.customMerge(e);return"function"==typeof n?n:Sb})(n,r)(e[n],t[n],r):i[n]=Sp(t[n],r))}),i):Sp(t,n)}Sb.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,n){return Sb(e,n,t)},{})};var Sv={exports:{}};!function(e){var t,n;t=S.a1,n=function(){return function(e){function t(e){return" "===e||"	"===e||e===`
`||"\f"===e||"\r"===e}function n(t){var n,r=t.exec(e.substring(m));if(r)return n=r[0],m+=n.length,n}for(var r,i,o,s,a,l=e.length,c=/^[ \t\n\r\u000c]+/,h=/^[, \t\n\r\u000c]+/,u=/^[^ \t\n\r\u000c]+/,d=/[,]+$/,f=/^\d+$/,p=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,m=0,g=[];;){if(n(h),m>=l)return g;r=n(u),i=[],","===r.slice(-1)?(r=r.replace(d,""),y()):function(){for(n(c),o="",s="in descriptor";;){if(a=e.charAt(m),"in descriptor"===s){if(t(a))o&&(i.push(o),o="",s="after descriptor");else if(","===a){m+=1,o&&i.push(o),y();return}else if("("===a)o+=a,s="in parens";else if(""===a){o&&i.push(o),y();return}else o+=a}else if("in parens"===s){if(")"===a)o+=a,s="in descriptor";else if(""===a){i.push(o),y();return}else o+=a}else if("after descriptor"===s&&!t(a)){if(""===a){y();return}s="in descriptor",m-=1}m+=1}}()}function y(){var t,n,o,s,a,l,c,h,u,d=!1,m={};for(s=0;s<i.length;s++)l=(a=i[s])[a.length-1],h=parseInt(c=a.substring(0,a.length-1),10),u=parseFloat(c),f.test(c)&&"w"===l?((t||n)&&(d=!0),0===h?d=!0:t=h):p.test(c)&&"x"===l?((t||n||o)&&(d=!0),u<0?d=!0:n=u):f.test(c)&&"h"===l?((o||n)&&(d=!0),0===h?d=!0:o=h):d=!0;d?console&&console.log&&console.log("Invalid srcset descriptor found in '"+e+"' at '"+a+"'."):(m.url=r,t&&(m.w=t),n&&(m.d=n),o&&(m.h=o),g.push(m))}}},e.exports?e.exports=n():t.parseSrcset=n()}(Sv);var Sx=Sv.exports,Sw={exports:{}},Sk=String,SO=function(){return{isColorSupported:!1,reset:Sk,bold:Sk,dim:Sk,italic:Sk,underline:Sk,inverse:Sk,hidden:Sk,strikethrough:Sk,black:Sk,red:Sk,green:Sk,yellow:Sk,blue:Sk,magenta:Sk,cyan:Sk,white:Sk,gray:Sk,bgBlack:Sk,bgRed:Sk,bgGreen:Sk,bgYellow:Sk,bgBlue:Sk,bgMagenta:Sk,bgCyan:Sk,bgWhite:Sk,blackBright:Sk,redBright:Sk,greenBright:Sk,yellowBright:Sk,blueBright:Sk,magentaBright:Sk,cyanBright:Sk,whiteBright:Sk,bgBlackBright:Sk,bgRedBright:Sk,bgGreenBright:Sk,bgYellowBright:Sk,bgBlueBright:Sk,bgMagentaBright:Sk,bgCyanBright:Sk,bgWhiteBright:Sk}};Sw.exports=SO(),Sw.exports.createColors=SO;var SS=Sw.exports;let SC=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})),ST=(0,S.a2)(SC),SA=class e extends Error{constructor(t,n,r,i,o,s){super(t),this.name="CssSyntaxError",this.reason=t,o&&(this.file=o),i&&(this.source=i),s&&(this.plugin=s),"u">typeof n&&"u">typeof r&&("number"==typeof n?(this.line=n,this.column=r):(this.line=n.line,this.column=n.column,this.endLine=r.line,this.endColumn=r.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,e)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>","u">typeof this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){if(!this.source)return"";let t=this.source;null==e&&(e=SS.isColorSupported);let n=e=>e,r=e=>e,i=e=>e;if(e){let{bold:e,gray:t,red:o}=SS.createColors(!0);r=t=>e(o(t)),n=e=>t(e),ST&&(i=e=>ST(e))}let o=t.split(/\r?\n/),s=Math.max(this.line-3,0),a=Math.min(this.line+2,o.length),l=String(a).length;return o.slice(s,a).map((e,t)=>{let o=s+1+t,a=" "+(" "+o).slice(-l)+" | ";if(o===this.line){if(e.length>160){let t=Math.max(0,this.column-20),o=Math.max(this.column+20,this.endColumn+20),s=e.slice(t,o),l=n(a.replace(/\d/g," "))+e.slice(0,Math.min(this.column-1,19)).replace(/[^\t]/g," ");return r(">")+n(a)+i(s)+`
 `+l+r("^")}let t=n(a.replace(/\d/g," "))+e.slice(0,this.column-1).replace(/[^\t]/g," ");return r(">")+n(a)+i(e)+`
 `+t+r("^")}return" "+n(a)+i(e)}).join(`
`)}toString(){let e=this.showSourceCode();return e&&(e=`

`+e+`
`),this.name+": "+this.message+e}};SA.default=SA;let SE={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1},SM=class{constructor(e){this.builder=e}atrule(e,t){let n="@"+e.name,r=e.params?this.rawValue(e,"params"):"";if("u">typeof e.raws.afterName?n+=e.raws.afterName:r&&(n+=" "),e.nodes)this.block(e,n+r);else{let i=(e.raws.between||"")+(t?";":"");this.builder(n+r+i,e)}}beforeAfter(e,t){let n;n="decl"===e.type?this.raw(e,null,"beforeDecl"):"comment"===e.type?this.raw(e,null,"beforeComment"):"before"===t?this.raw(e,null,"beforeRule"):this.raw(e,null,"beforeClose");let r=e.parent,i=0;for(;r&&"root"!==r.type;)i+=1,r=r.parent;if(n.includes(`
`)){let t=this.raw(e,null,"indent");if(t.length)for(let e=0;e<i;e++)n+=t}return n}block(e,t){let n,r=this.raw(e,"between","beforeOpen");this.builder(t+r+"{",e,"start"),e.nodes&&e.nodes.length?(this.body(e),n=this.raw(e,"after")):n=this.raw(e,"after","emptyBody"),n&&this.builder(n),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&"comment"===e.nodes[t].type;)t-=1;let n=this.raw(e,"semicolon");for(let r=0;r<e.nodes.length;r++){let i=e.nodes[r],o=this.raw(i,"before");o&&this.builder(o),this.stringify(i,t!==r||n)}}comment(e){let t=this.raw(e,"left","commentLeft"),n=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+n+"*/",e)}decl(e,t){let n=this.raw(e,"between","colon"),r=e.prop+n+this.rawValue(e,"value");e.important&&(r+=e.raws.important||" !important"),t&&(r+=";"),this.builder(r,e)}document(e){this.body(e)}raw(e,t,n){let r;if(n||(n=t),t&&"u">typeof(r=e.raws[t]))return r;let i=e.parent;if("before"===n&&(!i||"root"===i.type&&i.first===e||i&&"document"===i.type))return"";if(!i)return SE[n];let o=e.root();if(o.rawCache||(o.rawCache={}),"u">typeof o.rawCache[n])return o.rawCache[n];if("before"===n||"after"===n)return this.beforeAfter(e,n);{var s;let i="raw"+((s=n)[0].toUpperCase()+s.slice(1));this[i]?r=this[i](o,e):o.walk(e=>{if("u">typeof(r=e.raws[t]))return!1})}return typeof r>"u"&&(r=SE[n]),o.rawCache[n]=r,r}rawBeforeClose(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length>0&&"u">typeof e.raws.after)return(t=e.raws.after).includes(`
`)&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let n;return e.walkComments(e=>{if("u">typeof e.raws.before)return(n=e.raws.before).includes(`
`)&&(n=n.replace(/[^\n]+$/,"")),!1}),typeof n>"u"?n=this.raw(t,null,"beforeDecl"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeDecl(e,t){let n;return e.walkDecls(e=>{if("u">typeof e.raws.before)return(n=e.raws.before).includes(`
`)&&(n=n.replace(/[^\n]+$/,"")),!1}),typeof n>"u"?n=this.raw(t,null,"beforeRule"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeOpen(e){let t;return e.walk(e=>{if("decl"!==e.type&&"u">typeof(t=e.raws.between))return!1}),t}rawBeforeRule(e){let t;return e.walk(n=>{if(n.nodes&&(n.parent!==e||e.first!==n)&&"u">typeof n.raws.before)return(t=n.raws.before).includes(`
`)&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls(e=>{if("u">typeof e.raws.between)return t=e.raws.between.replace(/[^\s:]/g,""),!1}),t}rawEmptyBody(e){let t;return e.walk(e=>{if(e.nodes&&0===e.nodes.length&&"u">typeof(t=e.raws.after))return!1}),t}rawIndent(e){let t;return e.raws.indent?e.raws.indent:(e.walk(n=>{let r=n.parent;if(r&&r!==e&&r.parent&&r.parent===e&&"u">typeof n.raws.before){let e=n.raws.before.split(`
`);return t=(t=e[e.length-1]).replace(/\S/g,""),!1}}),t)}rawSemicolon(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length&&"decl"===e.last.type&&"u">typeof(t=e.raws.semicolon))return!1}),t}rawValue(e,t){let n=e[t],r=e.raws[t];return r&&r.value===n?r.raw:n}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}};function S_(e,t){new SM(t).stringify(e)}SM.default=SM,S_.default=S_;var SD={};SD.isClean=Symbol("isClean"),SD.my=Symbol("my");let{isClean:SN,my:SR}=SD;function SP(e,t){if(t&&"u">typeof t.offset)return t.offset;let n=1,r=1,i=0;for(let o=0;o<e.length;o++){if(r===t.line&&n===t.column){i=o;break}e[o]===`
`?(n=1,r+=1):n+=1}return i}let Sj=class{get proxyOf(){return this}constructor(e={}){for(let t in this.raws={},this[SN]=!1,this[SR]=!0,e)if("nodes"===t)for(let n of(this.nodes=[],e[t]))"function"==typeof n.clone?this.append(n.clone()):this.append(n);else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}after(e){return this.parent.insertAfter(this,e),this}assign(e={}){for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(e={}){let t=function e(t,n){let r=new t.constructor;for(let i in t){if(!Object.prototype.hasOwnProperty.call(t,i)||"proxyCache"===i)continue;let o=t[i],s=typeof o;"parent"===i&&"object"===s?n&&(r[i]=n):"source"===i?r[i]=o:Array.isArray(o)?r[i]=o.map(t=>e(t,r)):("object"===s&&null!==o&&(o=e(o)),r[i]=o)}return r}(this);for(let n in e)t[n]=e[n];return t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e,t={}){if(this.source){let{end:n,start:r}=this.rangeBy(t);return this.source.input.error(e,{column:r.column,line:r.line},{column:n.column,line:n.line},t)}return new SA(e)}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:"root"===t?()=>e.root().toProxy():e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,("prop"===t||"value"===t||"name"===t||"params"===t||"important"===t||"text"===t)&&e.markDirty()),!0)}}markClean(){this[SN]=!0}markDirty(){if(this[SN]){this[SN]=!1;let e=this;for(;e=e.parent;)e[SN]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e){let t=this.source.start;if(e.index)t=this.positionInside(e.index);else if(e.word){let n="document"in this.source.input?this.source.input.document:this.source.input.css,r=n.slice(SP(n,this.source.start),SP(n,this.source.end)).indexOf(e.word);-1!==r&&(t=this.positionInside(r))}return t}positionInside(e){let t=this.source.start.column,n=this.source.start.line,r="document"in this.source.input?this.source.input.document:this.source.input.css,i=SP(r,this.source.start),o=i+e;for(let e=i;e<o;e++)r[e]===`
`?(t=1,n+=1):t+=1;return{column:t,line:n}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},n=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let r="document"in this.source.input?this.source.input.document:this.source.input.css,i=r.slice(SP(r,this.source.start),SP(r,this.source.end)).indexOf(e.word);-1!==i&&(t=this.positionInside(i),n=this.positionInside(i+e.word.length))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?n={column:e.end.column,line:e.end.line}:"number"==typeof e.endIndex?n=this.positionInside(e.endIndex):e.index&&(n=this.positionInside(e.index+1));return(n.line<t.line||n.line===t.line&&n.column<=t.column)&&(n={column:t.column+1,line:t.line}),{end:n,start:t}}raw(e,t){return new SM().raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...e){if(this.parent){let t=this,n=!1;for(let r of e)r===this?n=!0:n?(this.parent.insertAfter(t,r),t=r):this.parent.insertBefore(t,r);n||this.remove()}return this}root(){let e=this;for(;e.parent&&"document"!==e.parent.type;)e=e.parent;return e}toJSON(e,t){let n={},r=null==t;t=t||new Map;let i=0;for(let e in this){if(!Object.prototype.hasOwnProperty.call(this,e)||"parent"===e||"proxyCache"===e)continue;let r=this[e];if(Array.isArray(r))n[e]=r.map(e=>"object"==typeof e&&e.toJSON?e.toJSON(null,t):e);else if("object"==typeof r&&r.toJSON)n[e]=r.toJSON(null,t);else if("source"===e){let o=t.get(r.input);null==o&&(o=i,t.set(r.input,i),i++),n[e]={end:r.end,inputId:o,start:r.start}}else n[e]=r}return r&&(n.inputs=[...t.keys()].map(e=>e.toJSON())),n}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(e=S_){e.stringify&&(e=e.stringify);let t="";return e(this,e=>{t+=e}),t}warn(e,t,n){let r={node:this};for(let e in n)r[e]=n[e];return e.warn(t,r)}};Sj.default=Sj;let SI=Sj,S$=class extends SI{constructor(e){super(e),this.type="comment"}};S$.default=S$;let SL=Sj,Sq=class extends SL{get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}constructor(e){e&&"u">typeof e.value&&"string"!=typeof e.value&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}};Sq.default=Sq;let Sz=Sj,{isClean:SB,my:SF}=SD,SQ,SV,SW,SU,SH=class e extends Sz{get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}append(...e){for(let t of e)for(let e of this.normalize(t,this.last))this.proxyOf.nodes.push(e);return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){if(!this.proxyOf.nodes)return;let t=this.getIterator(),n,r;for(;this.indexes[t]<this.proxyOf.nodes.length&&(n=this.indexes[t],!1!==(r=e(this.proxyOf.nodes[n],n)));)this.indexes[t]+=1;return delete this.indexes[t],r}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:e[t]?"each"===t||"string"==typeof t&&t.startsWith("walk")?(...n)=>e[t](...n.map(e=>"function"==typeof e?(t,n)=>e(t.toProxy(),n):e)):"every"===t||"some"===t?n=>e[t]((e,...t)=>n(e.toProxy(),...t)):"root"===t?()=>e.root().toProxy():"nodes"===t?e.nodes.map(e=>e.toProxy()):"first"===t||"last"===t?e[t].toProxy():e[t]:e[t],set:(e,t,n)=>(e[t]===n||(e[t]=n,("name"===t||"params"===t||"selector"===t)&&e.markDirty()),!0)}}index(e){return"number"==typeof e?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let n,r=this.index(e),i=this.normalize(t,this.proxyOf.nodes[r]).reverse();for(let t of(r=this.index(e),i))this.proxyOf.nodes.splice(r+1,0,t);for(let e in this.indexes)r<(n=this.indexes[e])&&(this.indexes[e]=n+i.length);return this.markDirty(),this}insertBefore(e,t){let n,r=this.index(e),i=0===r&&"prepend",o=this.normalize(t,this.proxyOf.nodes[r],i).reverse();for(let t of(r=this.index(e),o))this.proxyOf.nodes.splice(r,0,t);for(let e in this.indexes)r<=(n=this.indexes[e])&&(this.indexes[e]=n+o.length);return this.markDirty(),this}normalize(t,n){if("string"==typeof t)t=function e(t){return t.map(t=>(t.nodes&&(t.nodes=e(t.nodes)),delete t.source,t))}(SV(t).nodes);else if(typeof t>"u")t=[];else if(Array.isArray(t))for(let e of t=t.slice(0))e.parent&&e.parent.removeChild(e,"ignore");else if("root"===t.type&&"document"!==this.type)for(let e of t=t.nodes.slice(0))e.parent&&e.parent.removeChild(e,"ignore");else if(t.type)t=[t];else if(t.prop){if(typeof t.value>"u")throw Error("Value field is missed in node creation");"string"!=typeof t.value&&(t.value=String(t.value)),t=[new Sq(t)]}else if(t.selector||t.selectors)t=[new SU(t)];else if(t.name)t=[new SQ(t)];else if(t.text)t=[new S$(t)];else throw Error("Unknown node type in node creation");return t.map(t=>(t[SF]||e.rebuild(t),(t=t.proxyOf).parent&&t.parent.removeChild(t),t[SB]&&function e(t){if(t[SB]=!1,t.proxyOf.nodes)for(let n of t.proxyOf.nodes)e(n)}(t),t.raws||(t.raws={}),typeof t.raws.before>"u"&&n&&"u">typeof n.raws.before&&(t.raws.before=n.raws.before.replace(/\S/g,"")),t.parent=this.proxyOf,t))}prepend(...e){for(let t of e=e.reverse()){let e=this.normalize(t,this.first,"prepend").reverse();for(let t of e)this.proxyOf.nodes.unshift(t);for(let t in this.indexes)this.indexes[t]=this.indexes[t]+e.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){let t;for(let n in e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1),this.indexes)(t=this.indexes[n])>=e&&(this.indexes[n]=t-1);return this.markDirty(),this}replaceValues(e,t,n){return n||(n=t,t={}),this.walkDecls(r=>{t.props&&!t.props.includes(r.prop)||t.fast&&!r.value.includes(t.fast)||(r.value=r.value.replace(e,n))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((t,n)=>{let r;try{r=e(t,n)}catch(e){throw t.addToError(e)}return!1!==r&&t.walk&&(r=t.walk(e)),r})}walkAtRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("atrule"===n.type&&e.test(n.name))return t(n,r)}):this.walk((n,r)=>{if("atrule"===n.type&&n.name===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("atrule"===e.type)return t(e,n)}))}walkComments(e){return this.walk((t,n)=>{if("comment"===t.type)return e(t,n)})}walkDecls(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("decl"===n.type&&e.test(n.prop))return t(n,r)}):this.walk((n,r)=>{if("decl"===n.type&&n.prop===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("decl"===e.type)return t(e,n)}))}walkRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if("rule"===n.type&&e.test(n.selector))return t(n,r)}):this.walk((n,r)=>{if("rule"===n.type&&n.selector===e)return t(n,r)}):(t=e,this.walk((e,n)=>{if("rule"===e.type)return t(e,n)}))}};SH.registerParse=e=>{SV=e},SH.registerRule=e=>{SU=e},SH.registerAtRule=e=>{SQ=e},SH.registerRoot=e=>{SW=e},SH.default=SH,SH.rebuild=e=>{"atrule"===e.type?Object.setPrototypeOf(e,SQ.prototype):"rule"===e.type?Object.setPrototypeOf(e,SU.prototype):"decl"===e.type?Object.setPrototypeOf(e,Sq.prototype):"comment"===e.type?Object.setPrototypeOf(e,S$.prototype):"root"===e.type&&Object.setPrototypeOf(e,SW.prototype),e[SF]=!0,e.nodes&&e.nodes.forEach(e=>{SH.rebuild(e)})};let SG=SH,SX=class extends SG{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}};SX.default=SX,SG.registerAtRule(SX);let SZ=SH,SY,SJ,SK=class extends SZ{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new SY(new SJ,this,e).stringify()}};SK.registerLazyResult=e=>{SY=e},SK.registerProcessor=e=>{SJ=e},SK.default=SK;let{existsSync:S0,readFileSync:S1}=ST,{dirname:S2,join:S5}=ST,{SourceMapConsumer:S3,SourceMapGenerator:S4}=ST,S6=class{constructor(e,t){if(!1===t.map)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let n=t.map?t.map.prev:void 0,r=this.loadMap(t.from,n);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=S2(this.mapFile)),r&&(this.text=r)}consumer(){return this.consumerCache||(this.consumerCache=new S3(this.text)),this.consumerCache}decodeInline(e){let t=e.match(/^data:application\/json;charset=utf-?8,/)||e.match(/^data:application\/json,/);if(t)return decodeURIComponent(e.substr(t[0].length));let n=e.match(/^data:application\/json;charset=utf-?8;base64,/)||e.match(/^data:application\/json;base64,/);if(n){var r;return r=e.substr(n[0].length),E?E.from(r,"base64").toString():window.atob(r)}throw Error("Unsupported source map encoding "+e.match(/data:application\/json;([^,]+),/)[1])}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return"object"==typeof e&&("string"==typeof e.mappings||"string"==typeof e._mappings||Array.isArray(e.sections))}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/g);if(!t)return;let n=e.lastIndexOf(t.pop()),r=e.indexOf("*/",n);n>-1&&r>-1&&(this.annotation=this.getAnnotationURL(e.substring(n,r)))}loadFile(e){if(this.root=S2(e),S0(e))return this.mapFile=e,S1(e,"utf-8").toString().trim()}loadMap(e,t){if(!1===t)return!1;if(t){if("string"==typeof t)return t;if("function"==typeof t){let n=t(e);if(n){let e=this.loadFile(n);if(!e)throw Error("Unable to load previous source map: "+n.toString());return e}}else{if(t instanceof S3)return S4.fromSourceMap(t).toString();if(t instanceof S4)return t.toString();if(this.isMap(t))return JSON.stringify(t);throw Error("Unsupported previous source map format: "+t.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let t=this.annotation;return e&&(t=S5(S2(e),t)),this.loadFile(t)}}}startWith(e,t){return!!e&&e.substr(0,t.length)===t}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};S6.default=S6;let{nanoid:S8}={nanoid:(e=21)=>{let t="",n=0|e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}},{isAbsolute:S9,resolve:S7}=ST,{SourceMapConsumer:Ce,SourceMapGenerator:Ct}=ST,{fileURLToPath:Cn,pathToFileURL:Cr}=ST,Ci=Symbol("fromOffsetCache"),Co=!!(Ce&&Ct),Cs=!!(S7&&S9),Ca=class{get from(){return this.file||this.id}constructor(e,t={}){if(null===e||typeof e>"u"||"object"==typeof e&&!e.toString)throw Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),"\uFEFF"===this.css[0]||""===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,t.document&&(this.document=t.document.toString()),t.from&&(!Cs||/^\w+:\/\//.test(t.from)||S9(t.from)?this.file=t.from:this.file=S7(t.from)),Cs&&Co){let e=new S6(this.css,t);if(e.text){this.map=e;let t=e.consumer().file;!this.file&&t&&(this.file=this.mapResolve(t))}}this.file||(this.id="<input css "+S8(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,n,r={}){let i,o,s;if(t&&"object"==typeof t){let e=t,r=n;if("number"==typeof e.offset){let r=this.fromOffset(e.offset);t=r.line,n=r.col}else t=e.line,n=e.column;if("number"==typeof r.offset){let e=this.fromOffset(r.offset);o=e.line,i=e.col}else o=r.line,i=r.column}else if(!n){let e=this.fromOffset(t);t=e.line,n=e.col}let a=this.origin(t,n,o,i);return(s=a?new SA(e,void 0===a.endLine?a.line:{column:a.column,line:a.line},void 0===a.endLine?a.column:{column:a.endColumn,line:a.endLine},a.source,a.file,r.plugin):new SA(e,void 0===o?t:{column:n,line:t},void 0===o?n:{column:i,line:o},this.css,this.file,r.plugin)).input={column:n,endColumn:i,endLine:o,line:t,source:this.css},this.file&&(Cr&&(s.input.url=Cr(this.file).toString()),s.input.file=this.file),s}fromOffset(e){let t,n;if(this[Ci])n=this[Ci];else{let e=this.css.split(`
`);n=Array(e.length);let t=0;for(let r=0,i=e.length;r<i;r++)n[r]=t,t+=e[r].length+1;this[Ci]=n}t=n[n.length-1];let r=0;if(e>=t)r=n.length-1;else{let t=n.length-2,i;for(;r<t;)if(e<n[i=r+(t-r>>1)])t=i-1;else if(e>=n[i+1])r=i+1;else{r=i;break}}return{col:e-n[r]+1,line:r+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:S7(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,n,r){let i,o;if(!this.map)return!1;let s=this.map.consumer(),a=s.originalPositionFor({column:t,line:e});if(!a.source)return!1;"number"==typeof n&&(i=s.originalPositionFor({column:r,line:n})),o=S9(a.source)?Cr(a.source):new URL(a.source,this.map.consumer().sourceRoot||Cr(this.map.mapFile));let l={column:a.column,endColumn:i&&i.column,endLine:i&&i.line,line:a.line,url:o.toString()};if("file:"===o.protocol){if(Cn)l.file=Cn(o);else throw Error("file: protocol is not available in this PostCSS build")}let c=s.sourceContentFor(a.source);return c&&(l.source=c),l}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])null!=this[t]&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}};Ca.default=Ca,ST&&ST.registerInput&&ST.registerInput(Ca);let Cl=SH,Cc,Ch,Cu=class extends Cl{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,n){let r=super.normalize(e);if(t){if("prepend"===n)this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let e of r)e.raws.before=t.raws.before}return r}removeChild(e,t){let n=this.index(e);return!t&&0===n&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[n].raws.before),super.removeChild(e)}toResult(e={}){return new Cc(new Ch,this,e).stringify()}};Cu.registerLazyResult=e=>{Cc=e},Cu.registerProcessor=e=>{Ch=e},Cu.default=Cu,Cl.registerRoot(Cu);let Cd={comma:e=>Cd.split(e,[","],!0),space(e){let t=[" ",`
`,"	"];return Cd.split(e,t)},split(e,t,n){let r=[],i="",o=!1,s=0,a=!1,l="",c=!1;for(let n of e)c?c=!1:"\\"===n?c=!0:a?n===l&&(a=!1):'"'===n||"'"===n?(a=!0,l=n):"("===n?s+=1:")"===n?s>0&&(s-=1):0===s&&t.includes(n)&&(o=!0),o?(""!==i&&r.push(i.trim()),i="",o=!1):i+=n;return(n||""!==i)&&r.push(i.trim()),r}};Cd.default=Cd;let Cf=SH,Cp=class extends Cf{get selectors(){return Cd.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,n=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(n)}constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}};function Cm(e,t){if(Array.isArray(e))return e.map(e=>Cm(e));let{inputs:n,...r}=e;if(n)for(let e of(t=[],n)){let n={...e,__proto__:Ca.prototype};n.map&&(n.map={...n.map,__proto__:S6.prototype}),t.push(n)}if(r.nodes&&(r.nodes=e.nodes.map(e=>Cm(e,t))),r.source){let{inputId:e,...n}=r.source;r.source=n,null!=e&&(r.source.input=t[e])}if("root"===r.type)return new Cu(r);if("decl"===r.type)return new Sq(r);if("rule"===r.type)return new Cp(r);if("comment"===r.type)return new S$(r);if("atrule"===r.type)return new SX(r);throw Error("Unknown node type: "+e.type)}Cp.default=Cp,Cf.registerRule(Cp),Cm.default=Cm;let{dirname:Cg,relative:Cy,resolve:Cb,sep:Cv}=ST,{SourceMapConsumer:Cx,SourceMapGenerator:Cw}=ST,{pathToFileURL:Ck}=ST,CO=!!(Cx&&Cw),CS=!!(Cg&&Cb&&Cy&&Cv),CC=class{constructor(e,t,n,r){this.stringify=e,this.mapOpts=n.map||{},this.root=t,this.opts=n,this.css=r,this.originalCSS=r,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;e=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let t=`
`;this.css.includes(`\r
`)&&(t=`\r
`),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t=this.toUrl(this.path(e.file)),n=e.root||Cg(e.file),r;!1===this.mapOpts.sourcesContent?(r=new Cx(e.text)).sourcesContent&&(r.sourcesContent=null):r=e.consumer(),this.map.applySourceMap(r,t,this.toUrl(this.path(n)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation){if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)"comment"===(e=this.root.nodes[t]).type&&e.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}}generate(){if(this.clearAnnotation(),CS&&CO&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,t=>{e+=t}),[e]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=Cw.fromSourceMap(e,{ignoreInvalidMapping:!0})}else this.map=new Cw({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new Cw({file:this.outputFile(),ignoreInvalidMapping:!0});let e=1,t=1,n="<no source>",r={generated:{column:0,line:0},original:{column:0,line:0},source:""},i,o;this.stringify(this.root,(s,a,l)=>{if(this.css+=s,a&&"end"!==l&&(r.generated.line=e,r.generated.column=t-1,a.source&&a.source.start?(r.source=this.sourcePath(a),r.original.line=a.source.start.line,r.original.column=a.source.start.column-1):(r.source=n,r.original.line=1,r.original.column=0),this.map.addMapping(r)),(o=s.match(/\n/g))?(e+=o.length,i=s.lastIndexOf(`
`),t=s.length-i):t+=s.length,a&&"start"!==l){let i=a.parent||{raws:{}};(!("decl"===a.type||"atrule"===a.type&&!a.nodes)||a!==i.last||i.raws.semicolon)&&(a.source&&a.source.end?(r.source=this.sourcePath(a),r.original.line=a.source.end.line,r.original.column=a.source.end.column-1,r.generated.line=e,r.generated.column=t-2):(r.source=n,r.original.line=1,r.original.column=0,r.generated.line=e,r.generated.column=t-1),this.map.addMapping(r))}})}isAnnotation(){return!!this.isInline()||("u">typeof this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(e=>e.annotation))}isInline(){if("u">typeof this.mapOpts.inline)return this.mapOpts.inline;let e=this.mapOpts.annotation;return(!("u">typeof e)||!0===e)&&(!this.previous().length||this.previous().some(e=>e.inline))}isMap(){return"u">typeof this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return"u">typeof this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(e=>e.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute||60===e.charCodeAt(0)||/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let n=this.opts.to?Cg(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(n=Cg(Cb(n,this.mapOpts.annotation)));let r=Cy(n,e);return this.memoizedPaths.set(e,r),r}previous(){if(!this.previousMaps){if(this.previousMaps=[],this.root)this.root.walk(e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}});else{let e=new Ca(this.originalCSS,this.opts);e.map&&this.previousMaps.push(e.map)}}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk(t=>{if(t.source){let n=t.source.input.from;if(n&&!e[n]){e[n]=!0;let r=this.usesFileUrls?this.toFileUrl(n):this.toUrl(this.path(n));this.map.setSourceContent(r,t.source.input.css)}}});else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return E?E.from(e).toString("base64"):window.btoa(unescape(encodeURIComponent(e)))}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(Ck){let t=Ck(e).toString();return this.memoizedFileURLs.set(e,t),t}throw Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;"\\"===Cv&&(e=e.replace(/\\/g,"/"));let n=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,n),n}},CT=/[\t\n\f\r "#'()/;[\\\]{}]/g,CA=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,CE=/.[\r\n"'(/\\]/,CM=/[\da-f]/i,C_=function(e,t={}){let n=e.css.valueOf(),r=t.ignoreErrors,i,o,s,a,l,c,h,u,d,f,p=n.length,m=0,g=[],y=[];function b(t){throw e.error("Unclosed "+t,m)}return{back:function(e){y.push(e)},endOfFile:function(){return 0===y.length&&m>=p},nextToken:function(e){if(y.length)return y.pop();if(m>=p)return;let t=!!e&&e.ignoreUnclosed;switch(i=n.charCodeAt(m)){case 10:case 32:case 9:case 13:case 12:a=m;do a+=1,i=n.charCodeAt(a);while(32===i||10===i||9===i||13===i||12===i);c=["space",n.slice(m,a)],m=a-1;break;case 91:case 93:case 123:case 125:case 58:case 59:case 41:{let e=String.fromCharCode(i);c=[e,e,m];break}case 40:if(f=g.length?g.pop()[1]:"",d=n.charCodeAt(m+1),"url"===f&&39!==d&&34!==d&&32!==d&&10!==d&&9!==d&&12!==d&&13!==d){a=m;do{if(h=!1,-1===(a=n.indexOf(")",a+1))){if(r||t){a=m;break}b("bracket")}for(u=a;92===n.charCodeAt(u-1);)u-=1,h=!h}while(h);c=["brackets",n.slice(m,a+1),m,a],m=a}else a=n.indexOf(")",m+1),o=n.slice(m,a+1),-1===a||CE.test(o)?c=["(","(",m]:(c=["brackets",o,m,a],m=a);break;case 39:case 34:l=39===i?"'":'"',a=m;do{if(h=!1,-1===(a=n.indexOf(l,a+1))){if(r||t){a=m+1;break}b("string")}for(u=a;92===n.charCodeAt(u-1);)u-=1,h=!h}while(h);c=["string",n.slice(m,a+1),m,a],m=a;break;case 64:CT.lastIndex=m+1,CT.test(n),a=0===CT.lastIndex?n.length-1:CT.lastIndex-2,c=["at-word",n.slice(m,a+1),m,a],m=a;break;case 92:for(a=m,s=!0;92===n.charCodeAt(a+1);)a+=1,s=!s;if(i=n.charCodeAt(a+1),s&&47!==i&&32!==i&&10!==i&&9!==i&&13!==i&&12!==i&&(a+=1,CM.test(n.charAt(a)))){for(;CM.test(n.charAt(a+1));)a+=1;32===n.charCodeAt(a+1)&&(a+=1)}c=["word",n.slice(m,a+1),m,a],m=a;break;default:47===i&&42===n.charCodeAt(m+1)?(0===(a=n.indexOf("*/",m+2)+1)&&(r||t?a=n.length:b("comment")),c=["comment",n.slice(m,a+1),m,a]):(CA.lastIndex=m+1,CA.test(n),a=0===CA.lastIndex?n.length-1:CA.lastIndex-2,c=["word",n.slice(m,a+1),m,a],g.push(c)),m=a}return m++,c},position:function(){return m}}},CD={empty:!0,space:!0},CN=class{constructor(e){this.input=e,this.root=new Cu,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t=new SX;t.name=e[1].slice(1),""===t.name&&this.unnamedAtrule(t,e),this.init(t,e[2]);let n,r,i,o=!1,s=!1,a=[],l=[];for(;!this.tokenizer.endOfFile();){if("("===(n=(e=this.tokenizer.nextToken())[0])||"["===n?l.push("("===n?")":"]"):"{"===n&&l.length>0?l.push("}"):n===l[l.length-1]&&l.pop(),0===l.length){if(";"===n){t.source.end=this.getPosition(e[2]),t.source.end.offset++,this.semicolon=!0;break}if("{"===n){s=!0;break}if("}"===n){if(a.length>0){for(i=a.length-1,r=a[i];r&&"space"===r[0];)r=a[--i];r&&(t.source.end=this.getPosition(r[3]||r[2]),t.source.end.offset++)}this.end(e);break}else a.push(e)}else a.push(e);if(this.tokenizer.endOfFile()){o=!0;break}}t.raws.between=this.spacesAndCommentsFromEnd(a),a.length?(t.raws.afterName=this.spacesAndCommentsFromStart(a),this.raw(t,"params",a),o&&(e=a[a.length-1],t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++,this.spaces=t.raws.between,t.raws.between="")):(t.raws.afterName="",t.params=""),s&&(t.nodes=[],this.current=t)}checkMissedSemicolon(e){let t=this.colon(e);if(!1===t)return;let n=0,r;for(let i=t-1;i>=0&&!("space"!==(r=e[i])[0]&&2===(n+=1));i--);throw this.input.error("Missed semicolon","word"===r[0]?r[3]+1:r[2])}colon(e){let t=0,n,r;for(let[i,o]of e.entries()){if("("===(r=o[0])&&(t+=1),")"===r&&(t-=1),0===t&&":"===r){if(n){if("word"===n[0]&&"progid"===n[1])continue;return i}this.doubleColon(o)}n=o}return!1}comment(e){let t=new S$;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let n=e[1].slice(2,-2);if(/^\s*$/.test(n))t.text="",t.raws.left=n,t.raws.right="";else{let e=n.match(/^(\s*)([^]*\S)(\s*)$/);t.text=e[2],t.raws.left=e[1],t.raws.right=e[3]}}createTokenizer(){this.tokenizer=C_(this.input)}decl(e,t){let n,r=new Sq;this.init(r,e[0][2]);let i=e[e.length-1];for(";"===i[0]&&(this.semicolon=!0,e.pop()),r.source.end=this.getPosition(i[3]||i[2]||function(e){for(let t=e.length-1;t>=0;t--){let n=e[t],r=n[3]||n[2];if(r)return r}}(e)),r.source.end.offset++;"word"!==e[0][0];)1===e.length&&this.unknownWord(e),r.raws.before+=e.shift()[1];for(r.source.start=this.getPosition(e[0][2]),r.prop="";e.length;){let t=e[0][0];if(":"===t||"space"===t||"comment"===t)break;r.prop+=e.shift()[1]}for(r.raws.between="";e.length;)if(":"===(n=e.shift())[0]){r.raws.between+=n[1];break}else"word"===n[0]&&/\w/.test(n[1])&&this.unknownWord([n]),r.raws.between+=n[1];("_"===r.prop[0]||"*"===r.prop[0])&&(r.raws.before+=r.prop[0],r.prop=r.prop.slice(1));let o=[],s;for(;e.length&&!("space"!==(s=e[0][0])&&"comment"!==s);)o.push(e.shift());this.precheckMissedSemicolon(e);for(let t=e.length-1;t>=0;t--){if("!important"===(n=e[t])[1].toLowerCase()){r.important=!0;let n=this.stringFrom(e,t);" !important"!==(n=this.spacesFromEnd(e)+n)&&(r.raws.important=n);break}if("important"===n[1].toLowerCase()){let n=e.slice(0),i="";for(let e=t;e>0;e--){let t=n[e][0];if(i.trim().startsWith("!")&&"space"!==t)break;i=n.pop()[1]+i}i.trim().startsWith("!")&&(r.important=!0,r.raws.important=i,e=n)}if("space"!==n[0]&&"comment"!==n[0])break}e.some(e=>"space"!==e[0]&&"comment"!==e[0])&&(r.raws.between+=o.map(e=>e[1]).join(""),o=[]),this.raw(r,"value",o.concat(e),t),r.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new Cp;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let t=this.current.nodes[this.current.nodes.length-1];t&&"rule"===t.type&&!t.raws.ownSemicolon&&(t.raws.ownSemicolon=this.spaces,this.spaces="",t.source.end=this.getPosition(e[2]),t.source.end.offset+=t.raws.ownSemicolon.length)}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="","comment"!==e.type&&(this.semicolon=!1)}other(e){let t=!1,n=null,r=!1,i=null,o=[],s=e[1].startsWith("--"),a=[],l=e;for(;l;){if(n=l[0],a.push(l),"("===n||"["===n)i||(i=l),o.push("("===n?")":"]");else if(s&&r&&"{"===n)i||(i=l),o.push("}");else if(0===o.length){if(";"===n){if(r){this.decl(a,s);return}break}if("{"===n){this.rule(a);return}if("}"===n){this.tokenizer.back(a.pop()),t=!0;break}else":"===n&&(r=!0)}else n===o[o.length-1]&&(o.pop(),0===o.length&&(i=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),o.length>0&&this.unclosedBracket(i),t&&r){if(!s)for(;a.length&&!("space"!==(l=a[a.length-1][0])&&"comment"!==l);)this.tokenizer.back(a.pop());this.decl(a,s)}else this.unknownWord(a)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch((e=this.tokenizer.nextToken())[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e)}this.endFile()}precheckMissedSemicolon(){}raw(e,t,n,r){let i,o,s=n.length,a="",l=!0,c,h;for(let e=0;e<s;e+=1)"space"!==(o=(i=n[e])[0])||e!==s-1||r?"comment"===o?(h=n[e-1]?n[e-1][0]:"empty",c=n[e+1]?n[e+1][0]:"empty",CD[h]||CD[c]?l=!1:","===a.slice(-1)?l=!1:a+=i[1]):a+=i[1]:l=!1;if(!l){let r=n.reduce((e,t)=>e+t[1],"");e.raws[t]={raw:r,value:a}}e[t]=a}rule(e){e.pop();let t=new Cp;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,n="";for(;e.length&&!("space"!==(t=e[e.length-1][0])&&"comment"!==t);)n=e.pop()[1]+n;return n}spacesAndCommentsFromStart(e){let t,n="";for(;e.length&&!("space"!==(t=e[0][0])&&"comment"!==t);)n+=e.shift()[1];return n}spacesFromEnd(e){let t="";for(;e.length&&"space"===e[e.length-1][0];)t=e.pop()[1]+t;return t}stringFrom(e,t){let n="";for(let r=t;r<e.length;r++)n+=e[r][1];return e.splice(t,e.length-t),n}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word "+e[0][1],{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}};function CR(e,t){let n=new CN(new Ca(e,t));try{n.parse()}catch(e){throw e}return n.root}CR.default=CR,SH.registerParse(CR);let CP=class{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let e=t.node.rangeBy(t);this.line=e.start.line,this.column=e.start.column,this.endLine=e.end.line,this.endColumn=e.end.column}for(let e in t)this[e]=t[e]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};CP.default=CP;let Cj=class{get content(){return this.css}constructor(e,t,n){this.processor=e,this.messages=[],this.root=t,this.opts=n,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){t.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let n=new CP(e,t);return this.messages.push(n),n}warnings(){return this.messages.filter(e=>"warning"===e.type)}};Cj.default=Cj;let{isClean:CI,my:C$}=SD,CL={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},Cq={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},Cz={Once:!0,postcssPlugin:!0,prepare:!0};function CB(e){return"object"==typeof e&&"function"==typeof e.then}function CF(e){let t=!1,n=CL[e.type];return"decl"===e.type?t=e.prop.toLowerCase():"atrule"===e.type&&(t=e.name.toLowerCase()),t&&e.append?[n,n+"-"+t,0,n+"Exit",n+"Exit-"+t]:t?[n,n+"-"+t,n+"Exit",n+"Exit-"+t]:e.append?[n,0,n+"Exit"]:[n,n+"Exit"]}function CQ(e){return{eventIndex:0,events:"document"===e.type?["Document",0,"DocumentExit"]:"root"===e.type?["Root",0,"RootExit"]:CF(e),iterator:0,node:e,visitorIndex:0,visitors:[]}}function CV(e){return e[CI]=!1,e.nodes&&e.nodes.forEach(e=>CV(e)),e}let CW={},CU=class e{get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}constructor(t,n,r){let i;if(this.stringified=!1,this.processed=!1,"object"==typeof n&&null!==n&&("root"===n.type||"document"===n.type))i=CV(n);else if(n instanceof e||n instanceof Cj)i=CV(n.root),n.map&&(typeof r.map>"u"&&(r.map={}),r.map.inline||(r.map.inline=!1),r.map.prev=n.map);else{let e=CR;r.syntax&&(e=r.syntax.parse),r.parser&&(e=r.parser),e.parse&&(e=e.parse);try{i=e(n,r)}catch(e){this.processed=!0,this.error=e}i&&!i[C$]&&SH.rebuild(i)}this.result=new Cj(t,i,r),this.helpers={...CW,postcss:CW,result:this.result},this.plugins=this.processor.plugins.map(e=>"object"==typeof e&&e.prepare?{...e,...e.prepare(this.result)}:e)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let n=this.result.lastPlugin;try{(t&&t.addToError(e),this.error=e,"CssSyntaxError"!==e.name||e.plugin)?n.postcssVersion:(e.plugin=n.postcssPlugin,e.setMessage())}catch(e){console&&console.error&&console.error(e)}return e}prepareVisitors(){this.listeners={};let e=(e,t,n)=>{this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push([e,n])};for(let t of this.plugins)if("object"==typeof t)for(let n in t){if(!Cq[n]&&/^[A-Z]/.test(n))throw Error(`Unknown event ${n} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!Cz[n]){if("object"==typeof t[n])for(let r in t[n])e(t,"*"===r?n:n+"-"+r.toLowerCase(),t[n][r]);else"function"==typeof t[n]&&e(t,n,t[n])}}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],n=this.runOnRoot(t);if(CB(n))try{await n}catch(e){throw this.handleError(e)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[CI];){e[CI]=!0;let t=[CQ(e)];for(;t.length>0;){let e=this.visitTick(t);if(CB(e))try{await e}catch(n){let e=t[t.length-1].node;throw this.handleError(n,e)}}}if(this.listeners.OnceExit)for(let[t,n]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if("document"===e.type){let t=e.nodes.map(e=>n(e,this.helpers));await Promise.all(t)}else await n(e,this.helpers)}catch(e){throw this.handleError(e)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if("object"==typeof e&&e.Once){if("document"===this.result.root.type){let t=this.result.root.nodes.map(t=>e.Once(t,this.helpers));return CB(t[0])?Promise.all(t):t}return e.Once(this.result.root,this.helpers)}if("function"==typeof e)return e(this.result.root,this.result)}catch(e){throw this.handleError(e)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=S_;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let n=new CC(t,this.result.root,this.result.opts).generate();return this.result.css=n[0],this.result.map=n[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins)if(CB(this.runOnRoot(e)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[CI];)e[CI]=!0,this.walkSync(e);if(this.listeners.OnceExit){if("document"===e.type)for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}}return this.result}then(e,t){return this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[n,r]of e){let e;this.result.lastPlugin=n;try{e=r(t,this.helpers)}catch(e){throw this.handleError(e,t.proxyOf)}if("root"!==t.type&&"document"!==t.type&&!t.parent)return!0;if(CB(e))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:n,visitors:r}=t;if("root"!==n.type&&"document"!==n.type&&!n.parent){e.pop();return}if(r.length>0&&t.visitorIndex<r.length){let[e,i]=r[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===r.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=e;try{return i(n.toProxy(),this.helpers)}catch(e){throw this.handleError(e,n)}}if(0!==t.iterator){let r=t.iterator,i;for(;i=n.nodes[n.indexes[r]];)if(n.indexes[r]+=1,!i[CI]){i[CI]=!0,e.push(CQ(i));return}t.iterator=0,delete n.indexes[r]}let i=t.events;for(;t.eventIndex<i.length;){let e=i[t.eventIndex];if(t.eventIndex+=1,0===e){n.nodes&&n.nodes.length&&(n[CI]=!0,t.iterator=n.getIterator());return}if(this.listeners[e]){t.visitors=this.listeners[e];return}}e.pop()}walkSync(e){for(let t of(e[CI]=!0,CF(e)))if(0===t)e.nodes&&e.each(e=>{e[CI]||this.walkSync(e)});else{let n=this.listeners[t];if(n&&this.visitSync(n,e.toProxy()))return}}warnings(){return this.sync().warnings()}};CU.registerPostcss=e=>{CW=e},CU.default=CU,Cu.registerLazyResult(CU),SK.registerLazyResult(CU);let CH=class{get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){let e;if(this._root)return this._root;try{e=CR(this._css,this._opts)}catch(e){this.error=e}if(this.error)throw this.error;return this._root=e,e}get[Symbol.toStringTag](){return"NoWorkResult"}constructor(e,t,n){let r;t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=n,this._map=void 0,this.result=new Cj(this._processor,r,this._opts),this.result.css=t;let i=this;Object.defineProperty(this.result,"root",{get:()=>i.root});let o=new CC(S_,r,this._opts,t);if(o.isMap()){let[e,t]=o.generate();e&&(this.result.css=e),t&&(this.result.map=t)}else o.clearAnnotation(),this.result.css=o.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return this.async().then(e,t)}toString(){return this._css}warnings(){return[]}};CH.default=CH;let CG=class{constructor(e=[]){this.version="8.5.3",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let n of e)if(!0===n.postcss?n=n():n.postcss&&(n=n.postcss),"object"==typeof n&&Array.isArray(n.plugins))t=t.concat(n.plugins);else if("object"==typeof n&&n.postcssPlugin)t.push(n);else if("function"==typeof n)t.push(n);else if("object"==typeof n&&(n.parse||n.stringify));else throw Error(n+" is not a PostCSS plugin");return t}process(e,t={}){return this.plugins.length||t.parser||t.stringifier||t.syntax?new CU(this,e,t):new CH(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}};function CX(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),new CG(e)}CG.default=CG,Cu.registerProcessor(CG),SK.registerProcessor(CG),CX.plugin=function(e,t){let n,r=!1;function i(...n){console&&console.warn&&!r&&(r=!0,console.warn(e+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),A.env.LANG&&A.env.LANG.startsWith("cn")&&console.warn(e+`:  postcss.plugin . :
https://www.w3ctech.com/topic/2226`));let o=t(...n);return o.postcssPlugin=e,o.postcssVersion=new CG().version,o}return Object.defineProperty(i,"postcss",{get:()=>(n||(n=i()),n)}),i.process=function(e,t,n){return CX([i(n)]).process(e,t)},i},CX.stringify=S_,CX.parse=CR,CX.fromJSON=Cm,CX.list=Cd,CX.comment=e=>new S$(e),CX.atRule=e=>new SX(e),CX.decl=e=>new Sq(e),CX.rule=e=>new Cp(e),CX.root=e=>new Cu(e),CX.document=e=>new SK(e),CX.CssSyntaxError=SA,CX.Declaration=Sq,CX.Container=SH,CX.Processor=CG,CX.Document=SK,CX.Comment=S$,CX.Warning=CP,CX.AtRule=SX,CX.Result=Cj,CX.Input=Ca,CX.Rule=Cp,CX.Root=Cu,CX.Node=Sj,CU.registerPostcss(CX),CX.default=CX;let CZ=e=>{if("string"!=typeof e)throw TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},{isPlainObject:CY}=Sh,CJ=Sb,{parse:CK}=CX,C0=["img","audio","video","picture","svg","object","map","iframe","embed"],C1=["script","style"];function C2(e,t){e&&Object.keys(e).forEach(function(n){t(e[n],n)})}function C5(e,t){return({}).hasOwnProperty.call(e,t)}function C3(e,t){let n=[];return C2(e,function(e){t(e)&&n.push(e)}),n}let C4=/^[^\0\t\n\f\r /<=>]+$/;function C6(e,t,n){let r,i,o;if(null==e)return"";"number"==typeof e&&(e=e.toString());let s="",a="";function l(e,t){let n=this;this.tag=e,this.attribs=t||{},this.tagPosition=s.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(g.length){let e=g[g.length-1];e.text+=n.text}},this.updateParentNodeMediaChildren=function(){g.length&&C0.includes(this.tag)&&g[g.length-1].mediaChildren.push(this.tag)}}(t=Object.assign({},C6.defaults,t)).parser=Object.assign({},C8,t.parser);let c=function(e){return!1===t.allowedTags||(t.allowedTags||[]).indexOf(e)>-1};C1.forEach(function(e){c(e)&&!t.allowVulnerableTags&&console.warn(`

 Your \`allowedTags\` option includes, \`${e}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});let h=t.nonTextTags||["script","style","textarea","option"];t.allowedAttributes&&(r={},i={},C2(t.allowedAttributes,function(e,t){r[t]=[];let n=[];e.forEach(function(e){"string"==typeof e&&e.indexOf("*")>=0?n.push(CZ(e).replace(/\\\*/g,".*")):r[t].push(e)}),n.length&&(i[t]=RegExp("^("+n.join("|")+")$"))}));let u={},d={},f={};C2(t.allowedClasses,function(e,t){if(r&&(C5(r,t)||(r[t]=[]),r[t].push("class")),u[t]=e,Array.isArray(e)){let n=[];u[t]=[],f[t]=[],e.forEach(function(e){"string"==typeof e&&e.indexOf("*")>=0?n.push(CZ(e).replace(/\\\*/g,".*")):e instanceof RegExp?f[t].push(e):u[t].push(e)}),n.length&&(d[t]=RegExp("^("+n.join("|")+")$"))}});let p={};C2(t.transformTags,function(e,t){let n;"function"==typeof e?n=e:"string"==typeof e&&(n=C6.simpleTransform(e)),"*"===t?o=n:p[t]=n});let m,g,y,b,v,x,w=!1;O();let k=new kW.Parser({onopentag:function(e,n){let k;if(t.enforceHtmlBoundary&&"html"===e&&O(),v){x++;return}let E=new l(e,n);g.push(E);let M=!1,_=!!E.text;if(C5(p,e)&&(k=p[e](e,n),E.attribs=n=k.attribs,void 0!==k.text&&(E.innerText=k.text),e!==k.tagName&&(E.name=e=k.tagName,b[m]=k.tagName)),o&&(k=o(e,n),E.attribs=n=k.attribs,e!==k.tagName&&(E.name=e=k.tagName,b[m]=k.tagName)),(!c(e)||"recursiveEscape"===t.disallowedTagsMode&&!function(e){for(let t in e)if(C5(e,t))return!1;return!0}(y)||null!=t.nestingLimit&&m>=t.nestingLimit)&&(M=!0,y[m]=!0,("discard"===t.disallowedTagsMode||"completelyDiscard"===t.disallowedTagsMode)&&-1!==h.indexOf(e)&&(v=!0,x=1),y[m]=!0),m++,M){if("discard"===t.disallowedTagsMode||"completelyDiscard"===t.disallowedTagsMode){if(E.innerText&&!_){let n=S(E.innerText);t.textFilter?s+=t.textFilter(n,e):s+=S(E.innerText),w=!0}return}a=s,s=""}s+="<"+e,"script"===e&&(t.allowedScriptHostnames||t.allowedScriptDomains)&&(E.innerText=""),(!r||C5(r,e)||r["*"])&&C2(n,function(n,o){if(!C4.test(o)||""===n&&!t.allowedEmptyAttributes.includes(o)&&(t.nonBooleanAttributes.includes(o)||t.nonBooleanAttributes.includes("*"))){delete E.attribs[o];return}let a=!1;if(!r||C5(r,e)&&-1!==r[e].indexOf(o)||r["*"]&&-1!==r["*"].indexOf(o)||C5(i,e)&&i[e].test(o)||i["*"]&&i["*"].test(o))a=!0;else if(r&&r[e]){for(let t of r[e])if(CY(t)&&t.name&&t.name===o){a=!0;let e="";if(!0===t.multiple)for(let r of n.split(" "))-1!==t.values.indexOf(r)&&(""===e?e=r:e+=" "+r);else t.values.indexOf(n)>=0&&(e=n);n=e}}if(a){if(-1!==t.allowedSchemesAppliedToAttributes.indexOf(o)&&C(e,n)){delete E.attribs[o];return}if("script"===e&&"src"===o){let e=!0;try{let r=T(n);if(t.allowedScriptHostnames||t.allowedScriptDomains){let n=(t.allowedScriptHostnames||[]).find(function(e){return e===r.url.hostname}),i=(t.allowedScriptDomains||[]).find(function(e){return r.url.hostname===e||r.url.hostname.endsWith(`.${e}`)});e=n||i}}catch{e=!1}if(!e){delete E.attribs[o];return}}if("iframe"===e&&"src"===o){let e=!0;try{let r=T(n);if(r.isRelativeUrl)e=C5(t,"allowIframeRelativeUrls")?t.allowIframeRelativeUrls:!t.allowedIframeHostnames&&!t.allowedIframeDomains;else if(t.allowedIframeHostnames||t.allowedIframeDomains){let n=(t.allowedIframeHostnames||[]).find(function(e){return e===r.url.hostname}),i=(t.allowedIframeDomains||[]).find(function(e){return r.url.hostname===e||r.url.hostname.endsWith(`.${e}`)});e=n||i}}catch{e=!1}if(!e){delete E.attribs[o];return}}if("srcset"===o)try{let e=Sx(n);if(e.forEach(function(e){C("srcset",e.url)&&(e.evil=!0)}),(e=C3(e,function(e){return!e.evil})).length)n=C3(e,function(e){return!e.evil}).map(function(e){if(!e.url)throw Error("URL missing");return e.url+(e.w?` ${e.w}w`:"")+(e.h?` ${e.h}h`:"")+(e.d?` ${e.d}x`:"")}).join(", "),E.attribs[o]=n;else{delete E.attribs[o];return}}catch{delete E.attribs[o];return}if("class"===o){let t=u[e],r=u["*"],i=d[e],s=f[e],a=f["*"],l=[i,d["*"]].concat(s,a).filter(function(e){return e});if(!(n=t&&r?A(n,CJ(t,r),l):A(n,t||r,l)).length){delete E.attribs[o];return}}if("style"===o){if(t.parseStyleAttributes)try{let r=CK(e+" {"+n+"}",{map:!1});if(n=(function(e,t){let n;if(!t)return e;let r=e.nodes[0];return(n=t[r.selector]&&t["*"]?CJ(t[r.selector],t["*"]):t[r.selector]||t["*"])&&(e.nodes[0].nodes=r.nodes.reduce(function(e,t){return C5(n,t.prop)&&n[t.prop].some(function(e){return e.test(t.value)})&&e.push(t),e},[])),e})(r,t.allowedStyles).nodes[0].nodes.reduce(function(e,t){return e.push(`${t.prop}:${t.value}${t.important?" !important":""}`),e},[]).join(";"),0===n.length){delete E.attribs[o];return}}catch{"u">typeof window&&console.warn('Failed to parse "'+e+" {"+n+"}\", If you're running this in a browser, we recommend to disable style parsing: options.parseStyleAttributes: false, since this only works in a node environment due to a postcss dependency, More info: https://github.com/apostrophecms/sanitize-html/issues/547"),delete E.attribs[o];return}else if(t.allowedStyles)throw Error("allowedStyles option cannot be used together with parseStyleAttributes: false.")}s+=" "+o,n&&n.length?s+='="'+S(n,!0)+'"':t.allowedEmptyAttributes.includes(o)&&(s+='=""')}else delete E.attribs[o]}),-1!==t.selfClosing.indexOf(e)?s+=" />":(s+=">",!E.innerText||_||t.textFilter||(s+=S(E.innerText),w=!0)),M&&(s=a+S(s),a="")},ontext:function(e){let n;if(v)return;let r=g[g.length-1];if(r&&(n=r.tag,e=void 0!==r.innerText?r.innerText:e),"completelyDiscard"!==t.disallowedTagsMode||c(n)){if(("discard"===t.disallowedTagsMode||"completelyDiscard"===t.disallowedTagsMode)&&("script"===n||"style"===n))s+=e;else{let r=S(e,!1);t.textFilter&&!w?s+=t.textFilter(r,n):w||(s+=r)}}else e="";if(g.length){let t=g[g.length-1];t.text+=e}},onclosetag:function(e,n){if(v){if(--x)return;v=!1}let r=g.pop();if(!r)return;if(r.tag!==e){g.push(r);return}v=!!t.enforceHtmlBoundary&&"html"===e;let i=y[--m];if(i){if(delete y[m],"discard"===t.disallowedTagsMode||"completelyDiscard"===t.disallowedTagsMode){r.updateParentNodeText();return}a=s,s=""}if(b[m]&&(e=b[m],delete b[m]),t.exclusiveFilter&&t.exclusiveFilter(r)){s=s.substr(0,r.tagPosition);return}if(r.updateParentNodeMediaChildren(),r.updateParentNodeText(),-1!==t.selfClosing.indexOf(e)||n&&!c(e)&&["escape","recursiveEscape"].indexOf(t.disallowedTagsMode)>=0){i&&(s=a,a="");return}s+="</"+e+">",i&&(s=a+S(s),a=""),w=!1}},t.parser);return k.write(e),k.end(),s;function O(){s="",m=0,g=[],y={},b={},v=!1,x=0}function S(e,n){return"string"!=typeof e&&(e+=""),t.parser.decodeEntities&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n&&(e=e.replace(/"/g,"&quot;"))),e=e.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n&&(e=e.replace(/"/g,"&quot;")),e}function C(e,n){for(n=n.replace(/[\x00-\x20]+/g,"");;){let e=n.indexOf("\x3c!--");if(-1===e)break;let t=n.indexOf("--\x3e",e+4);if(-1===t)break;n=n.substring(0,e)+n.substring(t+3)}let r=n.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!r)return!!n.match(/^[/\\]{2}/)&&!t.allowProtocolRelative;let i=r[1].toLowerCase();return C5(t.allowedSchemesByTag,e)?-1===t.allowedSchemesByTag[e].indexOf(i):!t.allowedSchemes||-1===t.allowedSchemes.indexOf(i)}function T(e){if((e=e.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//")).startsWith("relative:"))throw Error("relative: exploit attempt");let t="relative://relative-site";for(let e=0;e<100;e++)t+=`/${e}`;let n=new URL(e,t);return{isRelativeUrl:n&&"relative-site"===n.hostname&&"relative:"===n.protocol,url:n}}function A(e,t,n){return t?(e=e.split(/\s+/)).filter(function(e){return -1!==t.indexOf(e)||n.some(function(t){return t.test(e)})}).join(" "):e}}let C8={decodeEntities:!0};C6.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],nonBooleanAttributes:["abbr","accept","accept-charset","accesskey","action","allow","alt","as","autocapitalize","autocomplete","blocking","charset","cite","class","color","cols","colspan","content","contenteditable","coords","crossorigin","data","datetime","decoding","dir","dirname","download","draggable","enctype","enterkeyhint","fetchpriority","for","form","formaction","formenctype","formmethod","formtarget","headers","height","hidden","high","href","hreflang","http-equiv","id","imagesizes","imagesrcset","inputmode","integrity","is","itemid","itemprop","itemref","itemtype","kind","label","lang","list","loading","low","max","maxlength","media","method","min","minlength","name","nonce","optimum","pattern","ping","placeholder","popover","popovertarget","popovertargetaction","poster","preload","referrerpolicy","rel","rows","rowspan","sandbox","scope","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","width","wrap","onauxclick","onafterprint","onbeforematch","onbeforeprint","onbeforeunload","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformdata","onhashchange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onlanguagechange","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmessageerror","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onoffline","ononline","onpagehide","onpageshow","onpaste","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreset","onresize","onrejectionhandled","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onslotchange","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","ontoggle","onunhandledrejection","onunload","onvolumechange","onwaiting","onwheel"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},allowedEmptyAttributes:["alt"],selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1,parseStyleAttributes:!0},C6.simpleTransform=function(e,t,n){return n=void 0===n||n,t=t||{},function(r,i){let o;if(n)for(o in t)i[o]=t[o];else i=t;return{tagName:e,attribs:i}}};let C9=(0,S.a3)(C6);function C7(){return{reportId:"",status:"blank",loading:!1,mode:"query-data",userQuestion:"",useWebsearch:!0,uploadedFiles:[]}}let Te={blank:"Add a spreadsheet or select a database, and start asking your questions!",getting_clarifications:"Analyzing database and thinking if I need to ask clarifying questions. This can take 15-20 seconds...",clarifications_received:"Please answer these clarifying questions...",submitting:"Submitting for generation..."};function Tt(){let e=C7(),t=[];function n(n){e="function"==typeof n?n(e):n,t.forEach(e=>e())}return{getDraft:function(){return e},setDraft:n,resetDraft:function(){n(C7())},subscribeToDraftChanges:function(e){return t.push(e),function(){t=t.filter(t=>t!==e)}},setMode:function(e){n(t=>({...t,mode:e}))},setReportId:function(t){n({...e,reportId:t})},setStatus:function(t){n({...e,status:t})},setQuestion:function(t){n({...e,userQuestion:t})}}}let Tn=(0,C.createContext)({apiEndpoint:"",token:"",searchBarManager:Tt()});function Tr(e={},t=crypto.randomUUID()){let n=!function(e){if(!e||"object"!=typeof e)return!1;for(let t in e){if("string"!=typeof t)return!1;let n=e[t];if(!n||"object"!=typeof n||!n.root||!n.analysisList||"object"!=typeof n.root||!Array.isArray(n.analysisList)||!Ti(n.root)||!n.analysisList.length||n.analysisList[0].analysisId!==n.root.analysisId||t!==n.root.analysisId)return!1;for(let e of n.analysisList)if(!Ti(e)||e.rootAnalysisId!==n.root.analysisId)return!1}return!0}(e)?{}:e,r={},i=Object.values(n).reduce((e,t)=>({...e,[t.root.analysisId]:t.root,...t.analysisList.reduce((e,t)=>({...e,[t.analysisId]:t}),{})}),{}),o=[],s=[],a={},l=null,c=null;function h(e,t){n=e,i=t,o.forEach(e=>e())}function u(){s.forEach(e=>e())}function d(e,t){r[e]=t,a[e]||(a[e]=[]),a[e].forEach(e=>{try{e()}catch(e){console.error("Error in active tab listener",e)}})}async function f({question:e,projectName:t,analysisId:r,rootAnalysisId:o,isRoot:s=!1,directParentId:a=null,sqlOnly:l=!1,isTemp:c=!1,activeTab:u}){let f={analysisId:r,isRoot:s,rootAnalysisId:s?r:o,user_question:e,isTemp:c,projectName:t,sqlOnly:l,timestamp:Date.now(),activeTab:u};f.directParentId=a,f.createAnalysisRequestBody={initialisation_details:{user_question:e,is_root_analysis:s,root_analysis_id:o,direct_parent_id:a},sql_only:l};let p={...n};s?p[f.analysisId]={root:f,analysisList:[f]}:p[n[o].root.analysisId].analysisList.push(f);let m={...i,[f.analysisId]:f};return d(f.analysisId,u||"table"),h(p,m),{newAnalysis:f}}return{subscribeToDataChanges:function(e){return o=[...o,e],function(){o=o.filter(t=>t!==e)}},getTree:function(){return n},getNestedTree:function(){let e={};for(let t in Object.keys(i).forEach(t=>{e[t]={...i[t],children:[],parent:null,flatOrderedChildren:[],allParents:[]}}),Object.keys(e).forEach(t=>{if(e[t].directParentId){let n=e[e[t].directParentId];n&&(e[t].parent=n,e[t].allParents=function(e){let t=[],n=e;for(;n;)t.push(n),n=n.parent;return t}(n),n.children.push(e[t]),n.children.sort((e,t)=>t.timestamp-e.timestamp))}}),e)e[t].isRoot?e[t].flatOrderedChildren=function e(t){var n;let r=[];if(null!=(n=null==t?void 0:t.children)&&n.length)for(let n of t.children)r.push(n),r.push(...e(n));return r}(e[t]):delete e[t];return e},getAll:function(){return i},subscribeToActiveAnalysisIdChanges:function(e){return s.push(e),function(){s=s.filter(t=>t!==e)}},getActiveTab:function(e){return r[e]||"table"},setActiveTab:d,subscribeToActiveTabChanges:function(e,t){return e?(a[e]&&Array.isArray(a[e])||(a[e]=[]),a[e].push(t),function(){e&&a[e]&&(a[e]=a[e].filter(e=>e!==t))}):()=>{}},setActiveAnalysisId:function(e){l=e,u()},setActiveRootAnalysisId:function(e){c=e,u()},getActiveAnalysisId:function(){return l},getActiveRootAnalysisId:function(){return c},submit:f,removeAnalysis:function({analysisId:e,isRoot:t,rootAnalysisId:r}){let o={...n};t?delete o[e]:r&&n[r].root&&(o[r].analysisList=o[r].analysisList.filter(t=>t.analysisId!==e));let s={...i};delete s[e],h(o,s)},updateAnalysis:function({analysisId:e,isRoot:t,updateObj:r,emit:o=!0}){let s={...n};if(!i[e]){console.warn("Analysis not found",e);return}t&&(s[e].root={...s[e].root,...r});let a=i[e].rootAnalysisId;s[a].analysisList=s[a].analysisList.map(t=>t.analysisId===e?{...t,...r}:t);let l={...i};l[e]={...l[e],...r},h(s,l)},getMgrId:()=>t,reset:function(){h({},{})}}}function Ti(e){return!(!e||"object"!=typeof e||!e.analysisId||"string"!=typeof e.analysisId||!e.createAnalysisRequestBody||"object"!=typeof e.createAnalysisRequestBody||"string"!=typeof e.directParentId&&null!==e.directParentId||"boolean"!=typeof e.isRoot||"boolean"!=typeof e.isTemp||"string"!=typeof e.projectName||"string"!=typeof e.rootAnalysisId||"boolean"!=typeof e.sqlOnly||"string"!=typeof e.user_question)}function To(e){if(!e||!Array.isArray(e)||0===e.length)return{};let t={},n={},r={};return e.forEach(e=>{var i,o;n[e.analysis_id]=e;let s={analysisId:e.analysis_id,createAnalysisRequestBody:{initialisation_details:{user_question:e.user_question,is_root_analysis:!!e.is_root_analysis,root_analysis_id:e.root_analysis_id,direct_parent_id:e.direct_parent_id},sql_only:(null==(i=e.data)?void 0:i.tool_name)==="sql_aggregator"},directParentId:e.direct_parent_id||null,timestamp:new Date(e.timestamp).getTime(),isRoot:!!e.is_root_analysis,isTemp:!1,projectName:e.db_name,rootAnalysisId:e.is_root_analysis?e.analysis_id:e.root_analysis_id,sqlOnly:(null==(o=e.data)?void 0:o.tool_name)==="sql_aggregator",user_question:e.user_question||"",activeTab:"table",analysisManager:void 0};s.isRoot&&(r[s.analysisId]=s,t[s.analysisId]={root:s,analysisList:[s]})}),e.forEach(e=>{var n,r;if(!e.is_root_analysis&&e.root_analysis_id){let i={analysisId:e.analysis_id,createAnalysisRequestBody:{initialisation_details:{user_question:e.user_question,is_root_analysis:!1,root_analysis_id:e.root_analysis_id,direct_parent_id:e.direct_parent_id},sql_only:(null==(n=e.data)?void 0:n.tool_name)==="sql_aggregator"},directParentId:e.direct_parent_id||null,timestamp:new Date(e.timestamp).getTime(),isRoot:!1,isTemp:!1,projectName:e.db_name,rootAnalysisId:e.root_analysis_id,sqlOnly:(null==(r=e.data)?void 0:r.tool_name)==="sql_aggregator",user_question:e.user_question||"",activeTab:"table",analysisManager:void 0};t[e.root_analysis_id]&&t[e.root_analysis_id].analysisList.push(i)}}),Object.keys(t).forEach(e=>{t[e].analysisList.sort((e,t)=>e.timestamp-t.timestamp)}),t}let Ts=({type:e=null,message:t=null,svg:n=null,children:r=null,classNames:i})=>S.j.jsxs("div",{className:(0,S.t)("agent-loader",i),children:[n&&n,S.j.jsxs("div",{className:"w-full h-40 flex text-sm flex-col items-center justify-center dark:text-gray-300",children:[t,S.j.jsx(S.d,{classNames:"text-gray-400 dark:text-gray-500 mt-3 mx-0"})]}),"error"===e&&S.j.jsx("h2",{children:"ERROR"}),r&&S.j.jsx("div",{className:"searchState-child",children:r})]});function Ta({questions:e,handleSubmit:t,globalLoading:n}){let r=(0,C.useRef)(e);return e?S.j.jsx("div",{className:"p-6 bg-transparent",children:S.j.jsxs("div",{className:"mb-4 text-sm text-gray-500 dark:text-gray-400",onKeyDown:e=>{"Enter"===e.key&&t({clarification_questions:r.current},"clarify")},children:[e.length?e.map((e,t)=>S.j.jsx("div",{className:"w-full",children:S.j.jsxs("div",{children:[S.j.jsx("p",{className:"q-desc m-0 mb-2 text-primary-text dark:text-gray-200",children:e.question}),S.j.jsx("div",{className:"w-full mb-4 min-w-64",children:S.j.jsx(S.a4,{onChange:e=>{r.current[t].response=e.target.value},defaultValue:e.response,placeholder:"Your response. Leave blank if the question above is not relevant",inputClassNames:"ring-0 bg-transparent rounded-none border-b border-dotted border-gray-300 dark:border-gray-600 focus:border-blue-500 focus:border-solid focus:ring-0 focus:border-b-primary-highlight shadow-none pl-0 w-full dark:text-gray-200"})})]})},e.question)):null,S.j.jsx("button",{className:"underline text-gray-400 dark:text-gray-500 text-sm mt-4 cursor-pointer hover:text-gray-600 dark:hover:text-gray-300",onClick:()=>t({clarification_questions:r.current},"clarify"),disabled:n,children:"Click here or press enter to submit"})]})}):S.j.jsx("div",{className:"agent-error",children:"Something went wrong, please retry or contact us if it fails again."})}let Tl={apiEndpoint:"https://demo.defog.ai",hiddenCharts:[],hideSqlTab:!1,hidePreviewTabs:!1,token:null,hideRawAnalysis:!0,analysisDataCache:{},updateConfig:()=>{}};function Tc(e={}){let t=Object.assign({},Tl);return Object.keys(e).forEach(n=>{void 0!==e[n]&&(t[n]=e[n])}),t}let Th=(0,C.createContext)(Object.assign({},Tl)),Tu={config:{selectedChart:"bar",separator:"%%%%^^^%%%%",selectedColumns:{x:null,y:null,facet:null,fill:null,stroke:null,filter:null},chartStyle:{title:"",fontSize:12,backgroundColor:"transparent",xLabel:null,yLabel:null,xGrid:!1,yGrid:!0,xTicks:10,dateFormat:"%b %-d, %Y",yTicks:10,selectedScheme:"Tableau10",yAxisUnitLabel:""},chartSpecificOptions:{line:{lineWidth:3,curve:"linear",marker:!1,filter:null,groupBy:"",stroke:"",lineOptions:{},showLabels:!1,aggregateFunction:"sum",colorBy:null,colorByIsDate:!1},bar:{barWidth:.8,aggregateFunction:"sum",fill:null,barOptions:{},colorBy:null,colorByIsDate:!1},scatter:{pointColor:"#f54242",pointSize:3}},loading:!1,data:[],availableColumns:[]},mergeConfigUpdates:function(e){return(e.selectedChart?"line"===e.selectedChart||"bar"===e.selectedChart:"line"===this.config.selectedChart||"bar"===this.config.selectedChart)?e.selectedColumns&&e.selectedColumns.y&&(Array.isArray(e.selectedColumns.y)||(e.selectedColumns.y=[e.selectedColumns.y])):e.selectedColumns&&e.selectedColumns.y&&Array.isArray(e.selectedColumns.y)&&e.selectedColumns.y.length>0&&(e.selectedColumns.y=e.selectedColumns.y[0]),e.selectedColumns&&this.setSelectedColumns(e.selectedColumns),this.config=function e(t,n){let r={...t};for(let i in n)"object"!=typeof n[i]||null===n[i]||Array.isArray(n[i])||void 0===t[i]?Array.isArray(n[i])?r[i]=n[i].slice():r[i]=n[i]:r[i]=e(t[i],n[i]);return r}(JSON.parse(JSON.stringify(this.config)),e),this},setConfigCallback:()=>{},clone:function(e=[]){let t={};for(let n in this.config)"function"!=typeof this.config[n]&&-1===e.indexOf(n)&&(t[n]=this.config[n]);return t},render:function(){this.setConfigCallback(this.config)},setSelectedChart:function(e){return this.config={...this.config,selectedChart:e,selectedColumns:{x:null,y:"line"===e||"bar"===e?[]:null},chartStyle:{...Tu.config.chartStyle,xLabel:null,yLabel:null}},this},setSelectedColumns:function(e){let t,n;return e.x&&Array.isArray(e.x)&&(t=e.x,n=e.x.join(this.config.separator),e.x.length>1&&this.config.data.forEach(e=>(e[n]=t.map(t=>e[t]??"").join("-"),e)),e.x=n),this.config={...this.config,selectedColumns:{...this.config.selectedColumns,...e}},this},updateChartStyle:function(e){return this.config={...this.config,chartStyle:{...this.config.chartStyle,...e}},this},updateChartSpecificOptions:function(e){return this.config={...this.config,chartSpecificOptions:{...this.config.chartSpecificOptions,[this.config.selectedChart]:{...this.config.chartSpecificOptions[this.config.selectedChart],...e}}},this},setData:function(e){return this.config.data=e,this},setAvailableColumns:function(e){return this.config.availableColumns=e,this},autoSelectVariables:function(){var e,t,n,r,i,o;let{selectedChart:s,availableColumns:a}=this.config,l=a.find(e=>e.isDate),c=a.filter(e=>"quantitative"===e.variableType),h=a.filter(e=>"quantitative"!==e.variableType&&!e.isDate),u=(null==(e=c[0])?void 0:e.key)||(null==(t=h[0])?void 0:t.key)||(null==(n=a[0])?void 0:n.key)||null,d=a.filter(e=>e.key!==u),f=d.filter(e=>"quantitative"!==e.variableType),p=d.filter(e=>"quantitative"===e.variableType),m=(null==l?void 0:l.key)||(null==(r=p[0])?void 0:r.key)||(null==(i=f[0])?void 0:i.key)||(null==(o=a[0])?void 0:o.key)||null;return this.config={...this.config,loading:!1,selectedColumns:{x:m,y:null===u?null:"line"===s||"bar"==s?[u]:u}},this},editChart:async function(e,t,n,r){var i;try{this.mergeConfigUpdates({loading:!0}).render();let r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,user_request:t,current_chart_state:this.clone(["data","availableColumns"]),columns:this.config.availableColumns.map(e=>({title:e.title,col_type:e.colType}))})}),i=await r.json();if(!r.ok||i.error||!i.success)throw Error(i.error||"Failed to edit chart");let o=i.chart_state_edits;this.mergeConfigUpdates({...o,loading:!1}).render()}catch(e){throw this.mergeConfigUpdates({loading:!1}).render(),null==(i=null==r?void 0:r.onError)||i.call(r,e),e}}};function Td(e={},t=()=>{}){let n=Object.assign({},Tu);for(let t in e)void 0!==e[t]&&(n.config[t]=e[t]);return{...n,config:n.config,setConfigCallback:t}}let Tf=(0,C.createContext)(Td()),Tp={line:["date","quantitative","categorical"],bar:["categorical","quantitative","date"],scatter:["quantitative","date","categorical"]},Tm=e=>e.isDate?"date":e.variableType,Tg=(e,t)=>{let n=Tp[t],r=Tm(e),i=n.indexOf(r);return -1===i?n.length:i},Ty=(e,t)=>[...e].sort((e,n)=>Tg(e,t)-Tg(n,t)),Tb=[{value:"line",label:"Line",Icon:$},{value:"bar",label:"Bar",Icon:I},{value:"scatter",label:"Scatter",Icon:q}];function Tv({selectedChart:e,onChartChange:t,hiddenCharts:n=[]}){let r=Tb.filter(e=>!n.includes(e.value));return S.j.jsxs("div",{children:[S.j.jsx("h3",{className:"mb-2 font-bold input-label",children:"Chart Type"}),S.j.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(({value:n,label:r,Icon:i})=>S.j.jsxs("button",{onClick:()=>t(n),className:`
                dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 
                hover:text-gray-800 dark:hover:text-gray-100 active:text-gray-800 dark:active:text-gray-100 
                agui-item agui-btn flex-row gap-1 active:brightness-[90%] p-2 rounded-sm min-w-20 border-[1px] 
                flex items-center justify-center font-semibold transition-colors duration-200 text-[11px] 
                font-sans ease-in-out
                ${e===n?"bg-blue-500/95 text-white border-0 shadow-sm hover:bg-blue-600":" bg-blue-100 text-blue-600/50 border-blue-200 hover:bg-blue-300"}
              `,children:[S.j.jsx(i,{size:16}),S.j.jsx("span",{children:r})]},n))})]})}function Tx({axis:e,columns:t,selectedValue:n,onAxisChange:r}){let i=t=>{if(document.activeElement===document.body&&!t.metaKey&&!t.ctrlKey&&!t.altKey&&!t.shiftKey){if("x"===e&&(0,S.a5)(t.key,S.a.SET_X_AXIS)){t.preventDefault();let e=document.querySelector('div[data-axis="x"] input');null==e||e.focus()}if("y"===e&&(0,S.a5)(t.key,S.a.SET_Y_AXIS)){t.preventDefault();let e=document.querySelector('div[data-axis="y"] input');null==e||e.focus()}}};return(0,C.useEffect)(()=>(window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)),[e]),S.j.jsx("div",{"data-axis":e,className:"dark:text-gray-200",children:S.j.jsx(S.f,{style:{width:"100%",minWidth:"100px"},value:Array.isArray(n)?n:(null==n?void 0:n.split("%%%%^^^%%%%"))??[],onChange:r,placeholder:`Select ${e.toUpperCase()} axis`,options:Array.isArray(t)?t.map(e=>({label:e.title,value:e.key})):null})})}let Tw=[{value:"count",label:"Count"},{value:"sum",label:"Sum"},{value:"mean",label:"Mean"}];function Tk({selectedChart:e,aggregateFunction:t,onAggregateChange:n,rootClassNames:r=""}){let i=Tw.filter(t=>"none"!==t.value||"line"!==e);return S.j.jsx(S.j.Fragment,{children:S.j.jsx("div",{className:"dark:text-gray-200",children:S.j.jsx(S.g,{allowClear:!1,rootClassNames:(0,S.t)("w-24",r),value:t||"sum",onChange:n,options:i.map(e=>({value:e.value,label:e.label}))})})})}let TO=({columns:e})=>{let[t,n]=(0,C.useState)([]),r=(0,C.useContext)(Tf),i=(0,C.useRef)(null),o=(0,C.useCallback)(t=>{let n=t.length?n=>t.every(({column:t,operator:r,value:i,isValid:o})=>{if(!o||!t||!r||""===i)return!0;let s=e.find(e=>e.dataIndex===t),a=n[t];return({"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,">":(e,t)=>e>t,"<":(e,t)=>e<t,">=":(e,t)=>e>=t,"<=":(e,t)=>e<=t,in:(e,t)=>t.split(",").map(e=>e.trim().toLowerCase()).includes(e),"not in":(e,t)=>!t.split(",").map(e=>e.trim().toLowerCase()).includes(e),contains:(e,t)=>e.includes(t),"starts with":(e,t)=>e.startsWith(t),"ends with":(e,t)=>e.endsWith(t),between:(e,t)=>{let[n,r]=t.split(",").map(Number);return e>=n&&e<=r}})[r]("categorical"===s.variableType&&"string"==typeof a?a.toLowerCase():a,"categorical"===s.variableType&&"string"==typeof i?i.toLowerCase():i)}):null;r.updateChartSpecificOptions({filter:n}).render()},[r.config,e]),s=(0,C.useCallback)((...e)=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>o(...e),200)},[o]);(0,C.useEffect)(()=>{let e=Object.values(r.config.selectedColumns||{}).flat(),i=t.map(t=>({...t,isValid:t.column&&(e.includes(t.column)||""===t.column)}));JSON.stringify(i)!==JSON.stringify(t)&&(n(i),s(i))},[r.config.selectedColumns,t,s]);let a=e=>{let r=t.filter((t,n)=>n!==e);n(r),o(r)},l=(r,i,a)=>{let l=[...t];if("column"===i){let t=e.find(e=>e.dataIndex===a);l[r][i]=t?a:""}else l[r][i]=a;n(l),"column"===i||"operator"===i?o(l):s(l)},c=e=>{let t=["==","!="];return"categorical"===e.variableType?[...t,"in","not in","contains","starts with","ends with"]:"quantitative"===e.variableType||"integer"===e.variableType?[...t,">","<",">=","<=","between"]:t},h={quantitative:Q,categorical:P},u=e=>{let t=h[e.variableType];return{label:S.j.jsxs("div",{className:"flex items-center gap-2",children:[t&&S.j.jsx(t,{className:"opacity-50",size:14}),S.j.jsx("span",{children:e.title})]}),value:e.dataIndex}},d=(e,t,n)=>{let r={className:"w-full",placeholder:"Value",value:e.value,onChange:e=>l(t,"value",e.target.value)};if("between"===e.operator){let[n,i]=e.value.split(",");return S.j.jsxs("div",{className:"flex gap-2",children:[S.j.jsx(S.e,{...r,type:"number",className:"w-1/2",placeholder:"From",value:n||"",onChange:e=>l(t,"value",`${e.target.value},${i||""}`)}),S.j.jsx(S.e,{...r,type:"number",className:"w-1/2",placeholder:"To",value:i||"",onChange:e=>l(t,"value",`${n||""},${e.target.value}`)})]})}return S.j.jsx(S.e,{...r,size:"small",autoResize:"quantitative"!==n.variableType,type:"quantitative"===n.variableType?"number":"text",placeholder:["in","not in"].includes(e.operator)?"Comma-separated values":"Value"})};return S.j.jsxs("div",{className:"space-y-4",children:[S.j.jsxs("div",{className:"space-y-1.5",children:[S.j.jsx("label",{className:"flex items-center gap-2 text-xs font-medium text-gray-700",children:S.j.jsx("span",{className:"flex items-center gap-2",children:"Filters"})}),S.j.jsx("p",{className:"text-xs text-gray-500",children:"Filter data based on selected columns"})]}),S.j.jsx("div",{className:"space-y-2",children:t.map((t,n)=>{let r=e.find(e=>e.dataIndex===t.column),i=r?h[r.variableType]:null;return S.j.jsxs("div",{className:"p-2 space-y-2 border border-gray-200 rounded-md bg-gray-50",children:[S.j.jsxs("div",{className:"flex items-center justify-between",children:[S.j.jsxs("div",{className:"flex items-center gap-2",children:[i&&S.j.jsx(i,{className:"text-gray-400",size:13}),S.j.jsxs("span",{className:"text-xs font-medium text-gray-700",children:["Filter ",n+1]})]}),S.j.jsx(S.B,{variant:"ghost",size:"xs",icon:S.j.jsx(J,{className:"w-3 h-3"}),onClick:()=>a(n)})]}),S.j.jsxs("div",{className:"space-y-2",children:[S.j.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.j.jsx(S.g,{value:t.column,onChange:e=>l(n,"column",e),placeholder:"Select column",options:e.filter(e=>e.dataIndex===t.column||"date"!==e.colType).map(u),allowClear:!0}),S.j.jsx(S.g,{value:t.operator,disabled:!t.isValid||!t.column,onChange:e=>l(n,"operator",e),placeholder:"Select operator",options:r?c(r).map(e=>({label:e,value:e})):[]})]}),r&&d(t,n,r)]}),!t.isValid&&S.j.jsx("div",{className:"text-xs text-red-500",children:"Filter may be outdated and not apply to the chart."})]},n)})}),S.j.jsx(S.B,{onClick:()=>{n([...t,{column:"",operator:"==",value:"",isValid:!0}])},type:"default",className:"flex items-center justify-center w-full gap-2 mt-4 text-sm font-medium text-gray-700 border-gray-200 h-9 bg-gray-50 hover:bg-gray-100",icon:S.j.jsx(B,{className:"w-4 h-4"}),children:"Add Filter"})]})},TS={date:R,quantitative:Q,categorical:P};function TC({columns:e,showChartTypeOnly:t=!1}){let n=(0,C.useContext)(Tf),{selectedChart:r,selectedColumns:i,chartSpecificOptions:o}=n.config,[s,a]=(0,C.useState)(e),{hiddenCharts:l=[]}=(0,C.useContext)(Th),[c,h]=(0,C.useState)(!1);(0,C.useEffect)(()=>{n.setAvailableColumns(e).render(),a(Ty(e,r))},[e,r]);let u=(0,C.useCallback)(t=>o=>{if(n.setSelectedColumns({...i,[t]:o}),("bar"===r||"line"==r)&&"y"===t){let t=e.find(e=>e.key===o);t&&"categorical"===t.variableType?n.updateChartSpecificOptions({useCount:!0}):n.updateChartSpecificOptions({useCount:!1})}"y"===t&&n.updateChartSpecificOptions({colorBy:null,colorByIsDate:!1}),n.render()},[n,i,r,e]),d=({key:e,isDate:t,variableType:n})=>{let r=TS[t?"date":n];return{label:S.j.jsxs("span",{children:[r&&S.j.jsx(S.j.Fragment,{children:S.j.jsx(r,{className:"inline-block mr-1 text-gray-400",size:13})}),e]}),value:e}};return t?S.j.jsx("div",{className:"flex mr-4 gap-1.5",children:S.j.jsx(Tv,{selectedChart:r,onChartChange:e=>{n.setSelectedChart(e).updateChartStyle({xLabel:null,yLabel:null}).autoSelectVariables().render()},hiddenCharts:l})}):S.j.jsxs("div",{className:"grid grid-rows-[auto_1fr_auto] max-h-[550px] overflow-y-auto h-full",children:[S.j.jsxs("div",{className:"space-y-6",children:[S.j.jsxs("div",{className:"space-y-4",children:[S.j.jsxs("div",{className:"space-y-1.5",children:[S.j.jsxs("div",{className:"flex items-center justify-between",children:[S.j.jsxs("label",{className:"flex items-center gap-2 text-xs font-medium text-gray-700 dark:text-gray-300",children:[S.j.jsx(S.K,{keyValue:S.a.SET_X_AXIS,className:"px-1 py-0.5 text-xs font-bold text-gray-500"}),S.j.jsx("span",{className:"flex items-center gap-2",children:"Horizontal Axis"})]}),S.j.jsx(Tk,{selectedChart:r,aggregateFunction:o[r].aggregateFunction||"sum",onAggregateChange:t=>{let s=null,a=!1;"bar"===r&&"none"===t&&e.length>0&&i.y.length<=1?(s=o[r].colorBy||e[0].dataIndex,a=e.find(e=>e.key===s).isDate):(s=null,a=!1),n.updateChartSpecificOptions({aggregateFunction:t||"sum",colorBy:s,colorByIsDate:a}).render()},className:"w-12"})]}),S.j.jsx(Tx,{axis:"x",columns:s,selectedValue:i.x,onAxisChange:u("x")})]}),S.j.jsxs("div",{className:"space-y-1.5",children:[S.j.jsxs("label",{className:"flex items-center gap-2 text-xs font-medium text-gray-700 dark:text-gray-300",children:[S.j.jsx(S.K,{keyValue:S.a.SET_Y_AXIS,className:"px-1 py-0.5 text-xs font-bold text-gray-500"}),S.j.jsx("span",{className:"flex items-center gap-2",children:"Vertical Axis"})]}),S.j.jsx(Tx,{axis:"y",columns:s,selectedValue:i.y,onAxisChange:u("y")})]})]}),"bar"!==r&&S.j.jsx("div",{className:"pt-4 space-y-2 border-t border-gray-100 dark:border-gray-700",children:S.j.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.j.jsxs("div",{className:"space-y-1.5",children:[S.j.jsx("h3",{className:"mb-2 font-medium input-label dark:text-gray-300",children:"Facet by"}),S.j.jsx(S.g,{style:{width:"100%"},placeholder:"Select Facet Column",onChange:e=>u("facet")(e),value:i.facet,allowClear:!0,options:s.map(d)})]}),S.j.jsxs("div",{className:"space-y-1.5",children:[S.j.jsx("h3",{className:"mb-2 font-medium input-label dark:text-gray-300",children:"Color By"}),S.j.jsx(S.g,{placeholder:"Color Column",value:i.fill,style:{width:"100%"},onChange:t=>{let r=(e.find(e=>e.key===t)||{}).isDate||!1;n.updateChartSpecificOptions({colorBy:t,colorByIsDate:r}).render()},disabled:i.y.length>1&&"line"===r,allowClear:!0,options:s.map(d)})]})]})})]}),S.j.jsxs(S.B,{block:!0,type:"default",onClick:()=>h(!c),className:"flex items-center justify-center gap-2 mt-4 text-sm font-medium text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700 h-9 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700",children:[S.j.jsx(U,{className:"w-4 h-4"}),"Advanced Options"]}),c&&S.j.jsx("div",{className:"pt-4 mt-4 border-t border-gray-100 dark:border-gray-700",children:S.j.jsx(TO,{columns:e})})]})}let TT=()=>{let e=(0,C.useContext)(Tf),{selectedColumns:t,chartSpecificOptions:n}=e.config,r=(t,n)=>{e.updateChartSpecificOptions({[t]:n}).render()},i=(t,r,i)=>{let o={...n.line.lineOptions||{}};o[t]={...o[t],[r]:i},e.updateChartSpecificOptions({lineOptions:o}).render()};return S.j.jsxs("div",{className:"space-y-6",children:[S.j.jsx("div",{className:"space-y-4",children:S.j.jsx("div",{children:S.j.jsx("div",{className:"mt-2 space-y-4",children:S.j.jsxs("div",{children:[S.j.jsx("h3",{className:"mb-2 input-label dark:text-gray-300",children:"Line Width"}),S.j.jsx(S.a6,{min:1,max:10,value:n.line.lineWidth||2,onChange:e=>r("lineWidth",e),rootClassNames:"w-full h-2"})]})})})}),Array.isArray(t.y)&&t.y.length>0&&S.j.jsx("div",{className:"space-y-4",children:S.j.jsx("div",{className:"grid gap-3",children:t.y.map(e=>{var t,r,o,s;return S.j.jsxs("div",{className:"flex items-center justify-between w-full gap-3 border-gray-100 dark:border-gray-700 rounded-sm bg-gray-50/20 dark:bg-gray-700/20",children:[S.j.jsx("h4",{className:"mb-2 font-mono text-xs font-bold text-gray-600 dark:text-gray-300",children:e}),S.j.jsx("div",{className:"w-full space-y-3",children:S.j.jsx(S.a7,{allowClear:!0,value:(null==(o=null==(r=null==(t=n.line)?void 0:t.lineOptions)?void 0:r[e])?void 0:o.stroke)||(null==(s=n.line)?void 0:s.pointColor)||"#4e79a7",onChange:t=>i(e,"stroke",t.cleared?null:t.toHexString())})})]},e)})})})]})},TA=()=>{var e;let t=(0,C.useContext)(Tf),{chartSpecificOptions:n}=t.config,r=(e,n)=>{t.updateChartSpecificOptions({[e]:n}).render()};return S.j.jsxs("div",{className:"flex flex-col gap-4 text-xs",children:[!t.config.selectedColumns.fill&&S.j.jsxs("div",{children:[S.j.jsx("h3",{className:"mb-2 dark:text-gray-300",children:"Override dot color"}),S.j.jsx(S.a7,{value:(null==(e=n.scatter)?void 0:e.pointColor)||"#4e79a7",onChange:e=>r("pointColor",e.cleared?null:e.toHexString())})]}),S.j.jsxs("div",{children:[S.j.jsx("h3",{className:"mb-2 dark:text-gray-300",children:"Point Size"}),S.j.jsx(S.a6,{min:1,max:20,value:n.scatter.pointSize,onChange:e=>r("pointSize",e)})]})]})},TE=()=>{let e=(0,C.useContext)(Tf),{chartSpecificOptions:t,selectedColumns:n}=e.config,r=(n,r,i)=>{let o={...t.bar.barOptions||{}};o[n]={...o[n],[r]:i},e.updateChartSpecificOptions({barOptions:o}).render()};return S.j.jsx("div",{className:"flex flex-col gap-4 text-xs",children:S.j.jsxs("div",{className:"flex flex-col gap-2",children:[S.j.jsx("span",{className:"block mb-1 dark:text-gray-300",children:"Bar color"}),S.j.jsx("div",{className:"flex flex-row flex-wrap gap-4",children:Array.isArray(n.y)&&n.y.map(e=>{var n,i,o;return S.j.jsxs("div",{className:"",children:[S.j.jsx("h4",{className:"mb-2 font-bold dark:text-gray-300",children:`${e}`}),S.j.jsx("div",{className:"mb-2",children:S.j.jsx(S.a7,{allowClear:!0,value:(null==(o=null==(i=null==(n=t.bar)?void 0:n.barOptions)?void 0:i[e])?void 0:o.fill)||"#4e79a7",onChange:t=>r(e,"fill",t.cleared?null:t.toHexString())})})]},e)})})]})})};function TM(){let e=(0,C.useContext)(Tf),{selectedChart:t,chartStyle:n}=e.config,r=(t,n)=>{e.updateChartStyle({[t]:n}).render()};return S.j.jsx("div",{className:"grid grid-rows-[auto_1fr] max-h-[550px] overflow-x-clip overflow-y-auto h-full",children:S.j.jsxs("div",{className:"space-y-6",children:[S.j.jsxs("div",{className:"space-y-1.5",children:[S.j.jsx("h3",{className:"input-label dark:text-gray-300",children:"Background Color"}),S.j.jsx(S.a7,{allowClear:!0,value:n.backgroundColor||"#ffffff",onChange:e=>r("backgroundColor",e.cleared?null:e.toHexString())})]}),S.j.jsx("div",{className:"space-y-4",children:S.j.jsx("div",{className:"space-y-4",children:(()=>{switch(t){case"line":return S.j.jsx(TT,{});case"bar":return S.j.jsx(TE,{});case"scatter":return S.j.jsx(TA,{});default:return null}})()})}),S.j.jsx("div",{className:"space-y-4"})]})})}var T_={exports:{}};!function(e,t){var n;S.a1,n=function(){return function(e,t,n){var r=function(e,t){if(!t||!t.length||1===t.length&&!t[0]||1===t.length&&Array.isArray(t[0])&&!t[0].length)return null;1===t.length&&t[0].length>0&&(t=t[0]),n=(t=t.filter(function(e){return e}))[0];for(var n,r=1;r<t.length;r+=1)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n};n.max=function(){var e=[].slice.call(arguments,0);return r("isAfter",e)},n.min=function(){var e=[].slice.call(arguments,0);return r("isBefore",e)}}},e.exports=n()}(T_);var TD=T_.exports;let TN=(0,S.a3)(TD),TR=(()=>{let e=0,t=()=>`0000${(1679616*Math.random()<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function TP(e){let t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}let Tj=null;function TI(e={}){return Tj||(Tj=e.includeStyleProperties?e.includeStyleProperties:TP(window.getComputedStyle(document.documentElement)))}function T$(e,t){let n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function TL(e,t={}){return{width:t.width||function(e){let t=T$(e,"border-left-width"),n=T$(e,"border-right-width");return e.clientWidth+t+n}(e),height:t.height||function(e){let t=T$(e,"border-top-width"),n=T$(e,"border-bottom-width");return e.clientHeight+t+n}(e)}}function Tq(e){return new Promise((t,n)=>{let r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>t(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function Tz(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function TB(e,t,n){let r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),o=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${t}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${t} ${n}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),i.appendChild(o),o.appendChild(e),Tz(i)}let TF=(e,t)=>{if(e instanceof t)return!0;let n=Object.getPrototypeOf(e);return null!==n&&(n.constructor.name===t.name||TF(n,t))};function TQ(e,t,n,r){let i=window.getComputedStyle(e,n),o=i.getPropertyValue("content");if(""===o||"none"===o)return;let s=TR();try{t.className=`${t.className} ${s}`}catch{return}let a=document.createElement("style");a.appendChild(function(e,t,n,r){let i=`.${e}:${t}`,o=n.cssText?function(e){let t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}(n):TI(r).map(e=>{let t=n.getPropertyValue(e),r=n.getPropertyPriority(e);return`${e}: ${t}${r?" !important":""};`}).join(" ");return document.createTextNode(`${i}{${o}}`)}(s,n,i,r)),t.appendChild(a)}let TV="application/font-woff",TW="image/jpeg",TU={woff:TV,woff2:TV,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:TW,jpeg:TW,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function TH(e){return TU[(function(e){let t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""})(e).toLowerCase()]||""}function TG(e){return -1!==e.search(/^(data:)/)}async function TX(e,t,n){let r=await fetch(e,t);if(404===r.status)throw Error(`Resource "${r.url}" not found`);let i=await r.blob();return new Promise((e,t)=>{let o=new FileReader;o.onerror=t,o.onloadend=()=>{try{e(n({res:r,result:o.result}))}catch(e){t(e)}},o.readAsDataURL(i)})}let TZ={};async function TY(e,t,n){var r,i,o,s,a;let l,c;let h=(r=e,i=t,o=n.includeQueryParams,c=r.replace(/\?.*/,""),o&&(c=r),/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,"")),i?`[${i}]${c}`:c);if(null!=TZ[h])return TZ[h];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());try{s=await TX(e,n.fetchRequestInit,({res:e,result:n})=>(t||(t=e.headers.get("Content-Type")||""),n.split(/,/)[1])),a=t,l=`data:${a};base64,${s}`}catch(r){l=n.imagePlaceholder||"";let t=`Failed to fetch resource: ${e}`;r&&(t="string"==typeof r?r:r.message),t&&console.warn(t)}return TZ[h]=l,l}async function TJ(e){let t=e.toDataURL();return"data:,"===t?e.cloneNode(!1):Tq(t)}async function TK(e,t){if(e.currentSrc){let t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.clientWidth,t.height=e.clientHeight,null==n||n.drawImage(e,0,0,t.width,t.height),Tq(t.toDataURL())}let n=e.poster,r=TH(n);return Tq(await TY(n,r,t))}async function T0(e,t){var n;try{if(!(null===(n=null==e?void 0:e.contentDocument)||void 0===n)&&n.body)return await T6(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function T1(e,t){return TF(e,HTMLCanvasElement)?TJ(e):TF(e,HTMLVideoElement)?TK(e,t):TF(e,HTMLIFrameElement)?T0(e,t):e.cloneNode(T5(e))}let T2=e=>null!=e.tagName&&"SLOT"===e.tagName.toUpperCase(),T5=e=>null!=e.tagName&&"SVG"===e.tagName.toUpperCase();async function T3(e,t,n){var r,i;if(T5(t))return t;let o=[];return T2(e)&&e.assignedNodes?o=TP(e.assignedNodes()):TF(e,HTMLIFrameElement)&&!(null===(r=e.contentDocument)||void 0===r)&&r.body?o=TP(e.contentDocument.body.childNodes):o=TP((null!==(i=e.shadowRoot)&&void 0!==i?i:e).childNodes),0===o.length||TF(e,HTMLVideoElement)||await o.reduce((e,r)=>e.then(()=>T6(r,n)).then(e=>{e&&t.appendChild(e)}),Promise.resolve()),t}async function T4(e,t){let n=e.querySelectorAll?e.querySelectorAll("use"):[];if(0===n.length)return e;let r={};for(let i=0;i<n.length;i++){let o=n[i].getAttribute("xlink:href");if(o){let n=e.querySelector(o),i=document.querySelector(o);n||!i||r[o]||(r[o]=await T6(i,t,!0))}}let i=Object.values(r);if(i.length){let t="http://www.w3.org/1999/xhtml",n=document.createElementNS(t,"svg");n.setAttribute("xmlns",t),n.style.position="absolute",n.style.width="0",n.style.height="0",n.style.overflow="hidden",n.style.display="none";let r=document.createElementNS(t,"defs");n.appendChild(r);for(let e=0;e<i.length;e++)r.appendChild(i[e]);e.appendChild(n)}return e}async function T6(e,t,n){return n||!t.filter||t.filter(e)?Promise.resolve(e).then(e=>T1(e,t)).then(n=>T3(e,n,t)).then(n=>(TF(n,Element)&&(function(e,t,n){let r=t.style;if(!r)return;let i=window.getComputedStyle(e);i.cssText?(r.cssText=i.cssText,r.transformOrigin=i.transformOrigin):TI(n).forEach(n=>{let o=i.getPropertyValue(n);"font-size"===n&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),TF(e,HTMLIFrameElement)&&"display"===n&&"inline"===o&&(o="block"),"d"===n&&t.getAttribute("d")&&(o=`path(${t.getAttribute("d")})`),r.setProperty(n,o,i.getPropertyPriority(n))})}(e,n,t),TQ(e,n,":before",t),TQ(e,n,":after",t),TF(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),TF(e,HTMLInputElement)&&n.setAttribute("value",e.value),function(e,t){if(TF(e,HTMLSelectElement)){let n=Array.from(t.children).find(t=>e.value===t.getAttribute("value"));n&&n.setAttribute("selected","")}}(e,n)),n)).then(e=>T4(e,t)):null}let T8=/url\((['"]?)([^'"]+?)\1\)/g,T9=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,T7=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;async function Ae(e,t,n,r,i){try{let o;let s=n?function(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;let n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),t&&(r.href=t),i.href=e,i.href}(t,n):t,a=TH(t);return i||(o=await TY(s,a,r)),e.replace(function(e){let t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}(t),`$1${o}$3`)}catch{}return e}function At(e){return -1!==e.search(T8)}async function An(e,t,n){if(!At(e))return e;let r=function(e,{preferredFontFormat:t}){return t?e.replace(T7,e=>{for(;;){let[n,,r]=T9.exec(e)||[];if(!r)return"";if(r===t)return`src: ${n};`}}):e}(e,n);return(function(e){let t=[];return e.replace(T8,(e,n,r)=>(t.push(r),e)),t.filter(e=>!TG(e))})(r).reduce((e,r)=>e.then(e=>Ae(e,r,t,n)),Promise.resolve(r))}async function Ar(e,t,n){var r;let i=null===(r=t.style)||void 0===r?void 0:r.getPropertyValue(e);if(i){let r=await An(i,null,n);return t.style.setProperty(e,r,t.style.getPropertyPriority(e)),!0}return!1}async function Ai(e,t){await Ar("background",e,t)||await Ar("background-image",e,t),await Ar("mask",e,t)||await Ar("-webkit-mask",e,t)||await Ar("mask-image",e,t)||await Ar("-webkit-mask-image",e,t)}async function Ao(e,t){let n=TF(e,HTMLImageElement);if(!(n&&!TG(e.src))&&!(TF(e,SVGImageElement)&&!TG(e.href.baseVal)))return;let r=n?e.src:e.href.baseVal,i=await TY(r,TH(r),t);await new Promise((r,o)=>{e.onload=r,e.onerror=t.onImageErrorHandler?(...e)=>{try{r(t.onImageErrorHandler(...e))}catch(e){o(e)}}:o,e.decode&&(e.decode=r),"lazy"===e.loading&&(e.loading="eager"),n?(e.srcset="",e.src=i):e.href.baseVal=i})}async function As(e,t){let n=TP(e.childNodes).map(e=>Aa(e,t));await Promise.all(n).then(()=>e)}async function Aa(e,t){TF(e,Element)&&(await Ai(e,t),await Ao(e,t),await As(e,t))}let Al={};async function Ac(e){let t=Al[e];if(null!=t)return t;let n=await (await fetch(e)).text();return t={url:e,cssText:n},Al[e]=t,t}async function Ah(e,t){let n=e.cssText,r=/url\(["']?([^"')]+)["']?\)/g;return Promise.all((n.match(/url\([^)]+\)/g)||[]).map(async i=>{let o=i.replace(r,"$1");return o.startsWith("https://")||(o=new URL(o,e.url).href),TX(o,t.fetchRequestInit,({result:e})=>(n=n.replace(i,`url(${e})`),[i,e]))})).then(()=>n)}function Au(e){if(null==e)return[];let t=[],n=e.replace(/(\/\*[\s\S]*?\*\/)/gi,""),r=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){let e=r.exec(n);if(null===e)break;t.push(e[0])}n=n.replace(r,"");let i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let e=i.exec(n);if(null===e){if(null===(e=o.exec(n)))break;i.lastIndex=o.lastIndex}else o.lastIndex=i.lastIndex;t.push(e[0])}return t}async function Ad(e,t){let n=[],r=[];return e.forEach(n=>{if("cssRules"in n)try{TP(n.cssRules||[]).forEach((e,i)=>{if(e.type===CSSRule.IMPORT_RULE){let o=i+1,s=e.href,a=Ac(s).then(e=>Ah(e,t)).then(e=>Au(e).forEach(e=>{try{n.insertRule(e,e.startsWith("@import")?o+=1:n.cssRules.length)}catch(t){console.error("Error inserting rule from remote css",{rule:e,error:t})}})).catch(e=>{console.error("Error loading remote css",e.toString())});r.push(a)}})}catch(o){let i=e.find(e=>null==e.href)||document.styleSheets[0];null!=n.href&&r.push(Ac(n.href).then(e=>Ah(e,t)).then(e=>Au(e).forEach(e=>{i.insertRule(e,i.cssRules.length)})).catch(e=>{console.error("Error loading remote stylesheet",e)})),console.error("Error inlining remote css file",o)}}),Promise.all(r).then(()=>(e.forEach(e=>{if("cssRules"in e)try{TP(e.cssRules||[]).forEach(e=>{n.push(e)})}catch(t){console.error(`Error while reading CSS rules from ${e.href}`,t)}}),n))}async function Af(e,t){if(null==e.ownerDocument)throw Error("Provided element is not within a Document");let n=TP(e.ownerDocument.styleSheets);return(await Ad(n,t)).filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>At(e.style.getPropertyValue("src")))}function Ap(e){return e.trim().replace(/["']/g,"")}async function Am(e,t){let n=await Af(e,t),r=function(e){let t=new Set;return function e(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(e=>{t.add(Ap(e))}),Array.from(n.children).forEach(t=>{t instanceof HTMLElement&&e(t)})}(e),t}(e);return(await Promise.all(n.filter(e=>r.has(Ap(e.style.fontFamily))).map(e=>{let n=e.parentStyleSheet?e.parentStyleSheet.href:null;return An(e.cssText,n,t)}))).join(`
`)}async function Ag(e,t){let n=null!=t.fontEmbedCSS?t.fontEmbedCSS:t.skipFonts?null:await Am(e,t);if(n){let t=document.createElement("style"),r=document.createTextNode(n);t.appendChild(r),e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}}async function Ay(e,t={}){let{width:n,height:r}=TL(e,t),i=await T6(e,t,!0);return await Ag(i,t),await Aa(i,t),function(e,t){let{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);let r=t.style;null!=r&&Object.keys(r).forEach(e=>{n[e]=r[e]})}(i,t),await TB(i,n,r)}async function Ab(e,t={}){let{width:n,height:r}=TL(e,t),i=await Ay(e,t),o=await Tq(i),s=document.createElement("canvas"),a=s.getContext("2d"),l=t.pixelRatio||function(){let e,t;try{t=A}catch{}let n=t&&t.env?t.env.devicePixelRatio:null;return n&&Number.isNaN(e=parseInt(n,10))&&(e=1),e||window.devicePixelRatio||1}(),c=t.canvasWidth||n,h=t.canvasHeight||r;return s.width=c*l,s.height=h*l,t.skipAutoScale||(s.width>16384||s.height>16384)&&(s.width>16384&&s.height>16384?s.width>s.height?(s.height*=16384/s.width,s.width=16384):(s.width*=16384/s.height,s.height=16384):s.width>16384?(s.height*=16384/s.width,s.width=16384):(s.width*=16384/s.height,s.height=16384)),s.style.width=`${c}`,s.style.height=`${h}`,t.backgroundColor&&(a.fillStyle=t.backgroundColor,a.fillRect(0,0,s.width,s.height)),a.drawImage(o,0,0,s.width,s.height),s}async function Av(e,t={}){return(await Ab(e,t)).toDataURL()}function Ax(e){return null!=e&&!Number.isNaN(e)}function Aw(e,t){return+Ax(t)-+Ax(e)||(0,S.s)(e,t)}function Ak(e,t){return+Ax(t)-+Ax(e)||(0,S.a8)(e,t)}function AO(e){return null!=e&&""!=`${e}`}function AS(e){return isFinite(e)?e:NaN}function AC(e){return e>0&&isFinite(e)?e:NaN}function AT(e){return e<0&&isFinite(e)?e:NaN}function AA(e,t){return`${e}`.padStart(t,"0")}let AE=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function AM(e,t){return AE.test(e+="")?new Date(e):t}function A_(e){if(null==e)return;let t=e[0],n=e[e.length-1];return(0,S.a8)(t,n)}let AD=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",1e3],["5 seconds",5e3],["15 seconds",15e3],["30 seconds",3e4],["minute",6e4],["5 minutes",3e5],["15 minutes",9e5],["30 minutes",18e5],["hour",36e5],["3 hours",108e5],["6 hours",216e5],["12 hours",432e5],["day",864e5],["2 days",1728e5],["week",6048e5],["2 weeks",12096e5],["month",2592e6],["3 months",7776e6],["6 months",15552e6],["year",31536e6],["2 years",63072e6],["5 years",15768e7],["10 years",31536e7],["20 years",63072e7],["50 years",15768e8],["100 years",31536e8]],AN=new Map([["second",1e3],["minute",6e4],["hour",36e5],["day",864e5],["monday",6048e5],["tuesday",6048e5],["wednesday",6048e5],["thursday",6048e5],["friday",6048e5],["saturday",6048e5],["sunday",6048e5],["week",6048e5],["month",2592e6],["year",31536e6]]),AR=new Map([["second",oK],["minute",o0],["hour",o2],["day",o3],["monday",o7],["tuesday",se],["wednesday",st],["thursday",sn],["friday",sr],["saturday",si],["sunday",o9],["week",o9],["month",sf],["year",sm]]),AP=new Map([["second",oK],["minute",o1],["hour",o5],["day",o6],["monday",sa],["tuesday",sl],["wednesday",sc],["thursday",sh],["friday",su],["saturday",sd],["sunday",ss],["week",ss],["month",sp],["year",sg]]),Aj=Symbol("intervalDuration"),AI=Symbol("intervalType");for(let[e,t]of AR)t[Aj]=AN.get(e),t[AI]="time";for(let[e,t]of AP)t[Aj]=AN.get(e),t[AI]="utc";let A$=[["year",sg,"utc"],["month",sp,"utc"],["day",o6,"utc",15552e6],["hour",o5,"utc",2592e5],["minute",o1,"utc",216e5],["second",oK,"utc",18e5]],AL=[["year",sm,"time"],["month",sf,"time"],["day",o3,"time",15552e6],["hour",o2,"time",2592e5],["minute",o0,"time",216e5],["second",oK,"time",18e5]],Aq=[A$[0],AL[0],A$[1],AL[1],A$[2],AL[2],...A$.slice(3)];function Az(e){let t=`${e}`.toLowerCase();t.endsWith("s")&&(t=t.slice(0,-1));let n=1,r=/^(?:(\d+)\s+)/.exec(t);switch(r&&(t=t.slice(r[0].length),n=+r[1]),t){case"quarter":t="month",n*=3;break;case"half":t="month",n*=6}let i=AP.get(t);if(!i)throw Error(`unknown interval: ${e}`);if(n>1&&!i.every)throw Error(`non-periodic interval: ${t}`);return[t,n]}function AB(e){return AQ(Az(e),"time")}function AF(e){return AQ(Az(e),"utc")}function AQ([e,t],n){let r=("time"===n?AR:AP).get(e);return t>1&&((r=r.every(t))[Aj]=AN.get(e)*t,r[AI]=n),r}function AV(e,t){if(!(t>1))return;let n=e[Aj];if(!AD.some(([,e])=>e===n)||n%864e5==0&&864e5<n&&n<2592e6)return;let[r]=AD[(0,S.Z)(([,e])=>Math.log(e)).center(AD,Math.log(n*t))];return("time"===e[AI]?AB:AF)(r)}function AW(e,t,n){let r="time"===t?h:u;if(null==n)return r("year"===e?"%Y":"month"===e?"%Y-%m":"day"===e?"%Y-%m-%d":"hour"===e||"minute"===e?"%Y-%m-%dT%H:%M":"second"===e?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");let i="left"===n||"right"===n?(e,t)=>`
${e}
${t}`:"top"===n?(e,t)=>`${t}
${e}`:(e,t)=>`${e}
${t}`;switch(e){case"millisecond":return AU(r(".%L"),r(":%M:%S"),i);case"second":return AU(r(":%S"),r("%-I:%M"),i);case"minute":return AU(r("%-I:%M"),r("%p"),i);case"hour":return AU(r("%-I %p"),r("%b %-d"),i);case"day":return AU(r("%-d"),r("%b"),i);case"month":return AU(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw Error("unable to format time ticks")}function AU(e,t,n){return(r,i,o)=>{let s=e(r,i),a=t(r,i),l=i-A_(o);return i!==l&&void 0!==o[l]&&a===t(o[l],l)?s:n(s,a)}}let AH=Object.getPrototypeOf(Uint8Array),AG=Object.prototype.toString;function AX(e){return e instanceof Array||e instanceof AH}function AZ(e){return e instanceof AH&&!(e instanceof BigInt64Array||e instanceof BigUint64Array)}function AY(e){return(null==e?void 0:e.prototype)instanceof AH&&!(e===BigInt64Array||e===BigUint64Array)}let AJ=Symbol("reindex");function AK(e,t,n){var r,i;let o=typeof t;return"string"===o?E1(e)?A2(e.getChild(t),n):A0(e,A4(t),n):"function"===o?A0(e,t,n):"number"===o||t instanceof Date||"boolean"===o?Eg(e,Ei(t),n):"function"==typeof(null==t?void 0:t.transform)?A1(t.transform(e),n):(r=A1(t,n),i=null==e?void 0:e[AJ],null!=r&&i?EA(r,i):r)}function A0(e,t,n){return Eg(e,AY(n)?(e,n)=>Es(t(e,n)):t,n)}function A1(e,t){return void 0===t?Ep(e):E2(e)?A2(e,t):e instanceof t?e:t.from(e,AY(t)&&!AZ(e)?Es:void 0)}function A2(e,t){var n;return null==e?e:(void 0===t||t===Array)&&(n=e.type)&&(8===n.typeId||10===n.typeId)&&1===n.unit?Ea(A5(e)):A1(A5(e),t)}function A5(e){return e.nullCount?e.toJSON():e.toArray()}let A3=[null],A4=e=>t=>{var n;let r=t[e];return void 0===r&&"Feature"===t.type?null==(n=t.properties)?void 0:n[e]:r},A6={transform:ET},A8={transform:e=>e},A9=()=>1,A7=()=>!0,Ee=e=>null==e?e:`${e}`,Et=e=>null==e?e:+e,En=e=>e?e[0]:void 0,Er=e=>e?e[1]:void 0,Ei=e=>()=>e;function Eo(e){return AZ(e)?e:Eg(e,Es,Float64Array)}function Es(e){return null==e?NaN:Number(e)}function Ea(e){return Eg(e,El)}function El(e){return e instanceof Date&&!isNaN(e)?e:"string"==typeof e?AM(e):null==e||isNaN(e=Number(e))?void 0:new Date(e)}function Ec(e,t){return void 0===e&&(e=t),null===e?[void 0,"none"]:EH(e)?[void 0,e]:[e,void 0]}function Eh(e,t){return void 0===e&&(e=t),null===e||"number"==typeof e?[void 0,e]:[e,void 0]}function Eu(e,t,n){if(null!=e)return Ed(e,t,n)}function Ed(e,t,n){let r=`${e}`.toLowerCase();if(!n.includes(r))throw Error(`invalid ${t}: ${e}`);return r}function Ef(e){return E1(e)?e:Ep(e)}function Ep(e){if(null==e||AX(e))return e;if(E2(e))return A2(e);if(Em(e))switch(e.type){case"FeatureCollection":return e.features;case"GeometryCollection":return e.geometries;default:return[e]}return Array.from(e)}function Em(e){switch(null==e?void 0:e.type){case"FeatureCollection":case"GeometryCollection":case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":return!0;default:return!1}}function Eg(e,t,n=Array){return null==e?e:e instanceof n?e.map(t):n.from(e,t)}function Ey(e,t=Array){return e instanceof t?e.slice():t.from(e)}function Eb({y:e,y1:t,y2:n}){return void 0!==e||void 0!==t||void 0!==n}function Ev(e){return(null==e?void 0:e.toString)===AG}function Ex(e){return Ev(e)&&(void 0!==e.type||void 0!==e.domain)}function Ew(e){return Ev(e)&&"function"!=typeof e.transform}function Ek(e){return Ew(e)&&void 0===e.value&&void 0===e.channel}function EO(e,t){return void 0===e&&void 0===t?[En,Er]:[e,t]}function ES({z:e,fill:t,stroke:n}={}){return void 0===e&&([e]=Ec(t)),void 0===e&&([e]=Ec(n)),e}function EC(e){return AX(e)?e.length:null==e?void 0:e.numRows}function ET(e){let t=EC(e),n=new Uint32Array(t);for(let e=0;e<t;++e)n[e]=e;return n}function EA(e,t){return AX(e)?Eg(t,t=>e[t],e.constructor):Eg(t,t=>e.at(t))}function EE(e){return null!==e&&"object"==typeof e?e.valueOf():e}function EM(e){let t;return[{transform:()=>t,label:ED(e)},e=>t=e]}function E_(e){return null==e?[e]:EM(e)}function ED(e,t){return"string"==typeof e?e:e&&void 0!==e.label?e.label:t}function EN(e,t){return{transform(n){let r=e.transform(n),i=t.transform(n);return EF(r)||EF(i)?Eg(r,(e,t)=>new Date((+r[t]+ +i[t])/2)):Eg(r,(e,t)=>(+r[t]+ +i[t])/2,Float64Array)},label:e.label}}function ER(e,t){let n=EP(null==t?void 0:t.interval,null==t?void 0:t.type);return n?Eg(e,n):e}function EP(e,t){let n=Ej(e,t);return n&&(e=>Ax(e)?n.floor(e):e)}function Ej(e,t){if(null!=e){if("number"==typeof e)return function(e){0<(e=+e)&&e<1&&Number.isInteger(1/e)&&(e=-1/e);let t=Math.abs(e);return e<0?{floor:e=>Math.floor(e*t)/t,offset:(e,n=1)=>(e*t+Math.floor(n))/t,range:(e,n)=>(0,S.W)(Math.ceil(e*t),n*t).map(e=>e/t)}:{floor:e=>Math.floor(e/t)*t,offset:(e,n=1)=>e+t*Math.floor(n),range:(e,n)=>(0,S.W)(Math.ceil(e/t),n/t).map(e=>e*t)}}(e);if("string"==typeof e)return("time"===t?AB:AF)(e);if("function"!=typeof e.floor)throw Error("invalid interval; missing floor method");if("function"!=typeof e.offset)throw Error("invalid interval; missing offset method");return e}}function EI(e,t){if((e=Ej(e,t))&&"function"!=typeof e.range)throw Error("invalid interval: missing range method");return e}function E$(e){return"function"==typeof(null==e?void 0:e.range)}function EL(e){return void 0===e||Ew(e)?e:{value:e}}function Eq(e){return e&&"function"==typeof e[Symbol.iterator]}function Ez(e){for(let t of e)if(null!=t)return"object"!=typeof t||t instanceof Date}function EB(e){for(let t of e){if(null==t)continue;let e=typeof t;return"string"===e||"boolean"===e}}function EF(e){for(let t of e)if(null!=t)return t instanceof Date}function EQ(e){for(let t of e)if(null!=t)return"string"==typeof t&&isNaN(t)&&AM(t)}function EV(e){for(let t of e)if(null!=t){if("string"!=typeof t)return!1;if(t.trim())return!isNaN(t)}}function EW(e,t){let n;for(let r of e)if(null!=r){if(!t(r))return!1;n=!0}return n}let EU=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function EH(e){return"string"==typeof e&&(e=e.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(e)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(e)||EU.has(e))}function EG(e){return"number"==typeof e&&(0<=e&&e<=1||isNaN(e))}function EX(e){return null==e||EZ(e)}function EZ(e){return/^\s*none\s*$/i.test(e)}function EY(e,t){return Eu(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function EJ(e="middle"){return EY(e,"frameAnchor")}function EK(e){return Eq(e)?function(e){console.warn("named iterables are deprecated; please use an object instead");let t=new Set;return Object.fromEntries(Array.from(e,e=>{let{name:n}=e;if(null==n)throw Error("missing name");let r=`${n}`;if("__proto__"===r)throw Error(`illegal name: ${r}`);if(t.has(r))throw Error(`duplicate name: ${r}`);return t.add(r),[n,e]}))}(e):e}function E0(e){return!0===e?e="frame":!1===e?e=null:Em(e)||null==e||"sphere"!==(e=Ed(e,"clip",["frame","sphere"]))||(e={type:"Sphere"}),e}function E1(e){return e&&"function"==typeof e.getChild&&"function"==typeof e.toArray&&e.schema&&Array.isArray(e.schema.fields)}function E2(e){return e&&"function"==typeof e.toArray&&e.type}let E5=Symbol("position"),E3=Symbol("color"),E4=Symbol("radius"),E6=Symbol("length"),E8=Symbol("opacity"),E9=Symbol("symbol"),E7=Symbol("projection"),Me=new Map([["x",E5],["y",E5],["fx",E5],["fy",E5],["r",E4],["color",E3],["opacity",E8],["symbol",E9],["length",E6],["projection",E7]]),Mt=2/Math.sqrt(3),Mn=new Map([["asterisk",cs],["circle",ca],["cross",cl],["diamond",cu],["diamond2",cd],["hexagon",{draw(e,t){let n=Math.sqrt(t/Math.PI),r=n*Mt,i=r/2;e.moveTo(0,r),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(0,-r),e.lineTo(-n,-i),e.lineTo(-n,i),e.closePath()}}],["plus",cf],["square",cp],["square2",cm],["star",cv],["times",cE],["triangle",cw],["triangle2",cO],["wye",cA]]);function Mr(e){return e&&"function"==typeof e.draw}function Mi(e){return!!Mr(e)||"string"==typeof e&&Mn.has(e.toLowerCase())}function Mo(e){if(null==e||Mr(e))return e;let t=Mn.get(`${e}`.toLowerCase());if(t)return t;throw Error(`invalid symbol: ${e}`)}function Ms({filter:e,sort:t,reverse:n,transform:r,initializer:i,...o}={},s){if(void 0===r&&(null!=e&&(r=Mh(e)),null==t||Ek(t)||(r=Ml(r,Md(t))),n&&(r=Ml(r,Mu))),null!=s&&null!=i)throw Error("transforms cannot be applied after initializers");return{...o,...(null===t||Ek(t))&&{sort:t},transform:Ml(r,s)}}function Ma({filter:e,sort:t,reverse:n,initializer:r,...i}={},o){return void 0===r&&(null!=e&&(r=Mh(e)),null==t||Ek(t)||(r=Mc(r,Md(t))),n&&(r=Mc(r,Mu))),{...i,...(null===t||Ek(t))&&{sort:t},initializer:Mc(r,o)}}function Ml(e,t){return null==e?null===t?void 0:t:null==t?null===e?void 0:e:function(n,r,i){return{data:n,facets:r}=e.call(this,n,r,i),t.call(this,Ef(n),r,i)}}function Mc(e,t){return null==e?null===t?void 0:t:null==t?null===e?void 0:e:function(n,r,i,...o){let s,a,l,c,h,u;return{data:a=n,facets:l=r,channels:s}=e.call(this,n,r,i,...o),{data:h=a,facets:u=l,channels:c}=t.call(this,a,l,{...i,...s},...o),{data:h,facets:u,channels:{...s,...c}}}}function Mh(e){return(t,n)=>{let r=AK(t,e);return{data:t,facets:n.map(e=>e.filter(e=>r[e]))}}}function Mu(e,t){return{data:e,facets:t.map(e=>e.slice().reverse())}}function Md(e){return("function"==typeof e&&1!==e.length?function(e){return(t,n)=>{let r=AX(t)?(n,r)=>e(t[n],t[r]):(n,r)=>e(t.get(n),t.get(r));return{data:t,facets:n.map(e=>e.slice().sort(r))}}}:function(e){let t,n;({channel:t,value:e,order:n}={...EL(e)});let r=null==t?void 0:t.startsWith("-");if(r&&(t=t.slice(1)),void 0===n&&(n=r?Ak:Aw),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=Aw;break;case"descending":n=Ak;break;default:throw Error(`invalid order: ${n}`)}return(r,i,o)=>{let s;if(void 0===t)s=AK(r,e);else{if(void 0===o)throw Error("channel sort requires an initializer");if(!(s=o[t]))return{};s=s.value}let a=(e,t)=>n(s[e],s[t]);return{data:r,facets:i.map(e=>e.slice().sort(a))}}})(e)}function Mf(e,...t){for(let{name:n}of e)if(t.includes(n))return!0;return!1}function Mp(e,t,n=Mm){let r=Object.entries(e);return null!=t.title&&void 0===e.title&&r.push(["title",M_]),null!=t.href&&void 0===e.href&&r.push(["href",MM]),r.filter(([,e])=>void 0!==e).map(([e,r])=>null===r?{name:e,initialize(){},scope(){},reduce(){}}:n(e,r,t))}function Mm(e,t,n,r=Mg){let i,o;Ev(t)&&"reduce"in t&&(i=t.scale,t=t.reduce);let s=r(e,t,n),[a,l]=EM(s.label);return{name:e,output:void 0===i?a:{value:a,scale:i},initialize(e){s.initialize(e),o=l([])},scope(e,t){s.scope(e,t)},reduce(e,t){o.push(s.reduce(e,t))}}}function Mg(e,t,n,r=Mb){let i,o;let s=function(e,t){if(void 0!==t[e])return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y"}return t[e]}(e,n),a=r(t,s);return{label:ED(a===MN?null:s,a.label),initialize(e){i=void 0===s?e:AK(e,s),"data"===a.scope&&(o=a.reduceIndex(ET(e),i))},scope(e,t){a.scope===e&&(o=a.reduceIndex(t,i))},reduce:(e,t)=>null==a.scope?a.reduceIndex(e,i,t):a.reduceIndex(e,i,o,t)}}function My(e,t){return t?tq(e,e=>t[e]):[[,e]]}function Mb(e,t,n=Mv){if(null==e)return n(e);if("function"==typeof e.reduceIndex)return e;if("function"==typeof e.reduce&&Ev(e))return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)};if("function"==typeof e)return{reduceIndex:(t,n,r)=>e(EA(n,t),r)};if(/^p\d{2}$/i.test(e))return MT(function(e){let t=+`${e}`.slice(1)/100;return(e,n)=>t6(e,t,n)}(e));switch(`${e}`.toLowerCase()){case"first":return MM;case"last":return MD;case"identity":return ME;case"count":return MN;case"distinct":return MR;case"sum":return null==t?MN:MP;case"proportion":return Mj(t,"data");case"proportion-facet":return Mj(t,"facet");case"deviation":return MT(tM);case"min":return MT(t2);case"min-index":return MT(t5);case"max":return MT(t0);case"max-index":return MT(t1);case"mean":return MA(S.a9);case"median":return MA(t7);case"variance":return MT(tE);case"mode":return MT(nt)}return n(e)}function Mv(e){throw Error(`invalid reduce: ${e}`)}function Mx(e,t,n){return Mm(e,t,n,Mw)}function Mw(e,t,n){return Mg(e,t,n,Mk)}function Mk(e,t){return Mb(e,t,MO)}function MO(e){switch(`${e}`.toLowerCase()){case"x":return MI;case"y":return M$;case"z":return ML}throw Error(`invalid group reduce: ${e}`)}function MS(e,t){for(let n in t){let r=t[n];if(void 0!==r&&!e.some(e=>e.name===n))return r}}function MC(e,t,n){if(t){let n=t.output.transform(),r=(e,t)=>Aw(n[e],n[t]);e.forEach(e=>e.sort(r))}n&&e.forEach(e=>e.reverse())}function MT(e){return{reduceIndex:(t,n)=>e(t,e=>n[e])}}function MA(e){return{reduceIndex(t,n){let r=e(t,e=>n[e]);return EF(n)?new Date(r):r}}}let ME={reduceIndex:(e,t)=>EA(t,e)},MM={reduceIndex:(e,t)=>t[e[0]]},M_={reduceIndex(e,t){let n=tF(tz(e,e=>e.length,e=>t[e]),Er),r=n.slice(-5).reverse();if(r.length<n.length){let e=n.slice(0,-4);r[4]=[` ${e.length.toLocaleString("en-US")} more`,nn(e,Er)]}return r.map(([e,t])=>`${e} (${t.toLocaleString("en-US")})`).join(`
`)}},MD={reduceIndex:(e,t)=>t[e[e.length-1]]},MN={label:"Frequency",reduceIndex:e=>e.length},MR={label:"Distinct",reduceIndex(e,t){let n=new tR;for(let r of e)n.add(t[r]);return n.size}},MP=MT(nn);function Mj(e,t){return null==e?{scope:t,label:"Frequency",reduceIndex:(e,t,n=1)=>e.length/n}:{scope:t,reduceIndex:(e,t,n=1)=>nn(e,e=>t[e])/n}}let MI={reduceIndex:(e,t,{x:n})=>n},M$={reduceIndex:(e,t,{y:n})=>n},ML={reduceIndex:(e,t,{z:n})=>n};function Mq(e,{scale:t,type:n,value:r,filter:i,hint:o,label:s=ED(r)},a){return void 0===o&&"function"==typeof(null==r?void 0:r.transform)&&(o=r.hint),Mz(a,{scale:t,type:n,value:AK(e,r),label:s,filter:i,hint:o})}function Mz(e,t){let{scale:n,value:r}=t;if(!0===n||"auto"===n)switch(e){case"fill":case"stroke":case"color":t.scale=!0!==n&&EW(r,EH)?null:"color",t.defaultScale="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=!0!==n&&EW(r,EG)?null:"opacity",t.defaultScale="opacity";break;case"symbol":!0!==n&&EW(r,Mi)?(t.scale=null,t.value=Eg(r,Mo)):t.scale="symbol",t.defaultScale="symbol";break;default:t.scale=Me.has(e)?e:null}else if(!1===n)t.scale=null;else if(null!=n&&!Me.has(n))throw Error(`unknown scale: ${n}`);return t}function MB(e,t,n){let r=MF(e,t);return Eg(MF(e,n),(e,t)=>Math.abs(e-r[t]),Float64Array)}function MF(e,t,n){let r=e[t];if(r||void 0===n||(r=e[n]),r)return r.value;throw Error(`missing channel: ${t}`)}function MQ([e,t],[n,r]){return Aw(t,r)||Aw(e,n)}function MV([e,t],[n,r]){return Ak(t,r)||Aw(e,n)}function MW(e,t){let n=e[t];if(n){for(;n.source;)n=n.source;return null===n.source?null:n}}let MU=new Map([["accent",aq],["category10",aL],["dark2",az],["observable10",aB],["paired",aF],["pastel1",aQ],["pastel2",aV],["set1",aW],["set2",aU],["set3",aH],["tableau10",aG]]),MH=new Map([...MU,["brbg",MX(aZ,aY)],["prgn",MX(aJ,aK)],["piyg",MX(a0,a1)],["puor",MX(a2,a5)],["rdbu",MX(a3,a4)],["rdgy",MX(a6,a8)],["rdylbu",MX(a9,a7)],["rdylgn",MX(le,lt)],["spectral",MX(ln,lr)],["burd",MZ(a3,a4)],["buylrd",MZ(a9,a7)],["blues",MG(lE,lM)],["greens",MG(l_,lD)],["greys",MG(lN,lR)],["oranges",MG(lL,lq)],["purples",MG(lP,lj)],["reds",MG(lI,l$)],["turbo",MY(lZ)],["viridis",MY(lJ)],["magma",MY(lK)],["inferno",MY(l0)],["plasma",MY(l1)],["cividis",MY(lz)],["cubehelix",MY(lB)],["warm",MY(lF)],["cool",MY(lQ)],["bugn",MG(li,lo)],["bupu",MG(ls,la)],["gnbu",MG(ll,lc)],["orrd",MG(lh,lu)],["pubu",MG(lp,lm)],["pubugn",MG(ld,lf)],["purd",MG(lg,ly)],["rdpu",MG(lb,lv)],["ylgn",MG(lk,lO)],["ylgnbu",MG(lx,lw)],["ylorbr",MG(lS,lC)],["ylorrd",MG(lT,lA)],["rainbow",MJ(lW)],["sinebow",MJ(lX)]]);function MG(e,t){return({length:n})=>1===n?[e[3][1]]:2===n?[e[3][1],e[3][2]]:(n=Math.max(3,Math.floor(n)))>9?nP(t,n):e[n]}function MX(e,t){return({length:n})=>2===n?[e[3][0],e[3][2]]:(n=Math.max(3,Math.floor(n)))>11?nP(t,n):e[n]}function MZ(e,t){return({length:n})=>2===n?[e[3][2],e[3][0]]:(n=Math.max(3,Math.floor(n)))>11?nP(e=>t(1-e),n):e[n].slice().reverse()}function MY(e){return({length:t})=>nP(e,Math.max(2,Math.floor(t)))}function MJ(e){return({length:t})=>nP(e,Math.floor(t)+1).slice(0,-1)}function MK(e){let t=`${e}`.toLowerCase();if(!MH.has(t))throw Error(`unknown ordinal scheme: ${t}`);return MH.get(t)}function M0(e,t){let n=MK(e),r="function"==typeof n?n({length:t}):n;return r.length!==t?r.slice(0,t):r}let M1=new Map([["brbg",aY],["prgn",aK],["piyg",a1],["puor",a5],["rdbu",a4],["rdgy",a8],["rdylbu",a7],["rdylgn",lt],["spectral",lr],["burd",e=>a4(1-e)],["buylrd",e=>a7(1-e)],["blues",lM],["greens",lD],["greys",lR],["purples",lj],["reds",l$],["oranges",lq],["turbo",lZ],["viridis",lJ],["magma",lK],["inferno",l0],["plasma",l1],["cividis",lz],["cubehelix",lB],["warm",lF],["cool",lQ],["bugn",lo],["bupu",la],["gnbu",lc],["orrd",lu],["pubugn",lf],["pubu",lm],["purd",ly],["rdpu",lv],["ylgnbu",lw],["ylgn",lO],["ylorbr",lC],["ylorrd",lA],["rainbow",lW],["sinebow",lX]]);function M2(e){let t=`${e}`.toLowerCase();if(!M1.has(t))throw Error(`unknown quantitative scheme: ${t}`);return M1.get(t)}let M5=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]),M3=e=>t=>e(1-t),M4=[0,1],M6=new Map([["number",S.L],["rgb",S.N],["hsl",nM],["hcl",n_],["lab",function(e,t){var n=(0,S.U)((e=nm(e)).l,(t=nm(t)).l),r=(0,S.U)(e.a,t.a),i=(0,S.U)(e.b,t.b),o=(0,S.U)(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}]]);function M8(e){let t=`${e}`.toLowerCase();if(!M6.has(t))throw Error(`unknown interpolator: ${t}`);return M6.get(t)}function M9(e,t,n,{type:r,nice:i,clamp:o,zero:s,domain:a=_r(e,n),unknown:l,round:c,scheme:h,interval:u,range:d=Me.get(e)===E4?function(e,t){let n=e.find(({radius:e})=>void 0!==e);if(void 0!==n)return[0,n.radius];let r=t6(e,.5,({value:e})=>void 0===e?NaN:t6(e,.25,AC)),i=t.map(e=>3*Math.sqrt(e/r)),o=30/t0(i);return o<1?i.map(e=>e*o):i}(n,a):Me.get(e)===E6?function(e,t){let n=t7(e,({value:e})=>void 0===e?NaN:t7(e,Math.abs)),r=t.map(e=>12*e/n),i=60/t0(r);return i<1?r.map(e=>e*i):r}(n,a):Me.get(e)===E8?M4:void 0,interpolate:f=Me.get(e)===E3?null==h&&void 0!==d?S.N:M2(void 0!==h?h:"cyclical"===r?"rainbow":"turbo"):c?nE:S.L,reverse:p}){var m;if(a=M7(a),u=EI(u,r),("cyclical"===r||"sequential"===r)&&(r="linear"),"function"!=typeof f&&(f=M8(f)),p=!!p,void 0!==d&&a.length!==(d=M7(d)).length){if(1===f.length)throw Error("invalid piecewise interpolator");f=nR(f,d),d=void 0}if(1===f.length?(p&&(f=M3(f),p=!1),void 0===d&&2===(d=Float64Array.from(a,(e,t)=>t/(a.length-1))).length&&(d=M4),t.interpolate((d===M4?Ei:_i)(f))):t.interpolate(f),s){let[e,t]=t_(a);(e>0||t<0)&&((A_(a=Ey(a))||1)===Math.sign(e)?a[0]=0:a[a.length-1]=0)}return p&&(a=nr(a)),t.domain(a).unknown(l),i&&(t.nice((m=r,!0===i?void 0:"number"==typeof i?i:function(e,t){if((e=EI(e,t))&&"function"!=typeof e.ceil)throw Error("invalid interval: missing ceil method");return e}(i,m))),a=t.domain()),void 0!==d&&t.range(d),o&&t.clamp(o),{type:r,domain:a,range:d,scale:t,interpolate:f,interval:u}}function M7(e){return(e=Ep(e)).length>=2?e:[e[0],e[0]]}function _e(e,t,{exponent:n=1,...r}){return M9(e,(function e(){var t=oG(oD());return t.copy=function(){return o_(t,e()).exponent(t.exponent())},ov.apply(t,arguments),t})().exponent(n),t,{...r,type:"pow"})}function _t(e,t,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:o,range:s=void 0!==o?nP(o,n.length+1):Me.get(e)===E3?M0(i,n.length+1):void 0,reverse:a}){let l=A_(n=Ep(n));if(!isNaN(l)&&!function(e,t){for(let n=1,r=e.length,i=e[0];n<r;++n){let r=(0,S.a8)(i,i=e[n]);if(0!==r&&r!==t)return!1}return!0}(n,l))throw Error(`the ${e} scale has a non-monotonic domain`);return a&&(s=nr(s)),{type:"threshold",scale:(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[(0,S.Y)(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(i=Math.min((n=Array.from(e)).length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},ov.apply(o,arguments)})(l<0?nr(n):n,void 0===s?[]:s).unknown(r),domain:n,range:s}}function _n(e,t=AS){return e.length?[t2(e,({value:e})=>void 0===e?e:t2(e,t)),t0(e,({value:e})=>void 0===e?e:t0(e,t))]:[0,1]}function _r(e,t){let n=Me.get(e);return(n===E4||n===E8||n===E6?function(e){return[0,e.length?t0(e,({value:e})=>void 0===e?e:t0(e,AS)):1]}:_n)(t)}function _i(e){return(t,n)=>r=>e(t+r*(n-t))}let _o=0,_s;function _a(e){e!==_s&&(_s=e,console.warn(e),++_o)}function _l(e,t,n,r,{type:i,nice:o,clamp:s,domain:a=_n(r),unknown:l,pivot:c=0,scheme:h,range:u,symmetric:d=!0,interpolate:f=Me.get(e)===E3?null==h&&void 0!==u?S.N:M2(void 0!==h?h:"rdbu"):S.L,reverse:p}){c=+c;let[m,g]=a=Ep(a);if(a.length>2&&_a(`Warning: the diverging ${e} scale domain contains extra elements.`),0>(0,S.a8)(m,g)&&([m,g]=[g,m],p=!p),m=Math.min(m,c),g=Math.max(g,c),"function"!=typeof f&&(f=M8(f)),void 0!==u&&(f=1===f.length?_i(f)(...u):nR(f,u)),p&&(f=M3(f)),d){let e=n.apply(c),t=e-n.apply(m),r=n.apply(g)-e;t<r?m=n.invert(e-r):t>r&&(g=n.invert(e+t))}return t.domain([m,c,g]).unknown(l).interpolator(f),s&&t.clamp(s),o&&t.nice(o),{type:i,domain:[m,g],pivot:c,interpolate:f,scale:t}}function _c(e,t,{exponent:n=1,...r}){var i;return _l(e,(function e(){var t=oG(aI());return t.copy=function(){return aj(t,e()).exponent(t.exponent())},ox.apply(t,arguments)})().exponent(n=+n),.5===(i=n)?_d:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),i),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/i)},t,{...r,type:"diverging-pow"})}let _h={apply:e=>e,invert:e=>e},_u={apply:Math.log,invert:Math.exp},_d={apply:e=>Math.sign(e)*Math.sqrt(Math.abs(e)),invert:e=>e*e*Math.sign(e)},_f=Symbol("ordinal");function _p(e,t,n,{type:r,interval:i,domain:o,range:s,reverse:a,hint:l}){return i=EI(i,r),void 0===o&&(o=_g(n,i,e)),("categorical"===r||r===_f)&&(r="ordinal"),a&&(o=nr(o)),o=t.domain(o).domain(),void 0!==s&&("function"==typeof s&&(s=s(o)),t.range(s)),{type:r,domain:o,range:s,scale:t,hint:l,interval:i}}function _m(e,t,n,r){let{round:i}=n;return void 0!==i&&e.round(i=!!i),(e=_p(r,e,t,n)).round=i,e}function _g(e,t,n){let r=new tR;for(let{value:t,domain:n}of e){if(void 0!==n)return n();if(void 0!==t)for(let e of t)r.add(e)}if(void 0!==t){let[e,n]=t_(r).map(t.floor,t);return t.range(e,t.offset(n))}if(r.size>1e4&&Me.get(n)===E5)throw Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return tF(r,Aw)}function _y(e,t){let n;for(let{hint:r}of e){let e=null==r?void 0:r[t];if(void 0!==e){if(void 0===n)n=e;else if(n!==e)return}}return n}function _b(e,{label:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:o=n,insetLeft:s=n,round:a,nice:l,clamp:c,zero:d,align:f,padding:p,projection:m,facet:{label:g=t}={},...y}={}){let b={};for(let[n,v]of e){let e=y[n],x=function(e,t=[],n={}){var r,i,o,s,a;let l=function(e,t,{type:n,domain:r,range:i,scheme:o,pivot:s,projection:a}){var l;if(n=_A(n),"fx"===e||"fy"===e)return"band";for(let r of(("x"===e||"y"===e)&&null!=a&&(n=_E),t)){let e=_A(r.type);if(void 0!==e){if(void 0===n)n=e;else if(n!==e)throw Error(`scale incompatible with channel: ${n} !== ${e}`)}}if(n===_E)return;if(void 0!==n)return n;if(void 0===r&&!t.some(({value:e})=>void 0!==e))return;let c=Me.get(e);if(c===E4)return"sqrt";if(c===E8||c===E6)return"linear";if(c===E9)return"ordinal";let h=null==(l=r??i)?void 0:l.length;if(h<2||h>2)return _M(c);if(void 0!==r){if(EB(r))return _M(c);if(EF(r))return"utc"}else{let e=t.map(({value:e})=>e).filter(e=>void 0!==e);if(e.some(EB))return _M(c);if(e.some(EF))return"utc"}if(c===E3){if(null!=s||null!=o&&M5.has(`${o}`.toLowerCase()))return"diverging";if(null!=o&&MU.has(`${o}`.toLowerCase()))return"categorical"}return"linear"}(e,t,n);if(void 0===n.type&&void 0===n.domain&&void 0===n.range&&null==n.interval&&"fx"!==e&&"fy"!==e&&__({type:l})){let n=t.map(({value:e})=>e).filter(e=>void 0!==e);n.some(EF)?_a(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${_T(l)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${_T(l)}".`):n.some(EQ)?_a(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${_T(l)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${_T(l)}".`):n.some(EV)&&_a(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${_T(l)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${_T(l)}".`)}switch(n.type=l,l){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=_R(t,n,Eo);break;case"identity":switch(Me.get(e)){case E5:n=_R(t,n,Eo);break;case E9:n=_R(t,n,_P)}break;case"utc":case"time":n=_R(t,n,Ea)}switch(l){case"diverging":return r=n,_l(e,function e(){var t=oN(aI()(oT));return t.copy=function(){return aj(t,e())},ox.apply(t,arguments)}(),_h,t,r);case"diverging-sqrt":return _c(e,t,{...n,exponent:.5});case"diverging-pow":return _c(e,t,n);case"diverging-log":return function(e,t,{base:n=10,pivot:r=1,domain:i=_n(t,r<0?AT:AC),...o}){return _l(e,(function e(){var t=oB(aI()).domain([.1,1,10]);return t.copy=function(){return aj(t,e()).base(t.base())},ox.apply(t,arguments)})().base(n=+n),_u,t,{domain:i,pivot:r,...o})}(e,t,n);case"diverging-symlog":return function(e,t,{constant:n=1,...r}){return _l(e,(function e(){var t=oV(aI());return t.copy=function(){return aj(t,e()).constant(t.constant())},ox.apply(t,arguments)})().constant(n=+n),function(e){return{apply:t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),invert:t=>Math.sign(t)*Math.expm1(Math.abs(t))*e}}(n),t,r)}(e,t,n);case"categorical":case"ordinal":case _f:return function(e,t,{type:n,interval:r,domain:i,range:o,scheme:s,unknown:a,...l}){let c;if(r=EI(r,n),void 0===i&&(i=_g(t,r,e)),Me.get(e)===E9)c={fill:_y(t,"fill"),stroke:_y(t,"stroke")},o=void 0===o?EX(c.fill)?c_:cM:Eg(o,Mo);else if(Me.get(e)===E3&&(void 0===o&&("ordinal"===n||n===_f)&&void 0!==(o=function(e,t="greys"){let n=new Set,[r,i]=M0(t,2);for(let t of e)if(null!=t){if(!0===t)n.add(i);else{if(!1!==t)return;n.add(r)}}return[...n]}(i,s))&&(s=void 0),void 0===s&&void 0===o&&(s="ordinal"===n?"turbo":"observable10"),void 0!==s)){if(void 0!==o){let e=M2(s),t=o[0],n=o[1]-o[0];o=({length:r})=>nP(r=>e(t+n*r),r)}else o=MK(s)}if(a===ow)throw Error(`implicit unknown on ${e} scale is not supported`);return _p(e,ok().unknown(a),t,{...l,type:n,domain:i,range:o,hint:c})}(e,t,n);case"cyclical":case"sequential":case"linear":return i=n,M9(e,oR(),t,i);case"sqrt":return _e(e,t,{...n,exponent:.5});case"threshold":return _t(e,t,n);case"quantile":return function(e,t,{range:n,quantiles:r=void 0===n?5:(n=[...n]).length,n:i=r,scheme:o="rdylbu",domain:s=function(e){let t=[];for(let{value:n}of e)if(void 0!==n)for(let e of n)t.push(e);return t}(t),unknown:a,interpolate:l,reverse:c}){return void 0===n&&(n=void 0!==l?nP(l,i):Me.get(e)===E3?M0(o,i):void 0),s.length>0&&(s=(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=Array(t-1);++e<t;)i[e-1]=function(e,t,n=S.u){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(i-o)}}(n,e/t);return s}function s(e){return null==e||isNaN(e=+e)?t:r[(0,S.Y)(i,e)]}return s.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},s.domain=function(e){if(!arguments.length)return n.slice();for(let t of(n=[],e))null==t||isNaN(t=+t)||n.push(t);return n.sort(S.s),o()},s.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},s.unknown=function(e){return arguments.length?(t=e,s):t},s.quantiles=function(){return i.slice()},s.copy=function(){return e().domain(n).range(r).unknown(t)},ov.apply(s,arguments)})(s,void 0===n?{length:i}:n).quantiles()),_t(e,t,{domain:s,range:n,reverse:c,unknown:a})}(e,t,n);case"quantize":return function(e,t,{range:n,n:r=void 0===n?5:(n=[...n]).length,scheme:i="rdylbu",domain:o=_r(e,t),unknown:s,interpolate:a,reverse:l}){let c;let[h,u]=t_(o);return void 0===n?((c=tZ(h,u,r))[0]<=h&&c.splice(0,1),c[c.length-1]>=u&&c.pop(),r=c.length+1,n=void 0!==a?nP(a,r):Me.get(e)===E3?M0(i,r):void 0):(c=nP((0,S.L)(h,u),r+1).slice(1,-1),h instanceof Date&&(c=c.map(e=>new Date(e)))),0>A_(Ep(o))&&c.reverse(),_t(e,t,{domain:c,range:n,reverse:l,unknown:s})}(e,t,n);case"pow":return _e(e,t,n);case"log":return function(e,t,{base:n=10,domain:r=function(e){for(let{value:t}of e)if(void 0!==t)for(let n of t){if(n>0)return _n(e,AC);if(n<0)return _n(e,AT)}return[1,10]}(t),...i}){return M9(e,(function e(){let t=oB(oD()).domain([1,10]);return t.copy=()=>o_(t,e()).base(t.base()),ov.apply(t,arguments),t})().base(n),t,{...i,domain:r})}(e,t,n);case"symlog":return function(e,t,{constant:n=1,...r}){return M9(e,(function e(){var t=oV(oD());return t.copy=function(){return o_(t,e()).constant(t.constant())},ov.apply(t,arguments)})().constant(n),t,r)}(e,t,n);case"utc":return o=n,M9(e,function(){return ov.apply(aP(sb,sv,sg,sp,ss,o4,o5,o1,oK,u).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}(),t,o);case"time":return s=n,M9(e,function(){return ov.apply(aP(sx,sw,sm,sf,o9,o3,o2,o0,oK,h).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}(),t,s);case"point":return function(e,t,{align:n=.5,padding:r=.5,...i}){return _m((function(){return function e(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return e(n())},t}(oO.apply(null,arguments).paddingInner(1))})().align(n).padding(r),t,i,e)}(e,t,n);case"band":return function(e,t,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:o="fx"===e||"fy"===e?0:r,...s}){return _m(oO().align(n).paddingInner(i).paddingOuter(o),t,s,e)}(e,t,n);case"identity":return{type:"identity",scale:(a=Me.get(e))===E5||a===E4||a===E6||a===E8?function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,oS),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,oS):[0,1],oN(r)}():e=>e};case void 0:return;default:throw Error(`unknown scale type: ${l}`)}}(n,v,{round:Me.get(n)===E5?a:void 0,nice:l,clamp:c,zero:d,align:f,padding:p,projection:m,...e});if(x){let{label:a="fx"===n||"fy"===n?g:t,percent:l,transform:c,inset:h,insetTop:u=void 0!==h?h:"y"===n?r:0,insetRight:d=void 0!==h?h:"x"===n?i:0,insetBottom:f=void 0!==h?h:"y"===n?o:0,insetLeft:p=void 0!==h?h:"x"===n?s:0}=e||{};if(null==c)c=void 0;else if("function"!=typeof c)throw Error("invalid scale transform; not a function");x.percent=!!l,x.label=void 0===a?function(e=[],t){let n;for(let{label:t}of e)if(void 0!==t){if(void 0===n)n=t;else if(n!==t)return}if(void 0!==n)return!__(t)&&t.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}(v,x):a,x.transform=c,"x"===n||"fx"===n?(x.insetLeft=+p,x.insetRight=+d):("y"===n||"fy"===n)&&(x.insetTop=+u,x.insetBottom=+f),b[n]=x}}return b}function _v(e){let t={},n={scales:t};for(let[r,i]of Object.entries(e)){let{scale:e,type:o,interval:s,label:a}=i;t[r]=function({scale:e,type:t,domain:n,range:r,interpolate:i,interval:o,transform:s,percent:a,pivot:l}){if("identity"===t)return{type:"identity",apply:e=>e,invert:e=>e};let c=e.unknown?e.unknown():void 0;return{type:t,domain:Ey(n),...void 0!==r&&{range:Ey(r)},...void 0!==s&&{transform:s},...a&&{percent:a},...void 0!==c&&{unknown:c},...void 0!==o&&{interval:o},...void 0!==i&&{interpolate:i},...e.clamp&&{clamp:e.clamp()},...void 0!==l&&{pivot:l,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:t=>e(t),...e.invert&&{invert:t=>e.invert(t)}}}(i),n[r]=e,e.type=o,null!=s&&(e.interval=s),null!=a&&(e.label=a)}return n}function _x(e){let{marginTop:t,marginRight:n,marginBottom:r,marginLeft:i,width:o,height:s,facet:{marginTop:a,marginRight:l,marginBottom:c,marginLeft:h}}=e;return{marginTop:Math.max(t,a),marginRight:Math.max(n,l),marginBottom:Math.max(r,c),marginLeft:Math.max(i,h),width:o,height:s}}function _w({fx:e,fy:t},n){let{marginTop:r,marginRight:i,marginBottom:o,marginLeft:s,width:a,height:l}=_x(n);return{marginTop:r,marginRight:i,marginBottom:o,marginLeft:s,width:e?e.scale.bandwidth()+s+i:a,height:t?t.scale.bandwidth()+r+o:l,facet:{width:a,height:l}}}function _k(e,t){if(void 0===e.range){let{insetLeft:n,insetRight:r}=e,{width:i,marginLeft:o=0,marginRight:s=0}=t,a=o+n;e.range=[a,Math.max(a,i-s-r)],__(e)||(e.range=_C(e)),e.scale.range(e.range)}_S(e)}function _O(e,t){if(void 0===e.range){let{insetTop:n,insetBottom:r}=e,{height:i,marginTop:o=0,marginBottom:s=0}=t,a=o+n;e.range=[Math.max(a,i-s-r),a],__(e)?e.range.reverse():e.range=_C(e),e.scale.range(e.range)}_S(e)}function _S(e){void 0===e.round&&function({type:e}){return"point"===e||"band"===e}(e)&&30>=function({scale:e}){let t=e.domain().length,[n,r]=e.range(),i=e.paddingInner?e.paddingInner():1,o=e.paddingOuter?e.paddingOuter():e.padding(),s=t-i,a=Math.abs(r-n)/Math.max(1,s+2*o);return(a-Math.floor(a))*s}(e)&&e.scale.round(!0)}function _C(e){let t=e.scale.domain().length+_D(e);if(!(t>2))return e.range;let[n,r]=e.range;return Array.from({length:t},(e,i)=>n+i/(t-1)*(r-n))}function _T(e){return"symbol"==typeof e?e.description:e}function _A(e){return"string"==typeof e?`${e}`.toLowerCase():e}let _E={toString:()=>"projection"};function _M(e){switch(e){case E5:return"point";case E3:return _f;default:return"ordinal"}}function __({type:e}){return"ordinal"===e||"point"===e||"band"===e||e===_f}function _D({type:e}){return"threshold"===e}function _N(e){if(void 0===e)return!0;let t=e.domain(),n=e(t[0]);for(let r=1,i=t.length;r<i;++r)if(e(t[r])-n)return!1;return!0}function _R(e,{domain:t,...n},r){var i;for(let n of e)void 0!==n.value&&(void 0===t&&(t=null==(i=n.value)?void 0:i.domain),n.value=r(n.value));return{domain:void 0===t?t:r(t),...n}}function _P(e){return Eg(e,Mo)}function _j(e,{fx:t,fy:n}){let r=ET(e),i=null==t?void 0:t.value,o=null==n?void 0:n.value;return t&&n?tz(r,e=>(e.fx=i[e[0]],e.fy=o[e[0]],e),e=>i[e],e=>o[e]):t?tz(r,e=>(e.fx=i[e[0]],e),e=>i[e]):tz(r,e=>(e.fy=o[e[0]],e),e=>o[e])}let _I=new Map([["top",_B],["right",_V],["bottom",_F],["left",_Q],["top-left",_W(_B,_Q)],["top-right",_W(_B,_V)],["bottom-left",_W(_F,_Q)],["bottom-right",_W(_F,_V)],["top-empty",function(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;let o=_q(t,r);if(o>0)return _z(e,n,t[o-1])}],["right-empty",function(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;let o=_q(t,n);if(o<t.length-1)return _z(e,t[o+1],r)}],["bottom-empty",function(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;let o=_q(t,r);if(o<t.length-1)return _z(e,n,t[o+1])}],["left-empty",function(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;let o=_q(t,n);if(o>0)return _z(e,t[o-1],r)}],["empty",function(e,t,{empty:n}){return n}]]),_$=new WeakMap;function _L(e){let t=_$.get(e);return t||_$.set(e,t=new tN(Eg(e,(e,t)=>[e,t]))),t}function _q(e,t){return _L(e).get(t)}function _z(e,t,n){var r,i,o;return null==(i=t,o=n,i=EE(i),o=EE(o),r=e.find(e=>Object.is(EE(e.x),i)&&Object.is(EE(e.y),o)))?void 0:r.empty}function _B(e,{y:t},{y:n}){return!t||0===_q(t,n)}function _F(e,{y:t},{y:n}){return!t||_q(t,n)===t.length-1}function _Q(e,{x:t},{x:n}){return!t||0===_q(t,n)}function _V(e,{x:t},{x:n}){return!t||_q(t,n)===t.length-1}function _W(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function _U(e,{channels:{fx:t,fy:n},groups:r}){return t&&n?e.map(({x:e,y:t})=>{var n;return(null==(n=r.get(e))?void 0:n.get(t))??[]}):t?e.map(({x:e})=>r.get(e)??[]):e.map(({y:e})=>r.get(e)??[])}let _H=Math.PI,_G=2*_H;function _X(e){switch(`${e}`.toLowerCase()){case"albers-usa":return _Z(i0,.7463,.4673);case"albers":return _Y(iK,.7463,.4673);case"azimuthal-equal-area":return _Z(i3,4,4);case"azimuthal-equidistant":return _Z(i6,_G,_G);case"conic-conformal":return _Y(on,_G,_G);case"conic-equal-area":return _Y(iJ,6.1702,2.9781);case"conic-equidistant":return _Y(oa,7.312,3.6282);case"equal-earth":return _Z(oh,5.4133,2.6347);case"equirectangular":return _Z(oi,_G,_H);case"gnomonic":return _Z(od,3.4641,3.4641);case"identity":return{type:_J};case"reflect-y":return{type:_K};case"mercator":return _Z(i9,_G,_G);case"orthographic":return _Z(op,2,2);case"stereographic":return _Z(og,2,2);case"transverse-mercator":return _Z(ob,_G,_G);default:throw Error(`unknown projection type: ${e}`)}}function _Z(e,t,n){return{type:({width:r,height:i,rotate:o,precision:s=.15,clip:a})=>{var l,c,h;let u=e();return null!=s&&(null==(l=u.precision)||l.call(u,s)),null!=o&&(null==(c=u.rotate)||c.call(u,o)),"number"==typeof a&&(null==(h=u.clipAngle)||h.call(u,a)),null!=r&&(u.scale(Math.min(r/t,i/n)),u.translate([r/2,i/2])),u},aspectRatio:n/t}}function _Y(e,t,n){let{type:r,aspectRatio:i}=_Z(e,t,n);return{type:e=>{let{parallels:t,domain:n,width:i,height:o}=e,s=r(e);return null!=t&&(s.parallels(t),void 0===n&&null!=i&&s.fitSize([i,o],{type:"Sphere"})),s},aspectRatio:i}}let _J=Ei({stream:e=>e}),_K=Ei(iI({point(e,t){this.stream.point(e,-t)}}));function _0(e={}){let{document:t="u">typeof window?window.document:void 0,clip:n}=e;return{document:t,clip:E0(n)}}function _1(e,{document:t}){return na((0,S.aa)(e).call(t.documentElement))}let _2=Symbol("unset");function _5(e){return(1===e.length?function(e){let t,n=_2;return r=>(Object.is(n,r)||(n=r,t=e(r)),t)}:function(e){let t,n;return(...r)=>(((null==n?void 0:n.length)!==r.length||n.some((e,t)=>!Object.is(e,r[t])))&&(n=r,t=e(...r)),t)})(e)}let _3=_5(e=>new Intl.NumberFormat(e));_5((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{month:t}})),_5((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{weekday:t}}));let _4=function(e="en-US"){let t=function(e="en-US"){let t=_3(e);return e=>null==e||isNaN(e)?void 0:t.format(e)}(e);return e=>(e instanceof Date?function(e){return function(e,t){var n;if(e instanceof Date||(e=new Date(+e)),isNaN(e))return t;let r=e.getUTCHours(),i=e.getUTCMinutes(),o=e.getUTCSeconds(),s=e.getUTCMilliseconds();return`${(n=e.getUTCFullYear())<0?`-${AA(-n,6)}`:n>9999?`+${AA(n,6)}`:AA(n,4)}-${AA(e.getUTCMonth()+1,2)}-${AA(e.getUTCDate(),2)}${r||i||o||s?`T${AA(r,2)}:${AA(i,2)}${o||s?`:${AA(o,2)}${s?`.${AA(s,3)}`:""}`:""}Z`:""}`}(e,"Invalid Date")}:"number"==typeof e?t:Ee)(e)}(),_6=("u">typeof window?window.devicePixelRatio>1:typeof it>"u")?0:.5,_8=0;function _9(){return`plot-clip-${++_8}`}function _7(e,t){t&&e.text(e=>_4(t[e]))}function De(e,t){t&&e.text(([e])=>_4(t[e]))}function Dt(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:l,strokeWidth:c,opacity:h,href:u}){r&&Dc(e,"aria-label",e=>r[e]),o&&Dc(e,"fill",e=>o[e]),s&&Dc(e,"fill-opacity",e=>s[e]),a&&Dc(e,"stroke",e=>a[e]),l&&Dc(e,"stroke-opacity",e=>l[e]),c&&Dc(e,"stroke-width",e=>c[e]),h&&Dc(e,"opacity",e=>h[e]),u&&Dl(e,e=>u[e],t),n||i&&e.filter(e=>AO(i[e])).append("title").call(_7,i)}function Dn(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:l,strokeWidth:c,opacity:h,href:u}){r&&Dc(e,"aria-label",([e])=>r[e]),o&&Dc(e,"fill",([e])=>o[e]),s&&Dc(e,"fill-opacity",([e])=>s[e]),a&&Dc(e,"stroke",([e])=>a[e]),l&&Dc(e,"stroke-opacity",([e])=>l[e]),c&&Dc(e,"stroke-width",([e])=>c[e]),h&&Dc(e,"opacity",([e])=>h[e]),u&&Dl(e,([e])=>u[e],t),n||i&&e.filter(([e])=>AO(i[e])).append("title").call(De,i)}let Dr=function(e){let t=new WeakMap;return(n,r)=>{let i=t.get(n);if(!i){let o=_9();na(n.ownerSVGElement).append("clipPath").attr("id",o).call(e,n,r),t.set(n,i=`url(#${o})`)}return i}}((e,t,n)=>{let{width:r,height:i,marginLeft:o,marginRight:s,marginTop:a,marginBottom:l}=n;e.append("rect").attr("x",o).attr("y",a).attr("width",r-s-o).attr("height",i-a-l)}),Di=new WeakMap,Do={type:"Sphere"};function Ds(e,t,n,r){(function(e,t,n,r){let i;let{clip:o=r.clip}=t;"frame"===o?(e=_1("svg:g",r).each(function(){this.appendChild(e.node()),e.node=()=>this}),i=Dr(r,n)):o&&(i=function(e,t){let n,r;if((n=Di.get(t))||Di.set(t,n=new WeakMap),"Sphere"===e.type&&(e=Do),!(r=n.get(e))){let i=_9();na(t.ownerSVGElement).append("clipPath").attr("id",i).append("path").attr("d",t.path()(e)),n.set(e,r=`url(#${i})`)}return r}(o,r)),Dc(e,"aria-label",t.ariaLabel),Dc(e,"aria-description",t.ariaDescription),Dc(e,"aria-hidden",t.ariaHidden),Dc(e,"clip-path",i)})(e,t,n,r),Dc(e,"class",t.className),Dc(e,"fill",t.fill),Dc(e,"fill-opacity",t.fillOpacity),Dc(e,"stroke",t.stroke),Dc(e,"stroke-width",t.strokeWidth),Dc(e,"stroke-opacity",t.strokeOpacity),Dc(e,"stroke-linejoin",t.strokeLinejoin),Dc(e,"stroke-linecap",t.strokeLinecap),Dc(e,"stroke-miterlimit",t.strokeMiterlimit),Dc(e,"stroke-dasharray",t.strokeDasharray),Dc(e,"stroke-dashoffset",t.strokeDashoffset),Dc(e,"shape-rendering",t.shapeRendering),Dc(e,"filter",t.imageFilter),Dc(e,"paint-order",t.paintOrder);let{pointerEvents:i=!1===r.pointerSticky?"none":void 0}=t;Dc(e,"pointer-events",i)}function Da(e,t){var n,r;n="mix-blend-mode",null!=(r=t.mixBlendMode)&&e.style(n,r),Dc(e,"opacity",t.opacity)}function Dl(e,t,n){e.each(function(e){let r=t(e);if(null!=r){let e=this.ownerDocument.createElementNS(S.ab.svg,"a");e.setAttribute("fill","inherit"),e.setAttributeNS(S.ab.xlink,"href",r),null!=n&&e.setAttribute("target",n),this.parentNode.insertBefore(e,this).appendChild(this)}})}function Dc(e,t,n){null!=n&&e.attr(t,n)}function Dh(e,t,{x:n,y:r},i=_6,o=_6){i+=t.dx,o+=t.dy,null!=n&&n.bandwidth&&(i+=n.bandwidth()/2),null!=r&&r.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&e.attr("transform",`translate(${i},${o})`)}function Du(e,t){if((e=Ee(e))!==t)return e}function Dd(e,t){if((e=Et(e))!==t)return e}let Df=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Dp(e){if(void 0===e)return"plot-d6a7b5";if(e=`${e}`,!Df.test(e))throw Error(`invalid class name: ${e}`);return e}function Dm(e,t){if("string"==typeof t)e.property("style",t);else if(null!=t)for(let n of e)Object.assign(n.style,t)}function Dg({frameAnchor:e},{width:t,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:s}){return[/left$/.test(e)?s:/right$/.test(e)?t-i:(s+t-i)/2,/^top/.test(e)?r:/^bottom/.test(e)?n-o:(r+n-o)/2]}let Dy=class{constructor(e,t={},n={},r){let{facet:i="auto",facetAnchor:o,fx:s,fy:a,sort:l,dx:c=0,dy:h=0,margin:u=0,marginTop:d=u,marginRight:f=u,marginBottom:p=u,marginLeft:m=u,className:g,clip:y=null==r?void 0:r.clip,channels:b,tip:v,render:x}=n;if(this.data=e,this.sort=Ek(l)?l:null,this.initializer=Ma(n).initializer,this.transform=this.initializer?n.transform:Ms(n).transform,null===i||!1===i?this.facet=null:(this.facet=Ed(!0===i?"include":i,"facet",["auto","include","exclude","super"]),this.fx=e===A3&&"string"==typeof s?[s]:s,this.fy=e===A3&&"string"==typeof a?[a]:a),this.facetAnchor=function(e){if(null==e)return null;let t=_I.get(`${e}`.toLowerCase());if(t)return t;throw Error(`invalid facet anchor: ${e}`)}(o),t=EK(t),void 0!==b&&(t={...Object.fromEntries(Object.entries(EK(b)).map(([e,t])=>(void 0===(t="string"==typeof t?{value:t,label:e}:EL(t)).filter&&null==t.scale&&(t={...t,filter:null}),[e,t]))),...t}),void 0!==r&&(t={...function(e,{title:t,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:s,fill:a,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:u,strokeLinejoin:d,strokeLinecap:f,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:g,opacity:y,mixBlendMode:b,imageFilter:v,paintOrder:x,pointerEvents:w,shapeRendering:k,channels:O},{ariaLabel:S,fill:C="currentColor",fillOpacity:T,stroke:A="none",strokeOpacity:E,strokeWidth:M,strokeLinecap:_,strokeLinejoin:D,strokeMiterlimit:N,paintOrder:R}){var P;null===C&&(a=null,l=null),null===A&&(c=null,u=null),EX(C)?EX(A)||EX(a)&&(null==O||!O.fill)||(A="none"):EX(A)&&(!EX(c)||null!=O&&O.stroke)&&(C="none");let[j,I]=Ec(a,C),[$,L]=Eh(l,T),[q,B]=Ec(c,A),[F,Q]=Eh(u,E),[V,W]=Eh(y);EZ(B)||(void 0===h&&(h=M),void 0===f&&(f=_),void 0===d&&(d=D),void 0!==p||(P=d,/^\s*round\s*$/i.test(P))||(p=N),EZ(I)||void 0!==x||(x=R));let[U,H]=Eh(h);return null!==C&&(e.fill=Du(I,"currentColor"),e.fillOpacity=Dd(L,1)),null!==A&&(e.stroke=Du(B,"none"),e.strokeWidth=Dd(H,1),e.strokeOpacity=Dd(Q,1),e.strokeLinejoin=Du(d,"miter"),e.strokeLinecap=Du(f,"butt"),e.strokeMiterlimit=Dd(p,4),e.strokeDasharray=Du(m,"none"),e.strokeDashoffset=Du(g,"0")),e.target=Ee(s),e.ariaLabel=Ee(S),e.ariaDescription=Ee(i),e.ariaHidden=Ee(o),e.opacity=Dd(W,1),e.mixBlendMode=Du(b,"normal"),e.imageFilter=Du(v,"none"),e.paintOrder=Du(x,"normal"),e.pointerEvents=Du(w,"auto"),e.shapeRendering=Du(k,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:j,scale:"auto",optional:!0},fillOpacity:{value:$,scale:"auto",optional:!0},stroke:{value:q,scale:"auto",optional:!0},strokeOpacity:{value:F,scale:"auto",optional:!0},strokeWidth:{value:U,optional:!0},opacity:{value:V,scale:"auto",optional:!0}}}(this,n,r),...t}),this.channels=Object.fromEntries(Object.entries(t).map(([t,n])=>{if(Ew(n.value)){let{value:e,label:t=n.label,scale:r=n.scale}=n.value;n={...n,label:t,scale:r,value:e}}if(e===A3&&"string"==typeof n.value){let{value:e}=n;n={...n,value:[e]}}return[t,n]}).filter(([e,{value:t,optional:n}])=>{if(null!=t)return!0;if(n)return!1;throw Error(`missing channel value: ${e}`)})),this.dx=+c,this.dy=+h,this.marginTop=+d,this.marginRight=+f,this.marginBottom=+p,this.marginLeft=+m,this.clip=E0(y),this.tip=function(e){return!0===e?"xy":!1===e||null==e?null:"string"==typeof e?Ed(e,"tip",["x","y","xy"]):e}(v),this.className=Ee(g),"super"===this.facet){if(s||a)throw Error("super-faceting cannot use fx or fy");for(let e in this.channels){let{scale:n}=t[e];if(!("x"!==n&&"y"!==n))throw Error("super-faceting cannot use x or y")}}null!=x&&(this.render=Dv(x,this.render))}initialize(e,t,n){var r,i;let o=Ef(this.data);void 0===e&&null!=o&&(e=[ET(o)]);let s=e;null!=this.transform&&({facets:e,data:o}=this.transform(o,e,n),o=Ef(o)),void 0!==e&&(e.original=s);let a=(r=this.channels,i=o,Object.fromEntries(Object.entries(r).map(([e,t])=>[e,Mq(i,t,e)])));return null!=this.sort&&function(e,t,n,r,i){let{order:o,reverse:s,reduce:a=!0,limit:l}=i;for(let c in i){if(!Me.has(c))continue;let{value:h,order:u=o,reverse:d=s,reduce:f=a,limit:p=l}=EL(i[c]),m=null==h?void 0:h.startsWith("-");if(m&&(h=h.slice(1)),u=void 0===u?m!==("width"===h||"height"===h)?MV:MQ:function(e){if(null==e||"function"==typeof e)return e;switch(`${e}`.toLowerCase()){case"ascending":return MQ;case"descending":return MV}throw Error(`invalid order: ${e}`)}(u),null==f||!1===f)continue;let g="fx"===c||"fy"===c?function(e,t){let n=e.original;if(n===e)return t;let r=t.value,i=t.value=[];for(let t=0;t<n.length;++t){let o=r[n[t][0]];for(let n of e[t])i[n]=o}return t}(t,r[c]):function(e,t){for(let n in e){let r=e[n];if(r.scale===t)return r}}(n,c);if(!g)throw Error(`missing channel for scale: ${c}`);let y=g.value,[b=0,v=1/0]=Eq(p)?p:p<0?[p]:[0,p];if(null==h)g.domain=()=>{let e=Array.from(new tR(y));return d&&(e=e.reverse()),(0!==b||v!==1/0)&&(e=e.slice(b,v)),e};else{let t="data"===h?e:"height"===h?MB(n,"y1","y2"):"width"===h?MB(n,"x1","x2"):MF(n,h,"y"===h?"y2":"x"===h?"x2":void 0),r=Mb(!0===f?"max":f,t);g.domain=()=>{let e=function(e,t,...n){return tB(e,Array.from,t,n)}(ET(y),e=>r.reduceIndex(e,t),e=>y[e]);return u&&e.sort(u),d&&e.reverse(),(0!==b||v!==1/0)&&(e=e.slice(b,v)),e.map(En)}}}}(o,e,a,t,this.sort),{data:o,facets:e,channels:a}}filter(e,t,n){for(let r in t){let{filter:i=Ax}=t[r];if(null!==i){let t=n[r];e=e.filter(e=>i(t[e]))}}return e}project(e,t,n){for(let r in e)if("x"===e[r].scale&&/^x|x$/.test(r)){let i=r.replace(/^x|x$/,"y");i in e&&"y"===e[i].scale&&function(e,t,n,r){let i;let o=n[e],s=n[t],a=o.length,l=n[e]=new Float64Array(a).fill(NaN),c=n[t]=new Float64Array(a).fill(NaN),h=r.stream({point(e,t){l[i]=e,c[i]=t}});for(i=0;i<a;++i)h.point(o[i],s[i])}(r,i,t,n.projection)}}scale(e,t,n){let r=function(e,t){let n=Object.fromEntries(Object.entries(e).map(([e,{scale:n,value:r}])=>{let i=null==n?null:t[n];return[e,null==i?r:Eg(r,i)]}));return n.channels=e,n}(e,t);return n.projection&&this.project(e,r,n),r}};function Db(...e){return e.plot=Dy.prototype.plot,e}function Dv(e,t){if(null==e)return null===t?void 0:t;if(null==t)return null===e?void 0:e;if("function"!=typeof e)throw TypeError(`invalid render transform: ${e}`);if("function"!=typeof t)throw TypeError(`invalid render transform: ${t}`);return function(n,r,i,o,s,a){return e.call(this,n,r,i,o,s,(e,n,r,i,o)=>t.call(this,e,n,r,i,o,a))}}function Dx(e,t){return(null==e?void 0:e.tip)===!0?{...e,tip:t}:Ev(null==e?void 0:e.tip)&&void 0===e.tip.pointer?{...e,tip:{...e.tip,pointer:t}}:e}function Dw(e,t){let n;if(!t)throw Error(`aspectRatio requires ${e} scale`);let{type:r,domain:i}=t;switch(r){case"linear":case"utc":case"time":n=Number;break;case"pow":{let e=t.scale.exponent();n=t=>Math.pow(t,e);break}case"log":n=Math.log;break;case"point":case"band":return i.length;default:throw Error(`unsupported ${e} scale for aspectRatio: ${r}`)}let[o,s]=t_(i);return Math.abs(n(s)-n(o))}let Dk=new WeakMap;function DO(e,t,{x:n,y:r,px:i,py:o,maxRadius:s=40,channels:a,render:l,...c}={}){return s=+s,null!=i&&(n??(n=null),a={...a,px:{value:i,scale:"x"}}),null!=o&&(r??(r=null),a={...a,py:{value:o,scale:"y"}}),{x:n,y:r,channels:a,...c,render:Dv(function(n,r,i,o,a,l){let c,h,u,d,f;let p=(a={...a,pointerSticky:!1}).ownerSVGElement,{data:m}=a.getMarkState(this),g=Dk.get(p);g||Dk.set(p,g={sticky:!1,roots:[],renders:[]});let y=g.renders.push(N)-1,{x:b,y:v,fx:x,fy:w}=r,k=x?x(n.fx)-o.marginLeft:0,O=w?w(n.fy)-o.marginTop:0;null!=b&&b.bandwidth&&(k+=b.bandwidth()/2),null!=v&&v.bandwidth&&(O+=v.bandwidth()/2);let S=null!=n.fi;if(S){let e=g.facetStates;e||(g.facetStates=e=new Map),(c=e.get(this))||e.set(this,c=new Map)}let[C,T]=Dg(this,o),{px:A,py:E}=i,M=A?e=>A[e]:DA(i,C),_=E?e=>E[e]:DE(i,T);function D(e,t){if(S){if(f&&(f=cancelAnimationFrame(f)),null==e)c.delete(n.fi);else{c.set(n.fi,t),f=requestAnimationFrame(()=>{for(let[r,i]of(f=null,c))if(i<t||i===t&&r<n.fi){e=null;break}N(e)});return}}N(e)}function N(e){if(h===e&&d===g.sticky)return;h=e,d=a.pointerSticky=g.sticky;let t=null==h?[]:[h];S&&(t.fx=n.fx,t.fy=n.fy,t.fi=n.fi);let s=l(t,r,i,o,a);if(u){if(S){let e=u.parentNode,t=u.getAttribute("transform"),n=s.getAttribute("transform");t?s.setAttribute("transform",t):s.removeAttribute("transform"),n?e.setAttribute("transform",n):e.removeAttribute("transform"),s.removeAttribute("aria-label"),s.removeAttribute("aria-description"),s.removeAttribute("aria-hidden")}u.replaceWith(s)}if(g.roots[y]=u=s,!(null==h&&(null==c?void 0:c.size)>1)){let e=null==h?null:AX(m)?m[h]:m.get(h);a.dispatchValue(e)}return s}function R(r){if(g.sticky||"mouse"===r.pointerType&&1===r.buttons)return;let[i,a]=function(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}(r);i-=k,a-=O;let l=i<o.marginLeft||i>o.width-o.marginRight?1:e,c=a<o.marginTop||a>o.height-o.marginBottom?1:t,h=null,u=s*s;for(let e of n){let t=l*(M(e)-i),n=c*(_(e)-a),r=t*t+n*n;r<=u&&(h=e,u=r)}if(null!=h&&(1!==e||1!==t)){let e=M(h)-i,t=_(h)-a;u=e*e+t*t}D(h,u)}return p.addEventListener("pointerenter",R),p.addEventListener("pointermove",R),p.addEventListener("pointerdown",function(e){"mouse"===e.pointerType&&null!=h&&(g.sticky&&g.roots.some(t=>null==t?void 0:t.contains(e.target))||(g.sticky?(g.sticky=!1,g.renders.forEach(e=>e(null))):(g.sticky=!0,N(h)),e.stopImmediatePropagation()))}),p.addEventListener("pointerleave",function(e){"mouse"===e.pointerType&&(g.sticky||D(null))}),N(null)},l)}}function DS(e){return DO(1,1,e)}function DC(e){return DO(1,.01,e)}function DT(e){return DO(.01,1,e)}function DA({x1:e,x2:t,x:n=e},r){return e&&t?n=>(e[n]+t[n])/2:n?e=>n[e]:()=>r}function DE({y1:e,y2:t,y:n=e},r){return e&&t?n=>(e[n]+t[n])/2:n?e=>n[e]:()=>r}function DM(e){return __(e)&&void 0===e.interval?void 0:"tabular-nums"}let D_=Math.PI/180;function DD(e,{marker:t,markerStart:n=t,markerMid:r=t,markerEnd:i=t}={}){e.markerStart=DN(n),e.markerMid=DN(r),e.markerEnd=DN(i)}function DN(e){if(null==e||!1===e)return null;if(!0===e)return Dj;if("function"==typeof e)return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return DR("auto");case"arrow-reverse":return DR("auto-start-reverse");case"dot":return DP;case"circle":case"circle-fill":return Dj;case"circle-stroke":return DI;case"tick":return D$("auto");case"tick-x":return D$(90);case"tick-y":return D$(0)}throw Error(`invalid marker: ${e}`)}function DR(e){return(t,n)=>_1("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(e=>e.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function DP(e,t){return _1("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(e=>e.append("circle").attr("r",2.5)).node()}function Dj(e,t){return _1("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(e=>e.append("circle").attr("r",3)).node()}function DI(e,t){return _1("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",e).attr("stroke-width",1.5).call(e=>e.append("circle").attr("r",3)).node()}function D$(e){return(t,n)=>_1("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",e).attr("stroke",t).call(e=>e.append("path").attr("d","M0,-3v6")).node()}let DL=0;function Dq(e,t,{stroke:n},r){return DB(e,t,n&&(e=>n[e]),null,r)}function Dz(e,t,{stroke:n,z:r},i){return DB(e,t,n&&(([e])=>n[e]),r,i)}function DB(e,{markerStart:t,markerMid:n,markerEnd:r,stroke:i},o=()=>i,s,a){if(!t&&!n&&!r)return;let l=new Map,c=s&&function(e,t){let n=new Uint8Array(t.length),r=e.data().filter(e=>e.length>1),i=r.length;for(let e=0,o=_2;e<i;++e){let i=r[e];if(i.length>1){let e=i[0];o!==(o=EE(t[e]))&&(n[e]|=1)}}for(let e=i-1,o=_2;e>=0;--e){let i=r[e];if(i.length>1){let e=i[0];o!==(o=EE(t[e]))&&(n[e]|=2)}}return([e])=>n[e]}(e,s);function h(e,t,n){return function(r){if(n&&!n(r))return;let i=o(r),s=l.get(t);s||l.set(t,s=new Map);let c=s.get(i);if(!c){let e=this.parentNode.insertBefore(t(i,a),this),n=`plot-marker-${++DL}`;e.setAttribute("id",n),s.set(i,c=`url(#${n})`)}this.setAttribute(e,c)}}t&&e.each(h("marker-start",t,c&&(e=>1&c(e)))),n&&c&&e.each(h("marker-start",n,e=>!(1&c(e)))),n&&e.each(h("marker-mid",n)),r&&e.each(h("marker-end",r,c&&(e=>2&c(e))))}function DF({inset:e,insetLeft:t,insetRight:n,...r}={}){return[t,n]=DV(e,t,n),{inset:e,insetLeft:t,insetRight:n,...r}}function DQ({inset:e,insetTop:t,insetBottom:n,...r}={}){return[t,n]=DV(e,t,n),{inset:e,insetTop:t,insetBottom:n,...r}}function DV(e,t,n){return void 0===e&&void 0===t&&void 0===n?_6?[1,0]:[.5,.5]:[t,n]}function DW(e,{interval:t}){return(e={...EL(e)}).interval=Ej(void 0===e.interval?t:e.interval),e}function DU(e,t,n,r){let i,o;let{[e]:s,[`${e}1`]:a,[`${e}2`]:l}=n,{value:c,interval:h}=DW(s,n);if(null==c||null==h&&!r)return n;let u=ED(s);if(null==h){let t;let i={transform:e=>t||(t=AK(e,c)),label:u};return{...n,[e]:void 0,[`${e}1`]:void 0===a?i:a,[`${e}2`]:void 0!==l||a===l&&r?l:i}}function d(e){return void 0!==o&&e===i?o:o=Eg(AK(i=e,c),e=>h.floor(e))}return t({...n,[e]:void 0,[`${e}1`]:void 0===a?{transform:d,label:u}:a,[`${e}2`]:void 0===l?{transform:e=>d(e).map(e=>h.offset(e)),label:u}:l})}function DH(e,t,n){let{[e]:r}=n,{value:i,interval:o}=DW(r,n);return null==i||null==o?n:t({...n,[e]:{label:ED(r),transform:e=>{let t=Eg(AK(e,i),e=>o.floor(e)),n=t.map(e=>o.offset(e));return t.map(EF(t)?(e,t)=>null==e||isNaN(e=+e)||null==(t=n[t])||isNaN(t=+t)?void 0:new Date((e+t)/2):(e,t)=>null==e||null==(t=n[t])?NaN:(+e+ +t)/2)}}})}let DG={ariaLabel:"rule",fill:null,stroke:"currentColor"};class DX extends Dy{constructor(e,t={}){let{x:n,y1:r,y2:i,inset:o=0,insetTop:s=o,insetBottom:a=o}=t;super(e,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:i,scale:"y",optional:!0}},Dx(t,"x"),DG),this.insetTop=Et(s),this.insetBottom=Et(a),DD(this,t)}render(e,t,n,r,i){let{x:o,y:s}=t,{x:a,y1:l,y2:c}=n,{width:h,height:u,marginTop:d,marginRight:f,marginLeft:p,marginBottom:m}=r,{insetTop:g,insetBottom:y}=this;return _1("svg:g",i).call(Ds,this,r,i).call(Dh,this,{x:a&&o},_6,0).call(t=>t.selectAll().data(e).enter().append("line").call(Da,this).attr("x1",a?e=>a[e]:(p+h-f)/2).attr("x2",a?e=>a[e]:(p+h-f)/2).attr("y1",l&&!_N(s)?e=>l[e]+g:d+g).attr("y2",c&&!_N(s)?s.bandwidth?e=>c[e]+s.bandwidth()-y:e=>c[e]-y:u-m-y).call(Dt,this,n).call(Dq,this,n,i)).node()}}class DZ extends Dy{constructor(e,t={}){let{x1:n,x2:r,y:i,inset:o=0,insetRight:s=o,insetLeft:a=o}=t;super(e,{y:{value:i,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},Dx(t,"y"),DG),this.insetRight=Et(s),this.insetLeft=Et(a),DD(this,t)}render(e,t,n,r,i){let{x:o,y:s}=t,{y:a,x1:l,x2:c}=n,{width:h,height:u,marginTop:d,marginRight:f,marginLeft:p,marginBottom:m}=r,{insetLeft:g,insetRight:y}=this;return _1("svg:g",i).call(Ds,this,r,i).call(Dh,this,{y:a&&s},0,_6).call(t=>t.selectAll().data(e).enter().append("line").call(Da,this).attr("x1",l&&!_N(o)?e=>l[e]+g:p+g).attr("x2",c&&!_N(o)?o.bandwidth?e=>c[e]+o.bandwidth()-y:e=>c[e]-y:h-f-y).attr("y1",a?e=>a[e]:(d+u-m)/2).attr("y2",a?e=>a[e]:(d+u-m)/2).call(Dt,this,n).call(Dq,this,n,i)).node()}}function DY(e,t){let{x:n=A8,y:r,y1:i,y2:o,...s}=function(e={}){return DU("y",DQ,e)}(t);return[i,o]=DK(r,i,o),new DX(e,{...s,x:n,y1:i,y2:o})}function DJ(e,t){let{y:n=A8,x:r,x1:i,x2:o,...s}=function(e={}){return DU("x",DF,e)}(t);return[i,o]=DK(r,i,o),new DZ(e,{...s,y:n,x1:i,x2:o})}function DK(e,t,n){if(null==e){if(void 0===t){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,t]}else{if(void 0===t)return void 0===n?[0,e]:[e,n];if(void 0===n)return[e,t]}return[t,n]}function D0(e,...t){let n=t.length;for(let r=0,i=!0;r<n;++r)"function"!=typeof t[r]&&(i&&(e=e.slice(),i=!1),e.splice(r,2,e[r]+t[r]+e[r+1]),t.splice(r,1),--r,--n);return r=>{let i=e[0];for(let o=0;o<n;++o)i+=t[o](r)+e[o+1];return i}}let D1={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},D2=class extends Dy{constructor(e,t={}){let{x:n,y:r,text:i=Eq(e)&&Ez(e)?A8:A6,frameAnchor:o,textAnchor:s=/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle",lineAnchor:a=/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle",lineHeight:l=1,lineWidth:c=1/0,textOverflow:h,monospace:u,fontFamily:d=u?"ui-monospace, monospace":void 0,fontSize:f,fontStyle:p,fontVariant:m,fontWeight:g,rotate:y}=t,[b,v]=Eh(y,0),[x,w]=function(e){return null==e||"number"==typeof e?[void 0,e]:"string"!=typeof e?[e,void 0]:(e=e.trim().toLowerCase(),D7.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}(f);if(super(e,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:x,optional:!0},rotate:{value:function(e){return null==e?null:{transform:t=>AK(t,e,Float64Array),label:ED(e)}}(b),optional:!0},text:{value:i,filter:AO,optional:!0}},t,D1),this.rotate=v,this.textAnchor=Du(s,"middle"),this.lineAnchor=Ed(a,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+l,this.lineWidth=+c,this.textOverflow=D5(h),this.monospace=!!u,this.fontFamily=Ee(d),this.fontSize=w,this.fontStyle=Ee(p),this.fontVariant=Ee(m),this.fontWeight=Ee(g),this.frameAnchor=EJ(o),!(this.lineWidth>=0))throw Error(`invalid lineWidth: ${c}`);this.splitLines=Nr(this),this.clipLine=Ni(this)}render(e,t,n,r,i){let{x:o,y:s}=t,{x:a,y:l,rotate:c,text:h,title:u,fontSize:d}=n,{rotate:f}=this,[p,m]=Dg(this,r);return _1("svg:g",i).call(Ds,this,r,i).call(D9,this,h,r).call(Dh,this,{x:a&&o,y:l&&s}).call(t=>t.selectAll().data(e).enter().append("text").call(Da,this).call(D3,this,h,u).attr("transform",D0`translate(${a?e=>a[e]:p},${l?e=>l[e]:m})${c?e=>` rotate(${c[e]})`:f?` rotate(${f})`:""}`).call(Dc,"font-size",d&&(e=>d[e])).call(Dt,this,n)).node()}};function D5(e){return null==e?null:Ed(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function D3(e,t,n,r){if(!n)return;let{lineAnchor:i,lineHeight:o,textOverflow:s,splitLines:a,clipLine:l}=t;e.each(function(e){let t=a(_4(n[e])??"").map(l),c=t.length,h="top"===i?.71:"bottom"===i?1-c:(164-100*c)/200;if(c>1){let e=0;for(let n=0;n<c;++n){if(++e,!t[n])continue;let r=this.ownerDocument.createElementNS(S.ab.svg,"tspan");r.setAttribute("x",0),n===e-1?r.setAttribute("y",`${(h+n)*o}em`):r.setAttribute("dy",`${e*o}em`),r.textContent=t[n],this.appendChild(r),e=0}}else h&&this.setAttribute("y",`${h*o}em`),this.textContent=t[0];if(s&&!r&&t[0]!==n[e]){let t=this.ownerDocument.createElementNS(S.ab.svg,"title");t.textContent=n[e],this.appendChild(t)}})}function D4(e,{x:t,y:n,...r}={}){return void 0===r.frameAnchor&&([t,n]=EO(t,n)),new D2(e,{...r,x:t,y:n})}function D6(e,{x:t=A8,...n}={}){return new D2(e,function(e={}){return DH("y",DQ,e)}({...n,x:t}))}function D8(e,{y:t=A8,...n}={}){return new D2(e,function(e={}){return DH("x",DF,e)}({...n,y:t}))}function D9(e,t,n){Dc(e,"text-anchor",t.textAnchor),Dc(e,"font-family",t.fontFamily),Dc(e,"font-size",t.fontSize),Dc(e,"font-style",t.fontStyle),Dc(e,"font-variant",void 0===t.fontVariant?n&&(function(e){for(let t of e)if(null!=t)return"number"==typeof t}(n)||EF(n))?"tabular-nums":void 0:t.fontVariant),Dc(e,"font-weight",t.fontWeight)}let D7=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]),Ne={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"":31,"":31,"":47,"":47,"":82};function Nt(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=Nu(e,i))r+=Ne[e[i]]??(Nf(e,i)?120:Ne.e);return r}function Nn(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=Nu(e,i))r+=Nf(e,i)?126:63;return r}function Nr({monospace:e,lineWidth:t,textOverflow:n}){if(null!=n||t==1/0)return e=>e.split(/\r\n?|\n/g);let r=e?Nn:Nt,i=100*t;return e=>(function(e,t,n){let r=[],i,o=0;for(let[s,a,l]of function*(e){let t=0,n=0,r=e.length;for(;n<r;){let r=1;switch(e[n]){case"\xad":case"-":++n,yield[t,n,!1],t=n;break;case" ":for(yield[t,n,!1];" "===e[++n];);t=n;break;case"\r":e[n+1]===`
`&&++r;case`
`:yield[t,n,!0],n+=r,t=n;break;default:++n}}yield[t,n,!0]}(e)){if(void 0===i&&(i=s),o>i&&n(e,i,a)>t&&(r.push(e.slice(i,o)+("\xad"===e[o-1]?"-":"")),i=s),l){r.push(e.slice(i,a)),i=void 0;continue}o=a}return r})(e,i,r)}function Ni({monospace:e,lineWidth:t,textOverflow:n}){if(null==n||t==1/0)return e=>e;let r=e?Nn:Nt,i=100*t;switch(n){case"clip-start":return e=>Nl(e,i,r,"");case"clip-end":return e=>Na(e,i,r,"");case"ellipsis-start":return e=>Nl(e,i,r,No);case"ellipsis-middle":return e=>(function(e,t,n,r){let i=n(e=e.trim());if(i<=t)return e;let o=n(r)/2,[s,a]=Ns(e,t/2,n,o),[l]=Ns(e,i-t/2-a+o,n,-o);return l<0?r:e.slice(0,s).trimEnd()+r+e.slice(Nu(e,l)).trimStart()})(e,i,r,No);case"ellipsis-end":return e=>Na(e,i,r,No)}}let No="";function Ns(e,t,n,r){let i=[],o=0;for(let s=0,a=0,l=e.length;s<l;s=a){a=Nu(e,s);let l=n(e,s,a);if(o+l>t){for(o+=r;o>t&&s>0;)a=s,o-=n(e,s=i.pop(),a);return[s,t-o]}o+=l,i.push(s)}return[-1,0]}function Na(e,t,n,r){e=e.trim();let i=n(r),[o]=Ns(e,t,n,i);return o<0?e:e.slice(0,o).trimEnd()+r}function Nl(e,t,n,r){let i=n(e=e.trim());if(i<=t)return e;let o=n(r),[s]=Ns(e,i-t+o,n,-o);return s<0?r:r+e.slice(Nu(e,s)).trimStart()}let Nc=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,Nh=RegExp("\\p{Extended_Pictographic}","uy");function Nu(e,t){var n,r;return t+=!function(e,t){let n=e.charCodeAt(t);if(n>=55296&&n<56320){let n=e.charCodeAt(t+1);return n>=56320&&n<57344}return!1}(e,t)?1:2,!Nd(e,n=t)&&(Nc.lastIndex=n,Nc.test(e))&&(t=Nc.lastIndex),(r=t,8205===e.charCodeAt(r))?Nu(e,t+1):t}function Nd(e,t){return 128>e.charCodeAt(t)}function Nf(e,t){return!Nd(e,t)&&(Nh.lastIndex=t,Nh.test(e))}let Np={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Nm={draw(e,t,n){let r=t*n/17.5;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-r,r-t),e.lineTo(0,-t),e.lineTo(r,r-t)}},Ng=new Map([["arrow",Nm],["spike",{draw(e,t,n){e.moveTo(-n,0),e.lineTo(0,-t),e.lineTo(n,0)}}]]);class Ny extends Dy{constructor(e,t={}){let{x:n,y:r,r:i=3.5,length:o,rotate:s,shape:a=Nm,anchor:l="middle",frameAnchor:c}=t,[h,u]=Eh(o,12),[d,f]=Eh(s,0);super(e,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:h,scale:"length",optional:!0},rotate:{value:d,optional:!0}},t,Np),this.r=+i,this.length=u,this.rotate=f,this.shape=function(e){if(e&&"function"==typeof e.draw)return e;let t=Ng.get(`${e}`.toLowerCase());if(t)return t;throw Error(`invalid shape: ${e}`)}(a),this.anchor=Ed(l,"anchor",["start","middle","end"]),this.frameAnchor=EJ(c)}render(e,t,n,r,i){let{x:o,y:s}=t,{x:a,y:l,length:c,rotate:h}=n,{length:u,rotate:d,anchor:f,shape:p,r:m}=this,[g,y]=Dg(this,r);return _1("svg:g",i).call(Ds,this,r,i).call(Dh,this,{x:a&&o,y:l&&s}).call(t=>t.selectAll().data(e).enter().append("path").call(Da,this).attr("transform",D0`translate(${a?e=>a[e]:g},${l?e=>l[e]:y})${h?e=>` rotate(${h[e]})`:d?` rotate(${d})`:""}${"start"===f?"":"end"===f?c?e=>` translate(0,${c[e]})`:` translate(0,${u})`:c?e=>` translate(0,${c[e]/2})`:` translate(0,${u/2})`}`).attr("d",c?e=>{let t=nz();return p.draw(t,c[e],m),t}:(()=>{let e=nz();return p.draw(e,u,m),e})()).call(Dt,this,n)).node()}}function Nb(e,t={}){let{x:n=A8,...r}=t;return new Ny(e,{...r,x:n})}function Nv(e,t={}){let{y:n=A8,...r}=t;return new Ny(e,{...r,y:n})}function Nx(e,t){return arguments.length<2&&!Eq(e)&&(t=e,e=null),void 0===t&&(t={}),[e,t]}function Nw({anchor:e}={},t){return void 0===e?t[0]:Ed(e,"anchor",t)}function Nk(e){return Nw(e,["left","right"])}function NO(e){return Nw(e,["right","left"])}function NS(e){return Nw(e,["bottom","top"])}function NC(e){return Nw(e,["top","bottom"])}function NT(){let[e,t]=Nx(...arguments);return N_("y",Nk(t),e,t)}function NA(){let[e,t]=Nx(...arguments);return N_("fy",NO(t),e,t)}function NE(){let[e,t]=Nx(...arguments);return ND("x",NS(t),e,t)}function NM(){let[e,t]=Nx(...arguments);return ND("fx",NC(t),e,t)}function N_(e,t,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:s=i,strokeWidth:a=1,fill:l=r,fillOpacity:c=i,textAnchor:h,textStroke:u,textStrokeOpacity:d,textStrokeWidth:f,tickSize:p="y"===e?6:0,tickPadding:m,tickRotate:g,x:y,margin:b,marginTop:v=void 0===b?20:b,marginRight:x=void 0===b?"right"===t?40:0:b,marginBottom:w=void 0===b?20:b,marginLeft:k=void 0===b?"left"===t?40:0:b,label:O,labelAnchor:S,labelArrow:C,labelOffset:T,ariaLabel:A=`${e}-axis`,...E}){return p=Et(p),m=Et(m),g=Et(g),void 0!==S&&(S=Ed(S,"labelAnchor",["center","top","bottom"])),C=NZ(C),Db(p&&!EX(o)?function(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:s=t+("y"===e?"-empty":""),frameAnchor:a=t,tickSize:l,inset:c=0,insetLeft:h=c,insetRight:u=c,dx:d=0,y:f="y"===e?void 0:null,ariaLabel:p,...m}){return Nz(Nv,e,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:o,facetAnchor:s,frameAnchor:a,y:f,...m,dx:"left"===t?+d-_6+ +h:+d+_6-u,anchor:"start",length:l,shape:"left"===t?NU:NH})}(e,t,n,{stroke:o,strokeOpacity:s,strokeWidth:a,tickSize:p,tickPadding:m,tickRotate:g,x:y,ariaLabel:A,...E}):null,EX(l)?null:function(e,t,n,{facetAnchor:r=t+("y"===e?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:s=0,tickPadding:a=Math.max(3,9-o)+(Math.abs(s)>60?4*Math.cos(s*D_):0),text:l,textAnchor:c=Math.abs(s)>60?"middle":"left"===t?"end":"start",lineAnchor:h=s>60?"top":s<-60?"bottom":"middle",fontVariant:u,inset:d=0,insetLeft:f=d,insetRight:p=d,dx:m=0,ariaLabel:g,y:y="y"===e?void 0:null,...b}){return Nz(D8,e,n,{ariaLabel:`${g} tick label`},{facetAnchor:r,frameAnchor:i,text:l,textAnchor:c,lineAnchor:h,fontVariant:u,rotate:s,y:y,...b,dx:"left"===t?+m-o-a+ +f:+m+ +o+ +a-p},function(e,n,r,i,o){void 0===u&&(this.fontVariant=NG(e)),void 0===l&&(o.text=NB(e,n,r,i,t))})}(e,t,n,{fill:l,fillOpacity:c,stroke:u,strokeOpacity:d,strokeWidth:f,textAnchor:h,tickSize:p,tickPadding:m,tickRotate:g,x:y,marginTop:v,marginRight:x,marginBottom:w,marginLeft:k,ariaLabel:A,...E}),EX(l)||null===O?null:D4([],Nq({fill:l,fillOpacity:c,...E},function(n,r,i,o,s){let a=o[e],{marginTop:l,marginRight:c,marginBottom:h,marginLeft:u}="y"===e&&s.inset||s,d=S??(a.bandwidth?"center":"top"),f=T??("right"===t?c:u)-3;return"center"===d?(this.textAnchor=void 0,this.lineAnchor="right"===t?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor="right"===t?"end":"start",this.lineAnchor=d,this.frameAnchor=`${d}-${t}`,this.rotate=0),this.dy="top"===d?3-l:"bottom"===d?h-3:0,this.dx="right"===t?f:-f,this.ariaLabel=`${A} label`,{facets:[[0]],channels:{text:{value:[NX(e,a,{anchor:t,label:O,labelAnchor:d,labelArrow:C})]}}}})))}function ND(e,t,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:s=i,strokeWidth:a=1,fill:l=r,fillOpacity:c=i,textAnchor:h,textStroke:u,textStrokeOpacity:d,textStrokeWidth:f,tickSize:p="x"===e?6:0,tickPadding:m,tickRotate:g,y:y,margin:b,marginTop:v=void 0===b?"top"===t?30:0:b,marginRight:x=void 0===b?20:b,marginBottom:w=void 0===b?"bottom"===t?30:0:b,marginLeft:k=void 0===b?20:b,label:O,labelAnchor:S,labelArrow:C,labelOffset:T,ariaLabel:A=`${e}-axis`,...E}){return p=Et(p),m=Et(m),g=Et(g),void 0!==S&&(S=Ed(S,"labelAnchor",["center","left","right"])),C=NZ(C),Db(p&&!EX(o)?function(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:s=t+("x"===e?"-empty":""),frameAnchor:a=t,tickSize:l,inset:c=0,insetTop:h=c,insetBottom:u=c,dy:d=0,x:f="x"===e?void 0:null,ariaLabel:p,...m}){return Nz(Nb,e,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:o,strokeLinecap:i,facetAnchor:s,frameAnchor:a,x:f,...m,dy:"bottom"===t?+d-_6-u:+d+_6+ +h,anchor:"start",length:l,shape:"bottom"===t?NV:NW})}(e,t,n,{stroke:o,strokeOpacity:s,strokeWidth:a,tickSize:p,tickPadding:m,tickRotate:g,y:y,ariaLabel:A,...E}):null,EX(l)?null:function(e,t,n,{facetAnchor:r=t+("x"===e?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:s=0,tickPadding:a=Math.max(3,9-o)+(Math.abs(s)>=10?4*Math.cos(s*D_):0),text:l,textAnchor:c=Math.abs(s)>=10?s<0^"bottom"===t?"start":"end":"middle",lineAnchor:h=Math.abs(s)>=10?"middle":"bottom"===t?"top":"bottom",fontVariant:u,inset:d=0,insetTop:f=d,insetBottom:p=d,dy:m=0,x:g="x"===e?void 0:null,ariaLabel:y,...b}){return Nz(D6,e,n,{ariaLabel:`${y} tick label`},{facetAnchor:r,frameAnchor:i,text:void 0===l?null:l,textAnchor:c,lineAnchor:h,fontVariant:u,rotate:s,x:g,...b,dy:"bottom"===t?+m+ +o+ +a-p:+m-o-a+ +f},function(e,n,r,i,o){void 0===u&&(this.fontVariant=NG(e)),void 0===l&&(o.text=NB(e,n,r,i,t))})}(e,t,n,{fill:l,fillOpacity:c,stroke:u,strokeOpacity:d,strokeWidth:f,textAnchor:h,tickSize:p,tickPadding:m,tickRotate:g,y:y,marginTop:v,marginRight:x,marginBottom:w,marginLeft:k,ariaLabel:A,...E}),EX(l)||null===O?null:D4([],Nq({fill:l,fillOpacity:c,...E},function(n,r,i,o,s){let a=o[e],{marginTop:l,marginRight:c,marginBottom:h,marginLeft:u}="x"===e&&s.inset||s,d=S??(a.bandwidth?"center":"right"),f=T??("top"===t?l:h)-3;return"center"===d?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${d}`,this.textAnchor="right"===d?"end":"start"),this.lineAnchor=t,this.dy="top"===t?-f:f,this.dx="right"===d?c-3:"left"===d?3-u:0,this.ariaLabel=`${A} label`,{facets:[[0]],channels:{text:{value:[NX(e,a,{anchor:t,label:O,labelAnchor:d,labelArrow:C})]}}}})))}function NN(){let[e,t]=Nx(...arguments);return NI("y",Nk(t),e,t)}function NR(){let[e,t]=Nx(...arguments);return NI("fy",NO(t),e,t)}function NP(){let[e,t]=Nx(...arguments);return N$("x",NS(t),e,t)}function Nj(){let[e,t]=Nx(...arguments);return N$("fx",NC(t),e,t)}function NI(e,t,n,{y:r="y"===e?void 0:null,x:i=null,x1:o="left"===t?i:null,x2:s="right"===t?i:null,ariaLabel:a=`${e}-grid`,ariaHidden:l=!0,...c}){return Nz(DJ,e,n,{ariaLabel:a,ariaHidden:l},{y:r,x1:o,x2:s,...NL(c)})}function N$(e,t,n,{x:r="x"===e?void 0:null,y:i=null,y1:o="top"===t?i:null,y2:s="bottom"===t?i:null,ariaLabel:a=`${e}-grid`,ariaHidden:l=!0,...c}){return Nz(DY,e,n,{ariaLabel:a,ariaHidden:l},{x:r,y1:o,y2:s,...NL(c)})}function NL({color:e="currentColor",opacity:t=.1,stroke:n=e,strokeOpacity:r=t,strokeWidth:i=1,...o}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...o}}function Nq({fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:s,monospace:a,pointerEvents:l,shapeRendering:c,clip:h=!1},u){return[,e]=Ec(e),[,t]=Eh(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:s,monospace:a,pointerEvents:l,shapeRendering:c,clip:h,initializer:u}}function Nz(e,t,n,r,i,o){let s;let a=Ma(i).initializer,l=e(n,Ma({...i,initializer:function(e,n,r,a,l,c){let h=null==e&&("fx"===t||"fy"===t),{[t]:u}=a;if(!u)throw Error(`missing scale: ${t}`);let d=u.domain(),{interval:f,ticks:p,tickFormat:m,tickSpacing:g="x"===t?80:35}=i;if("string"==typeof p&&NY(u)&&(f=p,p=void 0),void 0===p&&(p=EI(f,u.type)??function(e,t){let[n,r]=t_(e.range());return(r-n)/t}(u,g)),null==e){if(Eq(p))e=Ep(p);else if(E$(p))e=NQ(p,...t_(d));else if(u.interval){let t=u.interval;if(u.ticks){let[n,r]=t_(d),i=(r-n)/t[Aj];e=NQ(t=AV(t,i/p)??t,n,r)}else(t=AV(t,(e=d).length/p)??t)!==u.interval&&(e=NQ(t,...t_(e)));if(t===u.interval){let t=Math.round(e.length/p);t>1&&(e=e.filter((e,n)=>n%t==0))}}else e=u.ticks?u.ticks(p):d;if(!u.ticks&&e.length&&e!==d){let n=new tR(d);(e=e.filter(e=>n.has(e))).length||_a(`Warning: the ${t}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}"y"===t||"x"===t?n=[ET(e)]:s[t]={scale:t,value:A8}}null==o||o.call(this,u,e,p,m,s);let y=Object.fromEntries(Object.entries(s).map(([t,n])=>[t,{...n,value:AK(e,n.value)}]));return h&&(n=c.filterFacets(e,y)),{data:e,facets:n,channels:y}}},a));return null==n?(s=l.channels,l.channels={}):s={},void 0!==r&&Object.assign(l,r),void 0===l.clip&&(l.clip=!1),l}function NB(e,t,n,r,i){return{value:NF(e,t,n,r,i)}}function NF(e,t,n,r,i){return"function"!=typeof r||"log"===e.type&&e.tickFormat?void 0===r&&t&&EF(t)?function(e,t,n){let r=t0(function(e,t=function(e,t){return[e,t]}){let n=[],r,i=!1;for(let o of e)i&&n.push(t(r,o)),r=o,i=!0;return n}(t,(e,t)=>Math.abs(t-e)));if(r<1e3)return AW("millisecond","utc",n);for(let[i,o,s,a]of"time"===e?AL:"utc"===e?A$:Aq){if(r>a||"hour"===i&&!r)break;if(t.every(e=>o.floor(e)>=e))return AW(i,s,n)}}(e.type,t,i)??_4:e.tickFormat?e.tickFormat("number"==typeof n?n:null,r):"string"==typeof r&&e.domain().length>0?(EF(e.domain())?u:rQ)(r):void 0===r?_4:Ei(r):r}function NQ(e,t,n){return e.range(t,e.offset(e.floor(n)))}let NV={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},NW={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},NU={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},NH={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function NG(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function NX(e,t,{anchor:n,label:r=t.label,labelAnchor:i,labelArrow:o}={}){if(!(null==r||r.inferred&&NY(t)&&/^(date|time|year)$/i.test(r))){if(r=String(r),"auto"===o&&(o=(!t.bandwidth||t.interval)&&!/[]/.test(r)),!o)return r;if(!0===o){let n=Math.sign(A_(t.domain()))*Math.sign(A_(t.range()));n&&(o=/x$/.test(e)||"center"===i?/x$/.test(e)===n<0?"left":"right":n<0?"up":"down")}switch(o){case"left":return` ${r}`;case"right":return`${r} `;case"up":return"right"===n?`${r} `:` ${r}`;case"down":return"right"===n?`${r} `:` ${r}`}return r}}function NZ(e="auto"){return!EX(e)&&("boolean"==typeof e?e:Ed(e,"labelArrow",["auto","up","right","down","left"]))}function NY(e){return EF(e.domain())}function NJ(e,t){if(null==t)return t;let n=e(t);if(!n)throw Error(`scale not found: ${t}`);return n}function NK(e,t={},n){let r,{columns:i,tickFormat:o,fontVariant:s=DM(e),swatchSize:a=15,swatchWidth:l=a,swatchHeight:c=a,marginLeft:h=0,className:u,style:d,width:f}=t,p=_0(t);u=Dp(u),o=NF(e.scale,e.domain,void 0,o);let m=_1("div",p).attr("class",`${u}-swatches ${u}-swatches-${null!=i?"columns":"wrap"}`);return null!=i?(r=`:where(.${u}-swatches-columns .${u}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${u}-swatches-columns .${u}-swatch::before) {
  flex-shrink: 0;
}
:where(.${u}-swatches-columns .${u}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,m.style("columns",i).selectAll().data(e.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,e,l,c).call(e=>e.append("div").attr("class",`${u}-swatch-label`).attr("title",o).text(o))):(r=`:where(.${u}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${u}-swatches-wrap .${u}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,m.selectAll().data(e.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,e,l,c).append(function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))})),m.call(e=>e.insert("style","*").text(`:where(.${u}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${u}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${r}`)).style("margin-left",h?`${+h}px`:null).style("width",void 0===f?null:`${+f}px`).style("font-variant",Du(s,"normal")).call(Dm,d).node()}let N0=new Map([["symbol",function(e,{fill:t=void 0!==(t=>null==(t=e.hint)?void 0:t.fill)()?e.hint.fill:"none",fillOpacity:n=1,stroke:r=void 0!==(t=>null==(t=e.hint)?void 0:t.stroke)()?e.hint.stroke:EX(t)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:o=1.5,r:s=4.5,...a}={},l){let[c,h]=Ec(t),[u,d]=Ec(r),f=NJ(l,c),p=NJ(l,u),m=s*s*Math.PI;return n=Eh(n)[1],i=Eh(i)[1],o=Eh(o)[1],NK(e,a,(t,r,s,a)=>t.append("svg").attr("viewBox","-8 -8 16 16").attr("width",s).attr("height",a).attr("fill","color"===c?e=>f.scale(e):h).attr("fill-opacity",n).attr("stroke","color"===u?e=>p.scale(e):d).attr("stroke-opacity",i).attr("stroke-width",o).append("path").attr("d",t=>{let n=nz();return e.scale(t).draw(n,m),n}))}],["color",N2],["opacity",function({type:e,interpolate:t,...n},{legend:r=!0,color:i=(0,S.$)(0,0,0),...o}){if(!t)throw Error(`${e} opacity scales are not supported`);if(!0===r&&(r="ramp"),"ramp"!==`${r}`.toLowerCase())throw Error(`${r} opacity legends are not supported`);return N2({type:e,...n,interpolate:function(e){let{r:t,g:n,b:r}=(0,S.$)(e)||(0,S.$)(0,0,0);return e=>`rgba(${t},${n},${r},${e})`}(i)},{legend:r,...o})}]]);function N1({className:e,...t},{label:n,ticks:r,tickFormat:i}={},o){return function(e={},...t){let n=e;for(let r of t)for(let t in r)if(void 0===n[t]){let i=r[t];n===e?n={...n,[t]:i}:n[t]=i}return n}(o,{className:e,...t},{label:n,ticks:r,tickFormat:i})}function N2(e,{legend:t=!0,...n}){if(!0===t&&(t="ordinal"===e.type?"swatches":"ramp"),void 0!==e.domain)switch(`${t}`.toLowerCase()){case"swatches":return function(e,{opacity:t,...n}={}){if(!__(e)&&!_D(e))throw Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return NK(e,n,(e,n,r,i)=>e.append("svg").attr("width",r).attr("height",i).attr("fill",n.scale).attr("fill-opacity",Eh(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}(e,n);case"ramp":return function(e,t){let{label:n=e.label,tickSize:r=6,width:i=240,height:o=44+r,marginTop:s=18,marginRight:a=0,marginBottom:l=16+r,marginLeft:c=0,style:h,ticks:u=(i-c-a)/64,tickFormat:d,fontVariant:f=DM(e),round:p=!0,opacity:m,className:g}=t,y=_0(t);g=Dp(g),m=Eh(m)[1],null===d&&(d=()=>null);let b=_1("svg",y).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).call(e=>e.append("style").text(`:where(.${g}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${g}-ramp text) {
  white-space: pre;
}`)).call(Dm,h),v=e=>e.selectAll(".tick line").attr("y1",s+l-o),x,w=p?(e,t)=>e.rangeRound(t):(e,t)=>e.range(t),{type:k,domain:O,range:C,interpolate:T,scale:A,pivot:E}=e;if(T){let e=void 0===C?T:nR(1===T.length?_i(T):T,C);x=w(A.copy(),nP((0,S.L)(c,i-a),Math.min(O.length+(void 0!==E),void 0===C?1/0:C.length)));let t=y.document.createElement("canvas");t.width=256,t.height=1;let n=t.getContext("2d");for(let t=0;t<256;++t)n.fillStyle=e(t/255),n.fillRect(t,0,1,1);b.append("image").attr("opacity",m).attr("x",c).attr("y",s).attr("width",i-c-a).attr("height",o-s-l).attr("preserveAspectRatio","none").attr("xlink:href",t.toDataURL())}else if("threshold"===k){let e=void 0===d?e=>e:"string"==typeof d?rQ(d):d;x=w(oR().domain([-1,C.length-1]),[c,i-a]),b.append("g").attr("fill-opacity",m).selectAll().data(C).enter().append("rect").attr("x",(e,t)=>x(t-1)).attr("y",s).attr("width",(e,t)=>x(t)-x(t-1)).attr("height",o-s-l).attr("fill",e=>e),u=Eg(O,(e,t)=>t),d=t=>e(O[t],t)}else x=w(oO().domain(O),[c,i-a]),b.append("g").attr("fill-opacity",m).selectAll().data(O).enter().append("rect").attr("x",x).attr("y",s).attr("width",Math.max(0,x.bandwidth()-1)).attr("height",o-s-l).attr("fill",A),v=()=>{};return b.append("g").attr("transform",`translate(0,${o-l})`).call((function(e,t){var n=[],r=null,i=null,o=6,s=6,a=3,l="u">typeof window&&window.devicePixelRatio>1?0:.5;function c(e){var c=r??(t.ticks?t.ticks.apply(t,n):t.domain()),h=i??(t.tickFormat?t.tickFormat.apply(t,n):ni),u=Math.max(o,0)+a,d=t.range(),f=+d[0]+l,p=+d[d.length-1]+l,m=(t.bandwidth?function(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}:function(e){return t=>+e(t)})(t.copy(),l),g=e.selection?e.selection():e,y=g.selectAll(".domain").data([null]),b=g.selectAll(".tick").data(c,t).order(),v=b.exit(),x=b.enter().append("g").attr("class","tick"),w=b.select("line"),k=b.select("text");y=y.merge(y.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),b=b.merge(x),w=w.merge(x.append("line").attr("stroke","currentColor").attr("y2",1*o)),k=k.merge(x.append("text").attr("fill","currentColor").attr("y",1*u).attr("dy","0.71em")),e!==g&&(y=y.transition(e),b=b.transition(e),w=w.transition(e),k=k.transition(e),v=v.transition(e).attr("opacity",1e-6).attr("transform",function(e){return isFinite(e=m(e))?no(e+l):this.getAttribute("transform")}),x.attr("opacity",1e-6).attr("transform",function(e){var t=this.parentNode.__axis;return no((t&&isFinite(t=t(e))?t:m(e))+l)})),v.remove(),y.attr("d",s?"M"+f+","+1*s+"V"+l+"H"+p+"V"+1*s:"M"+f+","+l+"H"+p),b.attr("opacity",1).attr("transform",function(e){return no(m(e)+l)}),w.attr("y2",1*o),k.attr("y",1*u).text(h),g.filter(ns).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),g.each(function(){this.__axis=m})}return c.scale=function(e){return arguments.length?(t=e,c):t},c.ticks=function(){return n=Array.from(arguments),c},c.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),c):n.slice()},c.tickValues=function(e){return arguments.length?(r=null==e?null:Array.from(e),c):r&&r.slice()},c.tickFormat=function(e){return arguments.length?(i=e,c):i},c.tickSize=function(e){return arguments.length?(o=s=+e,c):o},c.tickSizeInner=function(e){return arguments.length?(o=+e,c):o},c.tickSizeOuter=function(e){return arguments.length?(s=+e,c):s},c.tickPadding=function(e){return arguments.length?(a=+e,c):a},c.offset=function(e){return arguments.length?(l=+e,c):l},c})(0,x).ticks(Array.isArray(u)?null:u,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(r).tickValues(Array.isArray(u)?u:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Du(f,"normal")).call(v).call(e=>e.select(".domain").remove()),void 0!==n&&b.append("text").attr("x",c).attr("y",s-6).attr("fill","currentColor").attr("font-weight","bold").text(n),b.node()}(e,n);default:throw Error(`unknown legend type: ${t}`)}}let N5={length:!0};function N3(e,t){let n=0,r=0;for(let i of e){let e=t[i];e<n&&(n=e),e>r&&(r=e)}return[n,r]}function N4(e,t,n){for(let r of e)for(let e of r){let[r,i]=N3(e,n);for(let o of e){let e=1/(i-r||1);t[o]=e*(t[o]-r),n[o]=e*(n[o]-r)}}}function N6(e,t,n){for(let r of e){for(let e of r){let[r,i]=N3(e,n);for(let o of e){let e=(i+r)/2;t[o]-=e,n[o]-=e}}N9(r,t,n)}N7(e,t,n)}function N8(e,t,n,r){for(let i of e){let e=new tN,o=0;for(let s of i){let i=-1,a=s.map(e=>Math.abs(n[e]-t[e])),l=s.map(o=>{i=r?r[o]:++i;let s=n[o]-t[o],a=e.has(i)?s-e.get(i):0;return e.set(i,s),a}),c=[0,...function(e,t){var n=0;return Float64Array.from(e,e=>n+=+e||0)}(l)];for(let e of s)t[e]+=o,n[e]+=o;let h=nn(a);h&&(o-=nn(a,(e,t)=>(l[t]/2+c[t])*e)/h)}N9(i,t,n)}N7(e,t,n)}function N9(e,t,n){let r=t2(e,e=>t2(e,e=>t[e]));for(let i of e)for(let e of i)t[e]-=r,n[e]-=r}function N7(e,t,n){let r=e.length;if(1===r)return;let i=e.map(e=>e.flat()),o=i.map(e=>(t2(e,e=>t[e])+t0(e,e=>n[e]))/2),s=t2(o);for(let e=0;e<r;e++){let r=s-o[e];for(let o of i[e])t[o]+=r,n[o]+=r}}function Re(e){return Rn(e,(e,t,n,r)=>{let i=ET(e),o=tW(i,e=>t[t4(e,e=>n[e])],e=>r[e]),s=tz(i,e=>nn(e,e=>n[e]),e=>r[e]),a=[],l=[],c=0;for(let e of o)c<0?(c+=s.get(e),a.push(e)):(c-=s.get(e),l.push(e));return l.reverse().concat(a)})}function Rt(e){return t=>{let n=AK(t,e);return(e,t)=>Aw(n[e],n[t])}}function Rn(e,t){return(n,r,i,o)=>{if(!o)throw Error("missing channel: z");let s=new tN(t(n,r,i,o).map((e,t)=>[e,t]));return(t,n)=>e(s.get(o[t]),s.get(o[n]))}}let Rr={ariaLabel:"rect"};class Ri extends Dy{constructor(e,t={}){let{x1:n,y1:r,x2:i,y2:o}=t;super(e,{x1:{value:n,scale:"x",type:null!=n&&null==i?"band":void 0,optional:!0},y1:{value:r,scale:"y",type:null!=r&&null==o?"band":void 0,optional:!0},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},t,Rr),Ro(this,t),Rs(this,t)}render(e,t,n,r,i){let{x:o,y:s}=t,{x1:a,y1:l,x2:c,y2:h}=n,{marginTop:u,marginRight:d,marginBottom:f,marginLeft:p,width:m,height:g}=r,{projection:y}=i,{insetTop:b,insetRight:v,insetBottom:x,insetLeft:w}=this,{rx:k,ry:O,rx1y1:S,rx1y2:C,rx2y1:T,rx2y2:A}=this;(a||c)&&!y&&_N(o)&&(a=c=null),(l||h)&&!y&&_N(s)&&(l=h=null);let E=null!=o&&o.bandwidth?o.bandwidth():0,M=null!=s&&s.bandwidth?s.bandwidth():0;return _1("svg:g",i).call(Ds,this,r,i).call(Dh,this,{},0,0).call(t=>t.selectAll().data(e).enter().call(S||C||T||A?e=>e.append("path").call(Da,this).call(Ra,a&&c?e=>a[e]+(c[e]<a[e]?-v:w):a?e=>a[e]+w:p+w,l&&h?e=>l[e]+(h[e]<l[e]?-x:b):l?e=>l[e]+b:u+b,a&&c?e=>c[e]-(c[e]<a[e]?-w:v):a?e=>a[e]+E-v:m-d-v,l&&h?e=>h[e]-(h[e]<l[e]?-b:x):l?e=>l[e]+M-x:g-f-x,this).call(Dt,this,n):e=>e.append("rect").call(Da,this).attr("x",a?c?e=>Math.min(a[e],c[e])+w:e=>a[e]+w:p+w).attr("y",l?h?e=>Math.min(l[e],h[e])+b:e=>l[e]+b:u+b).attr("width",a?c?e=>Math.max(0,Math.abs(c[e]-a[e])+E-w-v):E-w-v:m-d-p-v-w).attr("height",l?h?e=>Math.max(0,Math.abs(l[e]-h[e])+M-b-x):M-b-x:g-u-f-b-x).call(Dc,"rx",k).call(Dc,"ry",O).call(Dt,this,n))).node()}}function Ro(e,{inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:o=t}={}){e.insetTop=Et(n),e.insetRight=Et(r),e.insetBottom=Et(i),e.insetLeft=Et(o)}function Rs(e,{r:t,rx:n,ry:r,rx1:i=t,ry1:o=t,rx2:s=t,ry2:a=t,rx1y1:l=void 0!==i?+i:void 0!==o?+o:0,rx1y2:c=void 0!==i?+i:void 0!==a?+a:0,rx2y1:h=void 0!==s?+s:void 0!==o?+o:0,rx2y2:u=void 0!==s?+s:void 0!==a?+a:0}={}){l||c||h||u?(e.rx1y1=l,e.rx1y2=c,e.rx2y1=h,e.rx2y2=u):(e.rx=Du(n,"auto"),e.ry=Du(r,"auto"))}function Ra(e,t,n,r,i,o){let{rx1y1:s,rx1y2:a,rx2y1:l,rx2y2:c}=o;"function"!=typeof t&&(t=Ei(t)),"function"!=typeof n&&(n=Ei(n)),"function"!=typeof r&&(r=Ei(r)),"function"!=typeof i&&(i=Ei(i));let h=Math.max(Math.abs(s+l),Math.abs(a+c)),u=Math.max(Math.abs(s+a),Math.abs(l+c));e.attr("d",e=>{let o=t(e),d=n(e),f=r(e),p=i(e),m=o>f,g=d>p,y=m?f:o,b=m?o:f,v=g?p:d,x=g?d:p,w=Math.min(1,(b-y)/h,(x-v)/u),k=w*(m?g?c:l:g?a:s),O=w*(m?g?a:s:g?c:l),S=w*(m?g?s:a:g?l:c),C=w*(m?g?l:c:g?s:a);return`M${y},${v+Rc(k,C)}A${k},${k} 0 0 ${k<0?0:1} ${y+Rl(k,C)},${v}H${b-Rl(O,S)}A${O},${O} 0 0 ${O<0?0:1} ${b},${v+Rc(O,S)}V${x-Rc(S,O)}A${S},${S} 0 0 ${S<0?0:1} ${b-Rl(S,O)},${x}H${y+Rl(C,k)}A${C},${C} 0 0 ${C<0?0:1} ${y},${x-Rc(C,k)}Z`})}function Rl(e,t){return t<0?e:Math.abs(e)}function Rc(e,t){return t<0?Math.abs(e):e}let Rh={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},Ru={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class Rd extends Dy{constructor(e={}){let{anchor:t=null}=e;super(A3,void 0,e,null==t?Rh:Ru),this.anchor=Eu(t,"anchor",["top","right","bottom","left"]),Ro(this,e),t||Rs(this,e)}render(e,t,n,r,i){let{marginTop:o,marginRight:s,marginBottom:a,marginLeft:l,width:c,height:h}=r,{anchor:u,insetTop:d,insetRight:f,insetBottom:p,insetLeft:m}=this,{rx:g,ry:y,rx1y1:b,rx1y2:v,rx2y1:x,rx2y2:w}=this,k=l+m,O=c-s-f,S=o+d,C=h-a-p;return _1(u?"svg:line":b||v||x||w?"svg:path":"svg:rect",i).datum(0).call(Ds,this,r,i).call(Da,this).call(Dt,this,n).call(Dh,this,{}).call("left"===u?e=>e.attr("x1",k).attr("x2",k).attr("y1",S).attr("y2",C):"right"===u?e=>e.attr("x1",O).attr("x2",O).attr("y1",S).attr("y2",C):"top"===u?e=>e.attr("x1",k).attr("x2",O).attr("y1",S).attr("y2",S):"bottom"===u?e=>e.attr("x1",k).attr("x2",O).attr("y1",C).attr("y2",C):b||v||x||w?e=>e.call(Ra,k,S,O,C,this):e=>e.attr("x",k).attr("y",S).attr("width",O-k).attr("height",C-S).attr("rx",g).attr("ry",y)).node()}}let Rf={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},Rp=new Set(["geometry","href","src","ariaLabel","scales"]);class Rm extends Dy{constructor(e,t={}){t.tip&&(t={...t,tip:!1}),void 0===t.title&&Eq(e)&&Ez(e)&&(t={...t,title:A8});let{x:n,y:r,x1:i,x2:o,y1:s,y2:a,anchor:l,preferredAnchor:c="bottom",monospace:h,fontFamily:u=h?"ui-monospace, monospace":void 0,fontSize:d,fontStyle:f,fontVariant:p,fontWeight:m,lineHeight:g=1,lineWidth:y=20,frameAnchor:b,format:v,textAnchor:x="start",textOverflow:w,textPadding:k=8,title:O,pointerSize:S=12,pathFilter:C="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=t;for(let v in super(e,{x:{value:null!=i&&null!=o?null:n,scale:"x",optional:!0},y:{value:null!=s&&null!=a?null:r,scale:"y",optional:!0},x1:{value:i,scale:"x",optional:null==o},y1:{value:s,scale:"y",optional:null==a},x2:{value:o,scale:"x",optional:null==i},y2:{value:a,scale:"y",optional:null==s},title:{value:O,optional:!0}},t,Rf),this.anchor=EY(l,"anchor"),this.preferredAnchor=EY(c,"preferredAnchor"),this.frameAnchor=EJ(b),this.textAnchor=Du(x,"middle"),this.textPadding=+k,this.pointerSize=+S,this.pathFilter=Ee(C),this.lineHeight=+g,this.lineWidth=+y,this.textOverflow=D5(w),this.monospace=!!h,this.fontFamily=Ee(u),this.fontSize=Et(d),this.fontStyle=Ee(f),this.fontVariant=Ee(p),this.fontWeight=Ee(m),Rf)v in this.channels&&(this[v]=Rf[v]);this.splitLines=Nr(this),this.clipLine=Ni(this),this.format="string"==typeof v||"function"==typeof v?{title:v}:{...v}}render(e,t,n,r,i){let o,s;let a=this,{x:l,y:c,fx:h,fy:u}=t,{ownerSVGElement:d,document:f}=i,{anchor:p,monospace:m,lineHeight:g,lineWidth:y}=this,{textPadding:b,pointerSize:v,pathFilter:x}=this,{marginTop:w,marginLeft:k}=r,{x1:O,y1:S,x2:C,y2:T,x:A=O??C,y:E=S??T}=n,M=h?h(e.fx)-k:0,_=u?u(e.fy)-w:0,[D,N]=Dg(this,r),R=DA(n,D),P=DE(n,N),j=m?Nn:Nt,I=j(No);"title"in n?(o=Rg.call(this,{title:n.channels.title},t),s=Rb):(o=Rg.call(this,n.channels,t),s=Rv);let $=_1("svg:g",i).call(Ds,this,r,i).call(D9,this).call(Dh,this,{x:A&&l,y:E&&c}).call(r=>r.selectAll().data(e).enter().append("g").attr("transform",e=>`translate(${Math.round(R(e))},${Math.round(P(e))})`).call(Da,this).call(e=>e.append("path").attr("filter",x)).call(r=>r.append("text").each(function(r){let i=na(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");let l=s.call(a,r,e,o,t,n);if("string"==typeof l)for(let e of a.splitLines(l))L(i,{value:a.clipLine(e)});else{let e=new Set;for(let t of l){let{label:n=""}=t;n&&e.has(n)||(e.add(n),L(i,t))}}})));function L(e,{label:t,value:n,color:r,opacity:i}){t??(t=""),n??(n="");let o=null!=r||null!=i,s,a=100*y,[l]=Ns(t,a,j,I);if(l>=0)t=t.slice(0,l).trimEnd()+No,s=n.trim(),n="";else{!t&&(n||o)||(n=" "+n);let[e]=Ns(n,a-j(t),j,I);e>=0&&(s=n.trim(),n=n.slice(0,e).trimEnd()+No)}let c=e.append("tspan").attr("x",0).attr("dy",`${g}em`).text("");t&&c.append("tspan").attr("font-weight","bold").text(t),n&&c.append(()=>f.createTextNode(n)),o&&c.append("tspan").text(" ").attr("fill",r).attr("fill-opacity",i).style("user-select","none"),s&&c.append("title").text(s)}function q(){let{width:e,height:t}=r.facet??r;$.selectChildren().each(function(n){var r,i;let{x:o,width:s,height:l}=this.getBBox();s=Math.round(s),l=Math.round(l);let c=p;if(void 0===c){let r=R(n)+M,i=P(n)+_,o=r+s+v+2*b<e,h=r-s-v-2*b>0,u=i+l+v+2*b<t,d=i-l-v-2*b>0;c=o&&h?u&&d?a.preferredAnchor:d?"bottom":"top":u&&d?o?"left":"right":(o||h)&&(u||d)?`${d?"bottom":"top"}-${o?"left":"right"}`:a.preferredAnchor}let h=this.firstChild,u=this.lastChild;if(h.setAttribute("d",function(e,t,n,r,i){let o=r+2*n,s=i+2*n;switch(e){case"middle":return`M${-o/2},${-s/2}h${o}v${s}h${-o}z`;case"top-left":return`M0,0l${t},${t}h${o-t}v${s}h${-o}z`;case"top":return`M0,0l${t/2},${t/2}h${(o-t)/2}v${s}h${-o}v${-s}h${(o-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-o}v${s}h${o}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-s/2}h${-o}v${s}h${o}v${t/2-s/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${o-t}v${-s}h${-o}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(o-t)/2}v${-s}h${-o}v${s}h${(o-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-o}v${-s}h${o}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-s/2}h${o}v${s}h${-o}v${t/2-s/2}z`}}(c,v,b,s,l)),o)for(let e of u.childNodes)e.setAttribute("x",-o);u.setAttribute("y",`${+(r=c,i=u.childNodes.length,/^top(?:-|$)/.test(r)?.94-g:-.29-i*g).toFixed(6)}em`),u.setAttribute("transform",`translate(${function(e,t,n,r,i){switch(e){case"middle":return[-r/2,i/2];case"top-left":return[n,t+n];case"top":return[-r/2,t/2+n];case"top-right":return[-r-n,t+n];case"right":return[-t/2-r-n,i/2];case"bottom-left":return[n,-t-n];case"bottom":return[-r/2,-t/2-n];case"bottom-right":return[-r-n,-t-n];case"left":return[n+t/2,i/2]}}(c,v,b,s,l)})`)}),$.attr("visibility",null)}return e.length&&($.attr("visibility","hidden"),d.isConnected?Promise.resolve().then(q):"u">typeof requestAnimationFrame&&requestAnimationFrame(q)),$.node()}}function Rg(e,t){var n,r;let i={},o=this.format;for(let t in o=Ry(o,e,"x"),o=Ry(o,e,"y"),this.format=o,o){let n=o[t];if(!(null===n||!1===n)){if("fx"===t||"fy"===t)i[t]=!0;else{let n=MW(e,t);n&&(i[t]=n)}}}for(let t in e){if(t in i||t in o||Rp.has(t)||("x"===t||"y"===t)&&e.geometry)continue;let n=MW(e,t);if(n){if(null==n.scale&&"color"===n.defaultScale)continue;i[t]=n}}for(let e in!this.facet||(!t.fx||"fx"in o||(i.fx=!0),!t.fy||"fy"in o||(i.fy=!0)),i){let o=this.format[e];if("string"==typeof o){let s=(null==(n=i[e])?void 0:n.value)??(null==(r=t[e])?void 0:r.domain())??[];this.format[e]=(EF(s)?u:rQ)(o)}else if(void 0===o||!0===o){let n=t[e];this.format[e]=null!=n&&n.bandwidth?NF(n,n.domain()):_4}}return i}function Ry(e,t,n){if(!(n in e))return e;let r=`${n}1`,i=`${n}2`;if((r in e||!(r in t))&&(i in e||!(i in t)))return e;let o=Object.entries(e),s=e[n];return o.splice(o.findIndex(([e])=>e===n)+1,0,[r,s],[i,s]),Object.fromEntries(o)}function Rb(e,t,{title:n}){return this.format.title(n.value[e],e)}function*Rv(e,t,n,r,i){for(let o in n){if("fx"===o||"fy"===o){yield{label:Rk(r,n,o),value:this.format[o](t[o],e)};continue}if("x1"===o&&"x2"in n||"y1"===o&&"y2"in n)continue;let s=n[o];if("x2"===o&&"x1"in n)yield{label:Rw(r,n,"x"),value:Rx(this.format.x2,n.x1,s,e)};else if("y2"===o&&"y1"in n)yield{label:Rw(r,n,"y"),value:Rx(this.format.y2,n.y1,s,e)};else{let t=s.value[e],a=s.scale;if(!Ax(t)&&null==a)continue;yield{label:Rk(r,n,o),value:this.format[o](t,e),color:"color"===a?i[o][e]:null,opacity:"opacity"===a?i[o][e]:null}}}}function Rx(e,t,n,r){var i;return null!=(i=n.hint)&&i.length?`${e(n.value[r]-t.value[r],r)}`:`${e(t.value[r],r)}${e(n.value[r],r)}`}function Rw(e,t,n){let r=Rk(e,t,`${n}1`,n),i=Rk(e,t,`${n}2`,n);return r===i?r:`${r}${i}`}function Rk(e,t,n,r=n){let i=t[n],o=e[(null==i?void 0:i.scale)??n];return String((null==o?void 0:o.label)??(null==i?void 0:i.label)??r)}function RO(e={}){let t,n;let{facet:r,style:i,title:o,subtitle:s,caption:a,ariaLabel:l,ariaDescription:c}=e,h=Dp(e.className),u=void 0===e.marks?[]:RC(e.marks);u.push(...function(e){let t=[];for(let n of e){let e=n.tip;if(e){!0===e?e={}:"string"==typeof e&&(e={pointer:e});let{pointer:r,preferredAnchor:i}=e;(e=(r=/^x$/i.test(r)?DC:/^y$/i.test(r)?DT:DS)(function(e,t={}){return Ma({...t,x:null,y:null},(t,n,r,i,o,s)=>s.getMarkState(e))}(n,e))).title=null,void 0===i&&(e.preferredAnchor=r===DT?"left":"bottom");let o=function(e,{x:t,y:n,...r}={}){return void 0===r.frameAnchor&&([t,n]=EO(t,n)),new Rm(e,{...r,x:t,y:n})}(n.data,e);o.facet=n.facet,o.facetAnchor=n.facetAnchor,t.push(o)}}return t}(u));let d=function(e,t){if(null==e)return;let{x:n,y:r}=e;if(null==n&&null==r)return;let i=Ef(e.data);if(null==i)throw Error("missing facet data");let o={};null!=n&&(o.fx=Mq(i,{value:n,scale:"fx"})),null!=r&&(o.fy=Mq(i,{value:r,scale:"fy"})),RE(o,t);let s=_j(i,o);return{channels:o,groups:s,data:e.data}}(r,e),f=new Map;for(let t of u){let n=RN(t,d,e);n&&f.set(t,n)}let p=new Map;d&&R_(p,[d],e),R_(p,f,e);let m=RC(function(e,t,n){let{projection:r,x:i={},y:o={},fx:s={},fy:a={},axis:l,grid:c,facet:h={},facet:{axis:u=l,grid:d}=h,x:{axis:f=l,grid:p=null===f?null:c}=i,y:{axis:m=l,grid:g=null===m?null:c}=o,fx:{axis:y=u,grid:b=null===y?null:d}=s,fy:{axis:v=u,grid:x=null===v?null:d}=a}=n;!r&&(Ex(i)||RI("x",e))||(f=p=null),!r&&(Ex(o)||RI("y",e))||(m=g=null),t.has("fx")||(y=b=null),t.has("fy")||(v=x=null),void 0===f&&(f=!Rj(e,"x")),void 0===m&&(m=!Rj(e,"y")),void 0===y&&(y=!Rj(e,"fx")),void 0===v&&(v=!Rj(e,"fy")),!0===f&&(f="bottom"),!0===m&&(m="left"),!0===y&&(y="top"===f||null===f?"bottom":"top"),!0===v&&(v="right"===m||null===m?"left":"right");let w=[];return RP(w,x,NR,a),RR(w,v,NA,"right","left",h,a),RP(w,b,Nj,s),RR(w,y,NM,"top","bottom",h,s),RP(w,g,NN,o),RR(w,m,NT,"left","right",n,o),RP(w,p,NP,i),RR(w,f,NE,"bottom","top",n,i),w}(u,p,e));for(let t of m){let n=RN(t,d,e);n&&f.set(t,n)}u.unshift(...m);let g=function(e,t){let{fx:n,fy:r}=_b(e,t),i=null==n?void 0:n.scale.domain(),o=null==r?void 0:r.scale.domain();return i&&o?(function(...e){var t;let n="function"==typeof e[e.length-1]&&(t=e.pop(),e=>t(...e)),r=(e=e.map(tA)).map(tC),i=e.length-1,o=Array(i+1).fill(0),s=[];if(i<0||r.some(tT))return s;for(;;){s.push(o.map((t,n)=>e[n][t]));let t=i;for(;++o[t]===r[t];){if(0===t)return n?s.map(n):s;o[t--]=0}}})(i,o).map(([e,t],n)=>({x:e,y:t,i:n})):i?i.map((e,t)=>({x:e,i:t})):o?o.map((e,t)=>({y:e,i:t})):void 0}(p,e);if(void 0!==g){let e=d?_U(g,d):void 0;for(let t of u){if(null===t.facet||"super"===t.facet)continue;let n=f.get(t);void 0!==n&&(n.facetsIndex=null!=t.fx||null!=t.fy?_U(g,n):e)}let t=new Set;for(let{facetsIndex:e}of f.values())null==e||e.forEach((e,n)=>{(null==e?void 0:e.length)>0&&t.add(n)});for(let e of(g.forEach(0<t.size&&t.size<g.length?(e,n)=>e.empty=!t.has(n):e=>e.empty=!1),u))if("exclude"===e.facet){let t=f.get(e);void 0!==t&&(t.facetsIndex=function(e){let t=[],n=new Uint32Array(nn(e,e=>e.length));for(let r of e){let i=0;for(let t of e)r!==t&&(n.set(t,i),i+=t.length);t.push(n.slice(0,i))}return t}(t.facetsIndex))}}for(let t of Me.keys())Ex(e[t])&&"fx"!==t&&"fy"!==t&&p.set(t,[]);let y=new Map;for(let t of u){if(y.has(t))throw Error("duplicate mark; each mark must be unique");let{facetsIndex:n,channels:r}=f.get(t)??{},{data:i,facets:o,channels:s}=t.initialize(n,r,e);RE(s,e),y.set(t,{data:i,facets:o,channels:s})}let b=_b(R_(p,y,e),e),v=function(e,t,n={}){let r=.5-_6,i=.5+_6,o=.5+_6,s=.5-_6;for(let{marginTop:e,marginRight:n,marginBottom:a,marginLeft:l}of t)e>r&&(r=e),n>i&&(i=n),a>o&&(o=a),l>s&&(s=l);let{margin:a,marginTop:l=void 0!==a?a:r,marginRight:c=void 0!==a?a:i,marginBottom:h=void 0!==a?a:o,marginLeft:u=void 0!==a?a:s}=n;l=+l;let{width:d=640,height:f=function({x:e,y:t,fy:n,fx:r},{projection:i,aspectRatio:o},{width:s,marginTopDefault:a,marginRightDefault:l,marginBottomDefault:c,marginLeftDefault:h}){let u=n&&n.scale.domain().length||1,d=function(e){if("function"==typeof(null==e?void 0:e.stream))return .618;if(Ev(e)){let t,n;if({domain:t,type:e,...n}=e,null!=t&&null!=e){let[[r,i],[o,s]]=ij(("string"==typeof e?_X(e).type:e)({...n,width:100,height:100})).bounds(t),a=(s-i)/(o-r);return a&&isFinite(a)?a<.2?.2:a>5?5:a:.618}}if(null!=e){if("function"!=typeof e){let{aspectRatio:t}=_X(e);if(t)return t}return .618}}(i);if(d)return Math.round((s-h-l)*Math.max(.1,Math.min(10,(1.1*u-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*d))+a+c);let f=t?__(t)?t.scale.domain().length||1:Math.max(7,17/u):1;if(null!=o){if(!(isFinite(o=+o)&&o>0))throw Error(`invalid aspectRatio: ${o}`);let i=Dw("y",t)/(Dw("x",e)*o),u=r?r.scale.bandwidth():1,d=n?n.scale.bandwidth():1;return(i*(u*(s-h-l)-e.insetLeft-e.insetRight)+t.insetTop+t.insetBottom)/d+a+c}return!!(t||n)*Math.max(1,Math.min(60,f*u))*20+30*!!r+60}(e,n,{width:d,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:o,marginLeftDefault:s})+Math.max(0,l-r+h-o)}=n,p={width:d=+d,height:f=+f,marginTop:l,marginRight:c=+c,marginBottom:h=+h,marginLeft:u=+u};if(e.fx||e.fy){let{margin:e,marginTop:t=void 0!==e?e:l,marginRight:r=void 0!==e?e:c,marginBottom:i=void 0!==e?e:h,marginLeft:o=void 0!==e?e:u}=n.facet??{};t=+t,r=+r,i=+i,o=+o,p.facet={marginTop:t,marginRight:r,marginBottom:i,marginLeft:o}}return p}(b,u,e);!function(e,t){let{x:n,y:r,fx:i,fy:o}=e,s=i||o?_x(t):t;i&&_k(i,s),o&&_O(o,s);let a=i||o?_w(e,t):t;n&&_k(n,a),r&&_O(r,a)}(b,v);let x=_v(b),{fx:w,fy:k}=x,O=w||k?_w(b,v):v,C=w||k?function({fx:e,fy:t},n){let{marginTop:r,marginRight:i,marginBottom:o,marginLeft:s,width:a,height:l}=_x(n),c=e&&R$(e),h=t&&R$(t);return{marginTop:t?h[0]:r,marginRight:e?a-c[1]:i,marginBottom:t?l-h[1]:o,marginLeft:e?c[0]:s,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:a,height:l}}(x,v):v,T=_0(e),A=T.document,E=(0,S.aa)("svg").call(A.documentElement),M=E;T.ownerSVGElement=E,T.className=h,T.projection=function({projection:e,inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:o=t}={},s){if(null==e)return;if("function"==typeof e.stream)return e;let a,l,c="frame";if(Ev(e)){let t;if({type:e,domain:l,inset:t,insetTop:n=void 0!==t?t:n,insetRight:r=void 0!==t?t:r,insetBottom:i=void 0!==t?t:i,insetLeft:o=void 0!==t?t:o,clip:c=c,...a}=e,null==e)return}"function"!=typeof e&&({type:e}=_X(e));let{width:h,height:u,marginLeft:d,marginRight:f,marginTop:p,marginBottom:m}=s,g=h-d-f-o-r,y=u-p-m-n-i;if(null==(e=null==e?void 0:e({width:g,height:y,clip:c,...a})))return;c=function(e,t,n,r,i){if(!1===e||null==e||"number"==typeof e)return e=>e;if(!0===e&&(e="frame"),"frame"===`${e}`.toLowerCase())return r$(t,n,r,i);throw Error(`unknown projection clip type: ${e}`)}(c,d,p,h-f,u-m);let b=d+o,v=p+n,x;if(null!=l){let[[t,n],[r,i]]=ij(e).bounds(l),o=Math.min(g/(r-t),y/(i-n));o>0?(b-=(o*(t+r)-g)/2,v-=(o*(n+i)-y)/2,x=iI({point(e,t){this.stream.point(e*o+b,t*o+v)}})):_a("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??(x=0===b&&0===v?_J():iI({point(e,t){this.stream.point(e+b,t+v)}})),{stream:t=>e.stream(x.stream(c(t)))}}(e,O),T.path=function(){return ij(this.projection??function({x:e,y:t}){if(e||t)return e??(e=e=>e),t??(t=e=>e),iI({point(n,r){this.stream.point(e(n),t(r))}})}(x))},T.filterFacets=(e,t)=>_U(g,{channels:t,groups:_j(e,t)}),T.getMarkState=e=>{let t=y.get(e),n=f.get(e);return{...t,channels:{...t.channels,...null==n?void 0:n.channels}}},T.dispatchValue=e=>{M.value!==e&&(M.value=e,M.dispatchEvent(new T.document.defaultView.Event("input",{bubbles:!0})))};let _=new Set;for(let[t,n]of y)if(null!=t.initializer){let r="super"===t.facet?C:O,i=t.initializer(n.data,n.facets,n.channels,x,r,T);if(void 0!==i.data&&(n.data=i.data),void 0!==i.facets&&(n.facets=i.facets),void 0!==i.channels){let{fx:r,fy:o,...s}=i.channels;for(let t of(function(e){for(let t in e)Mz(t,e[t])}(s),Object.assign(n.channels,s),Object.values(s))){let{scale:n}=t;null==n||(j=Me.get(n))===E5||j===E7||(RM(t,e),_.add(n))}(null!=r||null!=o)&&f.set(t,!0)}}if(_.size){let t=new Map;R_(t,y,e,e=>_.has(e)),R_(p,y,e,e=>_.has(e));let n=function(e,t){for(let n in e){let r=e[n],i=t[n];void 0===r.label&&i&&(r.label=i.label)}return e}(_b(t,e),b),{scales:r,...i}=_v(n);Object.assign(b,n),Object.assign(x,i),Object.assign(x.scales,r)}for(let[e,r]of(void 0!==g&&(t={x:null==w?void 0:w.domain(),y:null==k?void 0:k.domain()},g=function(e,{x:t,y:n}){return t&&(t=_L(t)),n&&(n=_L(n)),e.filter(t&&n?e=>t.has(e.x)&&n.has(e.y):t?e=>t.has(e.x):e=>n.has(e.y)).sort(t&&n?(e,r)=>t.get(e.x)-t.get(r.x)||n.get(e.y)-n.get(r.y):t?(e,n)=>t.get(e.x)-t.get(n.x):(e,t)=>n.get(e.y)-n.get(t.y))}(g,t),n=function(e,t,{marginTop:n,marginLeft:r}){let i=e?({x:t})=>e(t)-r:()=>0,o=t?({y:e})=>t(e)-n:()=>0;return function(e){"svg"===this.tagName?(this.setAttribute("x",i(e)),this.setAttribute("y",o(e))):this.setAttribute("transform",`translate(${i(e)},${o(e)})`)}}(w,k,v)),y))r.values=e.scale(r.channels,x,T);let{width:D,height:N}=v;for(let e of(na(E).attr("class",h).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",D).attr("height",N).attr("viewBox",`0 0 ${D} ${N}`).attr("aria-label",l).attr("aria-description",c).call(e=>e.append("style").text(`:where(.${h}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${h} text),
:where(.${h} tspan) {
  white-space: pre;
}`)).call(Dm,i),u)){let{channels:r,values:i,facets:o}=y.get(e);if(void 0===g||"super"===e.facet){let t=null;if(o&&(t=o[0],0===(t=e.filter(t,r,i)).length))continue;let n=e.render(t,x,i,C,T);if(null==n)continue;E.appendChild(n)}else{let s;for(let n of g){if(!((null==(P=e.facetAnchor)?void 0:P.call(e,g,t,n))??!n.empty))continue;let a=null;if(o){let t=f.has(e);if(a=o[t?n.i:0],0===(a=e.filter(a,r,i)).length)continue;var R,P,j,I,$=void 0,L=void 0;t||a!==o[0]||(a=(I=a).subarray?I.subarray(void 0,void 0):I.slice($,L)),a.fx=n.x,a.fy=n.y,a.fi=n.i}let l=e.render(a,x,i,O,T);if(null!=l)for(let e of((s??(s=na(E).append("g"))).append(()=>l).datum(n),["aria-label","aria-description","aria-hidden","transform"]))l.hasAttribute(e)&&(s.attr(e,l.getAttribute(e)),l.removeAttribute(e))}null==s||s.selectChildren().each(n)}}let q=function(e,t,n){let r=[];for(let[i,o]of N0){let s=n[i];if(null!=s&&s.legend&&i in e){let n=o(e[i],N1(t,e[i],s),t=>e[t]);null!=n&&r.push(n)}}return r}(b,T,e),{figure:B=null!=o||null!=s||null!=a||q.length>0}=e;B&&((M=A.createElement("figure")).className=`${h}-figure`,M.style.maxWidth="initial",null!=o&&M.append(RS(A,o,"h2")),null!=s&&M.append(RS(A,s,"h3")),M.append(...q,E),null!=a&&M.append(function(e,t){let n=e.createElement("figcaption");return n.append(t),n}(A,a)),"value"in E&&(M.value=E.value,delete E.value)),M.scale=(R=x.scales,e=>{if(!Me.has(e=`${e}`))throw Error(`unknown scale: ${e}`);return R[e]}),M.legend=function(e,t,n={}){return(r,i)=>{if(!N0.has(r))throw Error(`unknown legend type: ${r}`);if(r in e)return N0.get(r)(e[r],N1(t,n[r],i),t=>e[t])}}(b,T,e);let F=function(){let e=_o;return _o=0,_s=void 0,e}();return F>0&&na(E).append("text").attr("x",D).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("").append("title").text(`${F.toLocaleString("en-US")} warning${1===F?"":"s"}. Please check the console.`),M}function RS(e,t,n){if(t.ownerDocument)return t;let r=e.createElement(n);return r.append(t),r}function RC(e){return e.flat(1/0).filter(e=>null!=e).map(RT)}function RT(e){return"function"==typeof e.render?e:new RA(e)}class RA extends Dy{constructor(e){if("function"!=typeof e)throw TypeError("invalid mark; missing render function");super(),this.render=e}render(){}}function RE(e,t){for(let n in e)RM(e[n],t);return e}function RM(e,t){let{scale:n,transform:r=!0}=e;if(null==n||!r)return;let{type:i,percent:o,interval:s,transform:a=o?e=>null==e?NaN:100*e:EP(s,i)}=t[n]??{};null!=a&&(e.value=Eg(e.value,a),e.transform=!1)}function R_(e,t,n,r=A7){var i,o;for(let{channels:s}of t.values())for(let t in s){let a=s[t],{scale:l}=a;if(null!=l&&r(l)){if("projection"===l){if(!function({projection:e}={}){return null!=e&&("function"==typeof e.stream||(Ev(e)&&(e=e.type),null!=e))}(n)){let t=(null==(i=n.x)?void 0:i.domain)===void 0,r=(null==(o=n.y)?void 0:o.domain)===void 0;if(t||r){let[n,i]=function(e){let t=[],n=[],r={point(e,r){t.push(e),n.push(r)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(let t of e.value)rd(t,r);return[{scale:"x",value:t},{scale:"y",value:n}]}(a);t&&RD(e,"x",n),r&&RD(e,"y",i)}}}else RD(e,l,a)}}return e}function RD(e,t,n){let r=e.get(t);void 0!==r?r.push(n):e.set(t,[n])}function RN(e,t,n){if(null===e.facet||"super"===e.facet)return;let{fx:r,fy:i}=e;if(null!=r||null!=i){let t=Ef(e.data??r??i);if(void 0===t)throw Error(`missing facet data in ${e.ariaLabel}`);if(null===t)return;let o={};return null!=r&&(o.fx=Mq(t,{value:r,scale:"fx"})),null!=i&&(o.fy=Mq(t,{value:i,scale:"fy"})),RE(o,n),{channels:o,groups:_j(t,o)}}if(void 0===t)return;let{channels:o,groups:s,data:a}=t;if("auto"!==e.facet||e.data===a)return{channels:o,groups:s};a.length>0&&(s.size>1||1===s.size&&o.fx&&o.fy&&[...s][0][1].size>1)&&EC(Ef(e.data))===EC(a)&&_a(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isnt faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function RR(e,t,n,r,i,o,s){if(!t)return;let a=/^\s*both\s*$/i.test(t),{line:l}=s=function(e,t,{line:n=t.line,ticks:r,tickSize:i,tickSpacing:o,tickPadding:s,tickFormat:a,tickRotate:l,fontVariant:c,ariaLabel:h,ariaDescription:u,label:d=t.label,labelAnchor:f,labelArrow:p=t.labelArrow,labelOffset:m}){return{anchor:e,line:n,ticks:r,tickSize:i,tickSpacing:o,tickPadding:s,tickFormat:a,tickRotate:l,fontVariant:c,ariaLabel:h,ariaDescription:u,label:d,labelAnchor:f,labelArrow:p,labelOffset:m}}(a?r:t,o,s);(n===NT||n===NE)&&l&&!EZ(l)&&e.push(new Rd(function(e){let{anchor:t,line:n}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:!0===n?void 0:n}}(s))),e.push(n(s)),a&&e.push(n({...s,anchor:i,label:null}))}function RP(e,t,n,r){!t||EZ(t)||e.push(n(function(e,{stroke:t=EH(e)?e:void 0,ticks:n=!function(e){switch(typeof e){case"number":return!0;case"string":return!EH(e)}return Eq(e)||"function"==typeof(null==e?void 0:e.range)}(e)?void 0:e,tickSpacing:r,ariaLabel:i,ariaDescription:o}){return{stroke:t,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:o}}(t,r)))}function Rj(e,t){let n=`${t}-axis `;return e.some(e=>{var t;return null==(t=e.ariaLabel)?void 0:t.startsWith(n)})}function RI(e,t){for(let n of t)for(let t in n.channels){let{scale:r}=n.channels[t];if(r===e||"projection"===r)return!0}return!1}function R$(e){let t=e.domain();if(0===t.length)return[0,e.bandwidth()];let n=e(t[0]),r=e(t[t.length-1]);return r<n&&([n,r]=[r,n]),[n,r+e.bandwidth()]}let RL=new Map([["basis",function(e){return new cR(e)}],["basis-closed",function(e){return new cP(e)}],["basis-open",function(e){return new cj(e)}],["bundle",c$],["bump-x",function(e){return new ci(e,!0)}],["bump-y",function(e){return new ci(e,!1)}],["cardinal",cz],["cardinal-closed",cF],["cardinal-open",cV],["catmull-rom",cH],["catmull-rom-closed",cX],["catmull-rom-open",cY],["linear",ct],["linear-closed",function(e){return new cJ(e)}],["monotone-x",function(e){return new c2(e)}],["monotone-y",function(e){return new c5(e)}],["natural",function(e){return new c4(e)}],["step",function(e){return new c8(e,.5)}],["step-after",function(e){return new c8(e,1)}],["step-before",function(e){return new c8(e,0)}]]);function Rq(e){return ct(e)}function Rz(e={y:"count"},t={}){[e,t]=function({cumulative:e,domain:t,thresholds:n,interval:r,...i},o){return[i,{cumulative:e,domain:t,thresholds:n,interval:r,...o}]}(e,t);let{x:n,y:r}=t;return function(e,t,n,r,{data:i=ME,filter:o=MN,sort:s,reverse:a,...l}={},c={}){e=RB(e),t=RB(t),l=Mp(l,c,RF),i=RV(i,A8),s=null==s?void 0:RF("sort",s,c),o=null==o?void 0:RQ("filter",o,c),null!=r&&Mf(l,"y","y1","y2")&&(r=null);let[h,u]=E_(e),[d,f]=E_(e),[p,m]=E_(t),[g,y]=E_(t),[b,v]=null!=r?[r,"y"]:[],[x,w]=E_(b),{x:k,y:O,z:S,fill:C,stroke:T,x1:A,x2:E,y1:M,y2:_,domain:D,cumulative:N,thresholds:R,interval:P,...j}=c,[I,$]=E_(S),[L]=Ec(C),[q]=Ec(T),[B,F]=E_(L),[Q,V]=E_(q);return{..."z"in c&&{z:I||S},..."fill"in c&&{fill:B||C},..."stroke"in c&&{stroke:Q||T},...Ms(j,(n,r,c)=>{let h=ER(AK(n,b),null==c?void 0:c[v]),d=AK(n,S),p=AK(n,L),g=AK(n,q),x=MS(l,{z:d,fill:p,stroke:g}),k=[],O=[],C=h&&w([]),T=d&&$([]),A=p&&F([]),E=g&&V([]),M=e&&u([]),_=e&&f([]),D=t&&m([]),N=t&&y([]),R=function(e,t,n){let r=null==e?void 0:e(n),i=null==t?void 0:t(n);return r&&i?function*(e){let t=r.bin(e);for(let[e,[o,s]]of r.entries()){let r=i.bin(t[e]);for(let[e,[t,a]]of i.entries())yield[r[e],{data:n,x1:o,y1:t,x2:s,y2:a}]}}:r?function*(e){let t=r.bin(e);for(let[e,[i,o]]of r.entries())yield[t[e],{data:n,x1:i,x2:o}]}:function*(e){let t=i.bin(e);for(let[e,[r,o]]of i.entries())yield[t[e],{data:n,y1:r,y2:o}]}}(e,t,n),P=0;for(let e of l)e.initialize(n);for(let e of(s&&s.initialize(n),o&&o.initialize(n),r)){let t=[];for(let t of l)t.scope("facet",e);for(let[r,a]of(s&&s.scope("facet",e),o&&o.scope("facet",e),My(e,x)))for(let[e,c]of My(a,h))for(let[a,u]of R(c))if(x&&(u.z=r),!(o&&!o.reduce(a,u))){for(let o of(t.push(P++),O.push(i.reduceIndex(a,n,u)),h&&C.push(e),d&&T.push(x===d?r:d[(a.length>0?a:c)[0]]),p&&A.push(x===p?r:p[(a.length>0?a:c)[0]]),g&&E.push(x===g?r:g[(a.length>0?a:c)[0]]),M&&(M.push(u.x1),_.push(u.x2)),D&&(D.push(u.y1),N.push(u.y2)),l))o.reduce(a,u);s&&s.reduce(a,u)}k.push(t)}return MC(k,s,a),{data:O,facets:k}}),...!Mf(l,"x")&&(h?{x1:h,x2:d,x:EN(h,d)}:{x:k,x1:A,x2:E}),...!Mf(l,"y")&&(p?{y1:p,y2:g,y:EN(p,g)}:{y:O,y1:M,y2:_}),...x&&{[v]:x},...Object.fromEntries(l.map(({name:e,output:t})=>[e,t]))}}(function(e,{cumulative:t,domain:n,thresholds:r,interval:i},o){return void 0===(e={...EL(e)}).domain&&(e.domain=n),void 0===e.cumulative&&(e.cumulative=t),void 0===e.thresholds&&(e.thresholds=r),void 0===e.interval&&(e.interval=i),void 0===e.value&&(e.value=o),e.thresholds=function(e,t,n=RU){if(void 0===e)return void 0===t?n:EI(t);if("string"==typeof e){switch(e.toLowerCase()){case"freedman-diaconis":return t8;case"scott":return t9;case"sturges":return tK;case"auto":return RU}return AF(e)}return e}(e.thresholds,e.interval),e}(n,t,A8),null,0,r,e,DF(t))}function RB(e){if(null==e)return;let{value:t,cumulative:n,domain:r=t_,thresholds:i}=e,o=e=>{var o;let s=AK(e,t),a;if(EF(s)||E$(o=i)&&"function"==typeof(null==o?void 0:o.floor)&&o.floor()instanceof Date||Eq(o)&&EF(o)){s=Eg(s,El,Float64Array);let[e,t]="function"==typeof r?r(s):r,n="function"!=typeof i||E$(i)?i:i(s,e,t);"number"==typeof n&&(n=sv(e,t,n)),E$(n)&&(r===t_&&(e=n.floor(e),t=n.offset(n.floor(t))),n=n.range(e,n.offset(t))),a=n}else{s=Eo(s);let[e,t]="function"==typeof r?r(s):r,n="function"!=typeof i||E$(i)?i:i(s,e,t);if("number"==typeof n){if(r===t_){let r=tY(e,t,n);if(isFinite(r)){if(r>0){let i=Math.round(e/r),o=Math.round(t/r);i*r<=e||--i,o*r>t||++o;let s=o-i+1;n=new Float64Array(s);for(let e=0;e<s;++e)n[e]=(i+e)*r}else if(r<0){let i=Math.round(e*(r=-r)),o=Math.round(t*r);i/r<=e||--i,o/r>t||++o;let s=o-i+1;n=new Float64Array(s);for(let e=0;e<s;++e)n[e]=(i+e)/r}else n=[e]}else n=[e]}else n=tZ(e,t,n)}else E$(n)&&(r===t_&&(e=n.floor(e),t=n.offset(n.floor(t))),n=n.range(e,n.offset(t)));a=n}let l=[];if(1===a.length)l.push([a[0],a[0]]);else for(let e=1;e<a.length;++e)l.push([a[e-1],a[e]]);return l.bin=(n<0?function(e,t,n){let r=RH(e,t,n);return e=>{let t=r(e);for(let e=t.length-2;e>=0;--e){let n=t[e+1],r=t[e];for(let e of n)r.push(e)}return t}}:n>0?function(e,t,n){let r=RH(e,t,n);return e=>{let t=r(e);for(let e=1,n=t.length;e<n;++e){let n=t[e-1],r=t[e];for(let e of n)r.push(e)}return t}}:RH)(l,a,s),l};return o.label=ED(t),o}function RF(e,t,n){return Mm(e,t,n,RQ)}function RQ(e,t,n){return Mg(e,t,n,RV)}function RV(e,t){return Mb(e,t,RW)}function RW(e){switch(`${e}`.toLowerCase()){case"x":return RX;case"x1":return RY;case"x2":return RJ;case"y":return RZ;case"y1":return RK;case"y2":return R0;case"z":return ML}throw Error(`invalid bin reduce: ${e}`)}function RU(e,t,n){return Math.min(200,t9(e,t,n))}function RH(e,t,n){return t=Eo(t),r=>{var i;let o=e.map(()=>[]);for(let e of r)null==(i=o[(0,S.Y)(t,n[e])-1])||i.push(e);return o}}function RG(e,t){let n=(+e+ +t)/2;return e instanceof Date?new Date(n):n}let RX={reduceIndex:(e,t,{x1:n,x2:r})=>RG(n,r)},RZ={reduceIndex:(e,t,{y1:n,y2:r})=>RG(n,r)},RY={reduceIndex:(e,t,{x1:n})=>n},RJ={reduceIndex:(e,t,{x2:n})=>n},RK={reduceIndex:(e,t,{y1:n})=>n},R0={reduceIndex:(e,t,{y2:n})=>n},R1={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};class R2 extends Dy{constructor(e,t={}){let{x:n,y:r,r:i,rotate:o,symbol:s=ca,frameAnchor:a}=t,[l,c]=Eh(o,0),[h,u]=function(e){if(null==e||Mr(e))return[void 0,e];if("string"==typeof e){let t=Mn.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}(s),[d,f]=Eh(i,null==h?3:4.5);super(e,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:d,scale:"r",filter:AC,optional:!0},rotate:{value:l,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},function(e){return void 0===e.sort&&void 0===e.reverse?function(e,{sort:t,...n}={}){return{...(Ew(e)&&void 0!==e.channel?Ma:function(e,t){return(null!=e.initializer?Ma:Ms)(e,t)})(n,Md(e)),sort:Ek(t)?t:null}}({channel:"-r"},e):e}(t),R1),this.r=f,this.rotate=c,this.symbol=u,this.frameAnchor=EJ(a);let{channels:p}=this,{symbol:m}=p;if(m){let{fill:e,stroke:t}=p;m.hint={fill:e?e.value===m.value?"color":"currentColor":this.fill??"currentColor",stroke:t?t.value===m.value?"color":"currentColor":this.stroke??"none"}}}render(e,t,n,r,i){let{x:o,y:s}=t,{x:a,y:l,r:c,rotate:h,symbol:u}=n,{r:d,rotate:f,symbol:p}=this,[m,g]=Dg(this,r),y=p===ca,b=c?void 0:d*d*Math.PI;return AT(d)&&(e=[]),_1("svg:g",i).call(Ds,this,r,i).call(Dh,this,{x:a&&o,y:l&&s}).call(t=>t.selectAll().data(e).enter().append(y?"circle":"path").call(Da,this).call(y?e=>{e.attr("cx",a?e=>a[e]:m).attr("cy",l?e=>l[e]:g).attr("r",c?e=>c[e]:d)}:e=>{e.attr("transform",D0`translate(${a?e=>a[e]:m},${l?e=>l[e]:g})${h?e=>` rotate(${h[e]})`:f?` rotate(${f})`:""}`).attr("d",c&&u?e=>{let t=nz();return u[e].draw(t,c[e]*c[e]*Math.PI),t}:c?e=>{let t=nz();return p.draw(t,c[e]*c[e]*Math.PI),t}:u?e=>{let t=nz();return u[e].draw(t,b),t}:(()=>{let e=nz();return p.draw(e,b),e})())}).call(Dt,this,n)).node()}}let R5={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class R3 extends Dy{constructor(e,t={}){let{x:n,y:r,z:i,curve:o,tension:s}=t;super(e,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:ES(t),optional:!0}},t,R5),this.z=i,this.curve=function(e=Rq,t){return"function"!=typeof e&&"auto"===`${e}`.toLowerCase()?Rq:function(e=ct,t){if("function"==typeof e)return e;let n=RL.get(`${e}`.toLowerCase());if(!n)throw Error(`unknown curve: ${e}`);if(void 0!==t){if("beta"in n)return n.beta(t);if("tension"in n)return n.tension(t);if("alpha"in n)return n.alpha(t)}return n}(e,t)}(o,s),DD(this,t)}filter(e){return e}project(e,t,n){this.curve!==Rq&&super.project(e,t,n)}render(e,t,n,r,i){let{x:o,y:s}=n,{curve:a}=this;return _1("svg:g",i).call(Ds,this,r,i).call(Dh,this,t).call(t=>{var r,l,c;return t.selectAll().data(function*(e,t,n,r){let{z:i}=n,{z:o}=r,s=function({ariaLabel:e,title:t,fill:n,fillOpacity:r,stroke:i,strokeOpacity:o,strokeWidth:s,opacity:a,href:l},{tip:c}){return[e,c?void 0:t,n,r,i,o,s,a,l].filter(e=>void 0!==e)}(r,n),a=[...t,...s];for(let t of o?function(e,t,n){let r=tq(e,e=>t[e]);return void 0===n&&r.size>1+e.length>>1&&_a("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}(e,o,i):[e]){let e,n;e:for(let r of t){for(let e of a)if(!Ax(e[r])){n&&n.push(-1);continue e}if(void 0===e){n&&(yield n),e=s.map(e=>EE(e[r])),n=[r];continue}n.push(r);for(let t=0;t<s.length;++t)if(EE(s[t][r])!==e[t]){yield n,e=s.map(e=>EE(e[r])),n=[r];continue e}}n&&(yield n)}}(e,[o,s],this,n)).enter().append("path").call(Da,this).call(Dn,this,n).call(Dz,this,n,i).attr("d",a===Rq&&i.projection?(r=i.path(),l=o,c=s,l=Eo(l),c=Eo(c),e=>{let t=[],n=[t];for(let r of e)-1===r?(t=[],n.push(t)):t.push([l[r],c[r]]);return r({type:"MultiLineString",coordinates:n})}):(function(e,t){let n;var r=l5(!0),i=null,o=ct,s=null,a=(n=3,l.digits=function(e){if(!arguments.length)return n;if(null==e)n=null;else{let t=Math.floor(e);if(!(t>=0))throw RangeError(`invalid digits: ${e}`);n=t}return l},()=>new nq(n));function l(n){var l,c,h,u,d=(n="object"==typeof(l=n)&&"length"in l?l:Array.from(l)).length,f=!1;for(null==i&&(s=o(u=a())),c=0;c<=d;++c)!(c<d&&r(h=n[c],c,n))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(h,c,n),+t(h,c,n));if(u)return s=null,u+""||null}return e="function"==typeof e?e:void 0===e?cn:l5(e),t="function"==typeof t?t:void 0===t?cr:l5(t),l.x=function(t){return arguments.length?(e="function"==typeof t?t:l5(+t),l):e},l.y=function(e){return arguments.length?(t="function"==typeof e?e:l5(+e),l):t},l.defined=function(e){return arguments.length?(r="function"==typeof e?e:l5(!!e),l):r},l.curve=function(e){return arguments.length?(o=e,null!=i&&(s=o(i)),l):o},l.context=function(e){return arguments.length?(null==e?i=s=null:s=o(i=e),l):i},l})().curve(a).defined(e=>e>=0).x(e=>o[e]).y(e=>s[e]))}).node()}}Dy.prototype.plot=function({marks:e=[],...t}={}){return RO({...t,marks:[...e,this]})};let R4={type:"line",x:null,y:null,xLabel:"X Axis",yLabel:"Y Axis",backgroundColor:"transparent",fontSize:12,title:"",lineWidth:3,pointColor:"steelblue",yAxisUnitLabel:"",yAxisUnitPosition:"suffix",showLabels:!1,margin:{top:20,right:20,bottom:120,left:50},dateFormat:"%Y-%m-%d",color:{legend:!0}},R6=(e,t,n,r,i)=>{var o,s,a,l,c,h,u,d;if(0===e.width||0===e.height||!t.x||!t.y||Array.isArray(t.y)&&0===t.y.length)return null;let f=t.filter?n.filter(t.filter):n,p=function(e,t,n,r){let i;let o={...R4,...t},s=function(e,t,n,r){var i;let o={line:R8,bar:R9,scatter:R7};return(null==(i=o[t.type])?void 0:i.call(o,e,t,n,r))||[]}(e,o,n,r);return"bar"!==t.type&&(i=NE({lineHeight:1.2,tickSize:0,nice:!0,rotate:-45,textAnchor:"end",tickFormat:(e,t,n)=>{if("bar"===o.type)return null;if(o.xIsDate){let t;try{t=(0,S.ac)(e)}catch{t=e}let r=(0,S.ac)(n[0]),i=(0,S.ac)(n[n.length-1]).diff(r,"day");return i>365?1===t.date()&&t.month()%3==0?t.format("MMM YYYY"):null:i>90?1===t.date()?t.format("MMM YYYY"):null:i>14?1===t.day()?t.format("MMM DD"):null:t.format("MMM DD")}return o.xTicks&&t%Math.ceil(n.length/o.xTicks)==0?e:null}})),[...i?[i]:[],...s]}(f,{...t},r,i);if(t.xIsDate,t.facet&&"bar"!==t.type){let e=Array.from(new Set(f.map(e=>e[t.facet]))),n=e.map((e,t)=>t%2),r=e.map((e,t)=>parseInt(t/2));f.forEach((i,o)=>{let s=e.indexOf(i[t.facet]);i.facetIndex=s,i.facetXLocation=n[s],i.facetYLocation=r[s]}),Array.from(e).map((t,i)=>{let o=e.indexOf(t),s=n[o],a=r[o];p.push(D4([t],{fx:s,fy:a,frameAnchor:"top",monospace:!0}))})}let m={width:e.width,height:e.height,marginTop:(null==(o=null==t?void 0:t.margin)?void 0:o.top)??(null==(s=null==R4?void 0:R4.margin)?void 0:s.top),marginRight:(null==(a=null==t?void 0:t.margin)?void 0:a.right)??(null==(l=null==R4?void 0:R4.margin)?void 0:l.right),marginBottom:(null==(c=null==t?void 0:t.margin)?void 0:c.bottom)??(null==(h=null==R4?void 0:R4.margin)?void 0:h.bottom),marginLeft:(null==(u=null==t?void 0:t.margin)?void 0:u.left)??(null==(d=null==R4?void 0:R4.margin)?void 0:d.left),style:{backgroundColor:t.backgroundColor,overflow:"visible",fontSize:t.fontSize},color:{legend:!0,tickFormat:e=>e,swatchSize:10},y:{grid:t.yGrid,nice:!0,label:t.yLabel||t.y,labelOffset:22},x:{grid:t.xGrid,label:t.xLabel||t.x},marks:p,facet:{label:t.xLabel}};return t.facet&&"bar"!==t.type&&(m.facet={data:f,x:"facetXLocation",y:"facetYLocation",axis:null}),m};function R8(e,t,n,r){var i;let o=[],s=t.aggregateFunction||"sum",{x:a,y:l,facet:c,colorBy:h}=t;return r.filter(e=>"categorical"===e.variableType&&e.title!==a&&e.title!==l&&e.title!==n.x&&e.title!==t.facet&&-1===n.y.indexOf(e.title)).slice(0,5),o.push(function(e,{x:t=A6,y:n=A8,...r}={}){return new R3(e,function(e={}){return function(e,t,n={}){if((null==n?void 0:n.interval)==null)return n;let{reduce:r=MM}=n,i={filter:null};return null!=n.y&&(i.y=r),null!=n.y1&&(i[`${t}1`]=r),null!=n[`${t}2`]&&(i[`${t}2`]=r),e(i,n)}(Rz,"y",Dx(e,"x"))}({...r,x:t,y:n}))}(e,function(e={y:"count"},t={}){let{x:n=A8}=t;if(null==n)throw Error("missing channel: x");return function(e,t,{data:n=ME,filter:r,sort:i,reverse:o,...s}={},a={}){s=Mp(s,a,Mx),n=Mk(n,A8),i=null==i?void 0:Mx("sort",i,a),r=null==r?void 0:Mw("filter",r,a);let[l,c]=E_(e),[h,u]=E_(null),{z:d,fill:f,stroke:p,x1:m,x2:g,y1:y,y2:b,...v}=a,[x,w]=E_(d),[k]=Ec(f),[O]=Ec(p),[S,C]=E_(k),[T,A]=E_(O);return{..."z"in a&&{z:x||d},..."fill"in a&&{fill:S||f},..."stroke"in a&&{stroke:T||p},...Ms(v,(t,a,l)=>{let h=ER(AK(t,e),null==l?void 0:l.x),f=ER(AK(t,null),null==l?void 0:l.y),p=AK(t,d),m=AK(t,k),g=AK(t,O),y=MS(s,{z:p,fill:m,stroke:g}),b=[],v=[],x=h&&c([]),S=f&&u([]),T=p&&w([]),E=m&&C([]),M=g&&A([]),_=0;for(let e of s)e.initialize(t);for(let e of(i&&i.initialize(t),r&&r.initialize(t),a)){let o=[];for(let t of s)t.scope("facet",e);for(let[a,l]of(i&&i.scope("facet",e),r&&r.scope("facet",e),My(e,y)))for(let[e,c]of My(l,f))for(let[l,u]of My(c,h)){let c={data:t};if(h&&(c.x=l),f&&(c.y=e),y&&(c.z=a),!(r&&!r.reduce(u,c))){for(let r of(o.push(_++),v.push(n.reduceIndex(u,t,c)),h&&x.push(l),f&&S.push(e),p&&T.push(y===p?a:p[u[0]]),m&&E.push(y===m?a:m[u[0]]),g&&M.push(y===g?a:g[u[0]]),s))r.reduce(u,c);i&&i.reduce(u,c)}}b.push(o)}return MC(b,i,o),{data:v,facets:b}}),...!Mf(s,"x")&&(l?{x:l}:{x1:m,x2:g}),...!Mf(s,"y")&&(h?{y:h}:{y1:y,y2:b}),...Object.fromEntries(s.map(({name:e,output:t})=>[e,t]))}}(n,null,e,t)}({y:s},{x:t.x,y:t.y,filter:t.filter,stroke:h||"label",strokeWidth:e=>{var n,r;let i=null==(n=null==e?void 0:e[0])?void 0:n.label;return i&&null!=(r=t.lineOptions)&&r[i]&&t.lineOptions[i].strokeWidth?t.lineOptions[i].strokeWidth:t.lineWidth},curve:(null==(i=t.lineOptions)?void 0:i.curve)||t.curve,tip:{format:{x:e=>`${e}`,y:e=>`${e}`,strokeWidth:!1,stroke:!1}}}))),o}function R9(e,t){var n;let r;let i=t.aggregateFunction||"sum",o=(n=e.map(e=>({label:e[t.x||"label"],value:e[t.y||"value"],facet:e[t.facet||"facet"]})),r=[],"sum"==i?r=n.reduce((e,t)=>{let{label:n,value:r,facet:i}=t,o=e.find(e=>e.label===n&&e.facet===i);return o?o.value+=r:e.push({label:n,value:r,facet:i}),e},[]):"count"==i?r=n.reduce((e,t)=>{let{label:n,facet:r}=t,i=e.find(e=>e.label===n&&e.facet===r);return i?i.value+=1:e.push({label:n,value:1,facet:r}),e},[]):"mean"==i&&(r=(r=n.reduce((e,t)=>{let{label:n,value:r,facet:i}=t,o=e.find(e=>e.label===n&&e.facet===i);return o?o.value+=r:e.push({label:n,value:r,facet:i}),e},[])).map(e=>({...e,value:e.value/n.filter(t=>t.label===e.label&&t.facet===e.facet).length}))),r);return[function(e,t={}){var n;return function({x:e,x1:t,x2:n}){return void 0!==e||void 0!==t||void 0!==n}(n=t)||Eb(n)||void 0!==n.interval||(t={...t,x:A6,y2:A8,interval:1}),new Ri(e,function({y:e,y1:t,y2:n,...r}={}){return r=Dx(r,"x"),void 0===t&&void 0===n?function(e={},t={}){1==arguments.length&&([e,t]=function(e){let{offset:t,order:n,reverse:r,...i}=e;return[{offset:t,order:n,reverse:r},i]}(e));let{x1:n,x:r=n,y:i,...o}=t,[s,a,l,c]=function(e,t=A9,n,r,{offset:i,order:o,reverse:s},a){if(null===t)throw Error("stack requires y");let l=ES(a),[c,h]=E_(e),[u,d]=EM(t),[f,p]=EM(t);return u.hint=f.hint=N5,i=function(e){if(null!=e){if("function"==typeof e)return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return N4;case"center":case"silhouette":return N6;case"wiggle":return N8}throw Error(`unknown offset: ${e}`)}}(i),o=function(e,t,n){if(void 0===e&&t===N8)return Re(Aw);if(null!=e){if("string"==typeof e){let t=e.startsWith("-"),r=t?Ak:Aw;switch((t?e.slice(1):e).toLowerCase()){case"value":case n:return(e,t,n)=>(e,t)=>r(n[e],n[t]);case"z":return(e,t,n,i)=>(e,t)=>r(i[e],i[t]);case"sum":return Rn(r,(e,t,n,r)=>tW(ET(e),e=>nn(e,e=>n[e]),e=>r[e]));case"appearance":return Rn(r,(e,t,n,r)=>tW(ET(e),e=>t[t4(e,e=>n[e])],e=>r[e]));case"inside-out":return Re(r)}return Rt(A4(e))}if("function"==typeof e)return(1===e.length?Rt:function(e){return t=>AX(t)?(n,r)=>e(t[n],t[r]):(n,r)=>e(t.get(n),t.get(r))})(e);if(AX(e))return Rn(Aw,()=>e);throw Error(`invalid order: ${e}`)}}(o,i,"y"),[Ms(a,(n,r,a)=>{({data:n,facets:r}=function(e,t){if(1===t.length)return{data:e,facets:t};let n=EC(e),r=new Uint8Array(n),i=0;for(let e of t)for(let t of e)r[t]&&++i,r[t]=1;if(0===i)return{data:e,facets:t};let o=(e=Ey(e))[AJ]=new Uint32Array(n+i);t=t.map(e=>Ey(e,Uint32Array));let s=n;for(let n of(r.fill(0),t))for(let t=0,i=n.length;t<i;++t){let i=n[t];r[i]?(n[t]=s,e[s]=e[i],o[s]=i,++s):o[i]=i,r[i]=1}return{data:e,facets:t}}(n,r));let c=null==e?void 0:h(ER(AK(n,e),null==a?void 0:a.x)),u=AK(n,t,Float64Array),f=AK(n,l),m=o&&o(n,c,u,f),g=EC(n),y=d(new Float64Array(g)),b=p(new Float64Array(g)),v=[];for(let e of r){let t=c?Array.from(tq(e,e=>c[e]).values()):[e];if(m)for(let e of t)e.sort(m);for(let e of t){let t=0,n=0;for(let r of(s&&e.reverse(),e)){let e=u[r];e<0?t=b[r]=(y[r]=t)+e:e>0?n=b[r]=(y[r]=n)+e:b[r]=y[r]=n}}v.push(t)}return i&&i(v,y,b,f),{data:n,facets:r}}),c,u,f]}(r,i,0,"y",e,o);return{...s,x1:n,x:a,y1:l,y2:c,y:EN(l,c)}}({y:e,...r}):([t,n]=function(e,t,n,r=A8){return void 0===t&&void 0===n?(t=0,n=void 0===e?r:e):void 0===t?t=void 0===e?0:e:void 0===n&&(n=void 0===e?0:e),[t,n]}(e,t,n),{...r,y1:t,y2:n})}(function(e={}){return DU("x",DF,e,!0)}(function(e={},t="y"){return Eb(e)?e:{...e,[t]:A8}}(t))))}(o=t.xIsDate?o.map(e=>({...e,facet:(0,S.ac)(e.facet)})):function(e){let t=new Set(e.reduce((e,t)=>{let n=e.find(e=>e.facet===t.facet);return n?n.value+=t.value:e.push({...t}),e},[]).sort((e,t)=>t.value-e.value).slice(0,10).map(e=>e.facet)),n={};e.forEach(e=>{t.has(e.facet)||(n[e.label]=(n[e.label]||0)+e.value)});let r=Object.entries(n).map(([e,t])=>({label:e,value:t,facet:"Others"}));return[...e.filter(e=>t.has(e.facet)),...r]}(o),{x:"label",y:"value",fx:"facet",fill:"label",sort:t.xIsDate?void 0:{fx:{value:"-y"}},tip:{format:{x:e=>e,y:e=>e,fill:!1}}})]}function R7(e,t,n,r){let{x:i,y:o,colorBy:s}=t;return r.filter(e=>"categorical"===e.variableType&&e.title!==i&&e.title!==o&&e.title!==n.x&&e.title!==t.facet&&-1===n.y.indexOf(e.title)).slice(0,5),[function(e,{x:t,y:n,...r}={}){return void 0===r.frameAnchor&&([t,n]=EO(t,n)),new R2(e,{...r,x:t,y:n})}(e,{x:t.x,y:t.y,filter:t.filter,fill:t.colorBy||t.pointColor,r:t.pointSize,fillOpacity:.7,tip:{format:{x:e=>e,y:e=>e}}})]}function Pe(e){let t=`scheme${e}`,n=`interpolate${e}`;return l2[t]?{colorScheme:Array.isArray(l2[t].slice(-1)[0])?l2[t][5]:l2[t],schemeName:t}:l2[n]?{colorScheme:l2[n],schemeName:n}:{colorScheme:null,schemeName:null}}function Pt(e,t,n){var r,i,o,s,a,l,c,h;let u=null,{selectedChart:d,selectedColumns:f,chartStyle:p,chartSpecificOptions:m,availableColumns:g,data:y}=n.config,b=g.find(e=>e.key===f.x);if(null!=b&&b.isDate){let e=S.ac.min(y.map(e=>(0,S.ac)(e[b.key]))),t=(S.ac.max(y.map(e=>(0,S.ac)(e[b.key])))-e)/1e3/60/60/24;t<14?b.rangeToShow="day":t<120?b.rangeToShow="week":t<1095?b.rangeToShow="month":b.rangeToShow="year"}if(!f.x||!f.y||Array.isArray(f.y)&&!(null!=(r=null==f?void 0:f.y)&&r.length))u=null;else{let e=y,n=g.find(e=>e.key===m[d].colorBy);if("bar"===d||"line"===d)try{e=(0,S.ad)(e,f.x,f.y,m[d].colorBy)}catch(e){console.error("Error converting wide to long format",e)}if("bar"!==d&&"line"!==d)u=R6(t,{...R4,type:d||"Bar",x:f.x||null,y:f.y||null,facet:f.facet,filter:null==(i=m[d])?void 0:i.filter,xIsDate:null==b?void 0:b.isDate,colorByIsDate:null==n?void 0:n.isDate,...p,...m[d]},e,f,g);else if("bar"===d)u=R6(t,{...R4,type:d,x:f.x&&(null==(o=null==f?void 0:f.y)?void 0:o.length)&&"label",y:f.x&&null!=(s=null==f?void 0:f.y)&&s.length?"value":null,facet:f.x||null,filter:null==(a=m[d])?void 0:a.filter,xIsDate:null==b?void 0:b.isDate,colorByIsDate:null==n?void 0:n.isDate,...p,...m[d]},e,f,g);else if("line"===d){let r=(0,S.ad)(e,f.x,f.y,m[d].colorBy,null==n?void 0:n.isDate,f.facet);u=R6(t,{...R4,type:d,x:f.x||null,y:f.x&&f.y.length?"value":null,stroke:"label",facet:f.facet||null,filter:null==(l=m[d])?void 0:l.filter,xIsDate:null==b?void 0:b.isDate,colorByIsDate:null==n?void 0:n.isDate,...p,...m[d]},r,f,g)}}if(e.innerHTML="",e.style.padding="0 0 0 0",u){if("bar"===d){let{colorScheme:t}=Pe(p.selectedScheme),n=f.y,r=(null==(c=null==m?void 0:m.bar)?void 0:c.barOptions)||{},i=-1,o=n.map(e=>r[e]&&r[e].fill?r[e].fill:Array.isArray(t)?t[++i%t.length]:t(i/n.length)),s={...u,color:m[d].colorBy?{legend:!0,tickFormat:e=>e}:{...u.color,scheme:void 0,domain:n,range:o},fx:{grid:!1,tickRotate:-45,tickFormat:e=>{if(null==b||!b.isDate)return e;{let t=(0,S.ac)(e);return"year"===b.rangeToShow?t.format("YYYY"):"month"===b.rangeToShow?t.format("MMM YYYY"):t.format("MMM DD")}},axis:"bottom",interval:null!=b&&b.isDate?b.rangeToShow:void 0},x:{axis:null,label:""}};e.appendChild(RO(s))}else if("line"===d){let{colorScheme:t}=Pe(p.selectedScheme),n=f.y,r=(null==(h=null==m?void 0:m.line)?void 0:h.lineOptions)||{},i=-1,o=n.map(e=>r[e]&&r[e].stroke?r[e].stroke:Array.isArray(t)?t[++i%t.length]:t(i/n.length));e.appendChild(RO({...u,color:m[d].colorBy?{legend:!0,tickFormat:e=>e}:{...u.color,scheme:void 0,domain:n,range:o}}))}else e.appendChild(RO(u));let t=e.querySelector("[aria-label^='x-axis tick label'], [aria-label^='fx-axis tick label']"),n=e.querySelector("[aria-label^='y-axis tick label']"),r=e.querySelector("[aria-label^='x-axis label'], [aria-label^='fx-axis label']"),i=e.querySelector("[aria-label^='y-axis label']"),o=0,s=0;if(t)try{let n=e.getBoundingClientRect().bottom,i=t.getBoundingClientRect().bottom-n+20;if(o=i=i>0?i:0,r){let[e,t]=r.getAttribute("transform").split("(")[1].slice(0,-1).split(",").map(e=>parseFloat(e)),n=t+i;r.setAttribute("transform",`translate(${e}, ${n})`)}}catch{}if(n)try{let t=e.getBoundingClientRect().left,r=n.getBoundingClientRect().left,o=r-t-20;if(s=o<0?Math.abs(o):0,i){let[e,t]=i.getAttribute("transform").split("(")[1].slice(0,-1).split(",").map(e=>parseFloat(e)),n=i.getBoundingClientRect().left,o=e;n>r&&(o=e-(n-r)-20),i.setAttribute("transform",`translate(${o}, ${t})`)}}catch{}let a=e.children[0];a&&(a.style.padding=`0 0 ${o}px ${s}px`)}else e.innerHTML="<div class='flex items-center justify-center h-full w-full'>Please select X and Y axes to display the chart.</div>";return u&&(u.wasSampled=!1),u}S.ac.extend(TN);let Pn=[{name:"square",label:S.j.jsxs("span",{children:[S.j.jsx("span",{className:"hidden md:inline",children:"Square("})," 800\xd7800",S.j.jsx("span",{className:"hidden md:inline",children:")"})]}),width:800,height:800},{name:"rectangle",label:S.j.jsxs("span",{children:[S.j.jsx("span",{className:"hidden md:inline",children:"Rectangle("})," 1280\xd7600",S.j.jsx("span",{className:"hidden md:inline",children:")"})]}),width:1280,height:600}],Pr={idle:S.j.jsxs("div",{className:"flex items-center animate-fade-up",children:[S.j.jsx(S.D,{size:16,className:"md:mr-2"}),S.j.jsx("span",{className:"hidden md:block",children:"Download PNG"})]}),downloading:S.j.jsxs("div",{className:"flex items-center animate-fade-up",children:[S.j.jsx(S.ae,{size:16,className:"mr-2 animate-spin"}),"Downloading..."]}),saved:S.j.jsxs("div",{className:"flex items-center animate-fade-up",children:[S.j.jsx(S.D,{size:16,className:"mr-2"}),"Saved"]})};function Pi({isOpen:e,onClose:t,className:n=""}){let[r,i]=(0,C.useState)({width:800,height:800}),o=(0,C.useRef)(null),s=(0,C.useRef)(null),a=(0,C.useRef)(null),l=(0,C.useRef)(null),c=(0,C.useContext)(Tf),[h,u]=(0,C.useState)("idle");(0,C.useEffect)(()=>{e&&s.current&&s.current.focus()},[e]),(0,C.useEffect)(()=>{e&&o.current&&Pt(o.current,r,c)},[e,r]);let d=(e,t)=>{let n=parseInt(t)||0;i(t=>({...t,[e]:n}))};(0,C.useEffect)(()=>{e&&(d("width",r.width),d("height",r.height))},[e]);let f=()=>{setTimeout(()=>{u("idle")},2e3)},p=async()=>{try{let e=a.current.value?l.current:o.current;await function(e,t={}){if(!e)return;let{bg:n="white",width:r=1e3,height:i=1e3,filename:o="chart.png"}=t,s={width:e.style.width,height:e.style.height,position:e.style.position,overflow:e.style.overflow,transform:e.style.transform,transformOrigin:e.style.transformOrigin,padding:e.style.padding,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,backgroundColor:e.style.backgroundColor},a=e.querySelectorAll("text, .tick text, .axis-label, .title"),l=new Map;a.forEach(e=>{l.set(e,{fill:e.style.fill||window.getComputedStyle(e).fill,stroke:e.style.stroke||window.getComputedStyle(e).stroke,color:e.style.color||window.getComputedStyle(e).color})});let c=()=>{Object.assign(e.style,{width:s.width,height:s.height,position:s.position,overflow:s.overflow,transform:s.transform,transformOrigin:s.transformOrigin,padding:s.padding,backgroundColor:s.backgroundColor}),e.scrollTop=s.scrollTop,e.scrollLeft=s.scrollLeft,a.forEach(e=>{let t=l.get(e);t&&(e.style.fill=t.fill,e.style.stroke=t.stroke,e.style.color=t.color)})};try{Object.assign(e.style,{width:`${e.scrollWidth}px`,height:`${e.scrollHeight}px`,position:"relative",overflow:"visible",transform:"none",transformOrigin:"top left",padding:"0px",backgroundColor:n}),e.scrollTop=0,e.scrollLeft=0,a.forEach(e=>{e.style.fill="#000000",e.style.stroke="none",e.style.color="#000000"});let t=e.offsetWidth,s=e.offsetHeight,l=e.cloneNode(!0);Object.assign(l.style,{transform:`scale(${r/t}, ${i/s})`,transformOrigin:"top left",width:`${t}px`,height:`${s}px`});let h=document.createElement("div");return Object.assign(h.style,{position:"absolute",top:"-10000px",left:"-10000px"}),h.appendChild(l),document.body.appendChild(h),Av(l,{backgroundColor:n,pixelRatio:2,width:e.scrollWidth,height:e.scrollHeight,style:{transform:"none",transformOrigin:"top left"}}).then(e=>{let t=document.createElement("a");t.download=o,t.href=e,t.click()}).finally(()=>{c(),document.body.removeChild(h)})}catch(e){throw c(),console.error("Failed to export chart:",e),e}}(e,r),u("saved"),f()}catch(e){u("idle"),console.error("Failed to download:",e)}};return S.j.jsxs(S.o,{open:e,onCancel:t,className:n,contentClassNames:"max-w-fit",footer:!1,rootClassNames:"z-[10000] max-h-full",title:"Export Chart",children:[S.j.jsx("div",{className:"pb-4 z-10",children:S.j.jsxs("div",{className:"flex items-start md:items-center justify-between gap-2",children:[S.j.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[S.j.jsxs("div",{className:"flex items-center gap-2",children:[S.j.jsx(S.a4,{ref:s,type:"number",placeholder:"Width",value:r.width,onChange:e=>d("width",e.target.value),inputClassNames:"w-24 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-blue-400"}),S.j.jsx("span",{className:"text-sm font-medium text-gray-400",children:"\xd7"}),S.j.jsx(S.a4,{type:"number",placeholder:"Height",value:r.height,onChange:e=>d("height",e.target.value),inputClassNames:"w-24 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-blue-400"})]}),S.j.jsx("div",{className:"flex gap-2",children:Pn.map(e=>S.j.jsx("button",{onClick:()=>i({width:e.width,height:e.height}),className:`px-3 py-1.5 rounded-md text-sm transition-all duration-200 
                    bg-white hover:bg-gray-50 border border-gray-200 hover:border-gray-300
                    shadow-sm hover:shadow backdrop-blur-sm
                    hover:-translate-y-0.5
                    dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600 dark:hover:bg-gray-600`,children:e.label},e.name))})]}),S.j.jsx("button",{onClick:()=>{u("downloading"),p()},disabled:"idle"!==h,className:`flex text-center justify-center items-center px-4 py-1.5 text-sm font-medium text-white bg-blue-600 
                rounded-md hover:bg-blue-700 transition-all duration-200 
                shadow-sm hover:shadow-md hover:-translate-y-0.5
                disabled:bg-blue-400 disabled:cursor-not-allowed disabled:hover:translate-y-0
                overflow-hidden
                dark:bg-blue-700 dark:hover:bg-blue-800`,children:Pr[h]})]})}),S.j.jsxs("div",{className:"relative bg-white dark:bg-gray-900 overflow-auto max-w-full",ref:l,style:{width:r.width,height:r.height},children:[S.j.jsx(S.a4,{ref:a,placeholder:"Add a title",rootClassNames:"*:!text-2xl border-0 *:!text-bold",inputClassNames:"ring-0 outline-0 border-0 !text-2xl shadow-none text-bold p-0"}),S.j.jsx("div",{ref:o,className:"[&_figure]:!p-0",style:{width:r.width,height:r.height}})]})]})}function Po(){let e=(0,C.useRef)(null),[t,n]=(0,C.useState)({width:0,height:0}),[r,i]=(0,C.useState)(!1),o=(0,C.useContext)(Tf),s=(0,C.useCallback)(()=>{if(e.current){let{width:t,height:r}=e.current.getBoundingClientRect();n(e=>t!==e.width||r!==e.height?{width:t,height:r}:e)}},[]);(0,C.useEffect)(()=>{let t=new ResizeObserver(s);return e.current&&t.observe(e.current),s(),()=>t.disconnect()},[s]);let a=(0,C.useMemo)(()=>{if(e.current)return Pt(e.current,t,o)},[o.config,t]);return(0,C.useEffect)(()=>{let e=e=>{!(document.activeElement===document.body&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.shiftKey&&(0,S.a5)(e.key,S.a.SAVE_CHART))||(i(!0),e.preventDefault())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),S.j.jsxs("div",{className:"mr-4 grow",children:[S.j.jsxs("div",{className:"flex justify-end gap-2 mb-2",children:[a&&(null==a?void 0:a.wasSampled)&&S.j.jsx("div",{className:"text-sm text-gray-500",children:"* Data has been sampled for better visualization"}),S.j.jsxs(S.B,{onClick:()=>i(!0),variant:"ghost",className:`inline-flex items-center px-2.5 py-1.5 rounded-md border border-gray-200/50 
                bg-white/95 hover:bg-gray-50/95 dark:bg-gray-800/95 dark:hover:bg-gray-700/95 
                shadow-sm backdrop-blur-sm transition-all duration-200 
                dark:border-gray-700/50 dark:hover:border-gray-600/50
                hover:shadow-md hover:-translate-y-0.5
                group`,title:`Download chart as PNG (${S.a.SAVE_CHART})`,children:[S.j.jsx(S.D,{size:16,className:"mr-1"}),S.j.jsx("span",{className:"mr-1 whitespace-nowrap",children:"Save as PNG"}),S.j.jsx(S.K,{keyValue:S.a.SAVE_CHART,className:"opacity-50 group-hover:opacity-100 transition-opacity ml-1 !py-0.5 !px-1.5"})]})]}),S.j.jsx("div",{ref:e,className:"w-full mx-6 border-gray-200 observable-plot h-[500px] overflow-visible observable-plot"}),S.j.jsx(Pi,{isOpen:r,onClose:()=>i(!1),sourceChartRef:e})]})}S.ac.extend(TN);let Ps=({isOpen:e,onClick:t})=>S.j.jsx("button",{onClick:t,className:`
      absolute -right-8 top-[50%] -translate-y-[50%]
      h-36 w-8 flex items-center justify-center group
      bg-[#F9FAFB] dark:bg-gray-800 
      border border-gray-200 dark:border-gray-700
      hover:bg-gray-50 dark:hover:bg-gray-700
      transition-colors rounded-r
       z-10
    `,title:`${e?"Collapse":"Expand"} chart options (${S.a.TOGGLE_CHART_OPTIONS})`,children:S.j.jsxs("div",{className:"relative flex flex-col h-full",children:[S.j.jsx("div",{className:"flex items-center justify-center flex-1",children:S.j.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:S.j.jsx(G,{className:"size-5"})})}),S.j.jsx("div",{className:"absolute -translate-x-1/2 bottom-2 left-1/2",children:S.j.jsx(S.K,{keyValue:S.a.TOGGLE_CHART_OPTIONS,className:"scale-75 opacity-75"})})]})}),Pa=({block:e,value:t,onChange:n,options:r,className:i=""})=>S.j.jsx("div",{className:`flex ${e?"w-full":"inline-flex"} justify-center  rounded-md p-0.5 bg-gray-200 dark:bg-gray-800 ${i}`,children:r.map((e,r)=>S.j.jsx("button",{onClick:()=>n(e.value),className:`
            flex w-full items-center justify-center gap-1.5 px-3 py-1.5 rounded-[4px]
            text-xs font-medium transition-all duration-150 ease-in-out
            ${t===e.value?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700/50"}
            ${r>0?"ml-0.5":""}
          `,children:e.label},r))});function Pl({rows:e,columns:t,stepData:n,initialQuestion:r=null,initialOptionsExpanded:i=!1}){let[o,s]=(0,C.useState)(i),a=(0,C.useMemo)(()=>n?null==n?void 0:n.chartManager:Td({data:e,availableColumns:t}),[n,e,t]),[l,c]=(0,C.useState)(a.config);(0,C.useEffect)(()=>{a.setConfigCallback=c},[]);let h=(0,C.useContext)(Th),u=(0,C.useContext)(Bl),{apiEndpoint:d,token:f}=h;f||(d=u.apiEndpoint,f=u.token);let p=(0,S.af)({protocol:"http",path:"edit_chart",apiEndpoint:d}),m=(0,C.useContext)(S.M),{selectedColumns:g}=l;(0,C.useEffect)(()=>{r&&!a.config.loading&&a.editChart(f,r,p,{onError:e=>{m.error(e.message),console.error(e)}})},[]),(0,C.useEffect)(()=>{let e=e=>{document.activeElement===document.body&&e.key===S.a.TOGGLE_CHART_OPTIONS&&(s(e=>!e),e.preventDefault())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let[y,b]=(0,C.useState)("primary");return S.j.jsx(Tf.Provider,{value:Object.assign(a,{config:l}),children:S.j.jsx("div",{className:"relative",children:S.j.jsxs("div",{className:"relative flex flex-row gap-3",children:[S.j.jsxs("div",{className:"relative flex",children:[S.j.jsx("div",{className:`
                relative border-r border-gray-200 dark:border-gray-700
                transition-all duration-200 overflow-hidden
                ${o?"w-[350px]":"w-[0px]"}
              `,children:S.j.jsxs("div",{className:`
                  transition-all duration-200 relative
                  overflow-x-hidden h-full
                  ${o?"pr-4":"pr-0"}
                `,children:[S.j.jsx("div",{style:{width:"350px"},children:(()=>{let e=l.availableColumns;return S.j.jsxs("div",{className:"space-y-4",children:[S.j.jsx(TC,{columns:e,showChartTypeOnly:!0}),S.j.jsx("div",{className:"mr-4",children:S.j.jsx(Pa,{block:!0,value:y,onChange:e=>b(e),className:"transition-none",options:[{label:S.j.jsxs("div",{className:"flex items-center mt-[0.5px] justify-center gap-1.5 px-3 py-1",children:[S.j.jsx(L,{className:"text-current",size:14}),S.j.jsx("p",{className:"font-sans text-xs font-semibold",children:"General"})]}),value:"primary"},{label:S.j.jsxs("div",{className:"flex items-center mt-[0.5px] justify-center gap-1.5 px-3 py-1",children:[S.j.jsx(H,{className:"text-current",size:14}),S.j.jsx("p",{className:"font-sans text-xs",children:"Style"})]}),value:"customization"}]})}),S.j.jsx("div",{className:"pl-1 pr-4",children:"primary"===y?S.j.jsx(TC,{columns:e,showChartTypeOnly:!1}):S.j.jsx(TM,{})})]})})()}),S.j.jsx("div",{className:`
                    absolute inset-y-0 left-0 w-24
                    transition-opacity duration-200
                    ${o?"opacity-0 pointer-events-none":"opacity-100"}
                    bg-gradient-to-l from-transparent 
                    via-white/50 to-white
                    dark:via-gray-800/50 dark:to-gray-800
                  `})]})}),S.j.jsx(Ps,{isOpen:o,onClick:()=>s(!o)})]}),S.j.jsx("div",{className:`
              transition-all duration-200 flex-1
              ${o?"w-[calc(100%-350px)]":"w-full"}
            `,children:l.loading?S.j.jsx("div",{className:"flex items-center justify-center w-full pt-10",children:S.j.jsx(S.ag,{chart:!0})}):S.j.jsx(Po,{})})]})})})}!function(e){var t,n,r=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,n=0,r={},i={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof o?new o(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function e(t,n){var r,o;switch(n=n||{},i.util.type(t)){case"Object":if(n[o=i.util.objId(t)])return n[o];for(var s in r={},n[o]=r,t)t.hasOwnProperty(s)&&(r[s]=e(t[s],n));return r;case"Array":return n[o=i.util.objId(t)]?n[o]:(r=[],n[o]=r,t.forEach(function(t,i){r[i]=e(t,n)}),r);default:return t}},getLanguage:function(e){for(;e;){var n=t.exec(e.className);if(n)return n[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,n){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+n)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document)return document.currentScript;try{throw Error()}catch(r){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(r.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var n in t)if(t[n].src==e)return t[n]}return null}},isActive:function(e,t,n){for(var r="no-"+t;e;){var i=e.classList;if(i.contains(t))return!0;if(i.contains(r))return!1;e=e.parentElement}return!!n}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(e,t){var n=i.util.clone(i.languages[e]);for(var r in t)n[r]=t[r];return n},insertBefore:function(e,t,n,r){var o=(r=r||i.languages)[e],s={};for(var a in o)if(o.hasOwnProperty(a)){if(a==t)for(var l in n)n.hasOwnProperty(l)&&(s[l]=n[l]);n.hasOwnProperty(a)||(s[a]=o[a])}var c=r[e];return r[e]=s,i.languages.DFS(i.languages,function(t,n){n===c&&t!=e&&(this[t]=s)}),s},DFS:function e(t,n,r,o){o=o||{};var s=i.util.objId;for(var a in t)if(t.hasOwnProperty(a)){n.call(t,a,t[a],r||a);var l=t[a],c=i.util.type(l);"Object"!==c||o[s(l)]?"Array"!==c||o[s(l)]||(o[s(l)]=!0,e(l,n,a,o)):(o[s(l)]=!0,e(l,n,null,o))}}},plugins:{},highlightAll:function(e,t){i.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var r={callback:n,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",r),r.elements=Array.prototype.slice.apply(r.container.querySelectorAll(r.selector)),i.hooks.run("before-all-elements-highlight",r);for(var o,s=0;o=r.elements[s++];)i.highlightElement(o,!0===t,r.callback)},highlightElement:function(t,n,r){var o=i.util.getLanguage(t),s=i.languages[o];i.util.setLanguage(t,o);var a=t.parentElement;a&&"pre"===a.nodeName.toLowerCase()&&i.util.setLanguage(a,o);var l=t.textContent,c={element:t,language:o,grammar:s,code:l};function h(e){c.highlightedCode=e,i.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,i.hooks.run("after-highlight",c),i.hooks.run("complete",c),r&&r.call(c.element)}if(i.hooks.run("before-sanity-check",c),(a=c.element.parentElement)&&"pre"===a.nodeName.toLowerCase()&&!a.hasAttribute("tabindex")&&a.setAttribute("tabindex","0"),!c.code){i.hooks.run("complete",c),r&&r.call(c.element);return}if(i.hooks.run("before-highlight",c),!c.grammar){h(i.util.encode(c.code));return}if(n&&e.Worker){var u=new Worker(i.filename);u.onmessage=function(e){h(e.data)},u.postMessage(JSON.stringify({language:c.language,code:c.code,immediateClose:!0}))}else h(i.highlight(c.code,c.grammar,c.language))},highlight:function(e,t,n){var r={code:e,grammar:t,language:n};if(i.hooks.run("before-tokenize",r),!r.grammar)throw Error('The language "'+r.language+'" has no grammar.');return r.tokens=i.tokenize(r.code,r.grammar),i.hooks.run("after-tokenize",r),o.stringify(i.util.encode(r.tokens),r.language)},tokenize:function(e,t){var n=t.rest;if(n){for(var r in n)t[r]=n[r];delete t.rest}var c=new a;return l(c,c.head,e),function e(t,n,r,a,c,h){for(var u in r)if(!(!r.hasOwnProperty(u)||!r[u])){var d=r[u];d=Array.isArray(d)?d:[d];for(var f=0;f<d.length;++f){if(h&&h.cause==u+","+f)return;var p=d[f],m=p.inside,g=!!p.lookbehind,y=!!p.greedy,b=p.alias;if(y&&!p.pattern.global){var v=p.pattern.toString().match(/[imsuy]*$/)[0];p.pattern=RegExp(p.pattern.source,v+"g")}for(var x=p.pattern||p,w=a.next,k=c;w!==n.tail&&!(h&&k>=h.reach);k+=w.value.length,w=w.next){var O=w.value;if(n.length>t.length)return;if(!(O instanceof o)){var S,C=1;if(y){if(!(S=s(x,k,t,g))||S.index>=t.length)break;var T=S.index,A=S.index+S[0].length,E=k;for(E+=w.value.length;T>=E;)E+=(w=w.next).value.length;if(E-=w.value.length,k=E,w.value instanceof o)continue;for(var M=w;M!==n.tail&&(E<A||"string"==typeof M.value);M=M.next)C++,E+=M.value.length;C--,O=t.slice(k,E),S.index-=k}else if(!(S=s(x,0,O,g)))continue;var T=S.index,_=S[0],D=O.slice(0,T),N=O.slice(T+_.length),R=k+O.length;h&&R>h.reach&&(h.reach=R);var P=w.prev;if(D&&(P=l(n,P,D),k+=D.length),function(e,t,n){for(var r=t.next,i=0;i<n&&r!==e.tail;i++)r=r.next;t.next=r,r.prev=t,e.length-=i}(n,P,C),w=l(n,P,new o(u,m?i.tokenize(_,m):_,b,_)),N&&l(n,w,N),C>1){var j={cause:u+","+f,reach:R};e(t,n,r,w.prev,k,j),h&&j.reach>h.reach&&(h.reach=j.reach)}}}}}}(e,c,t,c.head,0),function(e){for(var t=[],n=e.head.next;n!==e.tail;)t.push(n.value),n=n.next;return t}(c)},hooks:{all:{},add:function(e,t){var n=i.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=i.hooks.all[e];if(!(!n||!n.length))for(var r,o=0;r=n[o++];)r(t)}},Token:o};function o(e,t,n,r){this.type=e,this.content=t,this.alias=n,this.length=0|(r||"").length}function s(e,t,n,r){e.lastIndex=t;var i=e.exec(n);if(i&&r&&i[1]){var o=i[1].length;i.index+=o,i[0]=i[0].slice(o)}return i}function a(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function l(e,t,n){var r=t.next,i={value:n,prev:t,next:r};return t.next=i,r.prev=i,e.length++,i}if(e.Prism=i,o.stringify=function e(t,n){if("string"==typeof t)return t;if(Array.isArray(t)){var r="";return t.forEach(function(t){r+=e(t,n)}),r}var o={type:t.type,content:e(t.content,n),tag:"span",classes:["token",t.type],attributes:{},language:n},s=t.alias;s&&(Array.isArray(s)?Array.prototype.push.apply(o.classes,s):o.classes.push(s)),i.hooks.run("wrap",o);var a="";for(var l in o.attributes)a+=" "+l+'="'+(o.attributes[l]||"").replace(/"/g,"&quot;")+'"';return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+a+">"+o.content+"</"+o.tag+">"},!e.document)return e.addEventListener&&(i.disableWorkerMessageHandler||e.addEventListener("message",function(t){var n=JSON.parse(t.data),r=n.language,o=n.code,s=n.immediateClose;e.postMessage(i.highlight(o,i.languages[r],r)),s&&e.close()},!1)),i;var c=i.util.currentScript();function h(){i.manual||i.highlightAll()}if(c&&(i.filename=c.src,c.hasAttribute("data-manual")&&(i.manual=!0)),!i.manual){var u=document.readyState;"loading"===u||"interactive"===u&&c&&c.defer?document.addEventListener("DOMContentLoaded",h):window.requestAnimationFrame?window.requestAnimationFrame(h):window.setTimeout(h,16)}return i}("u">typeof window?window:"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});e.exports&&(e.exports=r),"u">typeof S.a1&&(S.a1.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};i["language-"+t]={pattern:/[\s\S]+/,inside:r.languages[t]};var o={};o[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:i},r.languages.insertBefore("markup","cdata",o)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(e,t){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:r.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/,r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css,(n=r.languages.markup)&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css")),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|")+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,function(){if(!(typeof r>"u")&&!(typeof document>"u")){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},t="data-src-status",n="loading",i="loaded",o="pre[data-src]:not(["+t+'="'+i+'"]):not(['+t+'="'+n+'"])';r.hooks.add("before-highlightall",function(e){e.selector+=", "+o}),r.hooks.add("before-sanity-check",function(s){var a=s.element;if(a.matches(o)){s.code="",a.setAttribute(t,n);var l,c,h,u=a.appendChild(document.createElement("CODE"));u.textContent="Loading";var d=a.getAttribute("data-src"),f=s.language;if("none"===f){var p=(/\.(\w+)$/.exec(d)||[,"none"])[1];f=e[p]||p}r.util.setLanguage(u,f),r.util.setLanguage(a,f);var m=r.plugins.autoloader;m&&m.loadLanguages(f),l=function(e){a.setAttribute(t,i);var n=function(e){var t=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||"");if(t){var n=Number(t[1]),r=t[2],i=t[3];return r?i?[n,Number(i)]:[n,void 0]:[n,n]}}(a.getAttribute("data-range"));if(n){var o=e.split(/\r\n?|\n/g),s=n[0],l=null==n[1]?o.length:n[1];s<0&&(s+=o.length),s=Math.max(0,Math.min(s-1,o.length)),l<0&&(l+=o.length),l=Math.max(0,Math.min(l,o.length)),e=o.slice(s,l).join(`
`),a.hasAttribute("data-start")||a.setAttribute("data-start",String(s+1))}u.textContent=e,r.highlightElement(u)},c=function(e){a.setAttribute(t,"failed"),u.textContent=e},(h=new XMLHttpRequest).open("GET",d,!0),h.onreadystatechange=function(){4==h.readyState&&(h.status<400&&h.responseText?l(h.responseText):h.status>=400?c(" Error "+h.status+" while fetching file: "+h.statusText):c(" Error: File does not exist or is empty"))},h.send(null)}}),r.plugins.fileHighlight={highlight:function(e){for(var t,n=(e||document).querySelectorAll(o),i=0;t=n[i++];)r.highlightElement(t)}};var s=!1;r.fileHighlight=function(){s||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),s=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}}}()}({exports:{}}),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/},Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python;let Pc={url:null,onMessage:()=>{},onOpen:()=>{},onClose:()=>{},onError:()=>{},onTimeout:()=>{},reconnectDelay:2e3,reconnectMaxAttempts:3,ping:!1,autoReconnect:!0,connectionTimeoutAfter:1e4,connectImmediately:!0};function Ph({projectName:e,analysisId:t,question:n,data_csv:r,apiEndpoint:i,sql:o,token:s}){let[a,l]=(0,C.useState)(""),[c,h]=(0,C.useState)(!1),u=(0,S.af)({protocol:"ws",path:"analyse_data_streaming",apiEndpoint:i});return(0,C.useEffect)(()=>{let i=(0,S.aj)(t);if(i){l(i);return}let a=function(e){let t={...Pc,...e},{url:n,reconnectDelay:r,reconnectMaxAttempts:i,ping:o,autoReconnect:s,connectionTimeoutAfter:a}=t,l=null,c=!1,h=null,u=null,d=Date.now(),f=-1,p=0,m=!1,g=t.onMessage,y=t.onOpen,b=t.onClose,v=t.onError,x=t.onTimeout,w=crypto.randomUUID().slice(0,8),k=[];function O(...e){c&&(console.groupCollapsed(w+": "+(e.length&&e[0])),console.log(...e),console.groupEnd())}function S(){f++,T(),l&&l.close&&l.readyState!==WebSocket.CLOSED&&l.close(),l=new WebSocket(n),O("connecting"),h=setTimeout(()=>{O("connection timed out"),l.readyState===WebSocket.CONNECTING&&(l.close(),f<i?(f++,setTimeout(S,r)):x&&"function"==typeof x&&x())},a),l.onopen=function(e){O("reconnected to",n),f=0,T(),y&&"function"==typeof y&&y(e)},l.onerror=function(e){O("error",n,e),v&&"function"==typeof v&&v(e)},l.onmessage=function(e){g&&"function"==typeof g&&g(e)},k.forEach(e=>{if(e.disabled)return;let t=e.event,n=e.cb;e.disabled=!1,l.addEventListener(t,n)}),l.onclose=function(e){O("closed",e),b&&"function"==typeof b&&b(e),T(),e.wasClean||m||(s&&O(`reconnecting to ${n}, in ${r} ms`),u=setTimeout(()=>{if(s){if(f>=i){O("Maximum number of reconnect attempts reached. Stopping reconnecting.");return}O("reconnecting to",n),S()}},r))}}function C(e,t=!1){l&&l.readyState===WebSocket.OPEN&&(f>=1&&!t&&p%10==0&&(O("Connection was previously lost and there might be connectivity issues while running this. Consider refreshing the page for best performance."),p++),l.send(JSON.stringify(e)))}function T(){clearTimeout(h),clearTimeout(u)}return o&&window.requestAnimationFrame(function e(){Date.now()-d>5e3&&(d=Date.now(),C({ping:"ping"},!0)),window.requestAnimationFrame(e)}),t.connectImmediately&&S(),{send:C,destroy:function(){T(),O("Closing socket and destroying manager",l),m=!0,l&&l.close(),O("destroyed")},connect:S,addEventListener:function(e,t){c&&O("adding event listeners"),l&&(l.addEventListener(e,t),k.push({event:e,cb:t,disabled:!1}))},removeEventListener:function(e,t,n){O("removing event listeners"),l&&(l.removeEventListener(e,t),-1!==n&&(k[n].disabled=!0))},isConnected:function(){return l&&l.readyState===WebSocket.OPEN},setLogging:function(e=!1){c=e},getSocket:function(){return l},getEventListeners:function(){return k}}}({url:u,onMessage:e=>{h(!1);let n=e.data;"Defog data analysis has ended"===n?(a.destroy(),l(e=>((0,S.ak)(t,e),e))):l(e=>e+n)},reconnectDelay:2e3,reconnectMaxAttempts:3,connectionTimeoutAfter:1e4,onTimeout:()=>{h(!1),l("Connection timeout with the websocket server. Please try again.")},onOpen:()=>{h(!0),l(""),a.send({question:n,data_csv:r,sql:o,db_name:e,token:s})},onError:e=>{console.error(e),h(!1),l("An error occurred while analyzing data. Please try again.")}});return()=>{a.destroy()}},[]),S.j.jsxs("div",{className:"relative h-full",children:[S.j.jsx("div",{className:"pb-3 mb-4 border-b border-gray-200 dark:border-gray-700",children:S.j.jsxs("h3",{className:"font-medium text-gray-900 text-md dark:text-gray-100",children:["Insights"," ",S.j.jsx(X,{className:"inline size-4 stroke-secondary-highlight-1"})]})}),S.j.jsx("div",{className:"space-y-4",children:c?S.j.jsxs("div",{className:"flex flex-col items-center justify-center p-8 h-[400px] rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[S.j.jsx(S.d,{classNames:"mb-4"}),S.j.jsxs("div",{className:"flex flex-col items-center",children:[S.j.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Analyzing your data"}),S.j.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"This may take a few moments"})]})]}):a?S.j.jsx(wW,{customErrorMessage:a,children:S.j.jsx("div",{className:`analysis-markdown max-w-full text-sm break-words
                [&>h1]:text-xl [&>h1]:font-semibold [&>h1]:mb-4 [&>h1]:text-gray-900 [&>h1]:dark:text-gray-100
                [&>h2]:text-lg [&>h2]:font-medium [&>h2]:mb-3 [&>h2]:text-gray-800 [&>h2]:dark:text-gray-200
                [&>p]:mb-4 [&>p]:text-gray-600 [&>p]:dark:text-gray-300 [&>p]:leading-relaxed [&>p]:whitespace-pre-wrap
                [&>ul]:mb-4 [&>ul]:list-disc [&>ul]:pl-5 [&>ul]:space-y-2 [&>ul]:text-gray-600 [&>ul]:dark:text-gray-300
                [&>ol]:mb-4 [&>ol]:list-decimal [&>ol]:pl-5 [&>ol]:space-y-2 [&>ol]:text-gray-600 [&>ol]:dark:text-gray-300
                [&>blockquote]:border-l-4 [&>blockquote]:border-gray-200 [&>blockquote]:dark:border-gray-700 
                [&>blockquote]:pl-4 [&>blockquote]:italic [&>blockquote]:my-4 [&>blockquote]:text-gray-600 [&>blockquote]:dark:text-gray-300`,dangerouslySetInnerHTML:{__html:C9(kV(a))}})}):null})]})}let Pu=({isOpen:e,onClick:t})=>S.j.jsx("button",{onClick:t,className:`
      absolute -left-8 top-1/2 -translate-y-1/2
      h-36 w-8 flex items-center justify-center group
      bg-[#F9FAFB] dark:bg-gray-800 
      border border-gray-200 dark:border-gray-700
      hover:bg-gray-50 dark:hover:bg-gray-700
      transition-colors rounded-l
      ${e?"":"z-10"}
    `,title:`${e?"Collapse":"Expand"} analysis panel (${S.a.TOGGLE_ANALYSIS})`,children:S.j.jsxs("div",{className:"relative flex flex-col h-full",children:[S.j.jsx("div",{className:"flex items-center justify-center flex-1",children:S.j.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:S.j.jsx(X,{className:"w-4 h-4"})})}),S.j.jsx("div",{className:"absolute -translate-x-1/2 bottom-2 left-1/2",children:S.j.jsx(S.K,{keyValue:S.a.TOGGLE_ANALYSIS,className:"scale-75"})})]})});function Pd({projectName:e,analysis:t=null,analysisTreeManager:n=null}){var r,i;let{apiEndpoint:o,token:s}=(0,C.useContext)(Th),a=(0,C.useRef)(null),[l,c]=(0,C.useState)(null==(r=null==t?void 0:t.data)?void 0:r.sql),[h,u]=(0,C.useState)(!1),[d,f]=(0,C.useState)(!0),[p,m]=(0,C.useState)(!1),g=(0,C.useContext)(S.M),y=t.analysis_id,b=null==(i=null==t?void 0:t.data)?void 0:i.parsedOutput;async function v(){if(h)return;let e="";try{let t=null==b?void 0:b.data;if(!t)return;let{columns:n,data:r}=t,i=n.filter(e=>"index"!==e.title);e=i.map(e=>e.title).join(",")+`
`;for(let t=0;t<r.length;t++){let n=r[t];for(let t=0;t<i.length;t++)e+=n[i[t].title],t<i.length-1&&(e+=",");e+=`
`}let o=new Blob([e],{type:"text/csv"}),s=URL.createObjectURL(o),a=document.createElement("a");a.href=s,a.download=`${y}-${new Date().toISOString().split(".")[0]}.csv`,a.click(),URL.revokeObjectURL(s),a.remove(),g.success("CSV saved.")}catch(e){console.error(e),g.error("Error saving CSV.")}finally{u(!1)}}let x=(0,C.useSyncExternalStore)(e=>n.subscribeToActiveTabChanges(t.analysis_id,e),()=>n.getActiveTab(t.analysis_id)),[w,k]=(0,C.useState)([]),O=(0,C.useMemo)(()=>{var n,r;return(null==b?void 0:b.csvString)&&S.j.jsx(Ph,{analysisId:t.analysis_id,projectName:e,question:null==(n=null==t?void 0:t.data)?void 0:n.initial_question,data_csv:null==b?void 0:b.csvString,sql:null==(r=null==t?void 0:t.data)?void 0:r.sql,apiEndpoint:o,token:s})},[t,e,o]),T=(0,C.useMemo)(()=>{var e;return b&&S.j.jsx(Pl,{stepData:b,initialQuestion:null==(e=null==t?void 0:t.data)?void 0:e.initial_question,initialOptionsExpanded:p})},[t,p]),A=e=>S.j.jsxs("div",{className:"flex",children:[S.j.jsx("div",{className:`
          transition-all duration-200 pr-6
          ${d?"w-[70%]":"w-[95%]"}
        `,children:e}),S.j.jsxs("div",{className:`
          relative
          transition-all duration-200 
          border-l border-gray-200 dark:border-gray-700
          ${d?"w-[30%]":"lg:w-[5%] w-0"}
        `,children:[S.j.jsxs("div",{className:"flex items-start",children:[S.j.jsx(Pu,{isOpen:d,onClick:()=>f(!d)}),S.j.jsxs("div",{className:"relative ml-2",onClick:()=>!d&&f(!0),children:[!d&&S.j.jsx("div",{className:"absolute inset-0 cursor-pointer",title:"Expand analysis panel"}),d&&S.j.jsx("div",{className:"relative w-[100%] max-h-[600px] overflow-y-auto",children:O})]})]}),S.j.jsx("div",{className:`
            absolute inset-y-0 right-0 w-24
            transition-opacity duration-200
            ${d?"opacity-0 pointer-events-none":"opacity-100"}
            bg-gradient-to-r from-transparent 
            via-white/50 to-white
            dark:via-gray-800/50 dark:to-gray-800
          `})]})]});return(0,C.useEffect)(()=>{let e=[],t=null==b?void 0:b.data;if(t){let n=(0,S.al)(t.data,t.columns);e.push({component:A(S.j.jsx(S.b,{rootClassNames:"lg:pl-0",rows:n,columns:t.columns.filter(e=>"index"!==e.title).map(e=>(e.render=e=>S.j.jsx("div",{children:e}),e)),pagination:{defaultPageSize:10,showSizeChanger:!0}})),key:"table",tabLabel:"Table",icon:S.j.jsx(Y,{className:"w-4 h-4 mb-0.5 mr-1 inline"})}),null!=b&&b.data&&e.push({component:A(S.j.jsx(wW,{children:T})),key:"chart",tabLabel:"Chart",icon:S.j.jsx(j,{className:"w-4 h-4 mb-0.5 mr-1 inline"})})}k(e)},[t,l,d]),(0,C.useEffect)(()=>{let e=e=>{document.activeElement!==document.body||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||((0,S.a5)(e.key,S.a.TOGGLE_ANALYSIS)&&(f(e=>!e),e.preventDefault()),(0,S.a5)(e.key,S.a.TOGGLE_CHART_OPTIONS)&&"chart"===x&&(m(e=>!e),e.preventDefault()),(0,S.a5)(e.key,S.a.VIEW_TABLE)&&(null==n||n.setActiveTab(y,"table"),e.preventDefault()),(0,S.a5)(e.key,S.a.VIEW_CHART)&&(null==n||n.setActiveTab(y,"chart"),e.preventDefault()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[x,y,n]),S.j.jsx("div",{className:"table-chart-ctr",ref:a,children:S.j.jsxs("div",{className:"flex flex-col w-full",children:[S.j.jsx("div",{className:"border-b border-gray-200",children:S.j.jsxs("div",{className:"flex items-center justify-between",children:[S.j.jsx("nav",{className:"flex space-x-4","aria-label":"Tabs",children:w.map(e=>S.j.jsxs("button",{onClick:()=>n.setActiveTab(y,e.key),className:`
                    px-3 py-2 text-sm font-medium rounded-t-lg flex items-center gap-2
                    ${x===e.key?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}
                  `,children:[S.j.jsxs("span",{className:"flex items-center",children:[e.icon,e.tabLabel]}),"table"===e.key&&S.j.jsx(S.K,{keyValue:S.a.VIEW_TABLE,className:"opacity-50 px-1 py-0.5"}),"chart"===e.key&&S.j.jsx(S.K,{keyValue:S.a.VIEW_CHART,className:"opacity-50 px-1 py-0.5"})]},e.key))}),S.j.jsxs(S.B,{onClick:async()=>{await v()},disabled:h,variant:"secondary",className:`flex mb-2 items-center px-2.5 py-1.5 hover:text-white text-white rounded-md border border-blue-200/50 
                bg-blue-500 hover:bg-blue-600/95 dark:bg-blue-900/20 dark:hover:bg-blue-800/30 
                shadow-sm  transition-all duration-200 
                dark:border-blue-700/50 dark:hover:border-blue-600/50
                hover:shadow-md hover:-translate-y-0.5
                group`,children:[S.j.jsx(S.D,{size:16,className:"mr-1"}),S.j.jsx("span",{children:"Download CSV"})]})]})}),S.j.jsx("div",{className:"relative mt-4",children:w.map(e=>S.j.jsx("div",{className:e.key===x?"z-2":"absolute overflow-hidden top-[-100%] z-[-1] pointer-events-none *:pointer-events-none opacity-0",children:e.component},e.key))})]})})}function Pf({error_message:e=null}){return S.j.jsxs("div",{className:"p-4 mb-4 border rounded-lg bg-rose-50 dark:bg-rose-900/20 border-rose-200 dark:border-rose-800",children:[S.j.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[S.j.jsx(S.am,{className:"w-4 h-4 text-rose-500 dark:text-rose-400"}),S.j.jsx("span",{className:"font-semibold text-rose-700 dark:text-rose-300",children:"An error occurred"})]}),S.j.jsx("div",{className:"pl-6 text-rose-600 dark:text-rose-400",children:e||"Something went wrong"})]})}function Pp({initialInputs:e,handleEdit:t}){let[n,r]=(0,C.useState)(e);function i(e,i){let o={...n};o[e]=i,r(o),t&&t(e,i)}return S.j.jsxs("div",{className:"text-sm text-gray-700 tool-input-list dark:text-gray-300",children:[n.question&&S.j.jsxs("div",{className:"mb-6",children:[S.j.jsxs("div",{className:"flex flex-row flex-wrap items-center gap-3 font-mono text-xs",children:[S.j.jsx("span",{className:"p-1 mr-2 text-gray-400 bg-gray-200 rounded-lg dark:bg-gray-700 dark:text-gray-400",children:"String"}),S.j.jsx("span",{className:"font-bold",children:"question"})]}),S.j.jsx("div",{className:"mt-2",children:S.j.jsx(S.e,{rootClassNames:"w-full",textAreaClassNames:"resize-none overflow-auto text-sm",value:n.question,defaultRows:1,onChange:e=>{i("question",e.target.value)}})})]}),n.hard_filters&&S.j.jsxs("div",{className:"space-y-4",children:[S.j.jsxs("div",{className:"flex flex-row flex-wrap items-center gap-3 font-mono text-xs",children:[S.j.jsx("span",{className:"p-1 mr-2 text-gray-400 bg-gray-200 rounded-lg dark:bg-gray-700 dark:text-gray-400",children:"List"}),S.j.jsx("span",{className:"font-bold",children:"hard_filters"})]}),S.j.jsxs("div",{className:"pb-4 space-y-2",children:[n.hard_filters.map((e,t)=>S.j.jsxs("div",{className:"flex items-center gap-2 group",children:[S.j.jsx(S.a4,{rootClassNames:"flex-1",value:e,placeholder:"Filter condition",onChange:e=>{let r=[...n.hard_filters];r[t]=e.target.value,i("hard_filters",r)}}),S.j.jsxs("button",{className:"p-1.5 text-gray-400  group-hover:text-red-500 transition-opacity",onClick:()=>{i("hard_filters",n.hard_filters.filter((e,n)=>n!==t))},children:[S.j.jsx("span",{className:"sr-only",children:"Remove filter"}),S.j.jsx(J,{size:16})]})]},t)),S.j.jsxs("button",{onClick:()=>i("hard_filters",[...n.hard_filters||[],""]),className:"flex mt-4 items-center gap-1.5 text-xs font-medium text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:[S.j.jsx(B,{size:14}),S.j.jsx("span",{children:"Add Filter"})]})]})]})]})}let Pm=({projectName:e,question:t,sql:n})=>{let[r,i]=(0,C.useState)(!1),[o,s]=(0,C.useState)(!1),[a,l]=(0,C.useState)(`






`),{apiEndpoint:c,token:h}=(0,C.useContext)(Th),u=(0,C.useContext)(S.M),d=(0,C.useCallback)(e=>{l(e)},[]),f=async()=>{s(!0),!0===(await (await fetch(c+"/integration/update_golden_queries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h,db_name:e,golden_queries:[{question:t,sql:a}]})})).json()).success?u.success("Feedback submitted successfully"):u.error("Failed to submit feedback"),s(!1),i(!1)};return S.j.jsxs("div",{className:"h-10 mt-2",children:[S.j.jsx("div",{className:"flex items-left h-10 gap-1",children:S.j.jsx("div",{className:"flex items-center justify-center w-40 h-10 rounded-full cursor-pointer",onClick:()=>{i(!0)},children:S.j.jsx("span",{className:"text-xs",children:"Bad result? Teach model to do better."})})}),S.j.jsx(S.o,{title:"Align the model by providing feedback",open:r,footer:null,onCancel:()=>i(!1),contentClassNames:"overflow-auto",children:S.j.jsxs("div",{className:"mt-4 dark:text-gray-200",children:[S.j.jsxs("p",{className:"mb-2",children:["Please provide the correct SQL query for answering this question. The question was:"," ",S.j.jsx("span",{className:"font-mono dark:text-blue-300 text-blue-500",children:t}),S.j.jsx("br",{})]}),S.j.jsx("p",{className:"mb-2",children:"The query originally generated by Defog was:"}),S.j.jsx(xE,{theme:"dark",extensions:[wQ(),fm.lineWrapping],value:n,basicSetup:{lineNumbers:!1},editable:!1,minHeight:"200px",className:"dark:bg-gray-800 rounded-md"}),S.j.jsx("p",{className:"mb-2",children:"Please enter the correct SQL query below:"}),S.j.jsx(xE,{theme:"dark",extensions:[wQ(),fm.lineWrapping],value:a,onChange:d,basicSetup:{lineNumbers:!1},editable:!0,minHeight:"200px",className:"dark:bg-gray-800 rounded-md"}),S.j.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white dark:bg-blue-600 dark:hover:bg-blue-800 font-bold py-2 px-4 rounded text-xs",onClick:f,children:"Submit SQL"})]})})]})},Pg=({projectName:e,question:t,submitFollowOn:n=e=>{}})=>{let[r,i]=(0,C.useState)([]),{apiEndpoint:o,token:s}=(0,C.useContext)(Th);async function a(){try{let n=(0,S.af)({protocol:"http",path:"query-data/generate_follow_on_questions",apiEndpoint:o}),r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_question:t,db_name:e,token:s})});if(r.ok){let e=await r.json();i(e.follow_on_questions||[])}else throw Error("Error generating follow on questions")}catch(e){console.error(e)}}return(0,C.useEffect)(()=>{a()},[]),S.j.jsx("div",{className:"p-4",children:S.j.jsx("div",{className:"max-w-[900px] w-full m-auto flex flex-row gap-4 justify-center",children:r&&r.length?r.map((e,t)=>S.j.jsx("button",{"data-testid":"follow-on-question",className:"p-2 m-1 text-sm text-gray-700 bg-white border border-gray-200 rounded-md shadow-sm cursor-pointer grow basis-1 dark:border-gray-600 dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 dark:text-gray-200",onClick:()=>{n(e)},children:e},t)):null})})};function Py({projectName:e,analysis:t,analysisBusy:n=!1,handleReRun:r=e=>{},submitFollowOn:i=e=>{},analysisTreeManager:o=null}){var s,a,l,c,h,u,d;let{hideSqlTab:f}=(0,C.useContext)(Th),p=null==t?void 0:t.data;null==t||t.analysis_id;let m=(0,C.useRef)({question:(null==(a=null==(s=null==t?void 0:t.data)?void 0:s.inputs)?void 0:a.question)||"",sql:(null==(l=null==t?void 0:t.data)?void 0:l.sql)||"",hard_filters:(null==(h=null==(c=null==t?void 0:t.data)?void 0:c.inputs)?void 0:h.hard_filters)||[]}),g=(0,C.useCallback)((e,t)=>{e&&(m.current[e]=t)},[p]),y=(0,C.useMemo)(()=>{var s,a,l;return[{name:"SQL/Code",content:S.j.jsxs(wW,{maybeOldAnalysis:!0,children:[(null==p?void 0:p.error)&&S.j.jsx(Pf,{error_message:null==p?void 0:p.error}),S.j.jsx("div",{className:"flex ",children:S.j.jsx("div",{className:"w-full",children:S.j.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[S.j.jsx("div",{className:"space-y-6",children:S.j.jsxs("div",{className:"space-y-2",children:[S.j.jsx("h3",{className:"text-xs font-medium text-gray-400 uppercase",children:"Inputs"}),S.j.jsx("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-800",children:S.j.jsx(Pp,{initialInputs:null==p?void 0:p.inputs,handleEdit:g})})]})}),S.j.jsxs("div",{className:"space-y-6",children:[S.j.jsxs("div",{className:"space-y-2",children:[S.j.jsx("h3",{className:"text-xs font-medium text-gray-400 uppercase",children:"Generated SQL"}),S.j.jsx("div",{className:"rounded-lg ",children:S.j.jsx(wU,{className:"tool-code-ctr",code:(null==p?void 0:p.sql)||"",language:"sql",editable:!0,handleEdit:g,updateProp:"sql"})})]}),(null==p?void 0:p.instructions_used)&&S.j.jsxs("div",{className:"space-y-2",children:[S.j.jsx("h3",{className:"text-xs font-medium text-gray-400 uppercase",children:"Instructions used for this query"}),S.j.jsx("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-800",children:S.j.jsx("p",{className:"text-sm leading-relaxed text-gray-600 dark:text-gray-300 whitespace-break-spaces",children:p.instructions_used})})]}),S.j.jsxs("div",{className:"flex justify-between mt-auto",children:[S.j.jsx(Pm,{projectName:e,question:null==(s=null==p?void 0:p.inputs)?void 0:s.question,sql:null==p?void 0:p.sql}),S.j.jsx("div",{className:"flex justify-end ",children:S.j.jsx(S.B,{disabled:n,className:"h-10 px-4 py-2 font-mono text-white bg-gray-600 border border-gray-200 hover:bg-blue-500 hover:text-white active:hover:text-white hover:border-transparent",onClick:()=>r(m.current),children:"Re run"})})]})]})]})})})]})},{name:"Analysis",content:S.j.jsxs("div",{children:[S.j.jsx(Pd,{projectName:e,analysis:t,analysisTreeManager:o}),(null==p?void 0:p.sql)&&S.j.jsx(Pm,{projectName:e,question:null==(a=null==p?void 0:p.inputs)?void 0:a.question,sql:null==p?void 0:p.sql}),S.j.jsx(Pg,{projectName:e,question:null==(l=null==p?void 0:p.inputs)?void 0:l.question,submitFollowOn:i})]},crypto.randomUUID())}]},[p,n]);return null!=p&&p.parsedOutput?S.j.jsxs("div",{className:"w-full h-full tool-results-ctr",children:[n&&S.j.jsxs("div",{className:"absolute top-0 left-0 z-20 flex flex-col items-center justify-center w-full h-full bg-white dark:bg-gray-900 bg-opacity-90 dark:bg-opacity-90 text-md dark:text-gray-300",children:[S.j.jsxs("span",{className:"my-1",children:[S.j.jsx(S.d,{}),"Running"]}),S.j.jsx(S.ag,{classNames:"text-gray-500 dark:text-gray-400 w-5 h-5"})]}),n?S.j.jsx("div",{className:"tool-run-loading",children:S.j.jsx(Ts,{message:"Running analysis..."})}):S.j.jsx(S.j.Fragment,{children:f?S.j.jsx("div",{children:null==(d=null==(u=y.filter(e=>"Analysis"===e.name))?void 0:u[0])?void 0:d.content}):S.j.jsx(S.T,{disableSingleSelect:!0,defaultSelected:"Analysis",tabs:y})})]}):S.j.jsx(S.j.Fragment,{})}let Pb=({analysisId:e,rootAnalysisId:t,projectName:n,isTemp:r=!1,metadata:i=null,sqlOnly:o=!1,rootClassNames:s="",createAnalysisRequestBody:a={},initiateAutoSubmit:l=!1,hasExternalSearchBar:c=!1,searchBarPlaceholder:h=null,extraTools:u=[],plannerQuestionSuffix:d=null,previousContextCreator:f=()=>[],setGlobalLoading:p=(...e)=>{},onManagerCreated:m=(...e)=>{},onManagerDestroyed:g=(...e)=>{},disabled:y=!1,initialConfig:b={analysisManager:null,analysisTreeManager:null},submitFollowOn:v=(...e)=>{},onHeightChange:x=(...e)=>{}})=>{var w,k,O,T,A,E,M,_,D;let{apiEndpoint:N,token:R,updateConfig:P,analysisDataCache:j}=(0,C.useContext)(Th),I=(0,C.useRef)(null),$=(0,C.useRef)(null),L=(0,C.useRef)(null);(0,C.useEffect)(()=>{var e;if(!$.current||!x)return;null==(e=L.current)||e.disconnect();let t=new ResizeObserver(e=>{e.forEach(e=>{x(e.contentRect.height)})});return t.observe($.current),L.current=t,()=>{var e;null==(e=L.current)||e.disconnect(),L.current=null}},[x]);let q=(0,C.useContext)(S.M),B=(0,C.useMemo)(()=>b.analysisManager||function({analysisId:e,rootAnalysisId:t,apiEndpoint:n,token:r,projectName:i,metadata:o,isTemp:s,sqlOnly:a=!1,extraTools:l=[],plannerQuestionSuffix:c="",previousContextCreator:h=()=>[],onNewData:u=(...e)=>{},onManagerDestroyed:d=(...e)=>{},onAbortError:f=(...e)=>{},createAnalysisRequestBody:p={}}){let m=null,g=!1,y=[],b=!1,v=!1,x=!1,w=[],k=(0,S.af)({protocol:"http",path:"query-data/clarify",apiEndpoint:n}),O=(0,S.af)({protocol:"http",path:"query-data/generate_analysis",apiEndpoint:n}),C=(0,S.af)({protocol:"http",path:"query-data/rerun",apiEndpoint:n});function T(e){var t;e&&(null!=(t=null==e?void 0:e.data)&&t.output&&(e.data.parsedOutput=function(e){let t={};return t.csvString=e,t.data=(0,S.q)(e),t.chartManager=Td({data:t.data.data,availableColumns:t.data.columns}),t}(e.data.output)),m=e,y.forEach(e=>e()))}function A(e){x=e,w.forEach(e=>e(x))}async function E(n,o={}){try{var u;if(b)throw Error("Analysis Manager already destroyed.");A(!0);let d=null!=(u=null==m?void 0:m.data)&&u.clarification_questions?"generate_analysis":"clarify",f;"clarify"===d?f=k:"generate_analysis"===d&&(f=O);let p={...o,request_type:d,analysis_id:e,user_question:n,sql_only:a,token:r,temp:s,db_name:i,db_creds:null,previous_context:h(),root_analysis_id:t,extra_tools:l,planner_question_suffix:c};if(console.groupCollapsed("Analysis Manager submitting"),console.log("Request body",p),!f)throw Error("Endpoint not found");let g=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(6e4),body:JSON.stringify(p)});if(!g.ok)throw Error("Failed to submit.");let y=await g.json();console.log(y),console.groupEnd(),T(y)}catch(e){console.log(e),f(e)}finally{A(!1)}}async function M(t){if(!t)throw Error("No inputs provided");try{A(!0);let n=await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:r,db_name:i,analysis_id:e,edited_inputs:t})});if(!n.ok)throw Error("Could not rerun step");let o=await n.json();T(o)}catch(e){throw Error(e instanceof Error?e.message:"Unknown error")}finally{A(!1)}}return{init:async function({question:t,existingData:o=null}){v=!0;let s=null,a=!1;if(o)s=o,a=!1;else{let t=await (0,S.ah)(e,r,n);t?s=t:(s=await (0,S.ai)(r,i,n,e,p),a=!0),g=a}T(s)},get wasNewAnalysisCreated(){return g},set wasNewAnalysisCreated(z){g=z},get didInit(){return v},get analysis(){return m},getAnalysis:function(){return m||null},subscribeToDataChanges:function(e){return y=[...y,e],function(){y=y.filter(t=>t!==e)}},getAnalysisBusy:function(){return x},subscribeToAnalysisBusyChanges:function(e){return w=[...w,e],function(){w=w.filter(t=>t!==e)}},setAnalysisBusy:A,submit:E,reRun:M,destroy:function(){b&&console.warn("Already destroyed"),console.groupCollapsed("Destroying. Open for trace"),console.log("Destroying"),console.trace(),console.groupEnd(),b=!0,d()},setOnNewDataCallback:function(e){}}}({analysisId:e,rootAnalysisId:t,apiEndpoint:N,token:R,projectName:n,metadata:i,isTemp:r,sqlOnly:o,extraTools:u,plannerQuestionSuffix:d,previousContextCreator:f,onAbortError:e=>{q.error(e),p(!1)},onManagerDestroyed:()=>g(e,$.current),createAnalysisRequestBody:a}),[e,q]),Q=(0,C.useSyncExternalStore)(B.subscribeToAnalysisBusyChanges,B.getAnalysisBusy),V=(0,C.useSyncExternalStore)(B.subscribeToDataChanges,B.getAnalysis);(0,C.useEffect)(()=>{var t,n,r,i,o,s,a,c;l&&null!=(t=null==V?void 0:V.data)&&t.initial_question&&!(null!=(n=null==V?void 0:V.data)&&n.clarification_questions)&&W(null==(r=null==V?void 0:V.data)?void 0:r.initial_question,{},null),null==(i=null==V?void 0:V.data)||!i.clarification_questions||(null==(o=null==V?void 0:V.data)?void 0:o.clarification_questions.length)!==0||null!=(s=null==V?void 0:V.data)&&s.parsedOutput||null!=(a=null==V?void 0:V.data)&&a.error||W(null==(c=null==V?void 0:V.data)?void 0:c.initial_question,{clarification_questions:[]}),P({analysisDataCache:{...j,[e]:V}}),p(!1)},[V]),(0,C.useEffect)(()=>{B.didInit||t();async function t(){var t;try{await B.init({question:null==(t=null==a?void 0:a.initialisation_details)?void 0:t.user_question,existingData:(null==j?void 0:j[e])||null}),B.wasNewAnalysisCreated&&P({analysisDataCache:{...j,[e]:V}})}catch(e){q.error(e.message),console.log(e.stack),B.destroy()}}},[]),(0,C.useEffect)(()=>{B&&m(B,e,$.current)},[B]);let W=(0,C.useCallback)((e,t={},n=null)=>{try{if(!e)throw Error("Query is empty");p(!0),B.submit(e,{...t})}catch(e){q.error(e),console.log(e.stack),p(!1),null===n&&c&&B.destroy()}},[B,p,q,o,c]),U=S.j.jsx(S.j.Fragment,{children:S.j.jsxs("div",{className:"flex flex-row flex-wrap items-center gap-4 p-6 transition-all duration-200 lg:items-start",children:[S.j.jsx("h1",{className:"font-bold text-xl text-gray-700 dark:text-gray-200 basis-0 grow min-w-[50%]",children:(0,S.an)((null==V?void 0:V.user_question)||a.user_question||"")}),!Q&&V&&V&&(null!=(w=null==V?void 0:V.data)&&w.clarification_questions||!c)?null:S.j.jsx("div",{className:"cursor-pointer basis-0 text-nowrap whitespace-nowrap group",onClick:()=>{console.log("clicked"),p(!1),B.destroy()},children:S.j.jsx(F,{className:"w-6 h-6 text-rose-300 group-hover:text-rose-500 dark:text-rose-400 dark:group-hover:text-rose-600"})})]})});return S.j.jsx(wW,{children:S.j.jsx("div",{ref:$,id:e,className:(0,S.t)("analysis-agent-container h-max min-h-20 relative grow outline-none focus:outline-none rounded-3xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 overflow-hidden",I?"bg-gray-50 dark:bg-gray-900":"max-w-full",s),children:Q?S.j.jsxs("div",{className:"flex flex-col w-full h-full bg-gray-50 dark:bg-gray-900 rounded-3xl max-h-96 border dark:border-gray-200",children:[U,S.j.jsx(Ts,{message:null!=(k=null==V?void 0:V.data)&&k.clarification_questions?"Fetching data...":"Thinking about whether I need to clarify the question...",classNames:"m-0 h-40 bg-transparent"})]}):S.j.jsxs(S.j.Fragment,{children:[c||null!=(O=null==V?void 0:V.data)&&O.clarification_questions?S.j.jsx(S.j.Fragment,{}):S.j.jsx("div",{className:"relative w-10/12 mx-auto top-6",children:S.j.jsx(S.a4,{ref:I,onPressEnter:e=>{W(e.target.value),e.target.value=""},placeholder:h||"Ask a question",disabled:y||Q,inputClassNames:"w-full mx-auto shadow-custom hover:border-blue-500 focus:border-blue-500"})}),null!=(T=null==V?void 0:V.data)&&T.clarification_questions&&!(null!=(A=null==V?void 0:V.data)&&A.output)?S.j.jsxs("div",{className:"w-full transition-all bg-gray-50 dark:bg-gray-900 rounded-3xl",children:[U,S.j.jsx(Ta,{questions:(null==(E=null==V?void 0:V.data)?void 0:E.clarification_questions)||[],handleSubmit:(e,t)=>{W(null==V?void 0:V.user_question,e,t)},globalLoading:Q})]}):S.j.jsx(S.j.Fragment,{}),(null==(M=null==V?void 0:V.data)?void 0:M.output)&&(null==(_=null==V?void 0:V.data)?void 0:_.parsedOutput)&&S.j.jsx("div",{className:"flex flex-col-reverse w-full h-full analysis-content lg:flex-row",children:S.j.jsxs("div",{className:"relative flex flex-col min-w-0 analysis-results grow dark:border-gray-600",children:[U,S.j.jsx(wW,{children:(null==(D=null==V?void 0:V.data)?void 0:D.parsedOutput)&&S.j.jsx(Py,{projectName:n,analysis:V,analysisBusy:Q,handleReRun:async e=>{console.log(e);try{await B.reRun(e)}catch(e){console.log(e),q.error(e.message)}},analysisTreeManager:null==b?void 0:b.analysisTreeManager,submitFollowOn:e=>{console.log("clicked follow on",e),v(e)}})})]})})]})})})};function Pv({analysis:e=null,activeAnalysisId:t=null,extraClasses:n="",isDummy:r=!1,onClick:i=(...e)=>{}}){let o=e&&t===e.analysisId;return S.j.jsx("div",{className:(0,S.t)("flex flex-row items-center dark:text-gray-300",r?"dummy-analysis m-0 mb-3 bg-blue-50 dark:bg-gray-700 border border-blue-200 dark:border-blue-800 shadow-sm text-blue-700 dark:text-blue-300 rounded-md":e&&e.analysisId&&"mb-1",n),children:S.j.jsxs("div",{className:"grow",children:[S.j.jsx("div",{className:r?"p-3 hover:cursor-pointer flex items-center":(0,S.t)("title hover:cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 history-item p-3 text-sm rounded-md transition-colors duration-200 mb-2 border border-transparent",o?"font-medium bg-blue-50 dark:bg-gray-700 border-blue-200 dark:border-blue-800 shadow-sm text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:border-gray-200 dark:hover:border-gray-700"),onClick:()=>{i(r?null:e)},children:r?S.j.jsxs("div",{className:"flex items-center",children:[S.j.jsx(Z,{size:18})," ",S.j.jsx("span",{className:"font-medium ml-2",children:"New Report"})]}):S.j.jsxs(S.j.Fragment,{children:[S.j.jsx("div",{className:"line-clamp-2 font-medium",children:(0,S.an)(null==e?void 0:e.user_question)}),(null==e?void 0:e.timestamp)&&S.j.jsxs("div",{className:"flex items-center text-xs mt-1.5 text-gray-500 dark:text-gray-400",children:[S.j.jsx("span",{className:"inline-block w-3 h-3 mr-1.5 rounded-full bg-blue-200 dark:bg-blue-700"}),new Date(e.timestamp).toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]})]})}),!r&&e&&e.children&&e.children.length>0&&S.j.jsx("div",{className:"ml-2",children:e.children.map(e=>S.j.jsx(Pv,{analysis:e,activeAnalysisId:t,isDummy:r,extraClasses:"ml-2",onClick:i},e.analysisId))})]})})}let Px=(0,C.forwardRef)(function({searchBarClasses:e="",searchBarDraggable:t=!0,loading:n=!1,handleSubmit:r,activeRootAnalysisId:i,activeAnalysisId:o,forceSqlOnly:s=!1,setSqlOnly:a,sqlOnly:l,question:c,onNewConversationTextClick:h=()=>{}},u){let d=(0,C.useRef)(null),f=(0,C.useRef)(!1);return(0,C.useEffect)(()=>{c&&(u.current.value=c,u.current.focus())},[c,u]),(0,C.useEffect)(()=>{if(t)return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)};function e(){d.current&&(d.current.style.left="0",d.current.style.right="0",d.current.style.bottom=window.innerWidth>1600?"30%":"20px")}},[t]),(0,C.useEffect)(()=>{if(t)return document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)};function e(e){if(!f.current||!d.current)return;let t=window.innerHeight-e.clientY-d.current.clientHeight,n=e.clientX,r=window.innerHeight-20-d.current.clientHeight;t<20?d.current.style.bottom="20px":t>r?d.current.style.bottom=r+"px":d.current.style.bottom=t+"px";let i=window.innerWidth-d.current.clientWidth-20;d.current.style.right="auto",n<20?d.current.style.left="20px":n>i?d.current.style.left=i+"px":d.current.style.left=n+"px"}function n(){f.current=!1}},[t]),(0,C.useEffect)(()=>{function e(e){document.activeElement===document.body&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.shiftKey&&((0,S.a5)(e.key,S.a.FOCUS_SEARCH)?(e.preventDefault(),u&&"current"in u&&u.current&&u.current.focus()):(0,S.a5)(e.key,S.a.NEW_CONVERSATION)&&(e.preventDefault(),h(),u&&"current"in u&&u.current&&u.current.focus()))}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[u,h]),S.j.jsx("div",{className:(0,S.t)("w-full lg:w-8/12 m-auto [&_textarea]:pl-2 bg-white dark:bg-gray-800 rounded-lg shadow-custom border border-gray-400 dark:border-gray-600 hover:border-blue-500 dark:hover:border-blue-500 focus:border-blue-500 dark:focus:border-blue-500",t?"fixed z-40":"",e),style:{left:"0",right:"0",bottom:t?window.innerWidth>1600?"30%":"20px":null},ref:d,children:S.j.jsxs("div",{className:"flex flex-row",children:[t&&S.j.jsx("div",{className:"flex items-center w-3 min-h-full ml-1 cursor-move group",onMouseDown:e=>{t&&(f.current=!0,e.preventDefault())},children:S.j.jsx(W,{className:"w-3 h-3 text-gray-400 dark:text-gray-500 group-hover:text-primary-text dark:group-hover:text-gray-300"})}),S.j.jsx("div",{className:"flex flex-row items-center rounded-md grow",children:S.j.jsxs("div",{className:"flex flex-row grow",children:[S.j.jsxs("div",{className:"relative flex flex-row-reverse items-center grow",children:[S.j.jsx(S.e,{rootClassNames:"grow border-none bg-transparent py-1.5 text-gray-900 dark:text-gray-100 px-2 placeholder:text-gray-400 dark:placeholder:text-gray-500 sm:leading-6 text-sm break-words focus:ring-0 focus:outline-none",textAreaClassNames:"resize-none pr-8",ref:u,id:"main-searchbar",disabled:n,defaultRows:1,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),e.stopPropagation(),r(u.current.value,i,!i,o)):"Escape"===e.key&&(e.preventDefault(),u&&"current"in u&&u.current&&u.current.blur())},placeholder:i?"Type your next question here":"Type your question here"}),S.j.jsx(S.K,{keyValue:S.a.FOCUS_SEARCH,className:"absolute -translate-y-1/2 opacity-50 pointer-events-none right-3 top-1/2"}),S.j.jsxs("span",{className:"relative inline-block pl-2 group hover:cursor-pointer hover:bg-gray-100 hover:text-blue-600",onClick:()=>{h()},children:[S.j.jsxs("div",{className:"flex items-center gap-2",children:[S.j.jsx(Z,{}),S.j.jsx(S.K,{keyValue:S.a.NEW_CONVERSATION,className:"opacity-50"})]}),S.j.jsx("span",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-max px-3 py-2 bg-gray-800 text-white text-xs rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",children:"Start New Thread"})]})]}),S.j.jsxs("button",{type:"button",className:"relative -ml-px inline-flex items-center gap-x-1.5 rounded-r-md px-3 p-0 text-sm font-semibold text-gray-900 dark:text-gray-100 ring-1 ring-inset ring-blue-500 hover:bg-blue-500 hover:text-white dark:hover:text-white",onClick:()=>{r(u.current.value,i,!i,o)},children:[S.j.jsx(N,{className:"-ml-0.5 h-5 w-5 text-gray-400 dark:text-gray-500","aria-hidden":"true"}),"Ask"]})]})})]})})});var Pw=NaN,Pk=/^\s+|\s+$/g,PO=/^[-+]0x[0-9a-f]+$/i,PS=/^0b[01]+$/i,PC=/^0o[0-7]+$/i,PT=parseInt,PA="object"==typeof S.a1&&S.a1&&S.a1.Object===Object&&S.a1,PE="object"==typeof self&&self&&self.Object===Object&&self,PM=PA||PE||Function("return this")(),P_=Object.prototype.toString,PD=Math.max,PN=Math.min,PR=function(){return PM.Date.now()};function PP(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Pj(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==P_.call(t))return Pw;if(PP(e)){var t,n="function"==typeof e.valueOf?e.valueOf():e;e=PP(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Pk,"");var r=PS.test(e);return r||PC.test(e)?PT(e.slice(2),r?2:8):PO.test(e)?Pw:+e}let PI=(0,S.a3)(function(e,t,n){var r,i,o,s,a,l,c=0,h=!1,u=!1,d=!0;if("function"!=typeof e)throw TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function p(e){var n=e-l,r=e-c;return void 0===l||n>=t||n<0||u&&r>=o}function m(){var e,n,r,i=PR();if(p(i))return g(i);a=setTimeout(m,(e=i-l,n=i-c,r=t-e,u?PN(r,o-n):r))}function g(e){return a=void 0,d&&r?f(e):(r=i=void 0,s)}function y(){var e,n=PR(),o=p(n);if(r=arguments,i=this,l=n,o){if(void 0===a)return c=e=l,a=setTimeout(m,t),h?f(e):s;if(u)return a=setTimeout(m,t),f(l)}return void 0===a&&(a=setTimeout(m,t)),s}return t=Pj(t)||0,PP(n)&&(h=!!n.leading,o=(u="maxWait"in n)?PD(Pj(n.maxWait)||0,t):o,d="trailing"in n?!!n.trailing:d),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=l=i=a=void 0},y.flush=function(){return void 0===a?s:g(PR())},y}),P$=(e,t,n="smooth")=>{var r,i;let o=t&&(null==(i=null==(r=null==t?void 0:t.current)?void 0:r[e])?void 0:i.ctr);(o||(o=document.getElementById(e)))&&o.scrollIntoView({behavior:n,block:"start"})},PL=(e,t)=>(0,C.useMemo)(()=>{try{let n=Object.keys(e).sort((t,n)=>{var r,i;return((null==(r=null==e?void 0:e[n])?void 0:r.timestamp)||0)-((null==(i=null==e?void 0:e[t])?void 0:i.timestamp)||0)}),r={Today:[],Yesterday:[],"Past week":[],"Past month":[],Earlier:[]},i=new Date,o=new Date(i);o.setDate(o.getDate()-1);let s=new Date(i);s.setDate(s.getDate()-7);let a=new Date(i);return a.setMonth(a.getMonth()-1),n.forEach(e=>{let n=t[e].root.timestamp,l=new Date(n);l.toDateString()===i.toDateString()?r.Today.push(e):l.toDateString()===o.toDateString()?r.Yesterday.push(e):l>=s?r["Past week"].push(e):l>=a?r["Past month"].push(e):r.Earlier.push(e)}),Object.keys(r).forEach(e=>{r[e].sort((e,n)=>{var r,i,o,s;return((null==(i=null==(r=null==t?void 0:t[n])?void 0:r.root)?void 0:i.timestamp)||0)-((null==(s=null==(o=null==t?void 0:t[e])?void 0:o.root)?void 0:s.timestamp)||0)})}),r}catch{return console.warn("Error in sorting keys. Returning as is."),{Earlier:Object.keys(e)}}},[e,t]),Pq=async(e,t,n,r,i,o,s,a,l,c)=>{let h="analysis-"+crypto.randomUUID(),{newAnalysis:u}=await e.submit({question:t,analysisId:h,rootAnalysisId:n?h:r,projectName:i,isRoot:n,directParentId:o,sqlOnly:a||s,isTemp:l,activeTab:c});return r||e.setActiveRootAnalysisId(u.analysisId),e.setActiveAnalysisId(u.analysisId),e.setActiveRootAnalysisId(u.rootAnalysisId),h},Pz=(e,t,n,r,i,o,s,a,l,c,h,u)=>(0,C.useCallback)(async(d,f=null,p=!1,m=null)=>{try{if(u(!0),!e)throw Error("Analysis tree manager not found");let c=e.getAll(),g="analysis",y="table";if(Object.keys(c).length>0){let e=await (0,S.ap)(o,t,s,d);g=e.question_type,y=e.default_open_tab}if("edit-chart"===g){f?await PB(c,d,l,a,e,o):await Pq(e,d,p,f,t,m,r,n,i,"chart");return}let b=await Pq(e,d,p,f,t,m,r,n,i,y);(0,S.r)(()=>{P$(b,h)})}catch(e){a.error("Failed to create analysis"),console.error(e)}finally{c.current&&(c.current.value=""),u(!1)}},[e,n,r,i,t,h]),PB=async(e,t,n,r,i,o)=>{var s,a,l,c;let h=(0,S.l)(Object.keys(e)),u=e[h.id],d=null==(l=null==(a=null==(s=null==u?void 0:u.analysisManager)?void 0:s.getAnalysis())?void 0:a.data)?void 0:l.parsedOutput;if(!d){r.error("No visible analysis found to edit chart");return}if(!(null!=(c=null==d?void 0:d.chartManager)&&c.config)){r.error("No chart found in the visible analysis");return}try{await d.chartManager.editChart(o,t,n,{onError:e=>{r.error(e.message),console.error(e)}}),i.setActiveTab(h.id,"chart")}catch(e){r.error(e.message),console.error(e)}},PF=(e,t)=>{(0,C.useEffect)(()=>{Object.values(e).forEach(e=>{t.current[e.analysisId]={id:e.analysisId,ctr:document.getElementById(e.analysisId),analysisManager:e.analysisManager}})},[e])},PQ=(e,t,n,r,i)=>{(0,C.useEffect)(()=>{r.current&&(clearTimeout(r.current),r.current=null,i.current=!1),i.current=!0,r.current=setTimeout(()=>{e&&t&&n.current[e]&&P$(e,n),i.current=!1},500)},[])},PV=({projectName:e,activeRootAnalysisId:t,nestedTree:n,metadata:r,analysisDomRefs:i,analysisTreeManager:o,autoScroll:s,setLoading:a,submitFollowOn:l})=>{if(!t||!n[t])return null;let c=(0,C.useSyncExternalStore)(o.subscribeToActiveAnalysisIdChanges,o.getActiveAnalysisId),h=e=>(0,S.t)("w-full mb-4 [&_.analysis-content]:min-h-96 shadow-md transition-opacity duration-200",`analysis-${e}`,e===c?"border-2 border-blue-500 dark:border-blue-400 bg-white dark:bg-gray-800 z-2 relative":"opacity-50 hover:opacity-75 bg-gray-50/80 dark:bg-gray-900/80 relative -z-0");return S.j.jsxs(S.j.Fragment,{children:[S.j.jsx(Pb,{projectName:e,setGlobalLoading:a,metadata:r,rootClassNames:h(t),analysisId:t,rootAnalysisId:t,createAnalysisRequestBody:n[t].createAnalysisRequestBody,initiateAutoSubmit:!0,hasExternalSearchBar:!0,sqlOnly:n[t].sqlOnly,isTemp:n[t].isTemp,previousContextCreator:()=>[],onManagerCreated:(e,r,s)=>{i.current[r]={ctr:s,analysisManager:e,id:r},o.updateAnalysis({analysisId:t,isRoot:n[t].isRoot,updateObj:{analysisManager:e}})},onManagerDestroyed:e=>{o.removeAnalysis({analysisId:t,isRoot:n[t].isRoot,rootAnalysisId:t}),o.setActiveAnalysisId(null),t===e&&o.setActiveRootAnalysisId(null),a(!1)},initialConfig:{analysisTreeManager:o},submitFollowOn:l},t),n[t].flatOrderedChildren.map(n=>S.j.jsx(Pb,{projectName:e,metadata:r,rootClassNames:h(n.analysisId),analysisId:n.analysisId,rootAnalysisId:n.rootAnalysisId,createAnalysisRequestBody:n.createAnalysisRequestBody,setGlobalLoading:a,initiateAutoSubmit:!0,hasExternalSearchBar:!0,sqlOnly:n.sqlOnly,isTemp:n.isTemp,previousContextCreator:()=>n.allParents.reverse().map(e=>{var t,n,r,i;let o=null==(t=null==e?void 0:e.analysisManager)?void 0:t.analysis;return o&&null!=o&&o.data?{question:null==(r=null==(n=null==o?void 0:o.data)?void 0:n.inputs)?void 0:r.question,sql:null==(i=null==o?void 0:o.data)?void 0:i.sql}:null}).filter(e=>e&&e.sql&&e.question),onManagerCreated:(e,t,r)=>{i.current[t]={ctr:r,analysisManager:e,id:t},o.updateAnalysis({analysisId:n.analysisId,isRoot:n.isRoot,updateObj:{analysisManager:e}})},onManagerDestroyed:e=>{o.removeAnalysis({analysisId:n.analysisId,isRoot:n.isRoot,rootAnalysisId:n.rootAnalysisId}),o.setActiveAnalysisId(null),t===e&&o.setActiveRootAnalysisId(null),a(!1)},initialConfig:{analysisTreeManager:o},submitFollowOn:l},n.analysisId))]})},PW=({predefinedQuestions:e,handleSubmit:t,activeRootAnalysisId:n,activeAnalysisId:r})=>S.j.jsx("div",{className:"grow flex flex-col place-content-center m-auto max-w-full relative z-[1]",children:S.j.jsxs("div",{className:"text-center text-gray-400 rounded-md dark:text-gray-500",children:[S.j.jsx("p",{className:"block mb-4 text-sm font-bold cursor-default",children:"Quickstart"}),S.j.jsx("ul",{className:"font-light text-gray-500 dark:text-gray-400",children:e.map((e,i)=>S.j.jsx("li",{children:S.j.jsx("button",{className:(0,S.t)("cursor-pointer text-sm p-2 m-1 border border-gray-200 dark:border-gray-700 rounded-md shadow-sm","hover:bg-gray-50 dark:hover:bg-gray-800 hover:border"),onClick:()=>{t((0,S.an)(e),n,!n,r)},children:(0,S.an)(e)})},i))})]})});function PU({analysisTreeManager:e,projectName:t,isTemp:n=!1,forceSqlOnly:r=!1,metadata:i=null,predefinedQuestions:o=[],autoScroll:s=!0,sideBarClasses:a="",searchBarClasses:l="",searchBarDraggable:c=!0,defaultSidebarOpen:h=!1,onTreeChange:u=()=>{},beforeTitle:d=null}){let f=(0,C.useContext)(S.M),{token:p,apiEndpoint:m}=(0,C.useContext)(Th),g=(0,C.useRef)(null),y=(0,C.useRef)({}),b=(0,C.useRef)(null),v=(0,C.useRef)(!1),[x,w]=(0,C.useState)(!1),[k,O]=(0,C.useState)(!0),[T,A]=(0,C.useState)(""),[E,M]=(0,C.useState)(h),[_,D]=(0,C.useState)(e.getActiveAnalysisId()),[N,R]=(0,C.useState)(e.getActiveRootAnalysisId()),[P,j]=(0,C.useState)(e.getAll()),I=(0,S.af)({protocol:"http",path:"edit_chart",apiEndpoint:m}),$=(0,C.useSyncExternalStore)(e.subscribeToDataChanges,e.getTree),L=(0,C.useMemo)(()=>e.getNestedTree(),[$]),q=PL(L,$);(0,C.useEffect)(()=>{let t=e.setActiveAnalysisId;return e.setActiveAnalysisId=n=>(D(n),t.call(e,n)),()=>{e.setActiveAnalysisId=t}},[e]),(0,C.useEffect)(()=>{let t=e.setActiveRootAnalysisId;return e.setActiveRootAnalysisId=n=>(R(n),t.call(e,n)),()=>{e.setActiveRootAnalysisId=t}},[e]),(0,C.useEffect)(()=>{j(e.getAll())},[$]);let B=Pz(e,t,r,k,n,p,m,f,I,g,y,w);(0,C.useEffect)(()=>{w(!1),y.current={}},[e]),(0,C.useEffect)(()=>{n||u(t,$)},[u,t,$,n]),PF(P,y),PQ(_,s,y,b,v);let F=(0,C.useCallback)(()=>{let t=e.getAll(),{id:n}=(0,S.l)(Object.keys(t));if(!n||n===e.getActiveAnalysisId())return;let r=t[n].rootAnalysisId;e.setActiveAnalysisId(n),e.setActiveRootAnalysisId(r)},[]);return S.j.jsx(wW,{children:S.j.jsxs("div",{className:"flex flex-row w-full h-full max-w-full text-gray-600 bg-white dark:bg-gray-900 analysis-tree-viewer",children:[S.j.jsx("div",{className:"absolute left-0 top-0 z-[20] lg:sticky h-full",children:S.j.jsx(S.S,{location:"left",open:E,onChange:e=>{M(e)},beforeTitle:d,title:S.j.jsxs("h2",{className:"font-bold text-gray-800 dark:text-gray-200 mb-3 text-lg flex items-center justify-between",children:[S.j.jsxs("span",{className:"flex items-center",children:[S.j.jsx("span",{className:"mr-2",children:"\uD83D\uDCDA"})," History"]}),S.j.jsx("span",{title:"Clear history",className:"inline-block text-xs font-medium text-gray-400 cursor-pointer dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-500 px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:()=>{e.reset(),e.setActiveAnalysisId(null),e.setActiveRootAnalysisId(null)},children:"Clear"})]}),rootClassNames:(0,S.t)("transition-all z-20 h-[calc(100%-1rem)] absolute left-0 min-h-full shadow-lg lg:shadow-none lg:sticky top-0 bg-gray-50 dark:bg-gray-800 z-20 border-r border-gray-100 dark:border-gray-700",a),contentClassNames:"w-72 p-5 rounded-tl-lg relative sm:block min-h-96 h-full overflow-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600 scrollbar-track-transparent",children:S.j.jsxs("div",{className:"flex flex-col w-full h-full space-y-4",children:[S.j.jsx("div",{className:"sticky top-0 mb-4",children:S.j.jsx(Pv,{isDummy:!0,onClick:()=>{A(""),v.current=!0,e.setActiveRootAnalysisId(null),e.setActiveAnalysisId(null)}})}),Object.entries(q).map(([t,n])=>0===n.length?null:S.j.jsxs("div",{className:"mb-6",children:[S.j.jsxs("div",{className:"px-2 mb-3 text-xs font-medium tracking-wide text-blue-600 dark:text-blue-400 uppercase flex items-center",children:[S.j.jsx("div",{className:"h-px bg-blue-100 dark:bg-blue-800 flex-grow mr-2"}),t,S.j.jsx("div",{className:"h-px bg-blue-100 dark:bg-blue-800 flex-grow ml-2"})]}),n.map(t=>{let n=L[t];return S.j.jsx("div",{children:S.j.jsx(Pv,{analysis:n,activeAnalysisId:_,onClick:n=>{e.setActiveRootAnalysisId(t),e.setActiveAnalysisId((null==n?void 0:n.analysisId)||t),window.innerWidth<S.ao.lg&&M(!1),b.current&&(clearTimeout(b.current),b.current=null,v.current=!1),b.current=setTimeout(()=>{v.current=!0,s&&P$((null==n?void 0:n.analysisId)||t,y),v.current=!1},200)},extraClasses:(0,S.t)("ml-4")},null==n?void 0:n.analysisId)},null==n?void 0:n.analysisId)})]},t))]})})}),S.j.jsx("div",{className:(0,S.t)("absolute left-0 top-0 h-full w-full overlay lg:hidden bg-gray-800 dark:bg-gray-900 z-[11] transition-all",E?"opacity-50 block":"opacity-0 pointer-events-none"),onClick:()=>{M(!1)}}),S.j.jsxs("div",{className:(0,S.t)("relative w-full h-full min-w-0 p-2 pt-10 overflow-y-auto overflow-x-clip rounded-tr-lg sm:pt-0 grow lg:p-4",_?"":"flex flex-col"),onScroll:PI(e=>{v.current||(e.stopPropagation(),F())},100),children:[_&&N&&L[N]&&S.j.jsx(PV,{projectName:t,activeRootAnalysisId:N,nestedTree:L,metadata:i,analysisDomRefs:y,analysisTreeManager:e,autoScroll:s,setLoading:w,submitFollowOn:A}),!_&&(x?S.j.jsx("div",{className:"flex items-center justify-center h-full",children:S.j.jsx(S.ag,{})}):S.j.jsx(PW,{predefinedQuestions:o,handleSubmit:B,activeRootAnalysisId:N,activeAnalysisId:_})),S.j.jsx("div",{className:c?"":"fixed bottom-1 z-40 lg:w-4/6 w-11/12 mx-auto left-0 right-0",children:S.j.jsx(Px,{ref:g,searchBarClasses:l,searchBarDraggable:c,handleSubmit:B,loading:x,activeRootAnalysisId:N,activeAnalysisId:_,forceSqlOnly:r,setSqlOnly:O,sqlOnly:k,question:T,onNewConversationTextClick:()=>{v.current=!0,e.setActiveRootAnalysisId(null),e.setActiveAnalysisId(null),window.innerWidth<S.ao.lg&&M(!1)}})})]})]})})}function PH(e){this.content=e}PH.prototype={constructor:PH,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return -1},get:function(e){var t=this.find(e);return -1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,i=r.find(e),o=r.content.slice();return -1==i?o.push(n||e,t):(o[i+1]=t,n&&(o[i]=n)),new PH(o)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new PH(n)},addToStart:function(e,t){return new PH([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new PH(n)},addBefore:function(e,t,n){var r=this.remove(t),i=r.content.slice(),o=r.find(e);return i.splice(-1==o?i.length:o,0,t,n),new PH(i)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=PH.from(e)).size?new PH(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=PH.from(e)).size?new PH(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=PH.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},PH.from=function(e){if(e instanceof PH)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new PH(t)};class PG{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,n,r=0,i){for(let o=0,s=0;s<t;o++){let a=this.content[o],l=s+a.nodeSize;if(l>e&&!1!==n(a,r+s,i||null,o)&&a.content.size){let i=s+1;a.nodesBetween(Math.max(0,e-i),Math.min(a.content.size,t-i),n,r+i)}s=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let i="",o=!0;return this.nodesBetween(e,t,(s,a)=>{let l=s.isText?s.text.slice(Math.max(e,a)-a,t-a):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(o?o=!1:i+=n),i+=l},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),i=1);i<e.content.length;i++)r.push(e.content[i]);return new PG(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let i=0,o=0;o<t;i++){let s=this.content[i],a=o+s.nodeSize;a>e&&((o<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-o),Math.min(s.text.length,t-o)):s.cut(Math.max(0,e-o-1),Math.min(s.content.size,t-o-1))),n.push(s),r+=s.nodeSize),o=a}return new PG(n,r)}cutByIndex(e,t){return e==t?PG.empty:0==e&&t==this.content.length?this:new PG(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),i=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new PG(r,i)}addToStart(e){return new PG([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new PG(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return function e(t,n,r){for(let i=0;;i++){if(i==t.childCount||i==n.childCount)return t.childCount==n.childCount?null:r;let o=t.child(i),s=n.child(i);if(o==s){r+=o.nodeSize;continue}if(!o.sameMarkup(s))return r;if(o.isText&&o.text!=s.text){for(let e=0;o.text[e]==s.text[e];e++)r++;return r}if(o.content.size||s.content.size){let t=e(o.content,s.content,r+1);if(null!=t)return t}r+=o.nodeSize}}(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return function e(t,n,r,i){for(let o=t.childCount,s=n.childCount;;){if(0==o||0==s)return o==s?null:{a:r,b:i};let a=t.child(--o),l=n.child(--s),c=a.nodeSize;if(a==l){r-=c,i-=c;continue}if(!a.sameMarkup(l))return{a:r,b:i};if(a.isText&&a.text!=l.text){let e=0,t=Math.min(a.text.length,l.text.length);for(;e<t&&a.text[a.text.length-e-1]==l.text[l.text.length-e-1];)e++,r--,i--;return{a:r,b:i}}if(a.content.size||l.content.size){let t=e(a.content,l.content,r-1,i-1);if(t)return t}r-=c,i-=c}}(this,e,t,n)}findIndex(e,t=-1){if(0==e)return PZ(0,e);if(e==this.size)return PZ(this.content.length,e);if(e>this.size||e<0)throw RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=r+this.child(n).nodeSize;if(i>=e)return i==e||t>0?PZ(n+1,i):PZ(n,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return PG.empty;if(!Array.isArray(t))throw RangeError("Invalid input for Fragment.fromJSON");return new PG(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return PG.empty;let t,n=0;for(let r=0;r<e.length;r++){let i=e[r];n+=i.nodeSize,r&&i.isText&&e[r-1].sameMarkup(i)?(t||(t=e.slice(0,r)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new PG(t||e,n)}static from(e){if(!e)return PG.empty;if(e instanceof PG)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new PG([e],e.nodeSize);throw RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}PG.empty=new PG([],0);let PX={index:0,offset:0};function PZ(e,t){return PX.index=e,PX.offset=t,PX}function PY(e,t){if(e===t)return!0;if(!(e&&"object"==typeof e)||!(t&&"object"==typeof t))return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!PY(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!PY(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let PJ=class e{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let i=e[r];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,r));else{if(i.type.excludes(this.type))return e;!n&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(i)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&PY(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return e.none;if(t instanceof e)return[t];let n=t.slice();return n.sort((e,t)=>e.type.rank-t.type.rank),n}};PJ.none=[];class PK extends Error{}class P0{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=function e(t,n,r,i){let{index:o,offset:s}=t.findIndex(n),a=t.maybeChild(o);if(s==n||a.isText)return t.cut(0,n).append(r).append(t.cut(n));let l=e(a.content,n-s-1,r);return l&&t.replaceChild(o,a.copy(l))}(this.content,e+this.openStart,t);return n&&new P0(n,this.openStart,this.openEnd)}removeBetween(e,t){return new P0(function e(t,n,r){let{index:i,offset:o}=t.findIndex(n),s=t.maybeChild(i),{index:a,offset:l}=t.findIndex(r);if(o==n||s.isText){if(l!=r&&!t.child(a).isText)throw RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(i!=a)throw RangeError("Removing non-flat range");return t.replaceChild(i,s.copy(e(s.content,n-o-1,r-o-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return P0.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw RangeError("Invalid input for Slice.fromJSON");return new P0(PG.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let n=e.lastChild;n&&!n.isLeaf&&(t||!n.type.spec.isolating);n=n.lastChild)r++;return new P0(e,n,r)}}function P1(e,t){if(!t.type.compatibleContent(e.type))throw new PK("Cannot join "+t.type.name+" onto "+e.type.name)}function P2(e,t,n){let r=e.node(n);return P1(r,t.node(n)),r}function P5(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function P3(e,t,n,r){let i=(t||e).node(n),o=0,s=t?t.index(n):i.childCount;e&&(o=e.index(n),e.depth>n?o++:e.textOffset&&(P5(e.nodeAfter,r),o++));for(let e=o;e<s;e++)P5(i.child(e),r);t&&t.depth==n&&t.textOffset&&P5(t.nodeBefore,r)}function P4(e,t){return e.type.checkContent(t),e.copy(t)}function P6(e,t,n){let r=[];return P3(null,e,n,r),e.depth>n&&P5(P4(P2(e,t,n+1),P6(e,t,n+1)),r),P3(t,null,n,r),new PG(r)}P0.empty=new P0(PG.empty,0,0);class P8{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)r+=n.child(t).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return PJ.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let i=n.marks;for(var o=0;o<i.length;o++)!1!==i[o].type.spec.inclusive||r&&i[o].isInSet(r.marks)||(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var i=0;i<n.length;i++)!1!==n[i].type.spec.inclusive||r&&n[i].isInSet(r.marks)||(n=n[i--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new jt(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw RangeError("Position "+t+" out of range");let n=[],r=0,i=t;for(let t=e;;){let{index:e,offset:o}=t.content.findIndex(i),s=i-o;if(n.push(t,e,r+o),!s||(t=t.child(e)).isText)break;i=s-1,r+=o+1}return new P8(t,n,i)}static resolveCached(e,t){let n=je.get(e);if(n)for(let e=0;e<n.elts.length;e++){let r=n.elts[e];if(r.pos==t)return r}else je.set(e,n=new P9);let r=n.elts[n.i]=P8.resolve(e,t);return n.i=(n.i+1)%P7,r}}class P9{constructor(){this.elts=[],this.i=0}}let P7=12,je=new WeakMap;class jt{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let jn=Object.create(null),jr=class e{constructor(e,t,n,r=PJ.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||PG.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&PY(this.attrs,t||e.defaultAttrs||jn)&&PJ.sameSet(this.marks,n||PJ.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return P0.empty;let r=this.resolve(e),i=this.resolve(t),o=n?0:r.sharedDepth(t),s=r.start(o);return new P0(r.node(o).content.cut(r.pos-s,i.pos-s),r.depth-o,i.depth-o)}replace(e,t,n){return function(e,t,n){if(n.openStart>e.depth)throw new PK("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new PK("Inconsistent open depths");return function e(t,n,r,i){let o=t.index(i),s=t.node(i);if(o==n.index(i)&&i<t.depth-r.openStart){let a=e(t,n,r,i+1);return s.copy(s.content.replaceChild(o,a))}if(!r.content.size)return P4(s,P6(t,n,i));if(r.openStart||r.openEnd||t.depth!=i||n.depth!=i){let{start:e,end:o}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let e=n-1;e>=0;e--)r=t.node(e).copy(PG.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(r,t);return P4(s,function e(t,n,r,i,o){let s=t.depth>o&&P2(t,n,o+1),a=i.depth>o&&P2(r,i,o+1),l=[];return P3(null,t,o,l),s&&a&&n.index(o)==r.index(o)?(P1(s,a),P5(P4(s,e(t,n,r,i,o+1)),l)):(s&&P5(P4(s,P6(t,n,o+1)),l),P3(n,r,o,l),a&&P5(P4(a,P6(r,i,o+1)),l)),P3(i,null,o,l),new PG(l)}(t,e,o,n,i))}{let e=t.parent,i=e.content;return P4(e,i.cut(0,t.parentOffset).append(r.content).append(i.cut(n.parentOffset)))}}(e,t,n,0)}(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(!(t=t.maybeChild(n)))return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return P8.resolveCached(this,e)}resolveNoCache(e){return P8.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),jo(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=PG.empty,r=0,i=n.childCount){let o=this.contentMatchAt(e).matchFragment(n,r,i),s=o&&o.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(let e=r;e<i;e++)if(!this.type.allowsMarks(n.child(e).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let i=this.contentMatchAt(e).matchType(n),o=i&&i.matchFragment(this.content,t);return!!o&&o.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=PJ.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!PJ.sameSet(e,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){let n;if(!t)throw RangeError("Invalid input for Node.fromJSON");if(t.marks){if(!Array.isArray(t.marks))throw RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=PG.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,r,n);return i.type.checkAttrs(i.attrs),i}};jr.prototype.text=void 0;class ji extends jr{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):jo(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ji(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ji(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function jo(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class js{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){var n;let r,i=new ja(e,t);if(null==i.next)return js.empty;let o=function e(t){let n=[];do n.push(function(t){let n=[];do n.push(function(t){let n=function(t){if(t.eat("(")){let n=e(t);return t.eat(")")||t.err("Missing closing paren"),n}if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=(function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let i=[];for(let e in n){let r=n[e];r.isInGroup(t)&&i.push(r)}return 0==i.length&&e.err("No node type or group '"+t+"' found"),i})(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}}(t);for(;;)if(t.eat("+"))n={type:"plus",expr:n};else if(t.eat("*"))n={type:"star",expr:n};else if(t.eat("?"))n={type:"opt",expr:n};else if(t.eat("{"))n=function(e,t){let n=jl(e),r=n;return e.eat(",")&&(r="}"!=e.next?jl(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}(t,n);else break;return n}(t));while(t.next&&")"!=t.next&&"|"!=t.next);return 1==n.length?n[0]:{type:"seq",exprs:n}}(t));while(t.eat("|"));return 1==n.length?n[0]:{type:"choice",exprs:n}}(i);i.next&&i.err("Unexpected trailing text");let s=(n=function(e){let t=[[]];return i(function e(t,o){if("choice"==t.type)return t.exprs.reduce((t,n)=>t.concat(e(n,o)),[]);if("seq"==t.type)for(let r=0;;r++){let s=e(t.exprs[r],o);if(r==t.exprs.length-1)return s;i(s,o=n())}else if("star"==t.type){let s=n();return r(o,s),i(e(t.expr,s),s),[r(s)]}else if("plus"==t.type){let s=n();return i(e(t.expr,o),s),i(e(t.expr,s),s),[r(s)]}else{if("opt"==t.type)return[r(o)].concat(e(t.expr,o));if("range"==t.type){let s=o;for(let r=0;r<t.min;r++){let r=n();i(e(t.expr,s),r),s=r}if(-1==t.max)i(e(t.expr,s),s);else for(let o=t.min;o<t.max;o++){let o=n();r(s,o),i(e(t.expr,s),o),s=o}return[r(s)]}if("name"==t.type)return[r(o,void 0,t.value)];throw Error("Unknown expr type")}}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let i={term:r,to:n};return t[e].push(i),i}function i(e,t){e.forEach(e=>e.to=t)}}(o),r=Object.create(null),function e(t){let i=[];t.forEach(e=>{n[e].forEach(({term:e,to:t})=>{let r;if(e){for(let t=0;t<i.length;t++)i[t][0]==e&&(r=i[t][1]);jh(n,t).forEach(t=>{r||i.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})}})});let o=r[t.join(",")]=new js(t.indexOf(n.length-1)>-1);for(let t=0;t<i.length;t++){let n=i[t][1].sort(jc);o.next.push({type:i[t][0],next:r[n.join(",")]||e(n)})}return o}(jh(n,0)));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],i=!e.validEnd,o=[];for(let t=0;t<e.next.length;t++){let{type:n,next:s}=e.next[t];o.push(n.name),i&&!(n.isText||n.hasRequiredAttrs())&&(i=!1),-1==r.indexOf(s)&&r.push(s)}i&&t.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,i),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let i=t;r&&i<n;i++)r=r.matchType(e.child(i).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function i(o,s){let a=o.matchFragment(e,n);if(a&&(!t||a.validEnd))return PG.from(s.map(e=>e.createAndFill()));for(let e=0;e<o.next.length;e++){let{type:t,next:n}=o.next[e];if(!(t.isText||t.hasRequiredAttrs())&&-1==r.indexOf(n)){r.push(n);let e=i(n,s.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),i=r.match;if(i.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<i.next.length;e++){let{type:o,next:s}=i.next[e];o.isLeaf||o.hasRequiredAttrs()||o.name in t||r.type&&!s.validEnd||(n.push({match:o.contentMatch,type:o,via:r}),t[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let n=0;n<t.next.length;n++)r+=(n?", ":"")+t.next[n].type.name+"->"+e.indexOf(t.next[n].next);return r}).join(`
`)}}js.empty=new js(!0);class ja{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw SyntaxError(e+" (in content expression '"+this.string+"')")}}function jl(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function jc(e,t){return t-e}function jh(e,t){let n=[];return function t(r){let i=e[r];if(1==i.length&&!i[0].term)return t(i[0].to);n.push(r);for(let e=0;e<i.length;e++){let{term:r,to:o}=i[e];r||-1!=n.indexOf(o)||t(o)}}(t),n.sort(jc)}function ju(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function jd(e,t){let n=Object.create(null);for(let r in e){let i=t&&t[r];if(void 0===i){let t=e[r];if(t.hasDefault)i=t.default;else throw RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function jf(e,t,n,r){for(let r in t)if(!(r in e))throw RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let n in e){let r=e[n];r.validate&&r.validate(t[n])}}function jp(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new jg(e,r,t[r]);return n}let jm=class e{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=jp(e,n.attrs),this.defaultAttrs=ju(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==js.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:jd(this.attrs,e)}create(e=null,t,n){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new jr(this,this.computeAttrs(e),PG.from(t),PJ.setFrom(n))}createChecked(e=null,t,n){return t=PG.from(t),this.checkContent(t),new jr(this,this.computeAttrs(e),t,PJ.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=PG.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),i=r&&r.fillBefore(PG.empty,!0);return i?new jr(this,e,t.append(i),PJ.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let t=0;t<e.childCount;t++)if(!this.allowsMarks(e.child(t).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){jf(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){let t;if(null==this.markSet)return e;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:PJ.none:e}static compile(t,n){let r=Object.create(null);t.forEach((t,i)=>r[t]=new e(t,n,i));let i=n.spec.topNode||"doc";if(!r[i])throw RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw RangeError("Every schema needs a 'text' type");for(let e in r.text.attrs)throw RangeError("The text node type should not have attributes");return r}};class jg{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let i=null===n?"null":typeof n;if(0>r.indexOf(i))throw RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${i}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class jy{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=jp(e,r.attrs),this.excluded=null;let i=ju(this.attrs);this.instance=i?new PJ(this,i):null}create(e=null){return!e&&this.instance?this.instance:new PJ(this,jd(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,i)=>n[e]=new jy(e,r++,t,i)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){jf(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class jb{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let n in e)t[n]=e[n];t.nodes=PH.from(e.nodes),t.marks=PH.from(e.marks||{}),this.nodes=jm.compile(this.spec.nodes,this),this.marks=jy.compile(this.spec.marks,this);let n=Object.create(null);for(let e in this.nodes){if(e in this.marks)throw RangeError(e+" can not be both a node and a mark");let t=this.nodes[e],r=t.spec.content||"",i=t.spec.marks;if(t.contentMatch=n[r]||(n[r]=js.parse(r,this.nodes)),t.inlineContent=t.contentMatch.inlineContent,t.spec.linebreakReplacement){if(this.linebreakReplacement)throw RangeError("Multiple linebreak nodes defined");if(!t.isInline||!t.isLeaf)throw RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=t}t.markSet="_"==i?null:i?jv(this,i.split(" ")):""!=i&&t.inlineContent?null:[]}for(let e in this.marks){let t=this.marks[e],n=t.spec.excludes;t.excluded=null==n?[t]:""==n?[]:jv(this,n.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else if(e instanceof jm){if(e.schema!=this)throw RangeError("Node type from different schema used ("+e.name+")")}else throw RangeError("Invalid node type: "+e);return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new ji(n,n.defaultAttrs,e,PJ.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return jr.fromJSON(this,e)}markFromJSON(e){return PJ.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw RangeError("Unknown node type: "+e);return t}}function jv(e,t){let n=[];for(let r=0;r<t.length;r++){let i=t[r],o=e.marks[i],s=o;if(o)n.push(o);else for(let t in e.marks){let r=e.marks[t];("_"==i||r.spec.group&&r.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=r)}if(!s)throw SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}let jx=class e{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(null!=e.tag)this.tags.push(e);else if(null!=e.style){let t=/[^=]*/.exec(e.style)[0];0>n.indexOf(t)&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new jT(this,t,!1);return n.addAll(e,PJ.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new jT(this,t,!0);return n.addAll(e,PJ.none,t.from,t.to),P0.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){var r;let n=this.tags[i];if(r=n.tag,(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,r)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let i=r?this.styles.indexOf(r)+1:0;i<this.styles.length;i++){let r=this.styles[i],o=r.style;if(!(0!=o.indexOf(e)||r.context&&!n.matchesContext(r.context)||o.length>e.length&&(61!=o.charCodeAt(e.length)||o.slice(e.length+1)!=t))){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let t in e.marks){let r=e.marks[t].spec.parseDOM;r&&r.forEach(e=>{n(e=jA(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)})}for(let t in e.nodes){let r=e.nodes[t].spec.parseDOM;r&&r.forEach(e=>{n(e=jA(e)),e.node||e.ignore||e.mark||(e.node=t)})}return t}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}},jw={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},jk={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},jO={ol:!0,ul:!0};function jS(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class jC{constructor(e,t,n,r,i,o){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=o,this.content=[],this.activeMarks=PJ.none,this.match=i||(4&o?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(PG.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let t=this.type.contentMatch,n;return(n=t.findWrapping(e.type))?(this.match=t,n):null}}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e=this.content[this.content.length-1],t;e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-t[0].length)))}let t=PG.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(PG.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!jw.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class jT{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r=t.topNode,i,o=jS(null,t.preserveWhitespace,0)|(n?4:0);i=r?new jC(r.type,r.attrs,PJ.none,!0,t.topMatch||r.type.contentMatch,o):n?new jC(null,null,PJ.none,!0,null,o):new jC(e.schema.topNodeType,null,PJ.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,i=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===i||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(i)n="full"!==i?n.replace(/\r?\n|\r/g," "):n.replace(/\r\n?/g,`
`);else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],i=e.previousSibling;(!t||i&&"BR"==i.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,i=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),s;jO.hasOwnProperty(o)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&jO.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,n));e:if(a?a.ignore:jk.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,r=this.needsBlock;if(jw.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),n=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let s=a&&a.skip?t:this.readStyles(e,t);s&&this.addAll(e,s),n&&this.sync(i),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?s:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let e=0;e<this.parser.matchedStyles.length;e++){let r=this.parser.matchedStyles[e],i=n.getPropertyValue(r);if(i)for(let e;;){let n=this.parser.matchStyle(r,i,this,e);if(!n)break;if(n.ignore)return null;if(t=n.clearMark?t.filter(e=>!n.clearMark(e)):t.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1===n.consuming)e=n;else break}}return t}addElementByRule(e,t,n,r){let i,o;if(t.node){if((o=this.parser.schema.nodes[t.node]).isLeaf)this.insertNode(o.create(t.attrs),n)||this.leafFallback(e,n);else{let e=this.enter(o,t.attrs||null,n,t.preserveWhitespace);e&&(i=!0,n=e)}}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let s=this.top;if(o&&o.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}i&&this.sync(s)&&this.open--}addAll(e,t,n,r){let i=n||0;for(let o=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];o!=s;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t){let n,r;for(let t=this.open;t>=0;t--){let i=this.nodes[t],o=i.findWrapping(e);if(o&&(!n||n.length>o.length)&&(n=o,r=i,!o.length)||i.solid)break}if(!n)return null;this.sync(r);for(let e=0;e<n.length;e++)t=this.enterInner(n[e],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let n=this.findPlace(e,t);if(n){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let r=PJ.none;for(let i of n.concat(e.marks))(t.type?t.type.allowsMarkType(i.type):jE(i.type,e.type))&&(r=i.addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,n,r){let i=this.findPlace(e.create(t),n);return i&&(i=this.enterInner(e,t,n,!0,r)),i}enterInner(e,t,n,r=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let s=jS(e,i,o.options);4&o.options&&0==o.content.length&&(s|=4);let a=PJ.none;return n=n.filter(t=>(o.type?!o.type.allowsMarkType(t.type):!jE(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new jC(e,t,a,r,null,s)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),i=-(n?n.depth+1:0)+(r?0:1),o=(e,s)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;s>=i;s--)if(o(e-1,s))return!0;return!1}{let e=s>0||0==s&&r?this.nodes[s].type:n&&s>=i?n.node(s-i).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;s--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}}function jA(e){let t={};for(let n in e)t[n]=e[n];return t}function jE(e,t){let n=t.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(e))continue;let o=[],s=e=>{o.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:i}=e.edge(n);if(r==t||0>o.indexOf(i)&&s(i))return!0}};if(s(i.contentMatch))return!0}}class jM{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=jD(t).createDocumentFragment());let r=n,i=[];return e.forEach(e=>{if(i.length||e.marks.length){let n=0,o=0;for(;n<i.length&&o<e.marks.length;){let t=e.marks[o];if(!this.marks[t.type.name]){o++;continue}if(!t.eq(i[n][0])||!1===t.type.spec.spanning)break;n++,o++}for(;n<i.length;)r=i.pop()[1];for(;o<e.marks.length;){let n=e.marks[o++],s=this.serializeMark(n,e.isInline,t);s&&(i.push([n,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=jR(jD(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let i=this.serializeMark(e.marks[r],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(n),n=i.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&jR(jD(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return jR(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new jM(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=j_(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return j_(e.marks)}}function j_(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function jD(e){return e.document||window.document}let jN=new WeakMap;function jR(e,t,n,r){let i,o;if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let s=t[0],a;if("string"!=typeof s)throw RangeError("Invalid array passed to renderSpec");if(r&&(void 0===(i=jN.get(r))&&jN.set(r,(o=null,function e(t){if(t&&"object"==typeof t){if(Array.isArray(t)){if("string"==typeof t[0])o||(o=[]),o.push(t);else for(let n=0;n<t.length;n++)e(t[n])}else for(let n in t)e(t[n])}}(r),i=o)),a=i)&&a.indexOf(t)>-1)throw RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let l=s.indexOf(" ");l>0&&(n=s.slice(0,l),s=s.slice(l+1));let c,h=n?e.createElementNS(n,s):e.createElement(s),u=t[1],d=1;if(u&&"object"==typeof u&&null==u.nodeType&&!Array.isArray(u)){for(let e in d=2,u)if(null!=u[e]){let t=e.indexOf(" ");t>0?h.setAttributeNS(e.slice(0,t),e.slice(t+1),u[e]):h.setAttribute(e,u[e])}}for(let i=d;i<t.length;i++){let o=t[i];if(0===o){if(i<t.length-1||i>d)throw RangeError("Content hole must be the only child of its parent node");return{dom:h,contentDOM:h}}{let{dom:t,contentDOM:i}=jR(e,o,n,r);if(h.appendChild(t),i){if(c)throw RangeError("Multiple content holes");c=i}}}return{dom:h,contentDOM:c}}class jP{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class jj{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&jj.empty)return jj.empty}recover(e){let t=0,n=65535&e;if(!this.inverted)for(let e=0;e<n;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*n]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?r:0);if(a>e)break;let l=this.ranges[s+i],c=this.ranges[s+o],h=a+l;if(e<=h){let i=l?e==a?-1:e==h?1:t:t,o=a+r+(i<0?0:c);if(n)return o;let u=e==(t<0?a:h)?null:s/3+(e-a)*65536,d=e==a?2:e==h?1:4;return(t<0?e!=a:e!=h)&&(d|=8),new jP(o,d,u)}r+=c-l}return n?e+r:new jP(e+r,0,null)}touches(e,t){let n=0,r=65535&t,i=this.inverted?2:1,o=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let s=this.ranges[t]-(this.inverted?n:0);if(s>e)break;let a=this.ranges[t+i];if(e<=s+a&&t==3*r)return!0;n+=this.ranges[t+o]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,i=0;r<this.ranges.length;r+=3){let o=this.ranges[r],s=o-(this.inverted?i:0),a=o+(this.inverted?0:i),l=this.ranges[r+t],c=this.ranges[r+n];e(s,s+l,a,a+c),i+=c-l}}invert(){return new jj(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?jj.empty:new jj(e<0?[0,-e,0]:[0,0,e])}}jj.empty=new jj([]);class jI{constructor(e=[],t,n=0,r=e.length){this.maps=e,this.mirror=t,this.from=n,this.to=r}slice(e=0,t=this.maps.length){return new jI(this.maps,this.mirror,e,t)}copy(){return new jI(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,n=this.maps.length;t<e.maps.length;t++){let r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new jI;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let n=this.from;n<this.to;n++){let i=this.maps[n].mapResult(e,t);if(null!=i.recover){let t=this.getMirror(n);if(null!=t&&t>n&&t<this.to){n=t,e=this.maps[t].recover(i.recover);continue}}r|=i.delInfo,e=i.pos}return n?e:new jP(e,r,null)}}let j$=Object.create(null);class jL{getMap(){return jj.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let n=j$[t.stepType];if(!n)throw RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in j$)throw RangeError("Duplicate use of step JSON ID "+e);return j$[e]=t,t.prototype.jsonID=e,t}}class jq{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new jq(e,null)}static fail(e){return new jq(null,e)}static fromReplace(e,t,n,r){try{return jq.ok(e.replace(t,n,r))}catch(e){if(e instanceof PK)return jq.fail(e.message);throw e}}}function jz(e,t,n){let r=[];for(let i=0;i<e.childCount;i++){let o=e.child(i);o.content.size&&(o=o.copy(jz(o.content,t,o))),o.isInline&&(o=t(o,n,i)),r.push(o)}return PG.fromArray(r)}class jB extends jL{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),i=new P0(jz(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return jq.fromReplace(e,this.from,this.to,i)}invert(){return new jF(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new jB(t.pos,n.pos,this.mark)}merge(e){return e instanceof jB&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new jB(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new jB(t.from,t.to,e.markFromJSON(t.mark))}}jL.jsonID("addMark",jB);class jF extends jL{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new P0(jz(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return jq.fromReplace(e,this.from,this.to,n)}invert(){return new jB(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new jF(t.pos,n.pos,this.mark)}merge(e){return e instanceof jF&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new jF(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new jF(t.from,t.to,e.markFromJSON(t.mark))}}jL.jsonID("removeMark",jF);class jQ extends jL{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return jq.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return jq.fromReplace(e,this.pos,this.pos+1,new P0(PG.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new jQ(this.pos,t.marks[n]);return new jQ(this.pos,this.mark)}}return new jV(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new jQ(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new jQ(t.pos,e.markFromJSON(t.mark))}}jL.jsonID("addNodeMark",jQ);class jV extends jL{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return jq.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return jq.fromReplace(e,this.pos,this.pos+1,new P0(PG.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new jQ(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new jV(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new jV(t.pos,e.markFromJSON(t.mark))}}jL.jsonID("removeNodeMark",jV);class jW extends jL{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&jH(e,this.from,this.to)?jq.fail("Structure replace would overwrite content"):jq.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new jj([this.from,this.to-this.from,this.slice.size])}invert(e){return new jW(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new jW(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof jW)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?P0.empty:new P0(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new jW(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?P0.empty:new P0(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new jW(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new jW(t.from,t.to,P0.fromJSON(e,t.slice),!!t.structure)}}jL.jsonID("replace",jW);class jU extends jL{constructor(e,t,n,r,i,o,s=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=i,this.insert=o,this.structure=s}apply(e){if(this.structure&&(jH(e,this.from,this.gapFrom)||jH(e,this.gapTo,this.to)))return jq.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return jq.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?jq.fromReplace(e,this.from,this.to,n):jq.fail("Content does not fit in gap")}getMap(){return new jj([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new jU(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||i>n.pos?null:new jU(t.pos,n.pos,r,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new jU(t.from,t.to,t.gapFrom,t.gapTo,P0.fromJSON(e,t.slice),t.insert,!!t.structure)}}function jH(e,t,n){let r=e.resolve(t),i=n-t,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let e=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,i--}}return!1}function jG(e,t,n,r=n.contentMatch,i=!0){let o=e.doc.nodeAt(t),s=[],a=t+1;for(let t=0;t<o.childCount;t++){let l=o.child(t),c=a+l.nodeSize,h=r.matchType(l.type);if(h){r=h;for(let t=0;t<l.marks.length;t++)n.allowsMarkType(l.marks[t].type)||e.step(new jF(a,c,l.marks[t]));if(i&&l.isText&&"pre"!=n.whitespace){let e,t=/\r?\n|\r/g,r;for(;e=t.exec(l.text);)r||(r=new P0(PG.from(n.schema.text(" ",n.allowedMarks(l.marks))),0,0)),s.push(new jW(a+e.index,a+e.index+e[0].length,r))}}else s.push(new jW(a,c,P0.empty));a=c}if(!r.validEnd){let t=r.fillBefore(PG.empty,!0);e.replace(a,a,new P0(t,0,0))}for(let t=s.length-1;t>=0;t--)e.step(s[t])}function jX(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let r=e.$from.node(n),i=e.$from.index(n),o=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(i,o,t))return n;if(0==n||r.type.spec.isolating||!((0==i||r.canReplace(i,r.childCount))&&(o==r.childCount||r.canReplace(0,o))))break}return null}function jZ(e,t,n=null,r=e){let i=function(e,t){let{parent:n,startIndex:r,endIndex:i}=e,o=n.contentMatchAt(r).findWrapping(t);if(!o)return null;let s=o.length?o[0]:t;return n.canReplaceWith(r,i,s)?o:null}(e,t),o=i&&function(e,t){let{parent:n,startIndex:r,endIndex:i}=e,o=n.child(r),s=t.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:t).contentMatch;for(let e=r;a&&e<i;e++)a=a.matchType(n.child(e).type);return a&&a.validEnd?s:null}(r,t);return o?i.map(jY).concat({type:t,attrs:n}).concat(o.map(jY)):null}function jY(e){return{type:e,attrs:null}}function jJ(e,t,n,r){t.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let i=e.mapping.slice(r).map(n+1+o+s.index);e.replaceWith(i,i+1,t.type.schema.linebreakReplacement.create())}}})}function jK(e,t,n,r){t.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let i=e.mapping.slice(r).map(n+1+o);e.replaceWith(i,i+1,t.type.schema.text(`
`))}})}function j0(e,t,n=1,r){let i=e.resolve(t),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let e=i.depth-1,t=n-2;e>o;e--,t--){let n=i.node(e),o=i.index(e);if(n.type.spec.isolating)return!1;let s=n.content.cutByIndex(o,n.childCount),a=r&&r[t+1];a&&(s=s.replaceChild(0,a.type.create(a.attrs)));let l=r&&r[t]||n;if(!n.canReplace(o+1,n.childCount)||!l.type.validContent(s))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function j1(e,t){let n=e.resolve(t),r=n.index();return j2(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function j2(e,t){return!!(e&&t&&!e.isLeaf&&function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let i=0;i<t.childCount;i++){let o=t.child(i),s=o.type==r?e.type.schema.nodes.text:o.type;if(!(n=n.matchType(s))||!e.type.allowsMarks(o.marks))return!1}return n.validEnd}(e,t))}function j5(e,t,n=-1){let r=e.resolve(t);for(let e=r.depth;;e--){let i,o,s=r.index(e);if(e==r.depth?(i=r.nodeBefore,o=r.nodeAfter):n>0?(i=r.node(e+1),s++,o=r.node(e).maybeChild(s)):(i=r.node(e).maybeChild(s-1),o=r.node(e+1)),i&&!i.isTextblock&&j2(i,o)&&r.node(e).canReplace(s,s+1))return t;if(0==e)break;t=n<0?r.before(e):r.after(e)}}function j3(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let i=n.content;for(let e=0;e<n.openStart;e++)i=i.firstChild.content;for(let e=1;e<=(0==n.openStart&&n.size?2:1);e++)for(let t=r.depth;t>=0;t--){let n=t==r.depth?0:r.pos<=(r.start(t+1)+r.end(t+1))/2?-1:1,o=r.index(t)+(n>0?1:0),s=r.node(t),a=!1;if(1==e)a=s.canReplace(o,o,i);else{let e=s.contentMatchAt(o).findWrapping(i.firstChild.type);a=e&&s.canReplaceWith(o,o,e[0])}if(a)return 0==n?r.pos:n<0?r.before(t+1):r.after(t+1)}return null}function j4(e,t,n=t,r=P0.empty){if(t==n&&!r.size)return null;let i=e.resolve(t),o=e.resolve(n);return j6(i,o,r)?new jW(t,n,r):new j8(i,o,r).fit()}function j6(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}jL.jsonID("replaceAround",jU);class j8{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=PG.empty;for(let t=0;t<=e.depth;t++){let n=e.node(t);this.frontier.push({type:n.type,match:n.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=PG.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let i=this.placed,o=n.depth,s=r.depth;for(;o&&s&&1==i.childCount;)i=i.firstChild.content,o--,s--;let a=new P0(i,o,s);return e>-1?new jU(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new jW(n.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let i=t.firstChild;if(t.childCount>1&&(r=0),i.type.spec.isolating&&r<=n){e=n;break}t=i.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e=null,r=(n?(e=Ie(this.unplaced.content,n-1).firstChild).content:this.unplaced.content).firstChild;for(let i=this.depth;i>=0;i--){let{type:o,match:s}=this.frontier[i],a,l=null;if(1==t&&(r?s.matchType(r.type)||(l=s.fillBefore(PG.from(r),!1)):e&&o.compatibleContent(e.type)))return{sliceDepth:n,frontierDepth:i,parent:e,inject:l};if(2==t&&r&&(a=s.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:i,parent:e,wrap:a};if(e&&s.matchType(e.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Ie(e,t);return!!r.childCount&&!r.firstChild.isLeaf&&(this.unplaced=new P0(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Ie(e,t);if(r.childCount<=1&&t>0){let i=e.size-t<=t+r.size;this.unplaced=new P0(j9(e,t-1,1),t-1,i?t-1:n)}else this.unplaced=new P0(j9(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let e=0;e<i.length;e++)this.openFrontierNode(i[e]);let o=this.unplaced,s=n?n.content:o.content,a=o.openStart-e,l=0,c=[],{match:h,type:u}=this.frontier[t];if(r){for(let e=0;e<r.childCount;e++)c.push(r.child(e));h=h.matchFragment(r)}let d=s.size+e-(o.content.size-o.openEnd);for(;l<s.childCount;){let e=s.child(l),t=h.matchType(e.type);if(!t)break;(++l>1||0==a||e.content.size)&&(h=t,c.push(function e(t,n,r){if(n<=0)return t;let i=t.content;return n>1&&(i=i.replaceChild(0,e(i.firstChild,n-1,1==i.childCount?r-1:0))),n>0&&(i=t.type.contentMatch.fillBefore(i).append(i),r<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(PG.empty,!0)))),t.copy(i)}(e.mark(u.allowedMarks(e.marks)),1==l?a:0,l==s.childCount?d:-1)))}let f=l==s.childCount;f||(d=-1),this.placed=j7(this.placed,t,PG.from(c)),this.frontier[t].match=h,f&&d<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=s;e<d;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=f?0==e?P0.empty:new P0(j9(o.content,e-1,1),e-1,d<0?o.openEnd:e-1):new P0(j9(o.content,e,l),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!It(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=It(e,t,r,n,i);if(o){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],i=It(e,n,r,t,!0);if(!i||i.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=j7(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=j7(this.placed,this.depth,PG.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(PG.empty,!0);e.childCount&&(this.placed=j7(this.placed,this.frontier.length,e))}}function j9(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(j9(e.firstChild.content,t-1,n)))}function j7(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(j7(e.lastChild.content,t-1,n)))}function Ie(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function It(e,t,n,r,i){let o=e.node(t),s=i?e.indexAfter(t):e.index(t);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,o.content,s)?a:null}function In(e,t){let n=[],r=Math.min(e.depth,t.depth);for(let i=r;i>=0;i--){let r=e.start(i);if(r<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(r==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==r-1)&&n.push(i)}return n}class Ir extends jL{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return jq.fail("No node at attribute step's position");let n=Object.create(null);for(let e in t.attrs)n[e]=t.attrs[e];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return jq.fromReplace(e,this.pos,this.pos+1,new P0(PG.from(r),0,t.isLeaf?0:1))}getMap(){return jj.empty}invert(e){return new Ir(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ir(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new Ir(t.pos,t.attr,t.value)}}jL.jsonID("attr",Ir);class Ii extends jL{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let n in e.attrs)t[n]=e.attrs[n];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return jq.ok(n)}getMap(){return jj.empty}invert(e){return new Ii(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new Ii(t.attr,t.value)}}jL.jsonID("docAttr",Ii);let Io=class extends Error{};(Io=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n}).prototype=Object.create(Error.prototype),Io.prototype.constructor=Io,Io.prototype.name="TransformError";class Is{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new jI}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Io(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=P0.empty){let r=j4(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new P0(PG.from(n),0,0))}delete(e,t){return this.replace(e,t,P0.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let i=e.doc.resolve(t),o=e.doc.resolve(n);if(j6(i,o,r))return e.step(new jW(t,n,r));let s=In(i,e.doc.resolve(n));0==s[s.length-1]&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let e=i.depth,t=i.pos-1;e>0;e--,t--){let n=i.node(e).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;s.indexOf(e)>-1?a=e:i.before(e)==t&&s.splice(1,0,-e)}let l=s.indexOf(a),c=[],h=r.openStart;for(let e=r.content,t=0;;t++){let n=e.firstChild;if(c.push(n),t==r.openStart)break;e=n.content}for(let e=h-1;e>=0;e--){var u;let t=c[e],n=(u=t.type).spec.defining||u.spec.definingForContent;if(n&&!t.sameMarkup(i.node(Math.abs(a)-1)))h=e;else if(n||!t.type.isTextblock)break}for(let t=r.openStart;t>=0;t--){let a=(t+h+1)%(r.openStart+1),u=c[a];if(u)for(let t=0;t<s.length;t++){let c=s[(t+l)%s.length],h=!0;c<0&&(h=!1,c=-c);let d=i.node(c-1),f=i.index(c-1);if(d.canReplaceWith(f,f,u.type,u.marks))return e.replace(i.before(c),h?o.after(c):n,new P0(function e(t,n,r,i,o){if(n<r){let o=t.firstChild;t=t.replaceChild(0,o.copy(e(o.content,n+1,r,i,o)))}if(n>i){let e=o.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(PG.empty,!0))}return t}(r.content,0,r.openStart,a),a,r.openEnd))}}let d=e.steps.length;for(let a=s.length-1;a>=0&&(e.replace(t,n,r),!(e.steps.length>d));a--){let e=s[a];e<0||(t=i.before(e),n=o.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let i=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let e=r.depth-1;e>=0;e--){let t=r.index(e);if(r.node(e).canReplaceWith(t,t,n))return r.before(e+1);if(t>0)return null}if(r.parentOffset==r.parent.content.size)for(let e=r.depth-1;e>=0;e--){let t=r.indexAfter(e);if(r.node(e).canReplaceWith(t,t,n))return r.after(e+1);if(t<r.node(e).childCount)break}return null}(e.doc,t,r.type);null!=i&&(t=n=i)}e.replaceRange(t,n,new P0(PG.from(r),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let r=e.doc.resolve(t),i=e.doc.resolve(n),o=In(r,i);for(let t=0;t<o.length;t++){let n=o[t],s=t==o.length-1;if(s&&0==n||r.node(n).type.contentMatch.validEnd)return e.delete(r.start(n),i.end(n));if(n>0&&(s||r.node(n-1).canReplace(r.index(n-1),i.indexAfter(n-1))))return e.delete(r.before(n),i.after(n))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(t-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return e.delete(r.before(o),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:r,$to:i,depth:o}=t,s=r.before(o+1),a=i.after(o+1),l=s,c=a,h=PG.empty,u=0;for(let e=o,t=!1;e>n;e--)t||r.index(e)>0?(t=!0,h=PG.from(r.node(e).copy(h)),u++):l--;let d=PG.empty,f=0;for(let e=o,t=!1;e>n;e--)t||i.after(e+1)<i.end(e)?(t=!0,d=PG.from(i.node(e).copy(d)),f++):c++;e.step(new jU(l,c,s,a,new P0(h.append(d),u,f),h.size-u,!0))}(this,e,t),this}join(e,t=1){return function(e,t,n){let r=null,{linebreakReplacement:i}=e.doc.type.schema,o=e.doc.resolve(t-n),s=o.node().type;if(i&&s.inlineContent){let e="pre"==s.whitespace,t=!!s.contentMatch.matchType(i);e&&!t?r=!1:!e&&t&&(r=!0)}let a=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);jK(e,r.node(),r.before(),a)}s.inlineContent&&jG(e,t+n-1,s,o.node().contentMatchAt(o.index()),null==r);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new jW(c,l.map(t+n,-1),P0.empty,!0)),!0===r){let t=e.doc.resolve(c);jJ(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return function(e,t,n){let r=PG.empty;for(let e=n.length-1;e>=0;e--){if(r.size){let t=n[e].type.contentMatch.matchFragment(r);if(!t||!t.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=PG.from(n[e].type.create(n[e].attrs,r))}let i=t.start,o=t.end;e.step(new jU(i,o,i,o,new P0(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,r=null){return function(e,t,n,r,i){if(!r.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let o=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{var s,a;let l,c,h="function"==typeof i?i(t):i;if(t.isTextblock&&!t.hasMarkup(r,h)&&(s=e.doc,a=e.mapping.slice(o).map(n),c=(l=s.resolve(a)).index(),l.parent.canReplaceWith(c,c+1,r))){let i=null;if(r.schema.linebreakReplacement){let e="pre"==r.whitespace,t=!!r.contentMatch.matchType(r.schema.linebreakReplacement);e&&!t?i=!1:!e&&t&&(i=!0)}!1===i&&jK(e,t,n,o),jG(e,e.mapping.slice(o).map(n,1),r,void 0,null===i);let s=e.mapping.slice(o),a=s.map(n,1),l=s.map(n+t.nodeSize,1);return e.step(new jU(a,l,a+1,l-1,new P0(PG.from(r.create(h,null,t.marks)),0,0),1,!0)),!0===i&&jJ(e,t,n,o),!1}})}(this,e,t,n,r),this}setNodeMarkup(e,t,n=null,r){return function(e,t,n,r,i){let o=e.doc.nodeAt(t);if(!o)throw RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return e.replaceWith(t,t+o.nodeSize,s);if(!n.validContent(o.content))throw RangeError("Invalid content for node type "+n.name);e.step(new jU(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new P0(PG.from(s),0,0),1,!0))}(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new Ir(e,t,n)),this}setDocAttribute(e,t){return this.step(new Ii(e,t)),this}addNodeMark(e,t){return this.step(new jQ(e,t)),this}removeNodeMark(e,t){if(!(t instanceof PJ)){let n=this.doc.nodeAt(e);if(!n)throw RangeError("No node at position "+e);if(!(t=t.isInSet(n.marks)))return this}return this.step(new jV(e,t)),this}split(e,t=1,n){return function(e,t,n=1,r){let i=e.doc.resolve(t),o=PG.empty,s=PG.empty;for(let e=i.depth,t=i.depth-n,a=n-1;e>t;e--,a--){o=PG.from(i.node(e).copy(o));let t=r&&r[a];s=PG.from(t?t.type.create(t.attrs,s):i.node(e).copy(s))}e.step(new jW(t,t,new P0(o.append(s),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){var r;let i,o,s,a;return r=this,i=[],o=[],r.doc.nodesBetween(e,t,(r,l,c)=>{if(!r.isInline)return;let h=r.marks;if(!n.isInSet(h)&&c.type.allowsMarkType(n.type)){let c=Math.max(l,e),u=Math.min(l+r.nodeSize,t),d=n.addToSet(h);for(let e=0;e<h.length;e++)h[e].isInSet(d)||(s&&s.to==c&&s.mark.eq(h[e])?s.to=u:i.push(s=new jF(c,u,h[e])));a&&a.to==c?a.to=u:o.push(a=new jB(c,u,n))}}),i.forEach(e=>r.step(e)),o.forEach(e=>r.step(e)),this}removeMark(e,t,n){var r;let i,o;return r=this,i=[],o=0,r.doc.nodesBetween(e,t,(r,s)=>{if(!r.isInline)return;o++;let a=null;if(n instanceof jy){let e=r.marks,t;for(;t=n.isInSet(e);)(a||(a=[])).push(t),e=t.removeFromSet(e)}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length){let n=Math.min(s+r.nodeSize,t);for(let t=0;t<a.length;t++){let r=a[t],l;for(let e=0;e<i.length;e++){let t=i[e];t.step==o-1&&r.eq(i[e].style)&&(l=t)}l?(l.to=n,l.step=o):i.push({style:r,from:Math.max(s,e),to:n,step:o})}}}),i.forEach(e=>r.step(new jF(e.from,e.to,e.style))),this}clearIncompatible(e,t,n){return jG(this,e,t,n),this}}let Ia=Object.create(null);class Il{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new Ic(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=P0.empty){let n=t.content.lastChild,r=null;for(let e=0;e<t.openEnd;e++)r=n,n=n.lastChild;let i=e.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:a,$to:l}=o[s],c=e.mapping.slice(i);e.replaceRange(c.map(a.pos),c.map(l.pos),s?P0.empty:t),0==s&&Iv(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){let{$from:o,$to:s}=r[i],a=e.mapping.slice(n),l=a.map(o.pos),c=a.map(s.pos);i?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),Iv(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new Id(e):Ib(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let r=e.depth-1;r>=0;r--){let i=t<0?Ib(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):Ib(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(i)return i}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Ig(e.node(0))}static atStart(e){return Ib(e,e,0,0,1)||new Ig(e)}static atEnd(e){return Ib(e,e,e.content.size,e.childCount,-1)||new Ig(e)}static fromJSON(e,t){if(!t||!t.type)throw RangeError("Invalid input for Selection.fromJSON");let n=Ia[t.type];if(!n)throw RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Ia)throw RangeError("Duplicate use of selection JSON ID "+e);return Ia[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Id.between(this.$anchor,this.$head).getBookmark()}}Il.prototype.visible=!0;class Ic{constructor(e,t){this.$from=e,this.$to=t}}let Ih=!1;function Iu(e){Ih||e.parent.inlineContent||(Ih=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Id extends Il{constructor(e,t=e){Iu(e),Iu(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return Il.near(n);let r=e.resolve(t.map(this.anchor));return new Id(r.parent.inlineContent?r:n,n)}replace(e,t=P0.empty){if(super.replace(e,t),t==P0.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof Id&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new If(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new Id(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if((!n||r)&&(n=r>=0?1:-1),!t.parent.inlineContent){let e=Il.findFrom(t,n,!0)||Il.findFrom(t,-n,!0);if(!e)return Il.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r?e=t:(e=(Il.findFrom(e,-n,!0)||Il.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0&&(e=t)),new Id(e,t)}}Il.jsonID("text",Id);class If{constructor(e,t){this.anchor=e,this.head=t}map(e){return new If(e.map(this.anchor),e.map(this.head))}resolve(e){return Id.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ip extends Il{constructor(e){let t=e.nodeAfter;super(e,e.node(0).resolve(e.pos+t.nodeSize)),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),i=e.resolve(r);return n?Il.near(i):new Ip(i)}content(){return new P0(PG.from(this.node),0,0)}eq(e){return e instanceof Ip&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Im(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new Ip(e.resolve(t.anchor))}static create(e,t){return new Ip(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}Ip.prototype.visible=!1,Il.jsonID("node",Ip);class Im{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new If(n,n):new Im(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&Ip.isSelectable(n)?new Ip(t):Il.near(t)}}class Ig extends Il{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=P0.empty){if(t==P0.empty){e.delete(0,e.doc.content.size);let t=Il.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Ig(e)}map(e){return new Ig(e)}eq(e){return e instanceof Ig}getBookmark(){return Iy}}Il.jsonID("all",Ig);let Iy={map(){return this},resolve:e=>new Ig(e)};function Ib(e,t,n,r,i,o=!1){if(t.inlineContent)return Id.create(e,n);for(let s=r-(i>0?0:1);i>0?s<t.childCount:s>=0;s+=i){let r=t.child(s);if(r.isAtom){if(!o&&Ip.isSelectable(r))return Ip.create(e,n-(i<0?r.nodeSize:0))}else{let t=Ib(e,r,n+i,i<0?r.childCount:0,i,o);if(t)return t}n+=r.nodeSize*i}return null}function Iv(e,t,n){let r,i=e.steps.length-1;if(i<t)return;let o=e.steps[i];(o instanceof jW||o instanceof jU)&&(e.mapping.maps[i].forEach((e,t,n,i)=>{null==r&&(r=i)}),e.setSelection(Il.near(e.doc.resolve(r),n)))}class Ix extends Is{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return PJ.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||PJ.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=n??t,!e)return this.deleteRange(t,n);let i=this.storedMarks;if(!i){let e=this.doc.resolve(t);i=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,i)),this.selection.empty||this.setSelection(Il.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function Iw(e,t){return t&&e?e.bind(t):e}class Ik{constructor(e,t,n){this.name=e,this.init=Iw(t.init,n),this.apply=Iw(t.apply,n)}}let IO=[new Ik("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new Ik("selection",{init:(e,t)=>e.selection||Il.atStart(t.doc),apply:e=>e.selection}),new Ik("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new Ik("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class IS{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=IO.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new Ik(e.key,e.spec.state,e))})}}class IC{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let s=this.config.plugins[o];if(s.spec.appendTransaction){let a=r?r[o].n:0,l=r?r[o].state:this,c=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,o)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<o?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),i=!0}r&&(r[o]={state:n,n:t.length})}}if(!i)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let t=new IC(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let i=n[r];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new Ix(this)}static create(e){let t=new IS(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new IC(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new IS(this.schema,e.plugins),n=t.fields,r=new IC(t);for(let t=0;t<n.length;t++){let i=n[t].name;r[i]=this.hasOwnProperty(i)?this[i]:n[t].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],i=r.spec.state;i&&i.toJSON&&(t[n]=i.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw RangeError("Required config field 'schema' missing");let r=new IS(e.schema,e.plugins),i=new IC(r);return r.fields.forEach(r=>{if("doc"==r.name)i.doc=jr.fromJSON(e.schema,t.doc);else if("selection"==r.name)i.selection=Il.fromJSON(i.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let o in n){let s=n[o],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,o)){i[r.name]=a.fromJSON.call(s,e,t[o],i);return}}i[r.name]=r.init(e,i)}}),i}}class IT{constructor(e){this.spec=e,this.props={},e.props&&function e(t,n,r){for(let i in t){let o=t[i];o instanceof Function?o=o.bind(n):"handleDOMEvents"==i&&(o=e(o,n,{})),r[i]=o}return r}(e.props,this,this.props),this.key=e.key?e.key.key:IE("plugin")}getState(e){return e[this.key]}}let IA=Object.create(null);function IE(e){return e in IA?e+"$"+ ++IA[e]:(IA[e]=0,e+"$")}class IM{constructor(e="key"){this.key=IE(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}let I_=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},ID=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},IN=null,IR=function(e,t,n){let r=IN||(IN=document.createRange());return r.setEnd(e,n??e.nodeValue.length),r.setStart(e,t||0),r},IP=function(){IN=null},Ij=function(e,t,n,r){return n&&(I$(e,t,n,r,-1)||I$(e,t,n,r,1))},II=/^(img|br|input|textarea|hr)$/i;function I$(e,t,n,r,i){for(;;){if(e==n&&t==r)return!0;if(t==(i<0?0:IL(e))){let n=e.parentNode;if(!n||1!=n.nodeType||Iq(e)||II.test(e.nodeName)||"false"==e.contentEditable)return!1;t=I_(e)+(i<0?0:1),e=n}else{if(1!=e.nodeType||"false"==(e=e.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?IL(e):0}}}function IL(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Iq(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}let Iz=function(e){return e.focusNode&&Ij(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function IB(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}let IF="u">typeof navigator?navigator:null,IQ="u">typeof document?document:null,IV=IF&&IF.userAgent||"",IW=/Edge\/(\d+)/.exec(IV),IU=/MSIE \d/.exec(IV),IH=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(IV),IG=!!(IU||IH||IW),IX=IU?document.documentMode:IH?+IH[1]:IW?+IW[1]:0,IZ=!IG&&/gecko\/(\d+)/i.test(IV);IZ&&(/Firefox\/(\d+)/.exec(IV)||[0,0])[1];let IY=!IG&&/Chrome\/(\d+)/.exec(IV),IJ=!!IY,IK=IY?+IY[1]:0,I0=!IG&&!!IF&&/Apple Computer/.test(IF.vendor),I1=I0&&(/Mobile\/\w+/.test(IV)||!!IF&&IF.maxTouchPoints>2),I2=I1||!!IF&&/Mac/.test(IF.platform),I5=!!IF&&/Win/.test(IF.platform),I3=/Android \d/.test(IV),I4=!!IQ&&"webkitFontSmoothing"in IQ.documentElement.style,I6=I4?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function I8(e,t){return"number"==typeof e?e:e[t]}function I9(e,t,n){let r=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,o=e.dom.ownerDocument;for(let s=n||e.dom;s;s=ID(s)){if(1!=s.nodeType)continue;let e=s,n=e==o.body,a=n?function(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}(o):function(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}(e),l=0,c=0;if(t.top<a.top+I8(r,"top")?c=-(a.top-t.top+I8(i,"top")):t.bottom>a.bottom-I8(r,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+I8(i,"top")-a.top:t.bottom-a.bottom+I8(i,"bottom")),t.left<a.left+I8(r,"left")?l=-(a.left-t.left+I8(i,"left")):t.right>a.right-I8(r,"right")&&(l=t.right-a.right+I8(i,"right")),l||c){if(n)o.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let i=e.scrollLeft-n,o=e.scrollTop-r;t={left:t.left-i,top:t.top-o,right:t.right-i,bottom:t.bottom-o}}}if(n||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function I7(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=ID(r));return t}function $e(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:i,left:o}=e[n];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=o&&(r.scrollLeft=o)}}let $t=null;function $n(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function $r(e){return e.top<e.bottom||e.left<e.right}function $i(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if($r(e))return e}return Array.prototype.find.call(n,$r)||e.getBoundingClientRect()}let $o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function $s(e,t,n){let{node:r,offset:i,atom:o}=e.docView.domFromPos(t,n<0?-1:1),s=I4||IZ;if(3==r.nodeType){if(s&&($o.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let e=$i(IR(r,i,i),n);if(IZ&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let t=$i(IR(r,i-1,i-1),-1);if(t.top==e.top){let n=$i(IR(r,i,i+1),-1);if(n.top!=e.top)return $a(n,n.left<t.left)}}return e}{let e=i,t=i,o=n<0?1:-1;return n<0&&!i?(t++,o=-1):n>=0&&i==r.nodeValue.length?(e--,o=1):n<0?e--:t++,$a($i(IR(r,e,t),o),o<0)}}if(!e.state.doc.resolve(t-(o||0)).parent.inlineContent){if(null==o&&i&&(n<0||i==IL(r))){let e=r.childNodes[i-1];if(1==e.nodeType)return $l(e.getBoundingClientRect(),!1)}if(null==o&&i<IL(r)){let e=r.childNodes[i];if(1==e.nodeType)return $l(e.getBoundingClientRect(),!0)}return $l(r.getBoundingClientRect(),n>=0)}if(null==o&&i&&(n<0||i==IL(r))){let e=r.childNodes[i-1],t=3==e.nodeType?IR(e,IL(e)-(s?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return $a($i(t,1),!1)}if(null==o&&i<IL(r)){let e=r.childNodes[i];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?IR(e,0,s?0:1):1==e.nodeType?e:null:null;if(t)return $a($i(t,-1),!0)}return $a($i(3==r.nodeType?IR(r):r,-n),n>=0)}function $a(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function $l(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function $c(e,t,n){let r=e.state,i=e.root.activeElement;r!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),i!=e.dom&&i&&i.focus()}}let $h=/[\u0590-\u08ac]/,$u=null,$d=null,$f=!1;class $p{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){let r;if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}if(e==this.dom&&this.contentDOM)r=t>I_(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return r??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let i=this.getDesc(r),o;if(i&&(!t||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==e.nodeType?e:e.parentNode):o==e))return i;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let e=t;e;e=e.parent)if(e==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let i=this.getDesc(r);if(i)return i.localPosFromDOM(e,t,n)}return -1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],i=n+r.size;if(n==e&&i!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<i)return r.descAt(e-n-r.border);n=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let t=0;n<this.children.length;n++){let i=this.children[n],o=t+i.size;if(o>e||i instanceof $w){r=e-t;break}t=o}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let e;n&&!(e=this.children[n-1]).size&&e instanceof $m&&e.side>=0;n--);if(t<=0){let e,r=!0;for(;!(!(e=n?this.children[n-1]:null)||e.dom.parentNode==this.contentDOM);n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?I_(e.dom)+1:0}}{let e,r=!0;for(;!(!(e=n<this.children.length?this.children[n]:null)||e.dom.parentNode==this.contentDOM);n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?I_(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,i=-1;for(let o=n,s=0;;s++){let n=this.children[s],a=o+n.size;if(-1==r&&e<=a){let i=o+n.border;if(e>=i&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,i);e=o;for(let t=s;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=I_(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(a>t||s==this.children.length-1)){t=a;for(let e=s+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){i=I_(n.dom);break}t+=n.size}-1==i&&(i=this.contentDOM.childNodes.length);break}o=a}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let s=0,a=0;s<this.children.length;s++){let l=this.children[s],c=a+l.size;if(i>a&&o<c)return l.setSelection(e-a-l.border,t-a-l.border,n,r);a=c}let s=this.domFromPos(e,e?-1:1),a=t==e?s:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),h=!1;if((IZ||I0)&&e==t){let{node:e,offset:t}=s;if(3==e.nodeType){if((h=!!(t&&e.nodeValue[t-1]==`
`))&&t==e.nodeValue.length)for(let t=e,n;t;t=t.parentNode){if(n=t.nextSibling){"BR"==n.nodeName&&(s=a={node:n.parentNode,offset:I_(n)+1});break}let e=t.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];h=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(IZ&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||h&&I0)&&Ij(s.node,s.offset,c.anchorNode,c.anchorOffset)&&Ij(a.node,a.offset,c.focusNode,c.focusOffset))return;let u=!1;if((l.extend||e==t)&&!h){l.collapse(s.node,s.offset);try{e!=t&&l.extend(a.node,a.offset),u=!0}catch{}}if(!u){if(e>t){let e=s;s=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let i=this.children[r],o=n+i.size;if(n==o?e<=o&&t>=n:e<o&&t>n){let r=n+i.border,s=o-i.border;if(e>=r&&t<=s){this.dirty=e==n||t==o?2:1,e==r&&t==s&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=3:i.markDirty(e-r,t-r);return}i.dirty=i.dom!=i.contentDOM||i.dom.parentNode!=this.contentDOM||i.children.length?3:2}n=o}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class $m extends $p{constructor(e,t,n,r){let i,o=t.type.toDOM;if("function"==typeof o&&(o=o(n,()=>i?i.parent?i.parent.posBeforeChild(i):void 0:r)),!t.type.spec.raw){if(1!=o.nodeType){let e=document.createElement("span");e.appendChild(o),o=e}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class $g extends $p{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class $y extends $p{constructor(e,t,n,r,i){super(e,[],n,r),this.mark=t,this.spec=i}static create(e,t,n,r){let i=r.nodeViews[t.type.name],o=i&&i(t,r,n);return o&&o.dom||(o=jM.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new $y(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=$y.create(this.parent,this.mark,!0,n),i=this.children,o=this.size;t<o&&(i=$N(i,t,o,n)),e>0&&(i=$N(i,0,e,n));for(let e=0;e<i.length;e++)i[e].parent=r;return r.children=i,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class $b extends $p{constructor(e,t,n,r,i,o,s,a,l){super(e,[],i,o),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=s}static create(e,t,n,r,i,o){let s=i.nodeViews[t.type.name],a,l=s&&s(t,i,()=>a?a.parent?a.parent.posBeforeChild(a):void 0:o,n,r),c=l&&l.dom,h=l&&l.contentDOM;if(t.isText){if(c){if(3!=c.nodeType)throw RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text)}else c||({dom:c,contentDOM:h}=jM.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));h||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return c=$A(c,n,t),l?a=new $k(e,t,n,r,c,h||null,u,l,i,o+1):t.isText?new $x(e,t,n,r,c,u,i):new $b(e,t,n,r,c,h||null,u,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM){if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>PG.empty)}else e.contentElement=this.contentDOM}else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&$E(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,s=i&&i.pos<0,a=new $_(this,o&&o.node,e);(function(e,t,n,r){let i=t.locals(e),o=0;if(0==i.length){for(let n=0;n<e.childCount;n++){let s=e.child(n);r(s,i,t.forChild(o,s),n),o+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let h,u,d,f;for(;s<i.length&&i[s].to==o;){let e=i[s++];e.widget&&(h?(u||(u=[h])).push(e):h=e)}if(h){if(u){u.sort($D);for(let e=0;e<u.length;e++)n(u[e],c,!!l)}else n(h,c,!!l)}if(l)f=-1,d=l,l=null;else if(c<e.childCount)f=c,d=e.child(c++);else break;for(let e=0;e<a.length;e++)a[e].to<=o&&a.splice(e--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let p=o+d.nodeSize;if(d.isText){let e=p;s<i.length&&i[s].from<e&&(e=i[s].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<p&&(l=d.cut(e-o),d=d.cut(0,e-o),p=e,f=-1)}else for(;s<i.length&&i[s].to<p;)s++;let m=d.isInline&&!d.isLeaf?a.filter(e=>!e.inline):a.slice();r(d,m,t.forChild(o,d),f),o=p}})(this.node,this.innerDeco,(t,i,o)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!o&&a.syncToMarks(i==this.node.childCount?PJ.none:this.node.child(i).marks,n,e),a.placeWidget(t,e,r)},(t,o,l,c)=>{let h;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,o,l,c)||s&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(h=a.findIndexWithChild(i.node))>-1&&a.updateNodeAt(t,o,l,h,e)||a.updateNextNode(t,o,l,e,c,r)||a.addNode(t,o,l,e,r),r+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(o&&this.protectLocalComposition(e,o),function e(t,n,r){let i=t.firstChild,o=!1;for(let s=0;s<n.length;s++){let a=n[s],l=a.dom;if(l.parentNode==t){for(;l!=i;)i=$M(i),o=!0;i=i.nextSibling}else o=!0,t.insertBefore(l,i);if(a instanceof $y){let n=i?i.previousSibling:t.lastChild;e(a.contentDOM,a.children,r),i=n?n.nextSibling:t.firstChild}}for(;i;)i=$M(i),o=!0;o&&r.trackWrites==t&&(r.trackWrites=null)}(this.contentDOM,this.children,e),I1&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof Id)||n<t||r>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(!this.node.inlineContent)return{node:i,pos:-1,text:""};{let e=i.nodeValue,o=function(e,t,n,r){for(let i=0,o=0;i<e.childCount&&o<=r;){let s=e.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<e.childCount;){let t=e.child(i++);if(o+=t.nodeSize,!t.isText)break;l+=t.text}if(o>=n){if(o>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let e=a<r?l.lastIndexOf(t,r-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return -1}(this.node.content,e,n-t,r-t);return o<0?null:{node:i,pos:o,text:e}}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new $g(this,i,t,r);e.input.compositionNodes.push(o),this.children=$N(this.children,n,n+r.length,e,o)}update(e,t,n,r){return!!(3!=this.dirty&&e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if($E(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=$T(this.dom,this.nodeDOM,$C(this.outerDeco,this.node,t),$C(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function $v(e,t,n,r,i){$A(r,t,e);let o=new $b(void 0,e,t,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class $x extends $b{constructor(e,t,n,r,i,o,s){super(e,t,n,r,i,null,o,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return!!(3!=this.dirty&&(0==this.dirty||this.inParent())&&e.sameMarkup(this.node))&&(this.updateOuterDeco(t),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),i=document.createTextNode(r.text);return new $x(this.parent,r,this.outerDeco,this.innerDeco,i,i,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(0==e||t==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class $w extends $p{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class $k extends $b{constructor(e,t,n,r,i,o,s,a,l,c){super(e,t,n,r,i,o,s,l,c),this.spec=a}update(e,t,n,r){if(3==this.dirty)return!1;if(!this.spec.update||this.node.type!=e.type&&!this.spec.multiType)return(!!this.contentDOM||!!e.isLeaf)&&super.update(e,t,n,r);{let i=this.spec.update(e,t,n);return i&&this.updateInner(e,t,n,r),i}}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}let $O=function(e){e&&(this.nodeName=e)};$O.prototype=Object.create(null);let $S=[new $O];function $C(e,t,n){if(0==e.length)return $S;let r=n?$S[0]:new $O,i=[r];for(let o=0;o<e.length;o++){let s=e[o].type.attrs;if(s)for(let e in s.nodeName&&i.push(r=new $O(s.nodeName)),s){let o=s[e];null!=o&&(n&&1==i.length&&i.push(r=new $O(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+o:"style"==e?r.style=(r.style?r.style+";":"")+o:"nodeName"!=e&&(r[e]=o))}}return i}function $T(e,t,n,r){if(n==$S&&r==$S)return t;let i=t;for(let t=0;t<r.length;t++){let o=r[t],s=n[t];if(t){let t;s&&s.nodeName==o.nodeName&&i!=e&&(t=i.parentNode)&&t.nodeName.toLowerCase()==o.nodeName||((t=document.createElement(o.nodeName)).pmIsDeco=!0,t.appendChild(i),s=$S[0]),i=t}!function(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==i.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<i.length;t++)-1==r.indexOf(i[t])&&e.classList.add(i[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(t.style);)e.style.removeProperty(r[1])}n.style&&(e.style.cssText+=n.style)}}(i,s||$S[0],o)}return i}function $A(e,t,n){return $T(e,e,$S,$C(t,n,1!=e.nodeType))}function $E(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function $M(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class $_{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,i=e.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let e=n.children[r-1];if(e instanceof $y)n=e,r=e.children.length;else{a=e,r--;break}}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;r<o&&(r==i-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<i;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[i])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=$y.create(this.top,e[i],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,n,r){let i=-1,o;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(let r=this.index,o=Math.min(this.top.children.length,r+5);r<o;r++){let o=this.top.children[r];if(o.matchesNode(e,t,n)&&!this.preMatch.matched.has(o)){i=r;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,r,i){let o=this.top.children[r];return 3==o.dirty&&o.dom==o.contentDOM&&(o.dirty=2),!!o.update(e,t,n,i)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return -1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t){for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e}return -1}e=t}}updateNextNode(e,t,n,r,i,o){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof $b){let l=this.preMatch.matched.get(a);if(null!=l&&l!=i)return!1;let c=a.dom,h,u=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&$E(t,a.outerDeco));if(!u&&a.update(e,t,n,r))return this.destroyBetween(this.index,s),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!u&&(h=this.recreateWrapper(a,e,t,n,r,o)))return this.destroyBetween(this.index,s),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=2,h.updateChildren(r,o+1),h.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!$E(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let s=$b.create(this.top,t,n,r,i,o);if(s.contentDOM)for(let t of(s.children=e.children,e.children=[],s.children))t.parent=s;return e.destroy(),s}addNode(e,t,n,r,i){let o=$b.create(this.top,e,t,n,r,i);o.contentDOM&&o.updateChildren(r,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let r=new $m(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof $y;)e=(t=e).children[t.children.length-1];(!e||!(e instanceof $x)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((I0||IJ)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new $w(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function $D(e,t){return e.type.side-t.type.side}function $N(e,t,n,r,i){let o=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,h=a+=l.size;c>=n||h<=t?o.push(l):(c<t&&o.push(l.slice(0,t-c,r)),i&&(o.push(i),i=void 0),h>n&&o.push(l.slice(n-c,l.size,r)))}return o}function $R(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let i=e.docView.nearestDesc(n.focusNode),o=i&&0==i.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(Iz(n)){for(l=s;i&&!i.node;)i=i.parent;let e=i.node;if(i&&e.isAtom&&Ip.isSelectable(e)&&i.parent&&!(e.isInline&&function(e,t,n){for(let r=0==t,i=t==IL(e);r||i;){if(e==n)return!0;let t=I_(e);if(!(e=e.parentNode))return!1;r=r&&0==t,i=i&&t==IL(e)}}(n.focusNode,n.focusOffset,i.dom))){let e=i.posBefore;c=new Ip(s==e?a:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=s,i=s;for(let r=0;r<n.rangeCount;r++){let o=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(o.startContainer,o.startOffset,1)),i=Math.max(i,e.docView.posFromDOM(o.endContainer,o.endOffset,-1))}if(t<0)return null;[l,s]=i==e.state.selection.anchor?[i,t]:[t,i],a=r.resolve(s)}else l=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let h=r.resolve(l);if(!c){let n="pointer"==t||e.state.selection.head<a.pos&&!o?1:-1;c=$F(e,h,a,n)}return c}function $P(e){return e.editable?e.hasFocus():$V(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function $j(e,t=!1){let n=e.state.selection;if($z(e,n),$P(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&IJ){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&Ij(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange();if(!t)return;let r=e.cursorWrapper.dom,i="IMG"==r.nodeName;i?n.setStart(r.parentNode,I_(r)+1):n.setStart(r,0),n.collapse(!0),t.removeAllRanges(),t.addRange(n),!i&&!e.state.selection.visible&&IG&&IX<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{let r,i,o,s,{anchor:a,head:l}=n,c,h;!$I||n instanceof Id||(n.$from.parent.inlineContent||(c=$$(e,n.from)),n.empty||n.$from.parent.inlineContent||(h=$$(e,n.to))),e.docView.setSelection(a,l,e,t),$I&&(c&&$q(c),h&&$q(h)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&((r=e.dom.ownerDocument).removeEventListener("selectionchange",e.input.hideSelectionGuard),o=(i=e.domSelectionRange()).anchorNode,s=i.anchorOffset,r.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(i.anchorNode!=o||i.anchorOffset!=s)&&(r.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!$P(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}let $I=I0||IJ&&IK<63;function $$(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(I0&&i&&"false"==i.contentEditable)return $L(i);if((!i||"false"==i.contentEditable)&&(!o||"false"==o.contentEditable)){if(i)return $L(i);if(o)return $L(o)}}function $L(e){return e.contentEditable="true",I0&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function $q(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function $z(e,t){if(t instanceof Ip){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&($B(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else $B(e)}function $B(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function $F(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||Id.between(t,n,r)}function $Q(e){return(!e.editable||!!e.hasFocus())&&$V(e)}function $V(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function $W(e,t){let{$anchor:n,$head:r}=e.selection,i=t>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return o&&Il.findFrom(o,t)}function $U(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function $H(e,t,n){let r=e.state.selection;if(r instanceof Id){if(n.indexOf("s")>-1){let{$head:n}=r,i=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=e.state.doc.resolve(n.pos+i.nodeSize*(t<0?-1:1));return $U(e,new Id(r.$anchor,o))}if(!r.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=$W(e.state,t);return!!n&&n instanceof Ip&&$U(e,n)}if(!(I2&&n.indexOf("m")>-1)){let n=r.$head,i=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter,o;if(!i||i.isText)return!1;let s=t<0?n.pos-i.nodeSize:n.pos;return!!(i.isAtom||(o=e.docView.descAt(s))&&!o.contentDOM)&&(Ip.isSelectable(i)?$U(e,new Ip(t<0?e.state.doc.resolve(n.pos-i.nodeSize):n)):!!I4&&$U(e,new Id(e.state.doc.resolve(t<0?s:s+i.nodeSize))))}}else{if(r instanceof Ip&&r.node.isInline)return $U(e,new Id(t>0?r.$to:r.$from));{let n=$W(e.state,t);return!!n&&$U(e,n)}}}function $G(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function $X(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function $Z(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i,o,s=!1;for(IZ&&1==n.nodeType&&r<$G(n)&&$X(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;{let e=n.childNodes[r-1];if($X(e,-1))i=n,o=--r;else if(3==e.nodeType)r=(n=e).nodeValue.length;else break}}else{if($Y(n))break;{let t=n.previousSibling;for(;t&&$X(t,-1);)i=n.parentNode,o=I_(t),t=t.previousSibling;if(t)r=$G(n=t);else{if((n=n.parentNode)==e.dom)break;r=0}}}s?$J(e,n,r):i&&$J(e,i,o)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i=$G(n),o,s;for(;;)if(r<i){if(1!=n.nodeType)break;if($X(n.childNodes[r],1))o=n,s=++r;else break}else{if($Y(n))break;{let t=n.nextSibling;for(;t&&$X(t,1);)o=t.parentNode,s=I_(t)+1,t=t.nextSibling;if(t)r=0,i=$G(n=t);else{if((n=n.parentNode)==e.dom)break;r=i=0}}}o&&$J(e,o,s)}(e)}function $Y(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function $J(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!Iq(e);)t=I_(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!Iq(e);)t=I_(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(Iz(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:i}=e;setTimeout(()=>{e.state==i&&$j(e)},50)}function $K(e,t){let n=e.state.doc.resolve(t);if(!(IJ||I5)&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function $0(e,t,n){let r=e.state.selection;if(r instanceof Id&&!r.empty||n.indexOf("s")>-1||I2&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=$W(e.state,t);if(n&&n instanceof Ip)return $U(e,n)}if(!i.parent.inlineContent){let n=t<0?i:o,s=r instanceof Ig?Il.near(n,t):Il.findFrom(n,t);return!!s&&$U(e,s)}return!1}function $1(e,t){if(!(e.state.selection instanceof Id))return!0;let{$head:n,$anchor:r,empty:i}=e.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let o=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let r=e.state.tr;return t<0?r.delete(n.pos-o.nodeSize,n.pos):r.delete(n.pos,n.pos+o.nodeSize),e.dispatch(r),!0}return!1}function $2(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function $5(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:i,openEnd:o}=t;for(;i>1&&o>1&&1==r.childCount&&1==r.firstChild.childCount;){i--,o--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let s=e.someProp("clipboardSerializer")||jM.fromSchema(e.state.schema),a=Lt(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,h,u=0;for(;c&&1==c.nodeType&&(h=$7[c.nodeName.toLowerCase()]);){for(let e=h.length-1;e>=0;e--){let t=a.createElement(h[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),u++}c=l.firstChild}return c&&1==c.nodeType&&c.setAttribute("data-pm-slice",`${i} ${o}${u?` -${u}`:""} ${JSON.stringify(n)}`),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,`

`),slice:t}}function $3(e,t,n,r,i){let o=i.parent.type.spec.code,s,a;if(!n&&!t)return null;let l=t&&(r||o||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,o||r,e)}),o)return t?new P0(PG.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):P0.empty;let n=e.someProp("clipboardTextParser",n=>n(t,i,r,e));if(n)a=n;else{let n=i.marks(),{schema:r}=e.state,o=jM.fromSchema(r);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=s.appendChild(document.createElement("p"));e&&t.appendChild(o.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),s=function(e){var t;let n,r=/^(\s*<meta [^>]*>)*/.exec(e);r&&(e=e.slice(r[0].length));let i=Lt().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e),s;if((s=o&&$7[o[1].toLowerCase()])&&(e=s.map(e=>"<"+e+">").join("")+e+s.map(e=>"</"+e+">").reverse().join("")),i.innerHTML=(t=e,(n=window.trustedTypes)?(Ln||(Ln=n.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),Ln.createHTML(t)):t),s)for(let e=0;e<s.length;e++)i=i.querySelector(s[e])||i;return i}(n),I4&&function(e){let t=e.querySelectorAll(IJ?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(s);let c=s&&s.querySelector("[data-pm-slice]"),h=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let e=+h[3];e>0;e--){let e=s.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;s=e}if(a||(a=(e.someProp("clipboardParser")||e.someProp("domParser")||jx.fromSchema(e.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||h),context:i,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||$4.test(e.parentNode.nodeName)?null:{ignore:!0}})),h)a=function(e,t){if(!e.size)return e;let n=e.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return e}let{content:i,openStart:o,openEnd:s}=e;for(let e=r.length-2;e>=0;e-=2){let t=n.nodes[r[e]];if(!t||t.hasRequiredAttrs())break;i=PG.from(t.create(r[e+1],i)),o++,s++}return new P0(i,o,s)}($9(a,+h[1],+h[2]),h[4]);else if((a=P0.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r=t.node(n).contentMatchAt(t.index(n)),i,o=[];if(e.forEach(e=>{if(!o)return;let t=r.findWrapping(e.type),n;if(!t)return o=null;if(n=o.length&&i.length&&function e(t,n,r,i,o){if(o<t.length&&o<n.length&&t[o]==n[o]){let s=e(t,n,r,i.lastChild,o+1);if(s)return i.copy(i.content.replaceChild(i.childCount-1,s));if(i.contentMatchAt(i.childCount).matchType(o==t.length-1?r.type:t[o+1]))return i.copy(i.content.append(PG.from($6(r,t,o+1))))}}(t,i,e,o[o.length-1],0))o[o.length-1]=n;else{o.length&&(o[o.length-1]=function e(t,n){if(0==n)return t;let r=t.content.replaceChild(t.childCount-1,e(t.lastChild,n-1)),i=t.contentMatchAt(t.childCount).fillBefore(PG.empty,!0);return t.copy(r.append(i))}(o[o.length-1],i.length));let n=$6(e,t);o.push(n),r=r.matchType(n.type),i=t}}),o)return PG.from(o)}return e}(a.content,i),!0)).openStart||a.openEnd){let e=0,t=0;for(let t=a.content.firstChild;e<a.openStart&&!t.type.spec.isolating;e++,t=t.firstChild);for(let e=a.content.lastChild;t<a.openEnd&&!e.type.spec.isolating;t++,e=e.lastChild);a=$9(a,e,t)}return e.someProp("transformPasted",t=>{a=t(a,e)}),a}let $4=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function $6(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,PG.from(e));return e}function $8(e,t,n,r,i,o){let s=t<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(o=0),i<r-1&&(a=$8(a,t,n,r,i+1,o)),i>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(PG.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function $9(e,t,n){return t<e.openStart&&(e=new P0($8(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new P0($8(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}let $7={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Le=null;function Lt(){return Le||(Le=document.implementation.createHTMLDocument("title"))}let Ln=null,Lr={},Li={},Lo={touchstart:!0,touchmove:!0};class Ls{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function La(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function Ll(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>Lc(e,t))})}function Lc(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function Lh(e){return{left:e.clientX,top:e.clientY}}function Lu(e,t,n,r,i){if(-1==r)return!1;let o=e.state.doc.resolve(r);for(let r=o.depth+1;r>0;r--)if(e.someProp(t,t=>r>o.depth?t(e,n,o.nodeAfter,o.before(r),i,!0):t(e,n,o.node(r),o.before(r),i,!1)))return!0;return!1}function Ld(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);r.setMeta("pointer",!0),e.dispatch(r)}Li.keydown=(e,t)=>{if(e.input.shiftKey=16==t.keyCode||t.shiftKey,!Lm(e,t)&&(e.input.lastKeyCode=t.keyCode,e.input.lastKeyCodeTime=Date.now(),!(I3&&IJ&&13==t.keyCode))){if(229!=t.keyCode&&e.domObserver.forceFlush(),!I1||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",n=>n(e,t))||function(e,t){let n;let r=t.keyCode,i=(n="",t.ctrlKey&&(n+="c"),t.metaKey&&(n+="m"),t.altKey&&(n+="a"),t.shiftKey&&(n+="s"),n);if(8==r||I2&&72==r&&"c"==i)return $1(e,-1)||$Z(e,-1);if(46==r&&!t.shiftKey||I2&&68==r&&"c"==i)return $1(e,1)||$Z(e,1);if(13==r||27==r)return!0;if(37==r||I2&&66==r&&"c"==i){let t=37==r?"ltr"==$K(e,e.state.selection.from)?-1:1:-1;return $H(e,t,i)||$Z(e,t)}if(39==r||I2&&70==r&&"c"==i){let t=39==r?"ltr"==$K(e,e.state.selection.from)?1:-1:1;return $H(e,t,i)||$Z(e,t)}return 38==r||I2&&80==r&&"c"==i?$0(e,-1,i)||$Z(e,-1):40==r||I2&&78==r&&"c"==i?function(e){if(!I0||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;$2(e,n,"true"),setTimeout(()=>$2(e,n,"false"),20)}return!1}(e)||$0(e,1,i)||$Z(e,1):i==(I2?"m":"c")&&(66==r||73==r||89==r||90==r)}(e,t)?t.preventDefault():La(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,IB(13,"Enter"))),e.input.lastIOSEnter=0)},200)}}},Li.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},Li.keypress=(e,t)=>{if(Lm(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||I2&&t.metaKey)return;if(e.someProp("handleKeyPress",n=>n(e,t))){t.preventDefault();return}let n=e.state.selection;if(!(n instanceof Id)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(t.charCode);/[\r\n]/.test(r)||e.someProp("handleTextInput",t=>t(e,n.$from.pos,n.$to.pos,r))||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}};let Lf=I2?"metaKey":"ctrlKey";Lr.mousedown=(e,t)=>{e.input.shiftKey=t.shiftKey;let n=Lv(e),r=Date.now(),i="singleClick";r-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.input.lastClick)&&!t[Lf]&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:r,x:t.clientX,y:t.clientY,type:i};let o=e.posAtCoords(Lh(t));o&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Lp(e,o,t,!!n)):("doubleClick"==i?function(e,t,n,r){return Lu(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}:function(e,t,n,r){return Lu(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(Ld(e,Id.create(r,0,r.content.size)),!0);let i=r.resolve(t);for(let t=i.depth+1;t>0;t--){let n=t>i.depth?i.nodeAfter:i.node(t),o=i.before(t);if(n.inlineContent)Ld(e,Id.create(r,o+1,o+1+n.content.size));else{if(!Ip.isSelectable(n))continue;Ld(e,Ip.create(r,o))}return!0}}(e,n,r)})(e,o.pos,o.inside,t)?t.preventDefault():La(e,"pointer"))};class Lp{constructor(e,t,n,r){let i,o;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[Lf],this.allowDefault=n.shiftKey,t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let n=e.state.doc.resolve(t.pos);i=n.parent,o=n.depth?n.before():0}let s=r?null:n.target,a=s?e.docView.nearestDesc(s,!0):null;this.target=a&&1==a.dom.nodeType?a.dom:null;let{selection:l}=e.state;(0==n.button&&i.type.spec.draggable&&!1!==i.type.spec.selectable||l instanceof Ip&&l.from<=o&&l.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&IZ&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),La(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>$j(this.view)),this.view.input.mouseDown=null}up(e){var t,n,r,i;if(this.done(),!this.view.dom.contains(e.target))return;let o=this.pos;this.view.state.doc!=this.startDoc&&(o=this.view.posAtCoords(Lh(e))),this.updateAllowDefault(e),this.allowDefault||!o?La(this.view,"pointer"):(t=this.view,n=o.pos,r=o.inside,i=this.selectNode,Lu(t,"handleClickOn",n,r,e)||t.someProp("handleClick",r=>r(t,n,e))||(i?function(e,t){if(-1==t)return!1;let n=e.state.selection,r,i;n instanceof Ip&&(r=n.node);let o=e.state.doc.resolve(t);for(let e=o.depth+1;e>0;e--){let t=e>o.depth?o.nodeAfter:o.node(e);if(Ip.isSelectable(t)){i=r&&n.$from.depth>0&&e>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?o.before(n.$from.depth):o.before(e);break}}return null!=i&&(Ld(e,Ip.create(e.state.doc,i)),!0)}(t,r):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&Ip.isSelectable(r))&&(Ld(e,new Ip(n)),!0)}(t,r)))?e.preventDefault():0==e.button&&(this.flushed||I0&&this.mightDrag&&!this.mightDrag.node.isAtom||IJ&&!this.view.state.selection.visible&&2>=Math.min(Math.abs(o.pos-this.view.state.selection.from),Math.abs(o.pos-this.view.state.selection.to)))?(Ld(this.view,Il.near(this.view.state.doc.resolve(o.pos))),e.preventDefault()):La(this.view,"pointer")}move(e){this.updateAllowDefault(e),La(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function Lm(e,t){return!!e.composing||!!(I0&&500>Math.abs(t.timeStamp-e.input.compositionEndedAt))&&(e.input.compositionEndedAt=-2e8,!0)}Lr.touchstart=e=>{e.input.lastTouch=Date.now(),Lv(e),La(e,"pointer")},Lr.touchmove=e=>{e.input.lastTouch=Date.now(),La(e,"pointer")},Lr.contextmenu=e=>Lv(e);let Lg=I3?5e3:-1;function Ly(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>Lv(e),t))}function Lb(e){let t;for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function Lv(e,t=!1){if(!(I3&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Lb(e),t||e.docView&&e.docView.dirty){let n=$R(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):(e.markCursor||t)&&!e.state.selection.empty?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}Li.compositionstart=Li.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof Id&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),Lv(e,!0),e.markCursor=null;else if(Lv(e,!t.selection.empty),IZ&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}Ly(e,Lg)},Li.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,Ly(e,20))};let Lx=IG&&IX<15||I1&&I6<604;function Lw(e,t,n,r,i){let o=$3(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,i,o||P0.empty)))return!0;if(!o)return!1;let s=0==o.openStart&&0==o.openEnd&&1==o.content.childCount?o.content.firstChild:null,a=s?e.state.tr.replaceSelectionWith(s,r):e.state.tr.replaceSelection(o);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Lk(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Lr.copy=Li.cut=(e,t)=>{let n=e.state.selection,r="cut"==t.type;if(n.empty)return;let i=Lx?null:t.clipboardData,{dom:o,text:s}=$5(e,n.content());i?(t.preventDefault(),i.clearData(),i.setData("text/html",o.innerHTML),i.setData("text/plain",s)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,o),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Li.paste=(e,t)=>{if(e.composing&&!I3)return;let n=Lx?null:t.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;n&&Lw(e,Lk(n),n.getData("text/html"),r,t)?t.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Lw(e,r.value,null,i,t):Lw(e,r.textContent,r.innerHTML,i,t)},50)}(e,t)};class LO{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}let LS=I2?"altKey":"ctrlKey";for(let e in Lr.dragstart=(e,t)=>{let n=e.input.mouseDown;if(n&&n.done(),!t.dataTransfer)return;let r=e.state.selection,i=r.empty?null:e.posAtCoords(Lh(t)),o;if(!(i&&i.pos>=r.from&&i.pos<=(r instanceof Ip?r.to-1:r.to))){if(n&&n.mightDrag)o=Ip.create(e.state.doc,n.mightDrag.pos);else if(t.target&&1==t.target.nodeType){let n=e.docView.nearestDesc(t.target,!0);n&&n.node.type.spec.draggable&&n!=e.docView&&(o=Ip.create(e.state.doc,n.posBefore))}}let s=(o||e.state.selection).content(),{dom:a,text:l,slice:c}=$5(e,s);t.dataTransfer.files.length&&IJ&&!(IK>120)||t.dataTransfer.clearData(),t.dataTransfer.setData(Lx?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",Lx||t.dataTransfer.setData("text/plain",l),e.dragging=new LO(c,!t[LS],o)},Lr.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},Li.dragover=Li.dragenter=(e,t)=>t.preventDefault(),Li.drop=(e,t)=>{let n=e.dragging;if(e.dragging=null,!t.dataTransfer)return;let r=e.posAtCoords(Lh(t));if(!r)return;let i=e.state.doc.resolve(r.pos),o=n&&n.slice;o?e.someProp("transformPasted",t=>{o=t(o,e)}):o=$3(e,Lk(t.dataTransfer),Lx?null:t.dataTransfer.getData("text/html"),!1,i);let s=!!(n&&!t[LS]);if(e.someProp("handleDrop",n=>n(e,t,o||P0.empty,s))){t.preventDefault();return}if(!o)return;t.preventDefault();let a=o?j3(e.state.doc,i.pos,o):i.pos;null==a&&(a=i.pos);let l=e.state.tr;if(s){let{node:e}=n;e?e.replace(l):l.deleteSelection()}let c=l.mapping.map(a),h=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,u=l.doc;if(h?l.replaceRangeWith(c,c,o.content.firstChild):l.replaceRange(c,c,o),l.doc.eq(u))return;let d=l.doc.resolve(c);if(h&&Ip.isSelectable(o.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(o.content.firstChild))l.setSelection(new Ip(d));else{let t=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((e,n,r,i)=>t=i),l.setSelection($F(e,d,l.doc.resolve(t)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))},Lr.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&$j(e)},20))},Lr.blur=(e,t)=>{e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},Lr.beforeinput=(e,t)=>{if(IJ&&I3&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,IB(8,"Backspace")))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}},Li)Lr[e]=Li[e];function LC(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class LT{constructor(e,t){this.toDOM=e,this.spec=t||LD,this.side=this.spec.side||0}map(e,t,n,r){let{pos:i,deleted:o}=e.mapResult(t.from+r,this.side<0?-1:1);return o?null:new LM(i-n,i-n,this)}valid(){return!0}eq(e){return this==e||e instanceof LT&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&LC(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class LA{constructor(e,t){this.attrs=e,this.spec=t||LD}map(e,t,n,r){let i=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,o=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return i>=o?null:new LM(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof LA&&LC(this.attrs,e.attrs)&&LC(this.spec,e.spec)}static is(e){return e.type instanceof LA}destroy(){}}class LE{constructor(e,t){this.attrs=e,this.spec=t||LD}map(e,t,n,r){let i=e.mapResult(t.from+r,1);if(i.deleted)return null;let o=e.mapResult(t.to+r,-1);return o.deleted||o.pos<=i.pos?null:new LM(i.pos-n,o.pos-n,this)}valid(e,t){let{index:n,offset:r}=e.content.findIndex(t.from),i;return r==t.from&&!(i=e.child(n)).isText&&r+i.nodeSize==t.to}eq(e){return this==e||e instanceof LE&&LC(this.attrs,e.attrs)&&LC(this.spec,e.spec)}destroy(){}}class LM{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new LM(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new LM(e,e,new LT(t,n))}static inline(e,t,n,r){return new LM(e,t,new LA(n,r))}static node(e,t,n,r){return new LM(e,t,new LE(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof LA}get widget(){return this.type instanceof LT}}let L_=[],LD={};class LN{constructor(e,t){this.local=e.length?e:L_,this.children=t.length?t:L_}static create(e,t){return t.length?LL(t,e,0,LD):LR}find(e,t,n){let r=[];return this.findInner(e??0,t??1e9,r,0,n),r}findInner(e,t,n,r,i){for(let o=0;o<this.local.length;o++){let s=this.local[o];s.from<=t&&s.to>=e&&(!i||i(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let s=this.children[o]+1;this.children[o+2].findInner(e-s,t-s,n,r+s,i)}}map(e,t,n){return this==LR||0==e.maps.length?this:this.mapInner(e,t,0,0,n||LD)}mapInner(e,t,n,r,i){let o;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(e,n,r);a&&a.type.valid(t,a)?(o||(o=[])).push(a):i.onRemove&&i.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,i,o,s){let a=e.slice();for(let e=0,t=o;e<n.maps.length;e++){let r=0;n.maps[e].forEach((e,n,i,o)=>{let s=o-i-(n-e);for(let i=0;i<a.length;i+=3){let o=a[i+1];if(o<0||e>o+t-r)continue;let l=a[i]+t-r;n>=l?a[i+1]=e<=l?-2:-1:e>=t&&s&&(a[i]+=s,a[i+1]+=s)}r+=s}),t=n.maps[e].map(t,-1)}let l=!1;for(let t=0;t<a.length;t+=3)if(a[t+1]<0){if(-2==a[t+1]){l=!0,a[t+1]=-1;continue}let c=n.map(e[t]+o),h=c-i;if(h<0||h>=r.content.size){l=!0;continue}let u=n.map(e[t+1]+o,-1)-i,{index:d,offset:f}=r.content.findIndex(h),p=r.maybeChild(d);if(p&&f==h&&f+p.nodeSize==u){let r=a[t+2].mapInner(n,p,c+1,e[t]+o+1,s);r!=LR?(a[t]=h,a[t+1]=u,a[t+2]=r):(a[t+1]=-2,l=!0)}else l=!0}if(l){let l=LL(function(e,t,n,r,i,o,s){for(let a=0;a<e.length;a+=3)-1==e[a+1]&&function e(t,o){for(let e=0;e<t.local.length;e++){let a=t.local[e].map(r,i,o);a?n.push(a):s.onRemove&&s.onRemove(t.local[e].spec)}for(let n=0;n<t.children.length;n+=3)e(t.children[n+2],t.children[n]+o+1)}(e[a+2],t[a]+o+1);return n}(a,e,t,n,i,o,s),r,0,s);t=l.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<l.children.length;e+=3){let n=l.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,l.children[e],l.children[e+1],l.children[e+2])}}return new LN(t.sort(Lq),a)}(this.children,o||[],e,t,n,r,i):o?new LN(o.sort(Lq),L_):LR}add(e,t){return t.length?this==LR?LN.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,i=0;e.forEach((e,o)=>{let s=o+n,a;if(a=LI(t,e,s)){for(r||(r=this.children.slice());i<r.length&&r[i]<o;)i+=3;r[i]==o?r[i+2]=r[i+2].addInner(e,a,s+1):r.splice(i,0,o,o+e.nodeSize,LL(a,e,s+1,LD)),i+=3}});let o=Lj(i?L$(t):t,-n);for(let t=0;t<o.length;t++)o[t].type.valid(e,o[t])||o.splice(t--,1);return new LN(o.length?this.local.concat(o).sort(Lq):this.local,r||this.children)}remove(e){return 0==e.length||this==LR?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let r=0;r<n.length;r+=3){let i,o=n[r]+t,s=n[r+1]+t;for(let t=0,n;t<e.length;t++)(n=e[t])&&n.from>o&&n.to<s&&(e[t]=null,(i||(i=[])).push(n));if(!i)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(i,o+1);a!=LR?n[r+2]=a:(n.splice(r,3),r-=3)}if(r.length){for(let n=0,i;n<e.length;n++)if(i=e[n])for(let e=0;e<r.length;e++)r[e].eq(i,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new LN(r,n):LR}forChild(e,t){let n,r;if(this==LR)return this;if(t.isLeaf)return LN.empty;for(let t=0;t<this.children.length;t+=3)if(this.children[t]>=e){this.children[t]==e&&(n=this.children[t+2]);break}let i=e+1,o=i+t.content.size;for(let e=0;e<this.local.length;e++){let t=this.local[e];if(t.from<o&&t.to>i&&t.type instanceof LA){let e=Math.max(i,t.from)-i,n=Math.min(o,t.to)-i;e<n&&(r||(r=[])).push(t.copy(e,n))}}if(r){let e=new LN(r.sort(Lq),L_);return n?new LP([e,n]):e}return n||LR}eq(e){if(this==e)return!0;if(!(e instanceof LN)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Lz(this.localsInner(e))}localsInner(e){if(this==LR)return L_;if(e.inlineContent||!this.local.some(LA.is))return this.local;let t=[];for(let e=0;e<this.local.length;e++)this.local[e].type instanceof LA||t.push(this.local[e]);return t}forEachSet(e){e(this)}}LN.empty=new LN([],[]),LN.removeOverlap=Lz;let LR=LN.empty;class LP{constructor(e){this.members=e}map(e,t){let n=this.members.map(n=>n.map(e,t,LD));return LP.from(n)}forChild(e,t){if(t.isLeaf)return LN.empty;let n=[];for(let r=0;r<this.members.length;r++){let i=this.members[r].forChild(e,t);i!=LR&&(i instanceof LP?n=n.concat(i.members):n.push(i))}return LP.from(n)}eq(e){if(!(e instanceof LP)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let i=this.members[r].localsInner(e);if(i.length){if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<i.length;e++)t.push(i[e])}else t=i}}return t?Lz(n?t:t.sort(Lq)):L_}static from(e){switch(e.length){case 0:return LR;case 1:return e[0];default:return new LP(e.every(e=>e instanceof LN)?e:e.reduce((e,t)=>e.concat(t instanceof LN?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Lj(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let i=e[r];n.push(new LM(i.from+t,i.to+t,i.type))}return n}function LI(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,i=null;for(let t=0,o;t<e.length;t++)(o=e[t])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),e[t]=null);return i}function L$(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function LL(e,t,n,r){let i=[],o=!1;t.forEach((t,s)=>{let a=LI(e,t,s+n);if(a){o=!0;let e=LL(a,t,n+s+1,r);e!=LR&&i.push(s,s+t.nodeSize,e)}});let s=Lj(o?L$(e):e,-n).sort(Lq);for(let e=0;e<s.length;e++)s[e].type.valid(t,s[e])||(r.onRemove&&r.onRemove(s[e].spec),s.splice(e--,1));return s.length||i.length?new LN(s,i):LR}function Lq(e,t){return e.from-t.from||e.to-t.to}function Lz(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let i=n+1;i<t.length;i++){let o=t[i];if(o.from==r.from){o.to!=r.to&&(t==e&&(t=e.slice()),t[i]=o.copy(o.from,r.to),LB(t,i+1,o.copy(r.to,o.to)));continue}o.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,o.from),LB(t,i,r.copy(o.from,r.to)));break}}return t}function LB(e,t,n){for(;t<e.length&&Lq(n,e[t])>0;)t++;e.splice(t,0,n)}function LF(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=LR&&t.push(r)}),e.cursorWrapper&&t.push(LN.create(e.state.doc,[e.cursorWrapper.deco])),LP.from(t)}let LQ={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},LV=IG&&IX<=11;class LW{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class LU{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new LW,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);IG&&IX<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),LV&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,LQ)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if($Q(this.view)){if(this.suppressingSelectionUpdates)return $j(this.view);if(IG&&IX<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ij(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let n=e.focusNode;n;n=ID(n))t.add(n);for(let r=e.anchorNode;r;r=ID(r))if(t.has(r)){n=r;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&$Q(e)&&!this.ignoreSelectionChange(n),i=-1,o=-1,s=!1,a=[];if(e.editable)for(let e=0;e<t.length;e++){let n=this.registerMutation(t[e],a);n&&(i=i<0?n.from:Math.min(n.from,i),o=o<0?n.to:Math.max(n.to,o),n.typeOver&&(s=!0))}if(IZ&&a.length){let t=a.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of t){let t=r.parentNode;t&&"LI"==t.nodeName&&(!n||function(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}(e,n)!=t)&&r.remove()}}}let l=null;i<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Iz(n)&&(l=$R(e))&&l.eq(Il.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,$j(e),this.currentSelection.set(n)):(i>-1||r)&&(i>-1&&(e.docView.markDirty(i,o),LH.has(e)||(LH.set(e,null),-1===["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))||(e.requiresGeckoHackNode=IZ,LG||(console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),LG=!0))),this.handleDOMChange(i,o,s,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||$j(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if("childList"!=e.type)return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue});{for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,i=e.nextSibling;if(IG&&IX<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:o}=e.addedNodes[t];(!n||0>Array.prototype.indexOf.call(e.addedNodes,n))&&(r=n),(!o||0>Array.prototype.indexOf.call(e.addedNodes,o))&&(i=o)}let o=r&&r.parentNode==e.target?I_(r)+1:0,s=n.localPosFromDOM(e.target,o,-1),a=i&&i.parentNode==e.target?I_(i):e.target.childNodes.length;return{from:s,to:n.localPosFromDOM(e.target,a,1)}}}}let LH=new WeakMap,LG=!1;function LX(e,t){let n=t.startContainer,r=t.startOffset,i=t.endContainer,o=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return Ij(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function LZ(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(I0&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||I0&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}let LY=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function LJ(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:$F(e,t.resolve(n.anchor),t.resolve(n.head))}function LK(e,t,n){let r=e.depth,i=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,i++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,i++}return i}function L0(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class L1{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Ls,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(L6),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=L3(this),L5(this),this.nodeViews=L4(this),this.docView=$v(this.state.doc,L2(this),LF(this),this.dom,this),this.domObserver=new LU(this,(e,t,n,r)=>(function(e,t,n,r,i){let o=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=$R(e,t);if(n&&!e.state.selection.eq(n)){if(IJ&&I3&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,IB(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),o&&r.setMeta("composition",o),e.dispatch(r)}return}let s=e.state.doc.resolve(t),a=s.sharedDepth(n);t=s.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l=e.state.selection,c=function(e,t,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=e.docView.parseRange(t,n),l=e.domSelectionRange(),c,h=l.anchorNode;if(h&&e.dom.contains(1==h.nodeType?h:h.parentNode)&&(c=[{node:h,offset:l.anchorOffset}],Iz(l)||c.push({node:l.focusNode,offset:l.focusOffset})),IJ&&8===e.input.lastKeyCode)for(let e=o;e>i;e--){let t=r.childNodes[e-1],n=t.pmViewDesc;if("BR"==t.nodeName&&!n){o=e;break}if(!n||n.size)break}let u=e.state.doc,d=e.someProp("domParser")||jx.fromSchema(e.state.schema),f=u.resolve(s),p=null,m=d.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:i,to:o,preserveWhitespace:"pre"!=f.parent.type.whitespace||"full",findPositions:c,ruleFromNode:LZ,context:f});if(c&&null!=c[0].pos){let e=c[0].pos,t=c[1]&&c[1].pos;null==t&&(t=e),p={anchor:e+s,head:t+s}}return{doc:m,sel:p,from:s,to:a}}(e,t,n),h=e.state.doc,u=h.slice(c.from,c.to),d,f;8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(d=e.state.selection.to,f="end"):(d=e.state.selection.from,f="start"),e.input.lastKeyCode=null;let p=function(e,t,n,r,i){let o=e.findDiffStart(t,n);if(null==o)return null;let{a:s,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==i){let e=Math.max(0,o-Math.min(s,a));r-=s+e-o}if(s<o&&e.size<t.size){let e=r<=o&&r>=s?o-r:0;(o-=e)&&o<t.size&&L0(t.textBetween(o-1,o+1))&&(o+=e?1:-1),a=o+(a-s),s=o}else if(a<o){let t=r<=o&&r>=a?o-r:0;(o-=t)&&o<e.size&&L0(e.textBetween(o-1,o+1))&&(o+=t?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}(u.content,c.doc.content,c.from,d,f);if(p&&e.input.domChangeCount++,(I1&&e.input.lastIOSEnter>Date.now()-225||I3)&&i.some(e=>1==e.nodeType&&!LY.test(e.nodeName))&&(!p||p.endA>=p.endB)&&e.someProp("handleKeyDown",t=>t(e,IB(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!p){if(r&&l instanceof Id&&!l.empty&&l.$head.sameParent(l.$anchor)&&!e.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let t=LJ(e,e.state.doc,c.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);o&&n.setMeta("composition",o),e.dispatch(n)}}return}}e.state.selection.from<e.state.selection.to&&p.start==p.endB&&e.state.selection instanceof Id&&(p.start>e.state.selection.from&&p.start<=e.state.selection.from+2&&e.state.selection.from>=c.from?p.start=e.state.selection.from:p.endA<e.state.selection.to&&p.endA>=e.state.selection.to-2&&e.state.selection.to<=c.to&&(p.endB+=e.state.selection.to-p.endA,p.endA=e.state.selection.to)),IG&&IX<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&" \xa0"==c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),g=c.doc.resolveNoCache(p.endB-c.from),y=h.resolve(p.start),b=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=p.endA,v;if((I1&&e.input.lastIOSEnter>Date.now()-225&&(!b||i.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!b&&m.pos<c.doc.content.size&&!m.sameParent(g)&&(v=Il.findFrom(c.doc.resolve(m.pos+1),1,!0))&&v.head==g.pos)&&e.someProp("handleKeyDown",t=>t(e,IB(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>p.start&&function(e,t,n,r,i){if(n-t<=i.pos-r.pos||LK(r,!0,!1)<i.pos)return!1;let o=e.resolve(t);if(!r.parent.isTextblock){let e=o.nodeAfter;return null!=e&&n==t+e.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=e.resolve(LK(o,!0,!0));return!(!s.parent.isTextblock||s.pos>n||LK(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(h,p.start,p.endA,m,g)&&e.someProp("handleKeyDown",t=>t(e,IB(8,"Backspace")))){I3&&IJ&&e.domObserver.suppressSelectionUpdates();return}IJ&&p.endB==p.start&&(e.input.lastChromeDelete=Date.now()),I3&&!b&&m.start()!=g.start()&&0==g.parentOffset&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,g=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,IB(13,"Enter"))})},20));let x=p.start,w=p.endA,k,O,S;if(b){if(m.pos==g.pos)IG&&IX<=11&&0==m.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>$j(e),20)),k=e.state.tr.delete(x,w),O=h.resolve(p.start).marksAcross(h.resolve(p.endA));else if(p.endA==p.endB&&(S=function(e,t){let n=e.firstChild.marks,r=t.firstChild.marks,i=n,o=r,s,a,l;for(let e=0;e<r.length;e++)i=r[e].removeFromSet(i);for(let e=0;e<n.length;e++)o=n[e].removeFromSet(o);if(1==i.length&&0==o.length)a=i[0],s="add",l=e=>e.mark(a.addToSet(e.marks));else{if(0!=i.length||1!=o.length)return null;a=o[0],s="remove",l=e=>e.mark(a.removeFromSet(e.marks))}let c=[];for(let e=0;e<t.childCount;e++)c.push(l(t.child(e)));if(PG.from(c).eq(e))return{mark:a,type:s}}(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,p.endA-y.start()))))k=e.state.tr,"add"==S.type?k.addMark(x,w,S.mark):k.removeMark(x,w,S.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let t=m.parent.textBetween(m.parentOffset,g.parentOffset);if(e.someProp("handleTextInput",n=>n(e,x,w,t)))return;k=e.state.tr.insertText(t,x,w)}}if(k||(k=e.state.tr.replace(x,w,c.doc.slice(p.start-c.from,p.endB-c.from))),c.sel){let t=LJ(e,k.doc,c.sel);t&&!(IJ&&e.composing&&t.empty&&(p.start!=p.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==x||t.head==k.mapping.map(w)-1)||IG&&t.empty&&t.head==x)&&k.setSelection(t)}O&&k.ensureMarks(O),o&&k.setMeta("composition",o),e.dispatch(k.scrollIntoView())})(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in Lr){let n=Lr[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||Lc(e,t)||!e.editable&&t.type in Li||n(e,t)},Lo[t]?{passive:!0}:void 0)}I0&&e.dom.addEventListener("input",()=>null),Ll(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;for(let t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ll(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(L6),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let e in this._props)t[e]=this._props[e];for(let n in t.state=this.state,e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n,r,i;let o=this.state,s=!1,a=!1;e.storedMarks&&this.composing&&(Lb(this),a=!0),this.state=e;let l=o.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=L4(this);(function(e,t){let n=0,r=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let e in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,s=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&Ll(this),this.editable=L3(this),L5(this);let c=LF(this),h=L2(this),u=o.plugins==e.plugins||o.doc.eq(e.doc)?e.scrollToSelection>o.scrollToSelection?"to selection":"preserve":"reset",d=s||!this.docView.matchesNode(e.doc,h,c);(d||!e.selection.eq(o.selection))&&(a=!0);let f="preserve"==u&&a&&null==this.dom.style.overflowAnchor&&function(e){let t=e.dom.getBoundingClientRect(),n=Math.max(0,t.top),r,i;for(let o=(t.left+t.right)/2,s=n+1;s<Math.min(innerHeight,t.bottom);s+=5){let t=e.root.elementFromPoint(o,s);if(!t||t==e.dom||!e.dom.contains(t))continue;let a=t.getBoundingClientRect();if(a.top>=n-20){r=t,i=a.top;break}}return{refDOM:r,refTop:i,stack:I7(e.dom)}}(this);if(a){let t,n,a;this.domObserver.stop();let l=d&&(IG||IJ)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&(r=o.selection,i=e.selection,a=Math.min(r.$anchor.sharedDepth(r.head),i.$anchor.sharedDepth(i.head)),r.$anchor.start(a)!=i.$anchor.start(a));if(d){let t=IJ?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=function(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=IL(e=e.childNodes[t-1])}else{if(!e.parentNode||Iq(e))return null;t=I_(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||Iq(e))return null;t=I_(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,i=e.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(!(!e||!e.isText(n.nodeValue)))return r}}return n||r}(this)),(s||!this.docView.update(e.doc,h,c,this))&&(this.docView.updateOuterDeco(h),this.docView.destroy(),this.docView=$v(e.doc,h,c,this.dom,this)),t&&!this.trackWrites&&(l=!0)}l||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&(t=this.docView.domFromPos(this.state.selection.anchor,0),n=this.domSelectionRange(),Ij(t.node,t.offset,n.anchorNode,n.anchorOffset)))?$j(this,l):($z(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),null===(n=this.dragging)||void 0===n||!n.node||o.doc.eq(e.doc)||this.updateDraggedNode(this.dragging,o),"reset"==u?this.dom.scrollTop=0:"to selection"==u?this.scrollToSelection():f&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;$e(n,0==r?0:r-t)}(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(1==e.nodeType?e:e.parentNode))&&!this.someProp("handleScrollToSelection",e=>e(this))){if(this.state.selection instanceof Ip){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&I9(this,t.getBoundingClientRect(),e)}else I9(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new LO(e.slice,e.move,r<0?void 0:Ip.create(this.state.doc,r))}someProp(e,t){let n=this._props&&this._props[e],r;if(null!=n&&(r=t?t(n):n))return r;for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n].props[e];if(null!=i&&(r=t?t(i):i))return r}let i=this.state.plugins;if(i)for(let n=0;n<i.length;n++){let o=i[n].props[e];if(null!=o&&(r=t?t(o):o))return r}}hasFocus(){if(IG){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if($t)return e.focus($t);let t=I7(e);e.focus(null==$t?{get preventScroll(){return $t={preventScroll:!0},!0}}:void 0),$t||($t=!1,$e(t,0))}(this.dom),$j(this),this.domObserver.start()}get root(){let e=this._root;if(null==e){for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return e||document}updateRoot(){this._root=null}posAtCoords(e){return function(e,t){var n;let r,i=e.dom.ownerDocument,o,s=0,a=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(IL(r.offsetNode),r.offset)}}catch{}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(IL(r.startContainer),r.startOffset)}}}(i,t.left,t.top);a&&({node:o,offset:s}=a);let l=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top),c;if(!l||!e.dom.contains(1!=l.nodeType?l.parentNode:l)){let n=e.dom.getBoundingClientRect();if(!$n(t,n)||!(l=function e(t,n,r){let i=t.childNodes.length;if(i&&r.top<r.bottom)for(let o=Math.max(0,Math.min(i-1,Math.floor(i*(n.top-r.top)/(r.bottom-r.top))-2)),s=o;;){let r=t.childNodes[s];if(1==r.nodeType){let t=r.getClientRects();for(let i=0;i<t.length;i++){let o=t[i];if($n(n,o))return e(r,n,o)}}if((s=(s+1)%i)==o)break}return t}(e.dom,t,n)))return null}if(I0)for(let e=l;o&&e;e=ID(e))e.draggable&&(o=void 0);if(l=(r=(n=l).parentNode)&&/^li$/i.test(r.nodeName)&&t.left<n.getBoundingClientRect().left?r:n,o){let n;if(IZ&&1==o.nodeType&&(s=Math.min(s,o.childNodes.length))<o.childNodes.length){let e=o.childNodes[s],n;"IMG"==e.nodeName&&(n=e.getBoundingClientRect()).right<=t.left&&n.bottom>t.top&&s++}I4&&s&&1==o.nodeType&&1==(n=o.childNodes[s-1]).nodeType&&"false"==n.contentEditable&&n.getBoundingClientRect().top>=t.top&&s--,o==e.dom&&s==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?c=e.state.doc.content.size:(0==s||1!=o.nodeType||"BR"!=o.childNodes[s-1].nodeName)&&(c=function(e,t,n,r){let i=-1;for(let n=t,o=!1;n!=e.dom;){let t=e.docView.nearestDesc(n,!0),s;if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent||!t.contentDOM)&&((s=t.dom.getBoundingClientRect()).width||s.height)&&(t.node.isBlock&&t.parent&&(!o&&s.left>r.left||s.top>r.top?i=t.posBefore:(!o&&s.right<r.left||s.bottom<r.top)&&(i=t.posAfter),o=!0),!t.contentDOM&&i<0&&!t.node.isText))return(t.node.isBlock?r.top<(s.top+s.bottom)/2:r.left<(s.left+s.right)/2)?t.posBefore:t.posAfter;n=t.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,n,-1)}(e,o,s,t))}null==c&&(c=function(e,t,n){let{node:r,offset:i}=function e(t,n){let r,i=2e8,o,s=0,a=n.top,l=n.top,c,h;for(let e=t.firstChild,u=0;e;e=e.nextSibling,u++){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=IR(e).getClientRects()}for(let d=0;d<t.length;d++){let f=t[d];if(f.top<=a&&f.bottom>=l){a=Math.max(f.bottom,a),l=Math.min(f.top,l);let t=f.left>n.left?f.left-n.left:f.right<n.left?n.left-f.right:0;if(t<i){r=e,i=t,o=t&&3==r.nodeType?{left:f.right<n.left?f.right:f.left,top:n.top}:n,1==e.nodeType&&t&&(s=u+(n.left>=(f.left+f.right)/2?1:0));continue}}else f.top>n.top&&!c&&f.left<=n.left&&f.right>=n.left&&(c=e,h={left:Math.max(f.left,Math.min(f.right,n.left)),top:f.top});!r&&(n.left>=f.right&&n.top>=f.top||n.left>=f.left&&n.top>=f.bottom)&&(s=u+1)}}return!r&&c&&(r=c,o=h,i=0),r&&3==r.nodeType?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(e,i+1),r.setStart(e,i);let n=$i(r,1);if(n.top!=n.bottom&&$n(t,n))return{node:e,offset:i+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(r,o):!r||i&&1==r.nodeType?{node:t,offset:s}:e(r,o)}(t,n),o=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();o=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,i,o)}(e,l,t));let h=e.docView.nearestDesc(l,!0);return{pos:c,inside:h?h.posAtStart-h.border:-1}}(this,e)}coordsAtPos(e,t=1){return $s(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){var n,r;let i,o;return n=t||this.state,$u==n&&$d==e?$f:($u=n,$d=e,$f="up"==e||"down"==e?(r=this,i=n.selection,o="up"==e?i.$from:i.$to,$c(r,n,()=>{let{node:t}=r.docView.domFromPos(o.pos,"up"==e?-1:1);for(;;){let e=r.docView.nearestDesc(t,!0);if(!e)break;if(e.node.isBlock){t=e.contentDOM||e.dom;break}t=e.dom.parentNode}let n=$s(r,o.pos,1);for(let r=t.firstChild;r;r=r.nextSibling){let t;if(1==r.nodeType)t=r.getClientRects();else{if(3!=r.nodeType)continue;t=IR(r,0,r.nodeValue.length).getClientRects()}for(let r=0;r<t.length;r++){let i=t[r];if(i.bottom>i.top+1&&("up"==e?n.top-i.top>(i.bottom-n.top)*2:i.bottom-n.bottom>(n.bottom-i.top)*2))return!1}}return!0})):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=i==r.parent.content.size,s=e.domSelection();return s?$h.test(r.parent.textContent)&&s.modify?$c(e,t,()=>{let{focusNode:t,focusOffset:i,anchorNode:o,anchorOffset:a}=e.domSelectionRange(),l=s.caretBidiLevel;s.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:h,focusOffset:u}=e.domSelectionRange(),d=h&&!c.contains(1==h.nodeType?h:h.parentNode)||t==h&&i==u;try{s.collapse(o,a),t&&(t!=o||i!=a)&&s.extend&&s.extend(t,i)}catch{}return null!=l&&(s.caretBidiLevel=l),d}):"left"==n||"backward"==n?!i:o:r.pos==r.start()||r.pos==r.end()}(this,n,e))}pasteHTML(e,t){return Lw(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Lw(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return $5(this,e)}destroy(){this.docView&&(function(e){for(let t in e.domObserver.stop(),e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],LF(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,IP())}get isDestroyed(){return null==this.docView}dispatchEvent(e){Lc(this,e)||!Lr[e.type]||!this.editable&&e.type in Li||Lr[e.type](this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?I0&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){let n;if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return LX(e,n)}function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?LX(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function L2(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[LM.node(0,e.state.doc.content.size,t)]}function L5(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:LM.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function L3(e){return!e.someProp("editable",t=>!1===t(e.state))}function L4(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function L6(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw RangeError("Plugins passed directly to the view must not have a state component")}let L8="u">typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function L9(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function L7(e){let t=function(e){let t=Object.create(null);for(let n in e)t[function(e){let t,n,r,i,o=e.split(/-(?!$)/),s=o[o.length-1];"Space"==s&&(s=" ");for(let e=0;e<o.length-1;e++){let s=o[e];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))L8?i=!0:n=!0;else throw Error("Unrecognized modifier name: "+s)}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),i&&(s="Meta-"+s),r&&(s="Shift-"+s),s}(n)]=e[n];return t}(e);return function(e,n){let r=hf(n),i,o=t[L9(r,n)];if(o&&o(e.state,e.dispatch,e))return!0;if(1==r.length&&" "!=r){if(n.shiftKey){let i=t[L9(r,n,!1)];if(i&&i(e.state,e.dispatch,e))return!0}if((n.shiftKey||n.altKey||n.metaKey||r.charCodeAt(0)>127)&&(i=ha[n.keyCode])&&i!=r){let r=t[L9(i,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}let qe=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function qt(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("backward",e):!(n.parentOffset>0))?n:null}let qn=(e,t,n)=>{let r=qt(e,n);if(!r)return!1;let i=ql(r);if(!i){let n=r.blockRange(),i=n&&jX(n);return null!=i&&(t&&t(e.tr.lift(n,i).scrollIntoView()),!0)}let o=i.nodeBefore;if(qk(e,i,t,-1))return!0;if(0==r.parent.content.size&&(qs(o,"end")||Ip.isSelectable(o)))for(let n=r.depth;;n--){let s=j4(e.doc,r.before(n),r.after(n),P0.empty);if(s&&s.slice.size<s.to-s.from){if(t){let n=e.tr.step(s);n.setSelection(qs(o,"end")?Il.findFrom(n.doc.resolve(n.mapping.map(i.pos,-1)),-1):Ip.create(n.doc,i.pos-o.nodeSize)),t(n.scrollIntoView())}return!0}if(1==n||r.node(n-1).childCount>1)break}return!!o.isAtom&&i.depth==r.depth-1&&(t&&t(e.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0)},qr=(e,t,n)=>{let r=qt(e,n);if(!r)return!1;let i=ql(r);return!!i&&qo(e,i,t)},qi=(e,t,n)=>{let r=qc(e,n);if(!r)return!1;let i=qd(r);return!!i&&qo(e,i,t)};function qo(e,t,n){let r=t.nodeBefore,i=t.pos-1;for(;!r.isTextblock;i--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let o=t.nodeAfter,s=t.pos+1;for(;!o.isTextblock;s++){if(o.type.spec.isolating)return!1;let e=o.firstChild;if(!e)return!1;o=e}let a=j4(e.doc,i,s,P0.empty);if(!a||a.from!=i||a instanceof jW&&a.slice.size>=s-i)return!1;if(n){let t=e.tr.step(a);t.setSelection(Id.create(t.doc,i)),n(t.scrollIntoView())}return!0}function qs(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)break}return!1}let qa=(e,t,n)=>{let{$head:r,empty:i}=e.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;o=ql(r)}let s=o&&o.nodeBefore;return!!(s&&Ip.isSelectable(s))&&(t&&t(e.tr.setSelection(Ip.create(e.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function ql(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function qc(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("forward",e):!(n.parentOffset<n.parent.content.size))?n:null}let qh=(e,t,n)=>{let r=qc(e,n);if(!r)return!1;let i=qd(r);if(!i)return!1;let o=i.nodeAfter;if(qk(e,i,t,1))return!0;if(0==r.parent.content.size&&(qs(o,"start")||Ip.isSelectable(o))){let n=j4(e.doc,r.before(),r.after(),P0.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(qs(o,"start")?Il.findFrom(r.doc.resolve(r.mapping.map(i.pos)),1):Ip.create(r.doc,r.mapping.map(i.pos))),t(r.scrollIntoView())}return!0}}return!!o.isAtom&&i.depth==r.depth-1&&(t&&t(e.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0)},qu=(e,t,n)=>{let{$head:r,empty:i}=e.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;o=qd(r)}let s=o&&o.nodeAfter;return!!(s&&Ip.isSelectable(s))&&(t&&t(e.tr.setSelection(Ip.create(e.doc,o.pos)).scrollIntoView()),!0)};function qd(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}let qf=(e,t)=>{let n=e.selection,r=n instanceof Ip,i;if(r){if(n.node.isTextblock||!j1(e.doc,n.from))return!1;i=n.from}else if(null==(i=j5(e.doc,n.from,-1)))return!1;if(t){let n=e.tr.join(i);r&&n.setSelection(Ip.create(n.doc,i-e.doc.resolve(i).nodeBefore.nodeSize)),t(n.scrollIntoView())}return!0},qp=(e,t)=>{let n=e.selection,r;if(n instanceof Ip){if(n.node.isTextblock||!j1(e.doc,n.to))return!1;r=n.to}else if(null==(r=j5(e.doc,n.to,1)))return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0},qm=(e,t)=>{let{$from:n,$to:r}=e.selection,i=n.blockRange(r),o=i&&jX(i);return null!=o&&(t&&t(e.tr.lift(i,o).scrollIntoView()),!0)},qg=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!!(n.parent.type.spec.code&&n.sameParent(r))&&(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function qy(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}let qb=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=qy(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(t){let r=n.after(),i=e.tr.replaceWith(r,r,s.createAndFill());i.setSelection(Il.near(i.doc.resolve(r),1)),t(i.scrollIntoView())}return!0},qv=(e,t)=>{let n=e.selection,{$from:r,$to:i}=n;if(n instanceof Ig||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=qy(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let n=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,s=e.tr.insert(n,o.createAndFill());s.setSelection(Id.create(s.doc,n+1)),t(s.scrollIntoView())}return!0},qx=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(j0(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),i=r&&jX(r);return null!=i&&(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)},qw=(e,t)=>{let{$from:n,to:r}=e.selection,i,o=n.sharedDepth(r);return 0!=o&&(i=n.before(o),t&&t(e.tr.setSelection(Ip.create(e.doc,i))),!0)};function qk(e,t,n,r){let i,o,s,a=t.nodeBefore,l=t.nodeAfter,c,h,u=a.type.spec.isolating||l.type.spec.isolating;if(!u&&(i=t.nodeBefore,o=t.nodeAfter,s=t.index(),i&&o&&i.type.compatibleContent(o.type)&&(!i.content.size&&t.parent.canReplace(s-1,s)?(n&&n(e.tr.delete(t.pos-i.nodeSize,t.pos).scrollIntoView()),!0):!!(t.parent.canReplace(s,s+1)&&(o.isTextblock||j1(e.doc,t.pos)))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))))return!0;let d=!u&&t.parent.canReplace(t.index(),t.index()+1);if(d&&(c=(h=a.contentMatchAt(a.childCount)).findWrapping(l.type))&&h.matchType(c[0]||l.type).validEnd){if(n){let r=t.pos+l.nodeSize,i=PG.empty;for(let e=c.length-1;e>=0;e--)i=PG.from(c[e].create(null,i));i=PG.from(a.copy(i));let o=e.tr.step(new jU(t.pos-1,r,t.pos,r,new P0(i,1,0),c.length,!0)),s=o.doc.resolve(r+2*c.length);s.nodeAfter&&s.nodeAfter.type==a.type&&j1(o.doc,s.pos)&&o.join(s.pos),n(o.scrollIntoView())}return!0}let f=l.type.spec.isolating||r>0&&u?null:Il.findFrom(t,1),p=f&&f.$from.blockRange(f.$to),m=p&&jX(p);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(p,m).scrollIntoView()),!0;if(d&&qs(l,"start",!0)&&qs(a,"end")){let r=a,i=[];for(;i.push(r),!r.isTextblock;)r=r.lastChild;let o=l,s=1;for(;!o.isTextblock;o=o.firstChild)s++;if(r.canReplace(r.childCount,r.childCount,o.content)){if(n){let r=PG.empty;for(let e=i.length-1;e>=0;e--)r=PG.from(i[e].copy(r));n(e.tr.step(new jU(t.pos-i.length,t.pos+l.nodeSize,t.pos+s,t.pos+l.nodeSize-s,new P0(r,i.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function qO(e){return function(t,n){let r=t.selection,i=e<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return!!i.node(o).isTextblock&&(n&&n(t.tr.setSelection(Id.create(t.doc,e<0?i.start(o):i.end(o)))),!0)}}let qS=qO(-1),qC=qO(1);function qT(e,t=null){return function(n,r){let i=!1;for(let r=0;r<n.selection.ranges.length&&!i;r++){let{$from:{pos:o},$to:{pos:s}}=n.selection.ranges[r];n.doc.nodesBetween(o,s,(r,o)=>{if(i)return!1;if(!(!r.isTextblock||r.hasMarkup(e,t))){if(r.type==e)i=!0;else{let t=n.doc.resolve(o),r=t.index();i=t.parent.canReplaceWith(r,r+1,e)}}})}if(!i)return!1;if(r){let i=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:o},$to:{pos:s}}=n.selection.ranges[r];i.setBlockType(o,s,e,t)}r(i.scrollIntoView())}return!0}}function qA(...e){return function(t,n,r){for(let i=0;i<e.length;i++)if(e[i](t,n,r))return!0;return!1}}function qE(e){let{state:t,transaction:n}=e,{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}qA(qe,qn,qa),qA(qe,qh,qu),qA(qg,qv,qx,(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof Ip&&e.selection.node.isBlock)return!!(n.parentOffset&&j0(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let i=[],o,s,a=!1,l=!1;for(let e=n.depth;;e--)if(n.node(e).isBlock){a=n.end(e)==n.pos+(n.depth-e),l=n.start(e)==n.pos-(n.depth-e),s=qy(n.node(e-1).contentMatchAt(n.indexAfter(e-1))),i.unshift(a&&s?{type:s}:null),o=e;break}else{if(1==e)return!1;i.unshift(null)}let c=e.tr;(e.selection instanceof Id||e.selection instanceof Ig)&&c.deleteSelection();let h=c.mapping.map(n.pos),u=j0(c.doc,h,i.length,i);if(u||(i[0]=s?{type:s}:null,u=j0(c.doc,h,i.length,i)),c.split(h,i.length,i),!a&&l&&n.node(o).type!=s){let e=c.mapping.map(n.before(o)),t=c.doc.resolve(e);s&&n.node(o-1).canReplaceWith(t.index(),t.index()+1,s)&&c.setNodeMarkup(c.mapping.map(n.before(o)),s)}return t&&t(c.scrollIntoView()),!0}),"u">typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"u">typeof os&&os.platform&&os.platform();class qM{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:i}=n,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{let n=t(...e)(o);return i.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(i),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s=[],a=!!e,l=e||i.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{let r=this.buildProps(l,t),i=n(...e)(r);return s.push(i),c}])),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(l),s.every(e=>!0===e))};return c}createCan(e){let{rawCommands:t,state:n}=this,r=e||n.tr,i=this.buildProps(r,!1);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...i,dispatch:void 0})])),chain:()=>this.createChain(r,!1)}}buildProps(e,t=!0){let{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s={tr:e,editor:r,view:o,state:qE({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(s)]))}};return s}}class q_{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){let n=(...r)=>{this.off(e,n),t.apply(this,r)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}}function qD(e,t,n){return void 0===e.config[t]&&e.parent?qD(e.parent,t,n):"function"==typeof e.config[t]?e.config[t].bind({...n,parent:e.parent?qD(e.parent,t,n):null}):e.config[t]}function qN(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function qR(e){let t=[],{nodeExtensions:n,markExtensions:r}=qN(e),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage,extensions:i},r=qD(e,"addGlobalAttributes",n);r&&r().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...o,...r}})})})})}),i.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=qD(e,"addAttributes",n);r&&Object.entries(r()).forEach(([n,r])=>{let i={...o,...r};"function"==typeof(null==i?void 0:i.default)&&(i.default=i.default()),null!=i&&i.isRequired&&(null==i?void 0:i.default)===void 0&&delete i.default,t.push({type:e.name,name:n,attribute:i})})}),t}function qP(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function qj(...e){return e.filter(e=>!!e).reduce((e,t)=>{let n={...e};return Object.entries(t).forEach(([e,t])=>{if(!n[e]){n[e]=t;return}if("class"===e){let r=t?String(t).split(" "):[],i=n[e]?n[e].split(" "):[],o=r.filter(e=>!i.includes(e));n[e]=[...i,...o].join(" ")}else if("style"===e){let r=t?t.split(";").map(e=>e.trim()).filter(Boolean):[],i=n[e]?n[e].split(";").map(e=>e.trim()).filter(Boolean):[],o=new Map;i.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());o.set(t,n)}),r.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());o.set(t,n)}),n[e]=Array.from(o.entries()).map(([e,t])=>`${e}: ${t}`).join("; ")}else n[e]=t}),n},{})}function qI(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>qj(e,t),{})}function q$(e){return"function"==typeof e}function qL(e,t,...n){return q$(e)?t?e.bind(t)(...n):e(...n):e}function qq(e,t){return"style"in e?e:{...e,getAttrs:n=>{let r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;let i=t.reduce((e,t)=>{var r;let i=t.attribute.parseHTML?t.attribute.parseHTML(n):"string"!=typeof(r=n.getAttribute(t.name))?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):"true"===r||"false"!==r&&r;return null==i?e:{...e,[t.name]:i}},{});return{...r,...i}}}}function qz(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!("attrs"===e&&function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function qB(e,t){return t.nodes[e]||t.marks[e]||null}function qF(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}function qQ(e,t){let n=jM.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}let qV=(e,t=500)=>{let n="",r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,i,o)=>{var s,a;let l=(null===(a=(s=e.type.spec).toText)||void 0===a?void 0:a.call(s,{node:e,pos:t,parent:i,index:o}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,r-t))}),n};function qW(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class qU{constructor(e){this.find=e.find,this.handler=e.handler}}let qH=(e,t)=>{if(qW(t))return t.exec(e);let n=t(e);if(!n)return null;let r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function qG(e){var t;let{editor:n,from:r,to:i,text:o,rules:s,plugin:a}=e,{view:l}=n;if(l.composing)return!1;let c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!(null===(t=c.nodeBefore||c.nodeAfter)||void 0===t)&&t.marks.find(e=>e.type.spec.code))return!1;let h=!1,u=qV(c)+o;return s.forEach(e=>{if(h)return;let t=qH(u,e.find);if(!t)return;let s=l.state.tr,c=qE({state:l.state,transaction:s}),d={from:r-(t[0].length-o.length),to:i},{commands:f,chain:p,can:m}=new qM({editor:n,state:c});null!==e.handler({state:c,range:d,match:t,commands:f,chain:p,can:m})&&s.steps.length&&(s.setMeta(a,{transform:s,from:r,to:i,text:o}),l.dispatch(s),h=!0)}),h}function qX(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function qZ(e,t){let n={...e};return qX(e)&&qX(t)&&Object.keys(t).forEach(r=>{qX(t[r])&&qX(e[r])?n[r]=qZ(e[r],t[r]):n[r]=t[r]}),n}class qY{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=qL(qD(this,"addOptions",{name:this.name}))),this.storage=qL(qD(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new qY(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>qZ(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new qY(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=qL(qD(t,"addOptions",{name:t.name})),t.storage=qL(qD(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){let{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){let i=r.marks();if(!i.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;let o=i.find(e=>(null==e?void 0:e.type.name)===t.name);return o&&n.removeStoredMark(o),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}}class qJ{constructor(e){this.find=e.find,this.handler=e.handler}}let qK=(e,t,n)=>{if(qW(t))return[...e.matchAll(t)];let r=t(e,n);return r?r.map(t=>{let n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]},q0=null,q1=e=>{var t;let n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(t=n.clipboardData)||void 0===t||t.setData("text/html",e),n};class q2{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=q2.resolve(e),this.schema=function(e,t){var n;let r=qR(e),{nodeExtensions:i,markExtensions:o}=qN(e);return new jb({topNode:null===(n=i.find(e=>qD(e,"topNode")))||void 0===n?void 0:n.name,nodes:Object.fromEntries(i.map(n=>{let i=r.filter(e=>e.type===n.name),o={name:n.name,options:n.options,storage:n.storage,editor:t},s=qz({...e.reduce((e,t)=>{let r=qD(t,"extendNodeSchema",o);return{...e,...r?r(n):{}}},{}),content:qL(qD(n,"content",o)),marks:qL(qD(n,"marks",o)),group:qL(qD(n,"group",o)),inline:qL(qD(n,"inline",o)),atom:qL(qD(n,"atom",o)),selectable:qL(qD(n,"selectable",o)),draggable:qL(qD(n,"draggable",o)),code:qL(qD(n,"code",o)),whitespace:qL(qD(n,"whitespace",o)),linebreakReplacement:qL(qD(n,"linebreakReplacement",o)),defining:qL(qD(n,"defining",o)),isolating:qL(qD(n,"isolating",o)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=qL(qD(n,"parseHTML",o));a&&(s.parseDOM=a.map(e=>qq(e,i)));let l=qD(n,"renderHTML",o);l&&(s.toDOM=e=>l({node:e,HTMLAttributes:qI(e,i)}));let c=qD(n,"renderText",o);return c&&(s.toText=c),[n.name,s]})),marks:Object.fromEntries(o.map(n=>{let i=r.filter(e=>e.type===n.name),o={name:n.name,options:n.options,storage:n.storage,editor:t},s=qz({...e.reduce((e,t)=>{let r=qD(t,"extendMarkSchema",o);return{...e,...r?r(n):{}}},{}),inclusive:qL(qD(n,"inclusive",o)),excludes:qL(qD(n,"excludes",o)),group:qL(qD(n,"group",o)),spanning:qL(qD(n,"spanning",o)),code:qL(qD(n,"code",o)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=qL(qD(n,"parseHTML",o));a&&(s.parseDOM=a.map(e=>qq(e,i)));let l=qD(n,"renderHTML",o);return l&&(s.toDOM=e=>l({mark:e,HTMLAttributes:qI(e,i)})),[n.name,s]}))})}(this.extensions,t),this.setupExtensions()}static resolve(e){var t;let n=q2.sort(q2.flatten(e)),r=Array.from(new Set((t=n.map(e=>e.name)).filter((e,n)=>t.indexOf(e)!==n)));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(e=>{let t={name:e.name,options:e.options,storage:e.storage},n=qD(e,"addExtensions",t);return n?[e,...this.flatten(n())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{let n=qD(e,"priority")||100,r=qD(t,"priority")||100;return n>r?-1:n<r?1:0})}get commands(){return this.extensions.reduce((e,t)=>{let n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:qB(t.name,this.schema)},r=qD(t,"addCommands",n);return r?{...e,...r()}:e},{})}get plugins(){let{editor:e}=this,t=q2.sort([...this.extensions].reverse()),n=[],r=[],i=t.map(t=>{let i={name:t.name,options:t.options,storage:t.storage,editor:e,type:qB(t.name,this.schema)},o=[],s=qD(t,"addKeyboardShortcuts",i),a={};if("mark"===t.type&&qD(t,"exitable",i)&&(a.ArrowRight=()=>qY.handleExit({editor:e,mark:t})),s){let t=Object.fromEntries(Object.entries(s()).map(([t,n])=>[t,()=>n({editor:e})]));a={...a,...t}}let l=new IT({props:{handleKeyDown:L7(a)}});o.push(l);let c=qD(t,"addInputRules",i);qF(t,e.options.enableInputRules)&&c&&n.push(...c());let h=qD(t,"addPasteRules",i);qF(t,e.options.enablePasteRules)&&h&&r.push(...h());let u=qD(t,"addProseMirrorPlugins",i);if(u){let e=u();o.push(...e)}return o}).flat();return[function(e){let{editor:t,rules:n}=e,r=new IT({state:{init:()=>null,apply(e,i,o){let s=e.getMeta(r);if(s)return s;let a=e.getMeta("applyInputRules");return a&&setTimeout(()=>{let{text:e}=a;e="string"==typeof e?e:qQ(PG.from(e),o.schema);let{from:i}=a,s=i+e.length;qG({editor:t,from:i,to:s,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:i}},props:{handleTextInput:(e,i,o,s)=>qG({editor:t,from:i,to:o,text:s,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{let{$cursor:i}=e.state.selection;i&&qG({editor:t,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,i){if("Enter"!==i.key)return!1;let{$cursor:o}=e.state.selection;return!!o&&qG({editor:t,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:n}),...function(e){let{editor:t,rules:n}=e,r=null,i=!1,o=!1,s="u">typeof ClipboardEvent?new ClipboardEvent("paste"):null,a;try{a="u">typeof DragEvent?new DragEvent("drop"):null}catch{a=null}let l=({state:e,from:n,to:r,rule:i,pasteEvt:o})=>{let l=e.tr;if(!(!function(e){let{editor:t,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:h}=new qM({editor:t,state:n}),u=[];return n.doc.nodesBetween(r,i,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;let d=Math.max(r,t),f=Math.min(i,t+e.content.size);qK(e.textBetween(d-t,f-t,void 0,""),o.find,s).forEach(e=>{if(void 0===e.index)return;let t=d+e.index+1,r=t+e[0].length,i={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},f=o.handler({state:n,range:i,match:e,commands:l,chain:c,can:h,pasteEvent:s,dropEvent:a});u.push(f)})}),u.every(e=>null!==e)}({editor:t,state:qE({state:e,transaction:l}),from:Math.max(n-1,0),to:r.b-1,rule:i,pasteEvent:o,dropEvent:a})||!l.steps.length)){try{a="u">typeof DragEvent?new DragEvent("drop"):null}catch{a=null}return s="u">typeof ClipboardEvent?new ClipboardEvent("paste"):null,l}};return n.map(e=>new IT({view(e){let n=n=>{var i;(r=!(null===(i=e.dom.parentElement)||void 0===i)&&i.contains(n.target)?e.dom.parentElement:null)&&(q0=t)},i=()=>{q0&&(q0=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",i),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",i)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(o=r===e.dom.parentElement,a=t,!o){let e=q0;e&&setTimeout(()=>{let t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;let r=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");return s=t,i=!!(null!=r&&r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{let a=t[0],c="paste"===a.getMeta("uiEvent")&&!i,h="drop"===a.getMeta("uiEvent")&&!o,u=a.getMeta("applyPasteRules"),d=!!u;if(!c&&!h&&!d)return;if(d){let{text:t}=u;t="string"==typeof t?t:qQ(PG.from(t),r.schema);let{from:n}=u,i=n+t.length;return l({rule:e,state:r,from:n,to:{b:i},pasteEvt:q1(t)})}let f=n.doc.content.findDiffStart(r.doc.content),p=n.doc.content.findDiffEnd(r.doc.content);if(!("number"!=typeof f||!p||f===p.b))return l({rule:e,state:r,from:f,to:p,pasteEvt:s})}}))}({editor:e,rules:r}),...i]}get attributes(){return qR(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:t}=qN(this.extensions);return Object.fromEntries(t.filter(e=>!!qD(e,"addNodeView")).map(t=>{let n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:t.storage,editor:e,type:qP(t.name,this.schema)},i=qD(t,"addNodeView",r);return i?[t.name,(r,o,s,a,l)=>{let c=qI(r,n);return i()({node:r,view:o,getPos:s,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]:[]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;let n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:qB(e.name,this.schema)};"mark"===e.type&&(!(null!==(t=qL(qD(e,"keepOnSplit",n)))&&void 0!==t)||t)&&this.splittableMarks.push(e.name);let r=qD(e,"onBeforeCreate",n),i=qD(e,"onCreate",n),o=qD(e,"onUpdate",n),s=qD(e,"onSelectionUpdate",n),a=qD(e,"onTransaction",n),l=qD(e,"onFocus",n),c=qD(e,"onBlur",n),h=qD(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),i&&this.editor.on("create",i),o&&this.editor.on("update",o),s&&this.editor.on("selectionUpdate",s),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),h&&this.editor.on("destroy",h)})}}class q5{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=qL(qD(this,"addOptions",{name:this.name}))),this.storage=qL(qD(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new q5(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>qZ(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new q5({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=qL(qD(t,"addOptions",{name:t.name})),t.storage=qL(qD(t,"addStorage",{name:t.name,options:t.options})),t}}function q3(e,t,n){let{from:r,to:i}=t,{blockSeparator:o=`

`,textSerializers:s={}}=n||{},a="";return e.nodesBetween(r,i,(e,n,l,c)=>{var h;e.isBlock&&n>r&&(a+=o);let u=null==s?void 0:s[e.type.name];if(u)return l&&(a+=u({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null===(h=null==e?void 0:e.text)||void 0===h?void 0:h.slice(Math.max(r,n)-n,i-n))}),a}function q4(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}let q6=q5.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new IT({key:new IM("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:i}=t,{ranges:o}=i,s=Math.min(...o.map(e=>e.$from.pos)),a=Math.max(...o.map(e=>e.$to.pos)),l=q4(n);return q3(r,{from:s,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});function q8(e,t,n={strict:!0}){let r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:qW(t[r])?t[r].test(e[r]):t[r]===e[r])}function q9(e,t,n={}){return e.find(e=>e.type===t&&q8(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function q7(e,t,n={}){return!!q9(e,t,n)}function ze(e,t,n){var r;if(!e||!t)return;let i=e.parent.childAfter(e.parentOffset);if(i.node&&i.node.marks.some(e=>e.type===t)||(i=e.parent.childBefore(e.parentOffset)),!i.node||!i.node.marks.some(e=>e.type===t)||(n=n||(null===(r=i.node.marks[0])||void 0===r?void 0:r.attrs),!q9([...i.node.marks],t,n)))return;let o=i.index,s=e.start()+i.offset,a=o+1,l=s+i.node.nodeSize;for(;o>0&&q7([...e.parent.child(o-1).marks],t,n);)o-=1,s-=e.parent.child(o).nodeSize;for(;a<e.parent.childCount&&q7([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function zt(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function zn(e){return e instanceof Id}function zr(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function zi(e,t=null){if(!t)return null;let n=Il.atStart(e),r=Il.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;let i=n.from,o=r.to;return"all"===t?Id.create(e,zr(0,i,o),zr(e.content.size,i,o)):Id.create(e,zr(t,i,o),zr(t,i,o))}function zo(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function zs(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}let za=e=>{let t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){let r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&za(r)}return e};function zl(e){let t=`<body>${e}</body>`;return za(new window.DOMParser().parseFromString(t,"text/html").body)}function zc(e,t,n){if(e instanceof jr||e instanceof PG)return e;n={slice:!0,parseOptions:{},...n};let r="object"==typeof e&&null!==e,i="string"==typeof e;if(r)try{if(Array.isArray(e)&&e.length>0)return PG.fromArray(e.map(e=>t.nodeFromJSON(e)));let r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(r){if(n.errorOnInvalidContent)throw Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),zc("",t,n)}if(i){if(n.errorOnInvalidContent){let r=!1,i="",o=new jb({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,i="string"==typeof e?e:e.outerHTML,null)}]}})});if(n.slice?jx.fromSchema(o).parseSlice(zl(e),n.parseOptions):jx.fromSchema(o).parse(zl(e),n.parseOptions),n.errorOnInvalidContent&&r)throw Error("[tiptap error]: Invalid HTML content",{cause:Error(`Invalid element found: ${i}`)})}let r=jx.fromSchema(t);return n.slice?r.parseSlice(zl(e),n.parseOptions).content:r.parse(zl(e),n.parseOptions)}return zc("",t,n)}let zh=e=>!("type"in e);function zu(){return"u">typeof navigator&&/Mac/.test(navigator.platform)}function zd(e,t,n={}){let{from:r,to:i,empty:o}=e.selection,s=t?qP(t,e.schema):null,a=[];e.doc.nodesBetween(r,i,(e,t)=>{if(e.isText)return;let n=Math.max(r,t),o=Math.min(i,t+e.nodeSize);a.push({node:e,from:n,to:o})});let l=i-r,c=a.filter(e=>!s||s.name===e.node.type.name).filter(e=>q8(e.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((e,t)=>e+t.to-t.from,0)>=l}function zf(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function zp(e,t){let n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}function zm(e,t,n={},r={}){return zc(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}function zg(e,t){let n=zt(t,e.schema),{from:r,to:i,empty:o}=e.selection,s=[];o?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,i,e=>{s.push(...e.marks)});let a=s.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function zy(e,t){for(let n=e.depth;n>0;n-=1){let r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function zb(e){return t=>zy(t.$from,e)}function zv(e,t,n){let r=[];return e===t?n.resolve(e).marks().forEach(t=>{let i=ze(n.resolve(e),t.type);i&&r.push({mark:t,...i})}):n.nodesBetween(e,t,(e,t)=>{e&&(null==e?void 0:e.nodeSize)!==void 0&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function zx(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{let r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function zw(e,t,n={}){let{empty:r,ranges:i}=e.selection,o=t?zt(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!o||o.name===e.type.name).find(e=>q8(e.attrs,n,{strict:!1}));let s=0,a=[];if(i.forEach(({$from:t,$to:n})=>{let r=t.pos,i=n.pos;e.doc.nodesBetween(r,i,(e,t)=>{if(!e.isText&&!e.marks.length)return;let n=Math.max(r,t),o=Math.min(i,t+e.nodeSize);s+=o-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:o})))})}),0===s)return!1;let l=a.filter(e=>!o||o.name===e.mark.type.name).filter(e=>q8(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!o||e.mark.type!==o&&e.mark.type.excludes(o)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=s}function zk(e,t){let{nodeExtensions:n}=qN(t),r=n.find(t=>t.name===e);if(!r)return!1;let i={name:r.name,options:r.options,storage:r.storage},o=qL(qD(r,"group",i));return"string"==typeof o&&o.split(" ").includes("list")}function zO(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!==(r=e.text)&&void 0!==r?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(zO(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function zS(e,t){let n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){let r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}let zC=(e,t)=>{let n=zb(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;let i=e.doc.nodeAt(r);return n.node.type===(null==i?void 0:i.type)&&j1(e.doc,n.pos)&&e.join(n.pos),!0},zT=(e,t)=>{let n=zb(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;let i=e.doc.nodeAt(r);return n.node.type===(null==i?void 0:i.type)&&j1(e.doc,r)&&e.join(r),!0};var zA=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null===(n=null==window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:n})=>{let{selection:r}=t,{ranges:i}=r;return n&&i.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;let{doc:r,mapping:i}=t,o=r.resolve(i.map(n)),s=r.resolve(i.map(n+e.nodeSize)),a=o.blockRange(s);if(!a)return;let l=jX(a);if(e.type.isTextblock){let{defaultType:e}=o.parent.contentMatchAt(o.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)})}),!0},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>qv(e,t),cut:(e,t)=>({editor:n,tr:r})=>{let{state:i}=n,o=i.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);let s=r.mapping.map(t);return r.insert(s,o.content),r.setSelection(new Id(r.doc.resolve(s-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;let i=e.selection.$anchor;for(let n=i.depth;n>0;n-=1)if(i.node(n).type===r.type){if(t){let t=i.before(n),r=i.after(n);e.delete(t,r).scrollIntoView()}return!0}return!1},deleteNode:e=>({tr:t,state:n,dispatch:r})=>{let i=qP(e,n.schema),o=t.selection.$anchor;for(let e=o.depth;e>0;e-=1)if(o.node(e).type===i){if(r){let n=o.before(e),r=o.after(e);t.delete(n,r).scrollIntoView()}return!0}return!1},deleteRange:e=>({tr:t,dispatch:n})=>{let{from:r,to:i}=e;return n&&t.delete(r,i),!0},deleteSelection:()=>({state:e,dispatch:t})=>qe(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>qb(e,t),extendMarkRange:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let o=zt(e,r.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:h}=a;if(i){let e=ze(l,o,t);if(e&&e.from<=c&&e.to>=h){let t=Id.create(s,e.from,e.to);n.setSelection(t)}}return!0},first:e=>t=>{let n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:n,view:r,tr:i,dispatch:o})=>{t={scrollIntoView:!0,...t};let s=()=>{(zs()||zo())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),null!=t&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(o&&null===e&&!zn(n.state.selection))return s(),!0;let a=zi(i.doc,e)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},forEach:(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),insertContent:(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),insertContentAt:(e,t,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){let i,a;n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};try{i=zc(t,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:null!==(s=n.errorOnInvalidContent)&&void 0!==s?s:o.options.enableContentCheck})}catch(e){return o.emit("contentError",{editor:o,error:e,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},h=!0,u=!0;if((zh(i)?i:[i]).forEach(e=>{e.check(),h=!!h&&e.isText&&0===e.marks.length,u=!!u&&e.isBlock}),l===c&&u){let{parent:e}=r.doc.resolve(l);!e.isTextblock||e.type.spec.code||e.childCount||(l-=1,c+=1)}if(h){if(Array.isArray(t))a=t.map(e=>e.text||"").join("");else if(t instanceof PG){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),a=e}else a="object"==typeof t&&t&&t.text?t.text:t;r.insertText(a,l,c)}else a=i,r.replaceWith(l,c,a);n.updateSelection&&function(e,t,n){let r=e.steps.length-1;if(r<t)return;let i=e.steps[r];if(!(i instanceof jW||i instanceof jU))return;let o=e.mapping.maps[r],s=0;o.forEach((e,t,n,r)=>{0===s&&(s=r)}),e.setSelection(Il.near(e.doc.resolve(s),-1))}(r,r.steps.length-1,0),n.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:a}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:a})}return!0},joinBackward:()=>({state:e,dispatch:t})=>qn(e,t),joinDown:()=>({state:e,dispatch:t})=>qp(e,t),joinForward:()=>({state:e,dispatch:t})=>qh(e,t),joinItemBackward:()=>({state:e,dispatch:t,tr:n})=>{try{let r=j5(e.doc,e.selection.$from.pos,-1);return null!=r&&(n.join(r,2),t&&t(n),!0)}catch{return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:n})=>{try{let r=j5(e.doc,e.selection.$from.pos,1);return null!=r&&(n.join(r,2),t&&t(n),!0)}catch{return!1}},joinTextblockBackward:()=>({state:e,dispatch:t})=>qr(e,t),joinTextblockForward:()=>({state:e,dispatch:t})=>qi(e,t),joinUp:()=>({state:e,dispatch:t})=>qf(e,t),keyboardShortcut:e=>({editor:t,view:n,tr:r,dispatch:i})=>{let o=(function(e){let t,n,r,i;let o=e.split(/-(?!$)/),s=o[o.length-1];"Space"===s&&(s=" ");for(let e=0;e<o.length-1;e+=1){let s=o[e];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))zs()||zu()?i=!0:n=!0;else throw Error(`Unrecognized modifier name: ${s}`)}return t&&(s=`Alt-${s}`),n&&(s=`Ctrl-${s}`),i&&(s=`Meta-${s}`),r&&(s=`Shift-${s}`),s})(e).split(/-(?!$)/),s=o.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{let t=e.map(r.mapping);t&&i&&r.maybeStep(t)}),!0},lift:(e,t={})=>({state:n,dispatch:r})=>{let i=qP(e,n.schema);return!!zd(n,i,t)&&qm(n,r)},liftEmptyBlock:()=>({state:e,dispatch:t})=>qx(e,t),liftListItem:e=>({state:t,dispatch:n})=>(function(e){return function(t,n){let{$from:r,$to:i}=t.selection,o=r.blockRange(i,t=>t.childCount>0&&t.firstChild.type==e);return!!o&&(!n||(r.node(o.depth-1).type==e?function(e,t,n,r){let i=e.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new jU(o-1,s,o,s,new P0(PG.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new jt(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));let a=jX(r);if(null==a)return!1;i.lift(r,a);let l=i.mapping.map(o,-1)-1;return j1(i.doc,l)&&i.join(l),t(i.scrollIntoView()),!0}(t,n,e,o):function(e,t,n){let r=e.tr,i=n.parent;for(let e=n.end,t=n.endIndex-1,o=n.startIndex;t>o;t--)e-=i.child(t).nodeSize,r.delete(e-1,e+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==i.childCount,c=o.node(-1),h=o.index(-1);if(!c.canReplace(h+(a?0:1),h+1,s.content.append(l?PG.empty:PG.from(i))))return!1;let u=o.pos,d=u+s.nodeSize;return r.step(new jU(u-(a?1:0),d+(l?1:0),u+1,d-1,new P0((a?PG.empty:PG.from(i.copy(PG.empty))).append(l?PG.empty:PG.from(i.copy(PG.empty))),a?0:1,l?0:1),a?0:1)),t(r.scrollIntoView()),!0}(t,n,o)))}})(qP(e,t.schema))(t,n),newlineInCode:()=>({state:e,dispatch:t})=>qg(e,t),resetAttributes:(e,t)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null,a=zf("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(o=qP(e,r.schema)),"mark"===a&&(s=zt(e,r.schema)),i&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{o&&o===e.type&&n.setNodeMarkup(r,void 0,zp(e.attrs,t)),s&&e.marks.length&&e.marks.forEach(i=>{s===i.type&&n.addMark(r,r+e.nodeSize,s.create(zp(i.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,dispatch:t})=>{if(t){let t=new Ig(e.doc);e.setSelection(t)}return!0},selectNodeBackward:()=>({state:e,dispatch:t})=>qa(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>qu(e,t),selectParentNode:()=>({state:e,dispatch:t})=>qw(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>qC(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>qS(e,t),setContent:(e,t=!1,n={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,c;let{doc:h}=o;if("full"!==n.preserveWhitespace){let a=zm(e,i.schema,n,{errorOnInvalidContent:null!==(l=r.errorOnInvalidContent)&&void 0!==l?l:i.options.enableContentCheck});return s&&o.replaceWith(0,h.content.size,a).setMeta("preventUpdate",!t),!0}return s&&o.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:h.content.size},e,{parseOptions:n,errorOnInvalidContent:null!==(c=r.errorOnInvalidContent)&&void 0!==c?c:i.options.enableContentCheck})},setMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let{selection:o}=n,{empty:s,ranges:a}=o,l=zt(e,r.schema);if(i){if(s){let e=zg(r,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach(e=>{let i=e.$from.pos,o=e.$to.pos;r.doc.nodesBetween(i,o,(e,r)=>{let s=Math.max(r,i),a=Math.min(r+e.nodeSize,o);e.marks.find(e=>e.type===l)?e.marks.forEach(e=>{l===e.type&&n.addMark(s,a,l.create({...e.attrs,...t}))}):n.addMark(s,a,l.create(t))})})}return function(e,t,n){var r;let{selection:i}=t,o=null;if(zn(i)&&(o=i.$cursor),o){let t=null!==(r=e.storedMarks)&&void 0!==r?r:o.marks();return!!n.isInSet(t)||!t.some(e=>e.type.excludes(n))}let{ranges:s}=i;return s.some(({$from:t,$to:r})=>{let i=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(i)return!1;if(e.isInline){let t=!r||r.type.allowsMarkType(n),o=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));i=t&&o}return!i}),i})}(r,n,l)},setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),setNode:(e,t={})=>({state:n,dispatch:r,chain:i})=>{let o;let s=qP(e,n.schema);return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:e})=>!!qT(s,{...o,...t})(n)||e.clearNodes()).command(({state:e})=>qT(s,{...o,...t})(e,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,r=zr(e,0,n.content.size),i=Ip.create(n,r);t.setSelection(i)}return!0},setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,{from:r,to:i}="number"==typeof e?{from:e,to:e}:e,o=Id.atStart(n).from,s=Id.atEnd(n).to,a=zr(r,o,s),l=zr(i,o,s),c=Id.create(n,a,l);t.setSelection(c)}return!0},sinkListItem:e=>({state:t,dispatch:n})=>(function(e){return function(t,n){let{$from:r,$to:i}=t.selection,o=r.blockRange(i,t=>t.childCount>0&&t.firstChild.type==e);if(!o)return!1;let s=o.startIndex;if(0==s)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=e)return!1;if(n){let r=l.lastChild&&l.lastChild.type==a.type,i=PG.from(r?e.create():null),s=new P0(PG.from(e.create(null,PG.from(a.type.create(null,i)))),r?3:1,0),c=o.start,h=o.end;n(t.tr.step(new jU(c-(r?3:1),h,c,h,s,1,!0)).scrollIntoView())}return!0}})(qP(e,t.schema))(t,n),splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:i})=>{let{selection:o,doc:s}=t,{$from:a,$to:l}=o,c=zx(i.extensionManager.attributes,a.node().type.name,a.node().attrs);if(o instanceof Ip&&o.node.isBlock)return!!(a.parentOffset&&j0(s,a.pos))&&(r&&(e&&zS(n,i.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let h=l.parentOffset===l.parent.content.size,u=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1))),d=h&&u?[{type:u,attrs:c}]:void 0,f=j0(t.doc,t.mapping.map(a.pos),1,d);if(!d&&!f&&j0(t.doc,t.mapping.map(a.pos),1,u?[{type:u}]:void 0)&&(f=!0,d=u?[{type:u,attrs:c}]:void 0),r){if(f&&(o instanceof Id&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,d),u&&!h&&!a.parentOffset&&a.parent.type!==u)){let e=t.mapping.map(a.before()),n=t.doc.resolve(e);a.node(-1).canReplaceWith(n.index(),n.index()+1,u)&&t.setNodeMarkup(t.mapping.map(a.before()),u)}e&&zS(n,i.extensionManager.splittableMarks),t.scrollIntoView()}return f},splitListItem:(e,t={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;let a=qP(e,r.schema),{$from:l,$to:c}=r.selection,h=r.selection.node;if(h&&h.isBlock||l.depth<2||!l.sameParent(c))return!1;let u=l.node(-1);if(u.type!==a)return!1;let d=o.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let e=PG.empty,r=l.index(-1)?1:l.index(-2)?2:3;for(let t=l.depth-r;t>=l.depth-3;t-=1)e=PG.from(l.node(t).copy(e));let i=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,o={...zx(d,l.node().type.name,l.node().attrs),...t},c=(null===(s=a.contentMatch.defaultType)||void 0===s?void 0:s.createAndFill(o))||void 0;e=e.append(PG.from(a.createAndFill(null,c)||void 0));let h=l.before(l.depth-(r-1));n.replace(h,l.after(-i),new P0(e,4-r,0));let u=-1;n.doc.nodesBetween(h,n.doc.content.size,(e,t)=>{if(u>-1)return!1;e.isTextblock&&0===e.content.size&&(u=t+1)}),u>-1&&n.setSelection(Id.near(n.doc.resolve(u))),n.scrollIntoView()}return!0}let f=c.pos===l.end()?u.contentMatchAt(0).defaultType:null,p={...zx(d,u.type.name,u.attrs),...t},m={...zx(d,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,c.pos);let g=f?[{type:a,attrs:p},{type:f,attrs:m}]:[{type:a,attrs:p}];if(!j0(n.doc,l.pos,2))return!1;if(i){let{selection:e,storedMarks:t}=r,{splittableMarks:s}=o.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(n.split(l.pos,2,g).scrollIntoView(),!a||!i)return!0;let c=a.filter(e=>s.includes(e.type.name));n.ensureMarks(c)}return!0},toggleList:(e,t,n,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:h})=>{let{extensions:u,splittableMarks:d}=i.extensionManager,f=qP(e,s.schema),p=qP(t,s.schema),{selection:m,storedMarks:g}=s,{$from:y,$to:b}=m,v=y.blockRange(b),x=g||m.$to.parentOffset&&m.$from.marks();if(!v)return!1;let w=zb(e=>zk(e.type.name,u))(m);if(v.depth>=1&&w&&v.depth-w.depth<=1){if(w.node.type===f)return c.liftListItem(p);if(zk(w.node.type.name,u)&&f.validContent(w.node.content)&&a)return l().command(()=>(o.setNodeMarkup(w.pos,f),!0)).command(()=>zC(o,f)).command(()=>zT(o,f)).run()}return n&&x&&a?l().command(()=>{let e=h().wrapInList(f,r),t=x.filter(e=>d.includes(e.type.name));return o.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(f,r).command(()=>zC(o,f)).command(()=>zT(o,f)).run():l().command(()=>!!h().wrapInList(f,r)||c.clearNodes()).wrapInList(f,r).command(()=>zC(o,f)).command(()=>zT(o,f)).run()},toggleMark:(e,t={},n={})=>({state:r,commands:i})=>{let{extendEmptyMarkRange:o=!1}=n,s=zt(e,r.schema);return zw(r,s,t)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,t)},toggleNode:(e,t,n={})=>({state:r,commands:i})=>{let o;let s=qP(e,r.schema),a=qP(t,r.schema),l=zd(r,s,n);return r.selection.$anchor.sameParent(r.selection.$head)&&(o=r.selection.$anchor.parent.attrs),l?i.setNode(a,o):i.setNode(s,{...o,...n})},toggleWrap:(e,t={})=>({state:n,commands:r})=>{let i=qP(e,n.schema);return zd(n,i,t)?r.lift(i):r.wrapIn(i,t)},undoInputRule:()=>({state:e,dispatch:t})=>{let n=e.plugins;for(let r=0;r<n.length;r+=1){let i;let o=n[r];if(o.spec.isInputRules&&(i=o.getState(e))){if(t){let t=e.tr,n=i.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(i.text){let n=t.doc.resolve(i.from).marks();t.replaceWith(i.from,i.to,e.schema.text(i.text,n))}else t.delete(i.from,i.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,{empty:r,ranges:i}=n;return r||t&&i.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0},unsetMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{var o;let{extendEmptyMarkRange:s=!1}=t,{selection:a}=n,l=zt(e,r.schema),{$from:c,empty:h,ranges:u}=a;if(!i)return!0;if(h&&s){let{from:e,to:t}=a,r=null===(o=c.marks().find(e=>e.type===l))||void 0===o?void 0:o.attrs,i=ze(c,l,r);i&&(e=i.from,t=i.to),n.removeMark(e,t,l)}else u.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},updateAttributes:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null,a=zf("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(o=qP(e,r.schema)),"mark"===a&&(s=zt(e,r.schema)),i&&n.selection.ranges.forEach(e=>{let i,a,l,c;let h=e.$from.pos,u=e.$to.pos;n.selection.empty?r.doc.nodesBetween(h,u,(e,t)=>{o&&o===e.type&&(l=Math.max(t,h),c=Math.min(t+e.nodeSize,u),i=t,a=e)}):r.doc.nodesBetween(h,u,(e,r)=>{r<h&&o&&o===e.type&&(l=Math.max(r,h),c=Math.min(r+e.nodeSize,u),i=r,a=e),r>=h&&r<=u&&(o&&o===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),s&&e.marks.length&&e.marks.forEach(i=>{if(s===i.type){let o=Math.max(r,h),a=Math.min(r+e.nodeSize,u);n.addMark(o,a,s.create({...i.attrs,...t}))}}))}),a&&(void 0!==i&&n.setNodeMarkup(i,void 0,{...a.attrs,...t}),s&&a.marks.length&&a.marks.forEach(e=>{s===e.type&&n.addMark(l,c,s.create({...e.attrs,...t}))}))}),!0)},wrapIn:(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),a=s&&jZ(s,e,t);return!!a&&(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0)}})(qP(e,n.schema),t)(n,r),wrapInList:(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let a=r?n.tr:null;return!!function(e,t,n,r=null){let i=!1,o=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=s.resolve(t.start-2);o=new jt(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new jt(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),i=!0}let a=jZ(o,n,r,t);return!!a&&(e&&function(e,t,n,r,i){let o=PG.empty;for(let e=n.length-1;e>=0;e--)o=PG.from(n[e].type.create(n[e].attrs,o));e.step(new jU(t.start-(r?2:0),t.end,t.start,t.end,new P0(o,0,0),n.length,!0));let s=0;for(let e=0;e<n.length;e++)n[e].type==i&&(s=e+1);let a=n.length-s,l=t.start+n.length-(r?2:0),c=t.parent;for(let n=t.startIndex,r=t.endIndex,i=!0;n<r;n++,i=!1)!i&&j0(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(n).nodeSize}(e,t,a,i,n),!0)}(a,s,e,t)&&(r&&r(a.scrollIntoView()),!0)}})(qP(e,n.schema),t)(n,r)});let zE=q5.create({name:"commands",addCommands:()=>({...zA})}),zM=q5.create({name:"drop",addProseMirrorPlugins(){return[new IT({key:new IM("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),z_=q5.create({name:"editable",addProseMirrorPlugins(){return[new IT({key:new IM("editable"),props:{editable:()=>this.editor.options.editable}})]}}),zD=q5.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new IT({key:new IM("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;let r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;let r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),zN=q5.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{let{selection:n,doc:r}=t,{empty:i,$anchor:o}=n,{pos:s,parent:a}=o,l=o.parent.isTextblock&&s>0?t.doc.resolve(s-1):o,c=l.parent.type.spec.isolating,h=o.pos-o.parentOffset,u=c&&1===l.parent.childCount?h===o.pos:Il.atStart(r).from===s;return!!i&&!!a.type.isTextblock&&!a.textContent.length&&!!u&&(!u||"paragraph"!==o.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},i={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return zs()||zu()?i:r},addProseMirrorPlugins(){return[new IT({key:new IM("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;let r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),i=e.some(e=>e.getMeta("preventClearDocument"));if(!r||i)return;let{empty:o,from:s,to:a}=t.selection,l=Il.atStart(t.doc).from,c=Il.atEnd(t.doc).to;if(o||!(s===l&&a===c)||!zO(n.doc))return;let h=n.tr,u=qE({state:n,transaction:h}),{commands:d}=new qM({editor:this.editor,state:u});if(d.clearNodes(),h.steps.length)return h}})]}}),zR=q5.create({name:"paste",addProseMirrorPlugins(){return[new IT({key:new IM("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),zP=q5.create({name:"tabindex",addProseMirrorPlugins(){return[new IT({key:new IM("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});var zj=Object.freeze({__proto__:null,ClipboardTextSerializer:q6,Commands:zE,Drop:zM,Editable:z_,FocusEvents:zD,Keymap:zN,Paste:zR,Tabindex:zP});class zI{get name(){return this.node.type.name}constructor(e,t,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!==(e=this.actualDepth)&&void 0!==e?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;let e=this.resolvedPos.start(this.resolvedPos.depth-1);return new zI(this.resolvedPos.doc.resolve(e),this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new zI(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new zI(e,this.editor)}get children(){let e=[];return this.node.content.forEach((t,n)=>{let r=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,o=this.pos+n+(i?0:1),s=this.resolvedPos.doc.resolve(o);if(!r&&s.depth<=this.depth)return;let a=new zI(s,this.editor,r,r?t:null);r&&(a.actualDepth=this.depth+1),e.push(new zI(s,this.editor,r,r?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){let e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e){if(Object.keys(t).length>0){let e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){let i=n[r];if(e[i]!==t[i])break}}else n=r}r=r.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let r=[];if(!this.children||0===this.children.length)return r;let i=Object.keys(t);return this.children.forEach(o=>{n&&r.length>0||(o.node.type.name===e&&i.every(e=>t[e]===o.node.attrs[e])&&r.push(o),n&&r.length>0||(r=r.concat(o.querySelectorAll(e,t,n))))}),r}setAttribute(e){let{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}let z$=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;class zL extends q_{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:e,slice:t,moved:n})=>this.options.onDrop(e,t,n)),this.on("paste",({event:e,slice:t})=>this.options.onPaste(e,t)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){let r=document.querySelector("style[data-tiptap-style]");if(null!==r)return r;let i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style",""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}(z$,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){let n=q$(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,n=t;if([].concat(e).forEach(e=>{let r="string"==typeof e?`${e}$`:e.key;n=t.filter(e=>!e.key.startsWith(r))}),t.length===n.length)return;let r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[z_,q6.configure({blockSeparator:null===(t=null===(e=this.options.coreExtensionOptions)||void 0===e?void 0:e.clipboardTextSerializer)||void 0===t?void 0:t.blockSeparator}),zE,zD,zN,zP,zM,zR].filter(e=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new q2(n,this)}createCommandManager(){this.commandManager=new qM({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=zm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),t=zm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}let n=zi(t,this.options.autofocus);this.view=new L1(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...null===(e=this.options.editorProps)||void 0===e?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:IC.create({doc:t,selection:n||void 0})});let r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass(),this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)});return}let t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let r=e.getMeta("focus"),i=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!e.docChanged||e.getMeta("preventUpdate")||this.emit("update",{editor:this,transaction:e})}getAttributes(e){return function(e,t){let n=zf("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){let n=qP(t,e.schema),{from:r,to:i}=e.selection,o=[];e.doc.nodesBetween(r,i,e=>{o.push(e)});let s=o.reverse().find(e=>e.type.name===n.name);return s?{...s.attrs}:{}}(e,t):"mark"===n?zg(e,t):{}}(this.state,e)}isActive(e,t){let n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return zd(e,null,n)||zw(e,null,n);let r=zf(t,e.schema);return"node"===r?zd(e,t,n):"mark"===r&&zw(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return qQ(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t=`

`,textSerializers:n={}}=e||{};return function(e,t){let n={from:0,to:e.content.size};return q3(e,n,t)}(this.state.doc,{blockSeparator:t,textSerializers:{...q4(this.schema),...n}})}get isEmpty(){return zO(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){let e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!(null===(e=this.view)||void 0===e)&&e.docView)}$node(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(e,t))||null}$pos(e){return new zI(this.state.doc.resolve(e),this)}get $doc(){return this.$pos(0)}}function zq(e){return new qU({find:e.find,handler:({state:t,range:n,match:r})=>{let i=qL(e.getAttributes,void 0,r);if(!1===i||null===i)return null;let{tr:o}=t,s=r[r.length-1],a=r[0];if(s){let r=a.search(/\S/),l=n.from+a.indexOf(s),c=l+s.length;if(zv(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>l).length)return null;c<n.to&&o.delete(c,n.to),l>n.from&&o.delete(n.from+r,l);let h=n.from+r+s.length;o.addMark(n.from+r,h,e.type.create(i||{})),o.removeStoredMark(e.type)}}})}function zz(e){return new qU({find:e.find,handler:({state:t,range:n,match:r})=>{let i=t.doc.resolve(n.from),o=qL(e.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function zB(e){return new qU({find:e.find,handler:({state:t,range:n,match:r,chain:i})=>{let o=qL(e.getAttributes,void 0,r)||{},s=t.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),l=a&&jZ(a,e.type,o);if(!l)return null;if(s.wrap(a,l),e.keepMarks&&e.editor){let{selection:n,storedMarks:r}=t,{splittableMarks:i}=e.editor.extensionManager,o=r||n.$to.parentOffset&&n.$from.marks();if(o){let e=o.filter(e=>i.includes(e.type.name));s.ensureMarks(e)}}if(e.keepAttributes){let t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";i().updateAttributes(t,o).run()}let c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===e.type&&j1(s.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,c))&&s.join(n.from-1)}})}let zF=class e{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=qL(qD(this,"addOptions",{name:this.name}))),this.storage=qL(qD(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new e(t)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>qZ(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(t={}){let n=new e(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=qL(qD(n,"addOptions",{name:n.name})),n.storage=qL(qD(n,"addStorage",{name:n.name,options:n.options})),n}};class zQ{constructor(e,t,n){this.isDragging=!1,this.component=e,this.editor=t.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=t.extension,this.node=t.node,this.decorations=t.decorations,this.innerDecorations=t.innerDecorations,this.view=t.view,this.HTMLAttributes=t.HTMLAttributes,this.getPos=t.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var t,n,r,i,o,s,a;let{view:l}=this.editor,c=e.target,h=3===c.nodeType?null===(t=c.parentElement)||void 0===t?void 0:t.closest("[data-drag-handle]"):c.closest("[data-drag-handle]");if(!this.dom||!(null===(n=this.contentDOM)||void 0===n)&&n.contains(c)||!h)return;let u=0,d=0;if(this.dom!==h){let t=this.dom.getBoundingClientRect(),n=h.getBoundingClientRect(),a=null!==(r=e.offsetX)&&void 0!==r?r:null===(i=e.nativeEvent)||void 0===i?void 0:i.offsetX,l=null!==(o=e.offsetY)&&void 0!==o?o:null===(s=e.nativeEvent)||void 0===s?void 0:s.offsetY;u=n.x-t.x+a,d=n.y-t.y+l}null===(a=e.dataTransfer)||void 0===a||a.setDragImage(this.dom,u,d);let f=this.getPos();if("number"!=typeof f)return;let p=Ip.create(l.state.doc,f),m=l.state.tr.setSelection(p);l.dispatch(m)}stopEvent(e){var t;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:e});let n=e.target;if(!(this.dom.contains(n)&&!(!(null===(t=this.contentDOM)||void 0===t)&&t.contains(n))))return!1;let r=e.type.startsWith("drag"),i="drop"===e.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!i&&!r)return!0;let{isEditable:o}=this.editor,{isDragging:s}=this,a=!!this.node.type.spec.draggable,l=Ip.isSelectable(this.node),c="copy"===e.type,h="paste"===e.type,u="cut"===e.type,d="mousedown"===e.type;if(!a&&l&&r&&e.target===this.dom&&e.preventDefault(),a&&r&&!s&&e.target===this.dom)return e.preventDefault(),!1;if(a&&o&&!s&&d){let e=n.closest("[data-drag-handle]");e&&(this.dom===e||this.dom.contains(e))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(s||i||c||h||u||d&&l)}ignoreMutation(e){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:e}):!!this.node.isLeaf||!!this.node.isAtom||!("selection"===e.type||this.dom.contains(e.target)&&"childList"===e.type&&(zs()||zo())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(e=>e.isContentEditable))&&(this.contentDOM===e.target&&"attributes"===e.type||!this.contentDOM.contains(e.target)))}updateAttributes(e){this.editor.commands.command(({tr:t})=>{let n=this.getPos();return"number"==typeof n&&(t.setNodeMarkup(n,void 0,{...this.node.attrs,...e}),!0)})}deleteNode(){let e=this.getPos();if("number"!=typeof e)return;let t=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:t})}}function zV(e){return new qJ({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:i})=>{let o=qL(e.getAttributes,void 0,r,i);if(!1===o||null===o)return null;let{tr:s}=t,a=r[r.length-1],l=r[0],c=n.to;if(a){let r=l.search(/\S/),i=n.from+l.indexOf(a),h=i+a.length;if(zv(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>i).length)return null;h<n.to&&s.delete(h,n.to),i>n.from&&s.delete(n.from+r,i),c=n.from+r+a.length,s.addMark(n.from+r,c,e.type.create(o||{})),s.removeStoredMark(e.type)}}})}var zW={exports:{}},zU={};zW.exports=function(){if(m)return zU;m=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=C.useState,n=C.useEffect,r=C.useLayoutEffect,i=C.useDebugValue;function o(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!e(t,r)}catch{return!0}}var s=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?function(e,t){return t()}:function(e,s){var a=s(),l=t({inst:{value:a,getSnapshot:s}}),c=l[0].inst,h=l[1];return r(function(){c.value=a,c.getSnapshot=s,o(c)&&h({inst:c})},[e,a,s]),n(function(){return o(c)&&h({inst:c}),e(function(){o(c)&&h({inst:c})})},[e]),i(a),a};return zU.useSyncExternalStore=void 0!==C.useSyncExternalStore?C.useSyncExternalStore:s,zU}();var zH=zW.exports;let zG=(...e)=>t=>{e.forEach(e=>{"function"==typeof e?e(t):e&&(e.current=t)})},zX=({contentComponent:e})=>{let t=zH.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return C.createElement(C.Fragment,null,Object.values(t))};class zZ extends C.Component{constructor(e){var t;super(e),this.editorContentRef=C.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!(null===(t=e.editor)||void 0===t)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){let e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;let t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=function(){let e=new Set,t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t={...t,[n]:T.createPortal(r.reactElement,r.element,n)},e.forEach(e=>e())},removeRenderer(n){let r={...t};delete r[n],t=r,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){let e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;let t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){let{editor:e,innerRef:t,...n}=this.props;return C.createElement(C.Fragment,null,C.createElement("div",{ref:zG(t,this.editorContentRef),...n}),(null==e?void 0:e.contentComponent)&&C.createElement(zX,{contentComponent:e.contentComponent}))}}let zY=(0,C.forwardRef)((e,t)=>{let n=C.useMemo(()=>Math.floor(0xffffffff*Math.random()).toString(),[e.editor]);return C.createElement(zZ,{key:n,innerRef:t,...e})}),zJ=C.memo(zY);var zK=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;for(i of t.entries())if(!e(i[1],n.get(i[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(t[i]!==n[i])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var r,i,o,s=o[i];if(!("_owner"===s&&t.$$typeof)&&!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}),z0={exports:{}},z1={};z0.exports=function(){if(g)return z1;g=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=zH.useSyncExternalStore,n=C.useRef,r=C.useEffect,i=C.useMemo,o=C.useDebugValue;return z1.useSyncExternalStoreWithSelector=function(s,a,l,c,h){var u=n(null);if(null===u.current){var d={hasValue:!1,value:null};u.current=d}else d=u.current;var f=t(s,(u=i(function(){function t(t){if(!i){if(i=!0,n=t,t=c(t),void 0!==h&&d.hasValue){var o=d.value;if(h(o,t))return r=o}return r=t}if(o=r,e(n,t))return o;var s=c(t);return void 0!==h&&h(o,s)?o:(n=t,r=s)}var n,r,i=!1,o=void 0===l?null:l;return[function(){return t(a())},null===o?void 0:function(){return t(o())}]},[a,l,c,h]))[0],u[1]);return r(function(){d.hasValue=!0,d.value=f},[f]),o(f),f},z1}();var z2=z0.exports;let z5="u">typeof window?C.useLayoutEffect:C.useEffect;class z3{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){let e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}}let z4=typeof window>"u",z6=z4||!!("u">typeof window&&window.next);class z8{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?z4||z6?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){return new zL({...this.options.current,onBeforeCreate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onBeforeCreate)||void 0===n?void 0:n.call(t,...e)},onBlur:(...e)=>{var t,n;return null===(n=(t=this.options.current).onBlur)||void 0===n?void 0:n.call(t,...e)},onCreate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onCreate)||void 0===n?void 0:n.call(t,...e)},onDestroy:(...e)=>{var t,n;return null===(n=(t=this.options.current).onDestroy)||void 0===n?void 0:n.call(t,...e)},onFocus:(...e)=>{var t,n;return null===(n=(t=this.options.current).onFocus)||void 0===n?void 0:n.call(t,...e)},onSelectionUpdate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onSelectionUpdate)||void 0===n?void 0:n.call(t,...e)},onTransaction:(...e)=>{var t,n;return null===(n=(t=this.options.current).onTransaction)||void 0===n?void 0:n.call(t,...e)},onUpdate:(...e)=>{var t,n;return null===(n=(t=this.options.current).onUpdate)||void 0===n?void 0:n.call(t,...e)},onContentError:(...e)=>{var t,n;return null===(n=(t=this.options.current).onContentError)||void 0===n?void 0:n.call(t,...e)},onDrop:(...e)=>{var t,n;return null===(n=(t=this.options.current).onDrop)||void 0===n?void 0:n.call(t,...e)},onPaste:(...e)=>{var t,n;return null===(n=(t=this.options.current).onPaste)||void 0===n?void 0:n.call(t,...e)}})}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var r;return e===(null===(r=t.extensions)||void 0===r?void 0:r[n])}):e[n]===t[n]))}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===e.length?z8.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){let e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}let z9=(0,C.createContext)({editor:null}),z7=z9.Consumer,Be=()=>(0,C.useContext)(z9);function Bt({children:e,slotAfter:t,slotBefore:n,editorContainerProps:r={},...i}){let o=function(e={},t=[]){let n=(0,C.useRef)(e);n.current=e;let[r]=(0,C.useState)(()=>new z8(n)),i=zH.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return(0,C.useDebugValue)(i),(0,C.useEffect)(r.onRender(t)),function(e){var t;let[n]=(0,C.useState)(()=>new z3(e.editor)),r=z2.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,null!==(t=e.equalityFn)&&void 0!==t?t:zK);z5(()=>n.watch(e.editor),[e.editor,n]),(0,C.useDebugValue)(r)}({editor:i,selector:({transactionNumber:t})=>!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===t?0:t+1}),i}(i);return o?C.createElement(z9.Provider,{value:{editor:o}},n,C.createElement(z7,null,({editor:e})=>C.createElement(zJ,{editor:e,...r})),e,t):null}let Bn=(0,C.createContext)({onDragStart:void 0}),Br=()=>(0,C.useContext)(Bn),Bi=C.forwardRef((e,t)=>{let{onDragStart:n}=Br(),r=e.as||"div";return C.createElement(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});class Bo{constructor(e,{editor:t,props:n={},as:r="div",className:i=""}){this.ref=null,this.id=Math.floor(0xffffffff*Math.random()).toString(),this.component=e,this.editor=t,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?(0,T.flushSync)(()=>{this.render()}):this.render()}render(){var e,t;let n=this.component,r=this.props,i=this.editor;("function"==typeof n&&n.prototype&&n.prototype.isReactComponent||"object"==typeof n&&(null===(t=n.$$typeof)||void 0===t?void 0:t.toString())==="Symbol(react.forward_ref)")&&(r.ref=e=>{this.ref=e}),this.reactElement=C.createElement(n,{...r}),null===(e=null==i?void 0:i.contentComponent)||void 0===e||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;let t=this.editor;null===(e=null==t?void 0:t.contentComponent)||void 0===e||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}}class Bs extends zQ{mount(){let e={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(e={})=>this.updateAttributes(e),deleteNode:()=>this.deleteNode()};if(!this.component.displayName){let e;this.component.displayName=(e=this.extension.name).charAt(0).toUpperCase()+e.substring(1)}let t={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:e=>{e&&this.contentDOMElement&&e.firstChild!==this.contentDOMElement&&e.appendChild(this.contentDOMElement)}},n=this.component,r=C.memo(e=>C.createElement(Bn.Provider,{value:t},C.createElement(n,e)));r.displayName="ReactNodeView",this.node.isLeaf?this.contentDOMElement=null:this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.style.whiteSpace="inherit");let i=this.node.isInline?"span":"div";this.options.as&&(i=this.options.as);let{className:o=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new Bo(r,{editor:this.editor,props:e,as:i,className:`node-${this.node.type.name} ${o}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var e;if(this.renderer.element.firstElementChild&&!(!(null===(e=this.renderer.element.firstElementChild)||void 0===e)&&e.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){let{from:e,to:t}=this.editor.state.selection,n=this.getPos();if("number"==typeof n){if(e<=n&&t>=n+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}}}update(e,t,n){let r=e=>{this.renderer.updateProps(e),"function"==typeof this.options.attrs&&this.updateElementAttributes()};if(e.type!==this.node.type)return!1;if("function"==typeof this.options.update){let i=this.node,o=this.decorations,s=this.innerDecorations;return this.node=e,this.decorations=t,this.innerDecorations=n,this.options.update({oldNode:i,oldDecorations:o,newNode:e,newDecorations:t,oldInnerDecorations:s,innerDecorations:n,updateProps:()=>r({node:e,decorations:t,innerDecorations:n})})}return e===this.node&&this.decorations===t&&this.innerDecorations===n||(this.node=e,this.decorations=t,this.innerDecorations=n,r({node:e,decorations:t,innerDecorations:n})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null}updateElementAttributes(){if(this.options.attrs){let e={};if("function"==typeof this.options.attrs){let t=this.editor.extensionManager.attributes,n=qI(this.node,t);e=this.options.attrs({node:this.node,HTMLAttributes:n})}else e=this.options.attrs;this.renderer.updateAttributes(e)}}}function Ba(e,t){return n=>n.editor.contentComponent?new Bs(e,n,t):{}}let Bl=(0,C.createContext)({apiEndpoint:"",user:null,projectName:"",reportId:"",token:"",multiTables:{},tables:{},images:{},analyses:[],executiveSummary:{title:"",introduction:"",recommendations:[]}});function Bc(e,t){let n=[],r=new DOMParser().parseFromString(e,"text/html").querySelectorAll(t);for(let e=0;e<r.length;e++){let t=r[e],i=t.outerHTML,o={};for(let e=0;e<t.attributes.length;e++){let n=t.attributes[e];o[n.name]=n.value}let s=t.innerHTML;n.push({fullText:i,attributes:o,innerContent:s})}return n}class Bh{constructor(e,t,n,r){D(this,"mdx"),D(this,"tables"),D(this,"multiTables"),D(this,"images"),D(this,"table_csv"),D(this,"sql"),D(this,"generated_qn"),D(this,"parseTables",()=>{let e=function(e,t,n,r){let i={tables:{},multiTables:{}};for(let t of Bc(e,"table")){let n=crypto.randomUUID();e=e.replace(t.fullText,`<oracle-table id="${n}"></oracle-table>`);let{columns:o,data:s}=(0,S.q)(t.attributes.csv);i.tables[n]={columns:o,data:s,...t},i.tables[n].attributes={...i.tables[n].attributes,generated_qn:r}}for(let t of Bc(e,"multitable")){let n=crypto.randomUUID(),r=Bc(t.fullText,"oracle-table");e=e.replace(t.fullText,`<oracle-multi-table id="${n}"></oracle-multi-table>`),i.multiTables[n]={tableIds:r.map(e=>e.attributes.id),...t}}if(0===Object.keys(i.multiTables).length&&t&&n){let{columns:o,data:s}=(0,S.q)(t);i.tables["default-table"]={columns:o,data:s,attributes:{sql:n,csv:t,generated_qn:r,type:"fetched_table_csv"}},i.multiTables["default-multi-table"]={tableIds:["default-table"],attributes:{},fullText:'<multitable><oracle-table id="default-table"></oracle-table></multitable>',innerText:'<oracle-table id="default-table"></oracle-table>'},e+='<oracle-multi-table id="default-multi-table"><oracle-table id="default-table"></oracle-table></oracle-multi-table>'}return{mdx:e,...i}}(this.mdx,this.table_csv,this.sql,this.generated_qn);return this.tables=e.tables,this.multiTables=e.multiTables,this.mdx=e.mdx,this}),D(this,"parseImages",()=>{let e=function(e){let t={images:{}};for(let n of Bc(e,"image")){let r=crypto.randomUUID();e=e.replace(n.fullText,`<oracle-image id="${r}"></oracle-image>`),t.images[r]=n}return{mdx:e,...t}}(this.mdx);return this.images=e.images,this.mdx=e.mdx,this}),D(this,"cleanup",()=>{let e=Bc(this.mdx,"oracle-comment-handler");if(e.length>0)for(let t of e)this.mdx=this.mdx.replace(t.fullText,"");return this.mdx=this.mdx+`

<oracle-comment-handler/>`,this}),D(this,"getParsed",()=>Object.assign({},{mdx:this.mdx,tables:Object.assign({},this.tables),multiTables:Object.assign({},this.multiTables),images:Object.assign({},this.images)})),this.mdx=e,this.tables={},this.multiTables={},this.images={},this.table_csv=t||"",this.sql=n||"",this.generated_qn=r||""}}let Bu=(e,t,n,r)=>{let i=new Bh(e,t,n,r);return i.parseTables().parseImages().cleanup(),i.getParsed()},Bd=e=>{let t=e;return(t=(t=(t=(t=(t=t.replace(/<oracle-table[^>]*><\/oracle-table>/g,"")).replace(/<oracle-multi-table[^>]*><\/oracle-multi-table>/g,"")).replace(/<oracle-image[^>]*><\/oracle-image>/g,"")).replace(/<oracle-comment-handler\/>/g,"")).replace(/<oracle-[^>]*>/g,"")).replace(/<\/oracle-[^>]*>/g,"")},Bf=async(e,t,n,r)=>{let i=await fetch((0,S.af)({protocol:"http",path:"oracle/get_report_mdx",apiEndpoint:e}),{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({db_name:n,token:r,report_id:t})});if(!i.ok)throw Error("Failed to fetch mdx");return await i.json()},Bp=async(e,t,n,r,i)=>{if(!(await fetch((0,S.af)({protocol:"http",path:"oracle/update_report_mdx",apiEndpoint:e}),{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({db_name:n,token:r,report_id:t,tiptap_mdx:i})})).ok)throw Error("Failed to update mdx")},Bm=async(e,t,n,r,i)=>{let o=await fetch((0,S.af)({protocol:"http",path:"oracle/get_report_image",apiEndpoint:e}),{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({image_file_name:i,db_name:n,report_id:t,token:r})});if(!o.ok)throw Error("Failed to fetch image");let s=await o.json();if(!s.encoded)throw Error("Error fetching image");return s.encoded},Bg=async(e,t,n,r)=>{let i=await fetch((0,S.af)({protocol:"http",path:"oracle/get_report_comments",apiEndpoint:e}),{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({db_name:n,token:r,report_id:t})});if(!i.ok)throw Error("Failed to fetch comments");return(await i.json()).comments||[]},By=async(e,t,n,r,i)=>{if(!(await fetch((0,S.af)({protocol:"http",path:"oracle/update_report_comments",apiEndpoint:e}),{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({db_name:n,token:r,report_id:t,comments:i})})).ok)throw Error("Failed to update comments")},Bb=async(e,t,n,r,i,o)=>{let s=await fetch((0,S.af)({protocol:"http",path:"oracle/revise_report",apiEndpoint:e}),{method:"POST",headers:{"Content-Type":"application/json",mode:"no-cors"},body:JSON.stringify({db_name:n,token:r,report_id:t,general_comments:i,comments_with_relevant_text:o})}),a=await s.json();if(!s.ok||a.error)throw Error(a.message||"Failed to submit for revision");return a};async function Bv(e,t,n,r){let{mdx:i,analyses:o}=await Bf(e,t,n,r);return{parsed:Bu(i),analyses:o,comments:await Bg(e,t,n,r)}}let Bx=async(e,t,n)=>{try{let r=await fetch((0,S.af)({apiEndpoint:e,protocol:"http",path:"oracle/list_reports"}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,db_name:n})});if(!r.ok)throw Error("Failed to fetch reports");return(await r.json()).reports}catch(e){return console.error("Error fetching reports:",e),null}},Bw=async(e,t,n,r)=>{try{return(await fetch((0,S.af)({apiEndpoint:e,protocol:"http",path:"oracle/delete_report"}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({db_name:r,report_id:t,token:n})})).ok}catch(e){return console.error("Error deleting report:",e),!1}},Bk=async(e,t,n,r,i,o=[],s=!0)=>{if(!t)throw Error("No token");if(!i)throw Error("No user question");if(!n)throw Error("No project name");if(!(await fetch((0,S.af)({apiEndpoint:e,protocol:"http",path:"oracle/generate_report"}),{method:"POST",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3),body:JSON.stringify({db_name:n,token:t,user_question:i,task_type:"exploration",clarifications:o,report_id:r,use_websearch:s})})).ok)throw Error("Failed to generate report")},BO=async(e,t,n,r)=>{if(!t)throw Error("No token");let i=await fetch((0,S.af)({apiEndpoint:e,protocol:"http",path:"oracle/clarify_question"}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({db_name:n,token:t,user_question:r})});if(!i.ok)throw Error(await i.text()||"Failed to get clarifications");return await i.json()},BS=async(e,t,n)=>{try{if(!t)throw Error("No token");if(!n)throw Error("No project name");let r=await fetch((0,S.af)({apiEndpoint:e,protocol:"http",path:"integration/get_tables_and_files"}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,db_name:n})});if(!r.ok)throw Error("Failed to get tables and files");let i=await r.json();return{tables:i.tables||[],pdf_files:i.pdf_files||[]}}catch(e){return console.error("Error fetching tables and files:",e),{tables:[],pdf_files:[]}}},BC=/^\s*>\s$/,BT=zF.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[zB({find:BC,type:this.type})]}}),BA=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,BE=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,BM=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,B_=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,BD=qY.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[zq({find:BA,type:this.type}),zq({find:BM,type:this.type})]},addPasteRules(){return[zV({find:BE,type:this.type}),zV({find:B_,type:this.type})]}}),BN="textStyle",BR=/^\s*([-+*])\s$/,BP=zF.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(BN)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=zB({find:BR,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=zB({find:BR,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(BN),editor:this.editor})),[e]}}),Bj=/(^|[^`])`([^`]+)`(?!`)/,BI=/(^|[^`])`([^`]+)`(?!`)/g,B$=qY.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[zq({find:Bj,type:this.type})]},addPasteRules(){return[zV({find:BI,type:this.type})]}}),BL=/^```([a-z]+)?[\s\n]$/,Bq=/^~~~([a-z]+)?[\s\n]$/,Bz=zF.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:n}=this.options;return[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",qj(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!!e&&t.parent.type.name===this.name&&(!!n||!t.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:n}=t,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;let o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!!o&&!!s&&e.chain().command(({tr:e})=>(e.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:n,doc:r}=t,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||i.parentOffset!==i.parent.nodeSize-2)return!1;let s=i.after();return void 0!==s&&(r.nodeAt(s)?e.commands.command(({tr:e})=>(e.setSelection(Il.near(r.resolve(s))),!0)):e.commands.exitCode())}}},addInputRules(){return[zz({find:BL,type:this.type,getAttributes:e=>({language:e[1]})}),zz({find:Bq,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new IT({key:new IM("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=null==i?void 0:i.mode;if(!n||!o)return!1;let{tr:s,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Id.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),BB=zF.create({name:"doc",topNode:!0,content:"block+"});class BF{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t,n=this.editorView.state.doc.resolve(this.cursorPos),r=!n.parent.inlineContent,i;if(r){let e=n.nodeBefore,t=n.nodeAfter;if(e||t){let n=this.editorView.nodeDOM(this.cursorPos-(e?e.nodeSize:0));if(n){let r=n.getBoundingClientRect(),o=e?r.bottom:r.top;e&&t&&(o=(o+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),i={left:r.left,right:r.right,top:o-this.width/2,bottom:o+this.width/2}}}}if(!i){let e=this.editorView.coordsAtPos(this.cursorPos);i={left:e.left-this.width/2,right:e.left+this.width/2,top:e.top,bottom:e.bottom}}let o=this.editorView.dom.offsetParent;if(this.element||(this.element=o.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r),o&&(o!=document.body||"static"!=getComputedStyle(o).position)){let n=o.getBoundingClientRect();e=n.left-o.scrollLeft,t=n.top-o.scrollTop}else e=-pageXOffset,t=-pageYOffset;this.element.style.left=i.left-e+"px",this.element.style.top=i.top-t+"px",this.element.style.width=i.right-i.left+"px",this.element.style.height=i.bottom-i.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,i="function"==typeof r?r(this.editorView,t,e):r;if(t&&!i){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=j3(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){e.target!=this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}let BQ=q5.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[function(e={}){return new IT({view:t=>new BF(t,e)})}(this.options)]}});class BV extends Il{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return BV.valid(n)?new BV(n):Il.near(n)}content(){return P0.empty}eq(e){return e instanceof BV&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for GapCursor.fromJSON");return new BV(e.resolve(t.pos))}getBookmark(){return new BW(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0==n){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&BV.valid(e))return e;let r=e.pos,i=null;for(let n=e.depth;;n--){let o=e.node(n);if(t>0?e.indexAfter(n)<o.childCount:e.index(n)>0){i=o.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let s=e.doc.resolve(r);if(BV.valid(s))return s}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!Ip.isSelectable(i)){e=e.doc.resolve(r+i.nodeSize*t),n=!1;continue e}break}i=o,r+=t;let s=e.doc.resolve(r);if(BV.valid(s))return s}return null}}}BV.prototype.visible=!1,BV.findFrom=BV.findGapCursorFrom,Il.jsonID("gapcursor",BV);class BW{constructor(e){this.pos=e}map(e){return new BW(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return BV.valid(t)?new BV(t):Il.near(t)}}let BU=L7({ArrowLeft:BH("horiz",-1),ArrowRight:BH("horiz",1),ArrowUp:BH("vert",-1),ArrowDown:BH("vert",1)});function BH(e,t){let n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,i){let o=e.selection,s=t>0?o.$to:o.$from,a=o.empty;if(o instanceof Id){if(!i.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}let l=BV.findGapCursorFrom(s,t,a);return!!l&&(r&&r(e.tr.setSelection(new BV(l))),!0)}}function BG(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!BV.valid(r))return!1;let i=e.posAtCoords({left:n.clientX,top:n.clientY});return!(i&&i.inside>-1&&Ip.isSelectable(e.state.doc.nodeAt(i.inside)))&&(e.dispatch(e.state.tr.setSelection(new BV(r))),!0)}function BX(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof BV))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let i=PG.empty;for(let e=r.length-1;e>=0;e--)i=PG.from(r[e].createAndFill(null,i));let o=e.state.tr.replace(n.pos,n.pos,new P0(i,0,0));return o.setSelection(Id.near(o.doc.resolve(n.pos+1))),e.dispatch(o),!1}function BZ(e){if(!(e.selection instanceof BV))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",LN.create(e.doc,[LM.widget(e.selection.head,t,{key:"gapcursor"})])}let BY=q5.create({name:"gapCursor",addProseMirrorPlugins:()=>[new IT({props:{decorations:BZ,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&BV.valid(n)?new BV(n):null,handleClick:BG,handleKeyDown:BU,handleDOMEvents:{beforeinput:BX}}})],extendNodeSchema(e){var t;let n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!==(t=qL(qD(e,"allowGapCursor",n)))&&void 0!==t?t:null}}}),BJ=zF.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",qj(this.options.HTMLAttributes,e)]},renderText:()=>`
`,addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:e,storedMarks:i}=n;if(e.$from.parent.type.spec.isolating)return!1;let{keepMarks:o}=this.options,{splittableMarks:s}=r.extensionManager,a=i||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{if(t&&a&&o){let t=a.filter(e=>s.includes(e.type.name));e.ensureMarks(t)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),BK=zF.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,qj(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>zz({find:RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var B0=function(){};B0.prototype.append=function(e){return e.length?(e=B0.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},B0.prototype.prepend=function(e){return e.length?B0.from(e).append(this):this},B0.prototype.appendInner=function(e){return new B2(this,e)},B0.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?B0.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},B0.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},B0.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},B0.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},B0.from=function(e){return e instanceof B0?e:e&&e.length?new B1(e):B0.empty};var B1=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var i=t;i<n;i++)if(!1===e(this.values[i],r+i))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var i=t-1;i>=n;i--)if(!1===e(this.values[i],r+i))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(B0);B0.empty=new B1([]);var B2=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var i=this.left.length;if(t<i&&!1===this.left.forEachInner(e,t,Math.min(n,i),r)||n>i&&!1===this.right.forEachInner(e,Math.max(t-i,0),Math.min(this.length,n)-i,r+i))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){var i=this.left.length;if(t>i&&!1===this.right.forEachInvertedInner(e,t-i,Math.max(n,i)-i,r+i)||n<i&&!1===this.left.forEachInvertedInner(e,Math.min(t,i),n,r))return!1},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(B0);class B5{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){let n,r;if(0==this.eventCount)return null;let i=this.items.length;for(;;i--)if(this.items.get(i-1).selection){--i;break}t&&(r=(n=this.remapping(i,this.items.length)).maps.length);let o=e.tr,s,a,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step){n||(r=(n=this.remapping(i,t+1)).maps.length),r--,c.push(e);return}if(n){c.push(new B3(e.map));let t=e.step.map(n.slice(r)),i;t&&o.maybeStep(t).doc&&(i=o.mapping.maps[o.mapping.maps.length-1],l.push(new B3(i,void 0,void 0,l.length+c.length))),r--,i&&n.appendMap(i,r)}else o.maybeStep(e.step);if(e.selection)return s=n?e.selection.map(n.slice(r)):e.selection,a=new B5(this.items.slice(0,i).append(c.reverse().concat(l)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:s}}addTransform(e,t,n,r){var i,o;let s,a=[],l=this.eventCount,c=this.items,h=!r&&c.length?c.get(c.length-1):null;for(let n=0;n<e.steps.length;n++){let i=e.steps[n].invert(e.docs[n]),o=new B3(e.mapping.maps[n],i,t),s;(s=h&&h.merge(o))&&(o=s,n?a.pop():c=c.slice(0,c.length-1)),a.push(o),t&&(l++,t=void 0),r||(h=o)}let u=l-n.depth;return u>B6&&(i=c,o=u,i.forEach((e,t)=>{if(e.selection&&0==o--)return s=t,!1}),c=i.slice(s),l-=u),new B5(c.append(a),l)}remapping(e,t){let n=new jI;return this.items.forEach((t,r)=>{let i=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,i)},e,t),n}addMaps(e){return 0==this.eventCount?this:new B5(this.items.append(e.map(e=>new B3(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,s=this.eventCount;this.items.forEach(e=>{e.selection&&s--},r);let a=t;this.items.forEach(t=>{let r=i.getMirror(--a);if(null==r)return;o=Math.min(o,r);let l=i.maps[r];if(t.step){let o=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(i.slice(a+1,r));c&&s++,n.push(new B3(l,o,c))}else n.push(new B3(l))},r);let l=[];for(let e=t;e<o;e++)l.push(new B3(i.maps[e]));let c=new B5(this.items.slice(0,r).append(l).append(n),s);return c.emptyItemCount()>500&&(c=c.compress(this.items.length-n.length)),c}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],i=0;return this.items.forEach((o,s)=>{if(s>=e)r.push(o),o.selection&&i++;else if(o.step){let e=o.step.map(t.slice(n)),s=e&&e.getMap();if(n--,s&&t.appendMap(s,n),e){let a=o.selection&&o.selection.map(t.slice(n));a&&i++;let l=new B3(s.invert(),e,a),c,h=r.length-1;(c=r.length&&r[h].merge(l))?r[h]=c:r.push(l)}}else o.map&&n--},this.items.length,0),new B5(B0.from(r.reverse()),i)}}B5.empty=new B5(B0.empty,0);class B3{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new B3(t.getMap().invert(),t,this.selection)}}}class B4{constructor(e,t,n,r,i){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=i}}let B6=20;function B8(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,i)=>t.push(r,i));return t}function B9(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let i=t.map(e[r],1),o=t.map(e[r+1],-1);i<=o&&n.push(i,o)}return n}let B7=!1,Fe=null;function Ft(e){let t=e.plugins;if(Fe!=t){B7=!1,Fe=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){B7=!0;break}}return B7}let Fn=new IM("history"),Fr=new IM("closeHistory");function Fi(e,t){return(n,r)=>{let i=Fn.getState(n);if(!i||0==(e?i.undone:i.done).eventCount)return!1;if(r){let o=function(e,t,n){let r=Ft(t),i=Fn.get(t).spec.config,o=(n?e.undone:e.done).popEvent(t,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(n?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),i,r),l=new B4(n?a:o.remaining,n?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(Fn,{redo:n,historyState:l})}(i,n,e);o&&r(t?o.scrollIntoView():o)}return!0}}let Fo=Fi(!1,!0),Fs=Fi(!0,!0),Fa=q5.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>Fo(e,t),redo:()=>({state:e,dispatch:t})=>Fs(e,t)}),addProseMirrorPlugins(){return[function(e={}){return new IT({key:Fn,state:{init:()=>new B4(B5.empty,B5.empty,null,0,-1),apply:(t,n,r)=>(function(e,t,n,r){let i=n.getMeta(Fn),o;if(i)return i.historyState;n.getMeta(Fr)&&(e=new B4(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(Fn))return s.getMeta(Fn).redo?new B4(e.done.addTransform(n,void 0,r,Ft(t)),e.undone,B8(n.mapping.maps),e.prevTime,e.prevComposition):new B4(e.done,e.undone.addTransform(n,void 0,r,Ft(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new B4(e.done.rebased(n,o),e.undone.rebased(n,o),B9(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new B4(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),B9(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let i=n.getMeta("composition"),o=0==e.prevTime||!s&&e.prevComposition!=i&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let i=0;i<t.length;i+=2)e<=t[i+1]&&r>=t[i]&&(n=!0)}),n}(n,e.prevRanges)),a=s?B9(e.prevRanges,n.mapping):B8(n.mapping.maps);return new B4(e.done.addTransform(n,o?t.selection.getBookmark():void 0,r,Ft(t)),B5.empty,a,n.time,i??e.prevComposition)}})(n,r,t,e)},config:e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?Fo:"historyRedo"==n?Fs:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Fl=zF.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",qj(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{let{selection:n}=t,{$from:r,$to:i}=n,o=e();return 0===r.parentOffset?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):n instanceof Ip?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:e,dispatch:t})=>{var n;if(t){let{$to:t}=e.selection,r=t.end();if(t.nodeAfter)t.nodeAfter.isTextblock?e.setSelection(Id.create(e.doc,t.pos+1)):t.nodeAfter.isBlock?e.setSelection(Ip.create(e.doc,t.pos)):e.setSelection(Id.create(e.doc,t.pos));else{let i=null===(n=t.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();i&&(e.insert(r,i),e.setSelection(Id.create(e.doc,r+1)))}e.scrollIntoView()}return!0}).run()}}},addInputRules(){var e;return[new qU({find:(e={find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type}).find,handler:({state:t,range:n,match:r})=>{let i=qL(e.getAttributes,void 0,r)||{},{tr:o}=t,s=n.from,a=n.to,l=e.type.create(i);if(r[1]){let e=s+r[0].lastIndexOf(r[1]);e>a?e=a:a=e+r[1].length;let t=r[0][r[0].length-1];o.insertText(t,s+r[0].length-1),o.replaceWith(e,a,l)}else if(r[0]){let t=e.type.isInline?s:s-1;o.insert(t,e.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()}})]}}),Fc=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Fh=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Fu=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Fd=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Ff=qY.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[zq({find:Fc,type:this.type}),zq({find:Fu,type:this.type})]},addPasteRules(){return[zV({find:Fh,type:this.type}),zV({find:Fd,type:this.type})]}}),Fp=zF.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",qj(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Fm="textStyle",Fg=/^(\d+)\.\s$/,Fy=zF.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){let{start:t,...n}=e;return 1===t?["ol",qj(this.options.HTMLAttributes,n),0]:["ol",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(Fm)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=zB({find:Fg,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=zB({find:Fg,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Fm)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),Fb=zF.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Fv=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Fx=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Fw=qY.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",qj(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[zq({find:Fv,type:this.type})]},addPasteRules(){return[zV({find:Fx,type:this.type})]}}),Fk=zF.create({name:"text",group:"inline"}),FO=q5.create({name:"starterKit",addExtensions(){var e,t,n,r,i,o,s,a,l,c,h,u,d,f,p,m,g,y;let b=[];return!1!==this.options.bold&&b.push(BD.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.blockquote&&b.push(BT.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bulletList&&b.push(BP.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&b.push(B$.configure(null===(r=this.options)||void 0===r?void 0:r.code)),!1!==this.options.codeBlock&&b.push(Bz.configure(null===(i=this.options)||void 0===i?void 0:i.codeBlock)),!1!==this.options.document&&b.push(BB.configure(null===(o=this.options)||void 0===o?void 0:o.document)),!1!==this.options.dropcursor&&b.push(BQ.configure(null===(s=this.options)||void 0===s?void 0:s.dropcursor)),!1!==this.options.gapcursor&&b.push(BY.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&b.push(BJ.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&b.push(BK.configure(null===(c=this.options)||void 0===c?void 0:c.heading)),!1!==this.options.history&&b.push(Fa.configure(null===(h=this.options)||void 0===h?void 0:h.history)),!1!==this.options.horizontalRule&&b.push(Fl.configure(null===(u=this.options)||void 0===u?void 0:u.horizontalRule)),!1!==this.options.italic&&b.push(Ff.configure(null===(d=this.options)||void 0===d?void 0:d.italic)),!1!==this.options.listItem&&b.push(Fp.configure(null===(f=this.options)||void 0===f?void 0:f.listItem)),!1!==this.options.orderedList&&b.push(Fy.configure(null===(p=this.options)||void 0===p?void 0:p.orderedList)),!1!==this.options.paragraph&&b.push(Fb.configure(null===(m=this.options)||void 0===m?void 0:m.paragraph)),!1!==this.options.strike&&b.push(Fw.configure(null===(g=this.options)||void 0===g?void 0:g.strike)),!1!==this.options.text&&b.push(Fk.configure(null===(y=this.options)||void 0===y?void 0:y.text)),b}});if("u">typeof WeakMap){let e=new WeakMap;y=t=>e.get(t),b=(t,n)=>(e.set(t,n),n)}else{let e=[],t=0;y=t=>{for(let n=0;n<e.length;n+=2)if(e[n]==t)return e[n+1]},b=(n,r)=>(10==t&&(t=0),e[t++]=n,e[t++]=r)}var FS=class{constructor(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r}findCell(e){for(let t=0;t<this.map.length;t++){let n=this.map[t];if(n!=e)continue;let r=t%this.width,i=t/this.width|0,o=r+1,s=i+1;for(let e=1;o<this.width&&this.map[t+e]==n;e++)o++;for(let e=1;s<this.height&&this.map[t+this.width*e]==n;e++)s++;return{left:r,top:i,right:o,bottom:s}}throw RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw RangeError(`No cell with offset ${e} found`)}nextCell(e,t,n){let{left:r,right:i,top:o,bottom:s}=this.findCell(e);return"horiz"==t?(n<0?0==r:i==this.width)?null:this.map[o*this.width+(n<0?r-1:i)]:(n<0?0==o:s==this.height)?null:this.map[r+this.width*(n<0?o-1:s)]}rectBetween(e,t){let{left:n,right:r,top:i,bottom:o}=this.findCell(e),{left:s,right:a,top:l,bottom:c}=this.findCell(t);return{left:Math.min(n,s),top:Math.min(i,l),right:Math.max(r,a),bottom:Math.max(o,c)}}cellsInRect(e){let t=[],n={};for(let r=e.top;r<e.bottom;r++)for(let i=e.left;i<e.right;i++){let o=r*this.width+i,s=this.map[o];n[s]||(n[s]=!0,i==e.left&&i&&this.map[o-1]==s||r==e.top&&r&&this.map[o-this.width]==s||t.push(s))}return t}positionAt(e,t,n){for(let r=0,i=0;;r++){let o=i+n.child(r).nodeSize;if(r==e){let n=t+e*this.width,r=(e+1)*this.width;for(;n<r&&this.map[n]<i;)n++;return n==r?o-1:this.map[n]}i=o}}static get(e){return y(e)||b(e,function(e){if("table"!=e.type.spec.tableRole)throw RangeError("Not a table node: "+e.type.name);let t=function(e){let t=-1,n=!1;for(let r=0;r<e.childCount;r++){let i=e.child(r),o=0;if(n)for(let t=0;t<r;t++){let n=e.child(t);for(let e=0;e<n.childCount;e++){let i=n.child(e);t+i.attrs.rowspan>r&&(o+=i.attrs.colspan)}}for(let e=0;e<i.childCount;e++){let t=i.child(e);o+=t.attrs.colspan,t.attrs.rowspan>1&&(n=!0)}-1==t?t=o:t!=o&&(t=Math.max(t,o))}return t}(e),n=e.childCount,r=[],i=0,o=null,s=[];for(let e=0,i=t*n;e<i;e++)r[e]=0;for(let a=0,l=0;a<n;a++){let c=e.child(a);l++;for(let e=0;;e++){for(;i<r.length&&0!=r[i];)i++;if(e==c.childCount)break;let h=c.child(e),{colspan:u,rowspan:d,colwidth:f}=h.attrs;for(let e=0;e<d;e++){if(e+a>=n){(o||(o=[])).push({type:"overlong_rowspan",pos:l,n:d-e});break}let c=i+e*t;for(let e=0;e<u;e++){0==r[c+e]?r[c+e]=l:(o||(o=[])).push({type:"collision",row:a,pos:l,n:u-e});let n=f&&f[e];if(n){let r=(c+e)%t*2,i=s[r];null==i||i!=n&&1==s[r+1]?(s[r]=n,s[r+1]=1):i==n&&s[r+1]++}}}i+=u,l+=h.nodeSize}let h=(a+1)*t,u=0;for(;i<h;)0==r[i++]&&u++;u&&(o||(o=[])).push({type:"missing",row:a,n:u}),l++}(0===t||0===n)&&(o||(o=[])).push({type:"zero_sized"});let a=new FS(t,n,r,o),l=!1;for(let e=0;!l&&e<s.length;e+=2)null!=s[e]&&s[e+1]<n&&(l=!0);return l&&function(e,t,n){e.problems||(e.problems=[]);let r={};for(let i=0;i<e.map.length;i++){let o=e.map[i];if(r[o])continue;r[o]=!0;let s=n.nodeAt(o);if(!s)throw RangeError(`No cell with offset ${o} found`);let a=null,l=s.attrs;for(let n=0;n<l.colspan;n++){let r=t[2*((i+n)%e.width)];null==r||l.colwidth&&l.colwidth[n]==r||((a||(a=function(e){if(e.colwidth)return e.colwidth.slice();let t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}(l)))[n]=r)}a&&e.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:a})}}(a,s,e),a}(e))}};function FC(e){let t=e.cached.tableNodeTypes;if(!t)for(let n in t=e.cached.tableNodeTypes={},e.nodes){let r=e.nodes[n],i=r.spec.tableRole;i&&(t[i]=r)}return t}var FT=new IM("selectingCells");function FA(e){for(let t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function FE(e){let t=e.selection.$head;for(let e=t.depth;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return!0;return!1}function FM(e){let t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&"cell"==t.node.type.spec.tableRole)return t.$anchor;let n=FA(t.$head)||function(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n-t.nodeSize)}}(t.$head);if(n)return n;throw RangeError(`No cell found around position ${t.head}`)}function F_(e){return"row"==e.parent.type.spec.tableRole&&!!e.nodeAfter}function FD(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function FN(e,t,n){let r=e.node(-1),i=FS.get(r),o=e.start(-1),s=i.nextCell(e.pos-o,t,n);return null==s?null:e.node(0).resolve(o+s)}function FR(e,t,n=1){let r={...e,colspan:e.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some(e=>e>0)||(r.colwidth=null)),r}function FP(e,t,n=1){let r={...e,colspan:e.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let e=0;e<n;e++)r.colwidth.splice(t,0,0)}return r}var Fj=class e extends Il{constructor(e,t=e){let n=e.node(-1),r=FS.get(n),i=e.start(-1),o=r.rectBetween(e.pos-i,t.pos-i),s=e.node(0),a=r.cellsInRect(o).filter(e=>e!=t.pos-i);a.unshift(t.pos-i);let l=a.map(e=>{let t=n.nodeAt(e);if(!t)throw RangeError(`No cell with offset ${e} found`);let r=i+e+1;return new Ic(s.resolve(r),s.resolve(r+t.content.size))});super(l[0].$from,l[0].$to,l),this.$anchorCell=e,this.$headCell=t}map(t,n){let r=t.resolve(n.map(this.$anchorCell.pos)),i=t.resolve(n.map(this.$headCell.pos));if(F_(r)&&F_(i)&&FD(r,i)){let t=this.$anchorCell.node(-1)!=r.node(-1);return t&&this.isRowSelection()?e.rowSelection(r,i):t&&this.isColSelection()?e.colSelection(r,i):new e(r,i)}return Id.between(r,i)}content(){let e=this.$anchorCell.node(-1),t=FS.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),i={},o=[];for(let n=r.top;n<r.bottom;n++){let s=[];for(let o=n*t.width+r.left,a=r.left;a<r.right;a++,o++){let n=t.map[o];if(i[n])continue;i[n]=!0;let a=t.findCell(n),l=e.nodeAt(n);if(!l)throw RangeError(`No cell with offset ${n} found`);let c=r.left-a.left,h=a.right-r.right;if(c>0||h>0){let e=l.attrs;if(c>0&&(e=FR(e,0,c)),h>0&&(e=FR(e,e.colspan-h,h)),a.left<r.left){if(!(l=l.type.createAndFill(e)))throw RangeError(`Could not create cell with attrs ${JSON.stringify(e)}`)}else l=l.type.create(e,l.content)}if(a.top<r.top||a.bottom>r.bottom){let e={...l.attrs,rowspan:Math.min(a.bottom,r.bottom)-Math.max(a.top,r.top)};l=a.top<r.top?l.type.createAndFill(e):l.type.create(e,l.content)}s.push(l)}o.push(e.child(n).copy(PG.from(s)))}let s=this.isColSelection()&&this.isRowSelection()?e:o;return new P0(PG.from(s),1,1)}replace(e,t=P0.empty){let n=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){let{$from:o,$to:s}=r[i],a=e.mapping.slice(n);e.replace(a.map(o.pos),a.map(s.pos),i?P0.empty:t)}let i=Il.findFrom(e.doc.resolve(e.mapping.slice(n).map(this.to)),-1);i&&e.setSelection(i)}replaceWith(e,t){this.replace(e,new P0(PG.from(t),0,0))}forEachCell(e){let t=this.$anchorCell.node(-1),n=FS.get(t),r=this.$anchorCell.start(-1),i=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let n=0;n<i.length;n++)e(t.nodeAt(i[n]),r+i[n])}isColSelection(){let e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);return!(Math.min(e,t)>0)&&Math.max(e+this.$anchorCell.nodeAfter.attrs.rowspan,t+this.$headCell.nodeAfter.attrs.rowspan)==this.$headCell.node(-1).childCount}static colSelection(t,n=t){let r=t.node(-1),i=FS.get(r),o=t.start(-1),s=i.findCell(t.pos-o),a=i.findCell(n.pos-o),l=t.node(0);return s.top<=a.top?(s.top>0&&(t=l.resolve(o+i.map[s.left])),a.bottom<i.height&&(n=l.resolve(o+i.map[i.width*(i.height-1)+a.right-1]))):(a.top>0&&(n=l.resolve(o+i.map[a.left])),s.bottom<i.height&&(t=l.resolve(o+i.map[i.width*(i.height-1)+s.right-1]))),new e(t,n)}isRowSelection(){let e=this.$anchorCell.node(-1),t=FS.get(e),n=this.$anchorCell.start(-1),r=t.colCount(this.$anchorCell.pos-n),i=t.colCount(this.$headCell.pos-n);return!(Math.min(r,i)>0)&&Math.max(r+this.$anchorCell.nodeAfter.attrs.colspan,i+this.$headCell.nodeAfter.attrs.colspan)==t.width}eq(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,n=t){let r=t.node(-1),i=FS.get(r),o=t.start(-1),s=i.findCell(t.pos-o),a=i.findCell(n.pos-o),l=t.node(0);return s.left<=a.left?(s.left>0&&(t=l.resolve(o+i.map[s.top*i.width])),a.right<i.width&&(n=l.resolve(o+i.map[i.width*(a.top+1)-1]))):(a.left>0&&(n=l.resolve(o+i.map[a.top*i.width])),s.right<i.width&&(t=l.resolve(o+i.map[i.width*(s.top+1)-1]))),new e(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,n){return new e(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,r=n){return new e(t.resolve(n),t.resolve(r))}getBookmark(){return new FI(this.$anchorCell.pos,this.$headCell.pos)}};Fj.prototype.visible=!1,Il.jsonID("cell",Fj);var FI=class e{constructor(e,t){this.anchor=e,this.head=t}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(e){let t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&FD(t,n)?new Fj(t,n):Il.near(n,1)}};function F$(e){if(!(e.selection instanceof Fj))return null;let t=[];return e.selection.forEachCell((e,n)=>{t.push(LM.node(n,n+e.nodeSize,{class:"selectedCell"}))}),LN.create(e.doc,t)}var FL=new IM("fix-tables");function Fq(e,t){let n;let r=(t,r)=>{"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){let i,o;let s=FS.get(t);if(!s.problems)return r;r||(r=e.tr);let a=[];for(let e=0;e<s.height;e++)a.push(0);for(let e=0;e<s.problems.length;e++){let i=s.problems[e];if("collision"==i.type){let e=t.nodeAt(i.pos);if(!e)continue;let o=e.attrs;for(let e=0;e<o.rowspan;e++)a[i.row+e]+=i.n;r.setNodeMarkup(r.mapping.map(n+1+i.pos),null,FR(o,o.colspan-i.n,i.n))}else if("missing"==i.type)a[i.row]+=i.n;else if("overlong_rowspan"==i.type){let e=t.nodeAt(i.pos);if(!e)continue;r.setNodeMarkup(r.mapping.map(n+1+i.pos),null,{...e.attrs,rowspan:e.attrs.rowspan-i.n})}else if("colwidth mismatch"==i.type){let e=t.nodeAt(i.pos);if(!e)continue;r.setNodeMarkup(r.mapping.map(n+1+i.pos),null,{...e.attrs,colwidth:i.colwidth})}else if("zero_sized"==i.type){let e=r.mapping.map(n);r.delete(e,e+t.nodeSize)}}for(let e=0;e<a.length;e++)a[e]&&(null==i&&(i=e),o=e);for(let l=0,c=n+1;l<s.height;l++){let n=t.child(l),s=c+n.nodeSize,h=a[l];if(h>0){let t="cell";n.firstChild&&(t=n.firstChild.type.spec.tableRole);let a=[];for(let n=0;n<h;n++){let n=FC(e.schema)[t].createAndFill();n&&a.push(n)}let u=(0==l||i==l-1)&&o==l?c+1:s-1;r.insert(r.mapping.map(u),a)}c=s}return r.setMeta(FL,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&function e(t,n,r,i){let o=t.childCount,s=n.childCount;e:for(let a=0,l=0;a<s;a++){let s=n.child(a);for(let e=l,n=Math.min(o,a+3);e<n;e++)if(t.child(e)==s){l=e+1,r+=s.nodeSize;continue e}i(s,r),l<o&&t.child(l).sameMarkup(s)?e(t.child(l),s,r+1,i):s.nodesBetween(0,s.content.size,i,r+1),r+=s.nodeSize}}(t.doc,e.doc,0,r):e.doc.descendants(r),n}function Fz(e){let t=e.selection,n=FM(e),r=n.node(-1),i=n.start(-1),o=FS.get(r);return{...t instanceof Fj?o.rectBetween(t.$anchorCell.pos-i,t.$headCell.pos-i):o.findCell(n.pos-i),tableStart:i,map:o,table:r}}function FB(e,{map:t,tableStart:n,table:r},i){let o=i>0?-1:0;(function(e,t,n){let r=FC(t.type.schema).header_cell;for(let i=0;i<e.height;i++)if(t.nodeAt(e.map[n+i*e.width]).type!=r)return!1;return!0})(t,r,i+o)&&(o=0==i||i==t.width?null:0);for(let s=0;s<t.height;s++){let a=s*t.width+i;if(i>0&&i<t.width&&t.map[a-1]==t.map[a]){let o=t.map[a],l=r.nodeAt(o);e.setNodeMarkup(e.mapping.map(n+o),null,FP(l.attrs,i-t.colCount(o))),s+=l.attrs.rowspan-1}else{let l=null==o?FC(r.type.schema).cell:r.nodeAt(t.map[a+o]).type,c=t.positionAt(s,i,r);e.insert(e.mapping.map(n+c),l.createAndFill())}}return e}function FF(e,{map:t,tableStart:n,table:r},i){var o;let s=n;for(let e=0;e<i;e++)s+=r.child(e).nodeSize;let a=[],l=i>0?-1:0;(function(e,t,n){var r;let i=FC(t.type.schema).header_cell;for(let o=0;o<e.width;o++)if((null==(r=t.nodeAt(e.map[o+n*e.width]))?void 0:r.type)!=i)return!1;return!0})(t,r,i+l)&&(l=0==i||i==t.height?null:0);for(let s=0,c=t.width*i;s<t.width;s++,c++)if(i>0&&i<t.height&&t.map[c]==t.map[c-t.width]){let i=t.map[c],o=r.nodeAt(i).attrs;e.setNodeMarkup(n+i,null,{...o,rowspan:o.rowspan+1}),s+=o.colspan-1}else{let e=null==l?FC(r.type.schema).cell:null==(o=r.nodeAt(t.map[c+l*t.width]))?void 0:o.type,n=null==e?void 0:e.createAndFill();n&&a.push(n)}return e.insert(s,FC(r.type.schema).row.create(null,a)),e}function FQ(e){let t=e.content;return 1==t.childCount&&t.child(0).isTextblock&&0==t.child(0).childCount}function FV(e,t){let n=e.selection;if(!(n instanceof Fj)||n.$anchorCell.pos==n.$headCell.pos)return!1;let r=Fz(e),{map:i}=r;if(function({width:e,height:t,map:n},r){let i=r.top*e+r.left,o=i,s=(r.bottom-1)*e+r.left,a=i+(r.right-r.left-1);for(let t=r.top;t<r.bottom;t++){if(r.left>0&&n[o]==n[o-1]||r.right<e&&n[a]==n[a+1])return!0;o+=e,a+=e}for(let o=r.left;o<r.right;o++){if(r.top>0&&n[i]==n[i-e]||r.bottom<t&&n[s]==n[s+e])return!0;i++,s++}return!1}(i,r))return!1;if(t){let n=e.tr,o={},s=PG.empty,a,l;for(let e=r.top;e<r.bottom;e++)for(let t=r.left;t<r.right;t++){let c=i.map[e*i.width+t],h=r.table.nodeAt(c);if(!(o[c]||!h)){if(o[c]=!0,null==a)a=c,l=h;else{FQ(h)||(s=s.append(h.content));let e=n.mapping.map(c+r.tableStart);n.delete(e,e+h.nodeSize)}}}if(null==a||null==l)return!0;if(n.setNodeMarkup(a+r.tableStart,null,{...FP(l.attrs,l.attrs.colspan,r.right-r.left-l.attrs.colspan),rowspan:r.bottom-r.top}),s.size){let e=a+1+l.content.size,t=FQ(l)?a+1:e;n.replaceWith(t+r.tableStart,e+r.tableStart,s)}n.setSelection(new Fj(n.doc.resolve(a+r.tableStart))),t(n)}return!0}function FW(e,t){var n;let r=FC(e.schema);return(n=({node:e})=>r[e.type.spec.tableRole],(e,t)=>{var r;let i,o;let s=e.selection;if(s instanceof Fj){if(s.$anchorCell.pos!=s.$headCell.pos)return!1;i=s.$anchorCell.nodeAfter,o=s.$anchorCell.pos}else{if(!(i=function(e){for(let t=e.depth;t>0;t--){let n=e.node(t).type.spec.tableRole;if("cell"===n||"header_cell"===n)return e.node(t)}return null}(s.$from)))return!1;o=null==(r=FA(s.$from))?void 0:r.pos}if(null==i||null==o||1==i.attrs.colspan&&1==i.attrs.rowspan)return!1;if(t){let r,a=i.attrs,l=[],c=a.colwidth;a.rowspan>1&&(a={...a,rowspan:1}),a.colspan>1&&(a={...a,colspan:1});let h=Fz(e),u=e.tr;for(let e=0;e<h.right-h.left;e++)l.push(c?{...a,colwidth:c&&c[e]?[c[e]]:null}:a);for(let e=h.top;e<h.bottom;e++){let t=h.map.positionAt(e,h.left,h.table);e==h.top&&(t+=i.nodeSize);for(let o=h.left,s=0;o<h.right;o++,s++)o==h.left&&e==h.top||u.insert(r=u.mapping.map(t+h.tableStart,1),n({node:i,row:e,col:o}).createAndFill(l[s]))}u.setNodeMarkup(o,n({node:i,row:h.top,col:h.left}),l[0]),s instanceof Fj&&u.setSelection(new Fj(u.doc.resolve(s.$anchorCell.pos),r?u.doc.resolve(r):void 0)),t(u)}return!0})(e,t)}function FU(e,t,n){let r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1});for(let e=0;e<r.length;e++){let i=t.table.nodeAt(r[e]);if(i&&i.type!==n.header_cell)return!1}return!0}function FH(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(t,n){if(!FE(t))return!1;if(n){let r=FC(t.schema),i=Fz(t),o=t.tr,s=i.map.cellsInRect("column"==e?{left:i.left,top:0,right:i.right,bottom:i.map.height}:"row"==e?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),a=s.map(e=>i.table.nodeAt(e));for(let e=0;e<s.length;e++)a[e].type==r.header_cell&&o.setNodeMarkup(i.tableStart+s[e],r.cell,a[e].attrs);if(0==o.steps.length)for(let e=0;e<s.length;e++)o.setNodeMarkup(i.tableStart+s[e],r.header_cell,a[e].attrs);n(o)}return!0}:function(t,n){if(!FE(t))return!1;if(n){let r=FC(t.schema),i=Fz(t),o=t.tr,s=FU("row",i,r),a=FU("column",i,r),l=("column"===e?s:"row"===e&&a)?1:0,c="column"==e?{left:0,top:l,right:1,bottom:i.map.height}:"row"==e?{left:l,top:0,right:i.map.width,bottom:1}:i,h="column"==e?a?r.cell:r.header_cell:"row"==e?s?r.cell:r.header_cell:r.cell;i.map.cellsInRect(c).forEach(e=>{let t=e+i.tableStart,n=o.doc.nodeAt(t);n&&o.setNodeMarkup(t,h,n.attrs)}),n(o)}return!0}}FH("row",{useDeprecatedLogic:!0}),FH("column",{useDeprecatedLogic:!0});var FG=FH("cell",{useDeprecatedLogic:!0});function FX(e){return function(t,n){if(!FE(t))return!1;let r=function(e,t){if(t<0){let t=e.nodeBefore;if(t)return e.pos-t.nodeSize;for(let t=e.index(-1)-1,n=e.before();t>=0;t--){let r=e.node(-1).child(t),i=r.lastChild;if(i)return n-1-i.nodeSize;n-=r.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;let t=e.node(-1);for(let n=e.indexAfter(-1),r=e.after();n<t.childCount;n++){let e=t.child(n);if(e.childCount)return r+1;r+=e.nodeSize}}return null}(FM(t),e);if(null==r)return!1;if(n){let e=t.doc.resolve(r);n(t.tr.setSelection(Id.between(e,e.node(0).resolve(e.pos+e.nodeAfter.nodeSize))).scrollIntoView())}return!0}}function FZ(e,t){let n=e.selection;if(!(n instanceof Fj))return!1;if(t){let r=e.tr,i=FC(e.schema).cell.createAndFill().content;n.forEachCell((e,t)=>{e.content.eq(i)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new P0(i,0,0))}),r.docChanged&&t(r)}return!0}function FY(e,t){let n=e.createAndFill();return new Is(n).replace(0,n.content.size,t).doc}function FJ(e,t,n,r,i,o,s,a){if(0==s||s==t.height)return!1;let l=!1;for(let c=i;c<o;c++){let i=s*t.width+c,o=t.map[i];if(t.map[i-t.width]==o){l=!0;let i=n.nodeAt(o),{top:h,left:u}=t.findCell(o);e.setNodeMarkup(e.mapping.slice(a).map(o+r),null,{...i.attrs,rowspan:s-h}),e.insert(e.mapping.slice(a).map(t.positionAt(s,u,n)),i.type.createAndFill({...i.attrs,rowspan:h+i.attrs.rowspan-s})),c+=i.attrs.colspan-1}}return l}function FK(e,t,n,r,i,o,s,a){if(0==s||s==t.width)return!1;let l=!1;for(let c=i;c<o;c++){let i=c*t.width+s,o=t.map[i];if(t.map[i-1]==o){l=!0;let i=n.nodeAt(o),h=t.colCount(o),u=e.mapping.slice(a).map(o+r);e.setNodeMarkup(u,null,FR(i.attrs,s-h,i.attrs.colspan-(s-h))),e.insert(u+i.nodeSize,i.type.createAndFill(FR(i.attrs,0,s-h))),c+=i.attrs.rowspan-1}}return l}function F0(e,t,n,r,i){let o=n?e.doc.nodeAt(n-1):e.doc;if(!o)throw Error("No table found");let s=FS.get(o),{top:a,left:l}=r,c=l+i.width,h=a+i.height,u=e.tr,d=0;function f(){if(!(o=n?u.doc.nodeAt(n-1):u.doc))throw Error("No table found");s=FS.get(o),d=u.mapping.maps.length}(function(e,t,n,r,i,o,s){let a,l;let c=FC(e.doc.type.schema);if(i>t.width)for(let o=0,s=0;o<t.height;o++){let h;let u=n.child(o);s+=u.nodeSize;let d=[];h=null==u.lastChild||u.lastChild.type==c.cell?a||(a=c.cell.createAndFill()):l||(l=c.header_cell.createAndFill());for(let e=t.width;e<i;e++)d.push(h);e.insert(e.mapping.slice(0).map(s-1+r),d)}if(o>t.height){let s=[];for(let e=0,r=(t.height-1)*t.width;e<Math.max(t.width,i);e++){let i=!(e>=t.width)&&n.nodeAt(t.map[r+e]).type==c.header_cell;s.push(i?l||(l=c.header_cell.createAndFill()):a||(a=c.cell.createAndFill()))}let h=c.row.create(null,PG.from(s)),u=[];for(let e=t.height;e<o;e++)u.push(h);e.insert(e.mapping.slice(0).map(r+n.nodeSize-2),u)}return!!(a||l)})(u,s,o,n,c,h,0)&&f(),FJ(u,s,o,n,l,c,a,d)&&f(),FJ(u,s,o,n,l,c,h,d)&&f(),FK(u,s,o,n,a,h,l,d)&&f(),FK(u,s,o,n,a,h,c,d)&&f();for(let e=a;e<h;e++){let t=s.positionAt(e,l,o),r=s.positionAt(e,c,o);u.replace(u.mapping.slice(d).map(t+n),u.mapping.slice(d).map(r+n),new P0(i.rows[e-a],0,0))}f(),u.setSelection(new Fj(u.doc.resolve(n+s.positionAt(a,l,o)),u.doc.resolve(n+s.positionAt(h-1,c-1,o)))),t(u)}var F1=L7({ArrowLeft:F5("horiz",-1),ArrowRight:F5("horiz",1),ArrowUp:F5("vert",-1),ArrowDown:F5("vert",1),"Shift-ArrowLeft":F3("horiz",-1),"Shift-ArrowRight":F3("horiz",1),"Shift-ArrowUp":F3("vert",-1),"Shift-ArrowDown":F3("vert",1),Backspace:FZ,"Mod-Backspace":FZ,Delete:FZ,"Mod-Delete":FZ});function F2(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function F5(e,t){return(n,r,i)=>{if(!i)return!1;let o=n.selection;if(o instanceof Fj)return F2(n,r,Il.near(o.$headCell,t));if("horiz"!=e&&!o.empty)return!1;let s=F9(i,e,t);if(null==s)return!1;if("horiz"==e)return F2(n,r,Il.near(n.doc.resolve(o.head+t),t));{let i;let o=n.doc.resolve(s),a=FN(o,e,t);return i=a?Il.near(a,1):t<0?Il.near(n.doc.resolve(o.before(-1)),-1):Il.near(n.doc.resolve(o.after(-1)),1),F2(n,r,i)}}}function F3(e,t){return(n,r,i)=>{let o;if(!i)return!1;let s=n.selection;if(s instanceof Fj)o=s;else{let r=F9(i,e,t);if(null==r)return!1;o=new Fj(n.doc.resolve(r))}let a=FN(o.$headCell,e,t);return!!a&&F2(n,r,new Fj(o.$anchorCell,a))}}function F4(e,t){let n=FA(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new Fj(n))),!0)}function F6(e,t,n){if(!FE(e.state))return!1;let r=function(e){if(!e.size)return null;let{content:t,openStart:n,openEnd:r}=e;for(;1==t.childCount&&(n>0&&r>0||"table"==t.child(0).type.spec.tableRole);)n--,r--,t=t.child(0).content;let i=t.child(0),o=i.type.spec.tableRole,s=i.type.schema,a=[];if("row"==o)for(let e=0;e<t.childCount;e++){let i=t.child(e).content,o=e?0:Math.max(0,n-1),l=e<t.childCount-1?0:Math.max(0,r-1);(o||l)&&(i=FY(FC(s).row,new P0(i,o,l)).content),a.push(i)}else{if("cell"!=o&&"header_cell"!=o)return null;a.push(n||r?FY(FC(s).row,new P0(t,n,r)).content:t)}return function(e,t){let n=[];for(let e=0;e<t.length;e++){let r=t[e];for(let t=r.childCount-1;t>=0;t--){let{rowspan:i,colspan:o}=r.child(t).attrs;for(let t=e;t<e+i;t++)n[t]=(n[t]||0)+o}}let r=0;for(let e=0;e<n.length;e++)r=Math.max(r,n[e]);for(let i=0;i<n.length;i++)if(i>=t.length&&t.push(PG.empty),n[i]<r){let o=FC(e).cell.createAndFill(),s=[];for(let e=n[i];e<r;e++)s.push(o);t[i]=t[i].append(PG.from(s))}return{height:t.length,width:r,rows:t}}(s,a)}(n),i=e.state.selection;if(i instanceof Fj){r||(r={width:1,height:1,rows:[PG.from(FY(FC(e.state.schema).cell,n))]});let t=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),s=FS.get(t).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=function({width:e,height:t,rows:n},r,i){if(e!=r){let t=[],i=[];for(let e=0;e<n.length;e++){let o=n[e],s=[];for(let n=t[e]||0,i=0;n<r;i++){let a=o.child(i%o.childCount);n+a.attrs.colspan>r&&(a=a.type.createChecked(FR(a.attrs,a.attrs.colspan,n+a.attrs.colspan-r),a.content)),s.push(a),n+=a.attrs.colspan;for(let n=1;n<a.attrs.rowspan;n++)t[e+n]=(t[e+n]||0)+a.attrs.colspan}i.push(PG.from(s))}n=i,e=r}if(t!=i){let e=[];for(let r=0,o=0;r<i;r++,o++){let s=[],a=n[o%t];for(let e=0;e<a.childCount;e++){let t=a.child(e);r+t.attrs.rowspan>i&&(t=t.type.create({...t.attrs,rowspan:Math.max(1,i-t.attrs.rowspan)},t.content)),s.push(t)}e.push(PG.from(s))}n=e,t=i}return{width:e,height:t,rows:n}}(r,s.right-s.left,s.bottom-s.top),F0(e.state,e.dispatch,o,s,r),!0}if(!r)return!1;{let t=FM(e.state),n=t.start(-1);return F0(e.state,e.dispatch,n,FS.get(t.node(-1)).findCell(t.pos-n),r),!0}}function F8(e,t){var n;let r;if(t.ctrlKey||t.metaKey)return;let i=F7(e,t.target);if(t.shiftKey&&e.state.selection instanceof Fj)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&i&&null!=(r=FA(e.state.selection.$anchor))&&(null==(n=Qe(e,t))?void 0:n.pos)!=r.pos)o(r,t),t.preventDefault();else if(!i)return;function o(t,n){let r=Qe(e,n),i=null==FT.getState(e.state);if(!r||!FD(t,r)){if(!i)return;r=t}let o=new Fj(t,r);if(i||!e.state.selection.eq(o)){let n=e.state.tr.setSelection(o);i&&n.setMeta(FT,t.pos),e.dispatch(n)}}function s(){e.root.removeEventListener("mouseup",s),e.root.removeEventListener("dragstart",s),e.root.removeEventListener("mousemove",a),null!=FT.getState(e.state)&&e.dispatch(e.state.tr.setMeta(FT,-1))}function a(n){let r;let a=FT.getState(e.state);if(null!=a)r=e.state.doc.resolve(a);else if(F7(e,n.target)!=i&&!(r=Qe(e,t)))return s();r&&o(r,n)}e.root.addEventListener("mouseup",s),e.root.addEventListener("dragstart",s),e.root.addEventListener("mousemove",a)}function F9(e,t,n){if(!(e.state.selection instanceof Id))return null;let{$head:r}=e.state.selection;for(let i=r.depth-1;i>=0;i--){let o=r.node(i);if((n<0?r.index(i):r.indexAfter(i))!=(n<0?0:o.childCount))break;if("cell"==o.type.spec.tableRole||"header_cell"==o.type.spec.tableRole){let o=r.before(i),s="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(s)?o:null}}return null}function F7(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t;return null}function Qe(e,t){let n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?FA(e.state.doc.resolve(n.pos)):null}var Qt=class{constructor(e,t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${t}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Qn(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type==this.node.type&&(this.node=e,Qn(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))}};function Qn(e,t,n,r,i,o){var s;let a=0,l=!0,c=t.firstChild,h=e.firstChild;if(h){for(let e=0,n=0;e<h.childCount;e++){let{colspan:s,colwidth:u}=h.child(e).attrs;for(let e=0;e<s;e++,n++){let s=i==n?o:u&&u[e],h=s?s+"px":"";if(a+=s||r,s||(l=!1),c)c.style.width!=h&&(c.style.width=h),c=c.nextSibling;else{let e=document.createElement("col");e.style.width=h,t.appendChild(e)}}}for(;c;){let e=c.nextSibling;null==(s=c.parentNode)||s.removeChild(c),c=e}l?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}}var Qr=new IM("tableColumnResizing"),Qi=class e{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(t){let n=t.getMeta(Qr);if(n&&null!=n.setHandle)return new e(n.setHandle,!1);if(n&&void 0!==n.setDragging)return new e(this.activeHandle,n.setDragging);if(this.activeHandle>-1&&t.docChanged){let n=t.mapping.map(this.activeHandle,-1);return F_(t.doc.resolve(n))||(n=-1),new e(n,this.dragging)}return this}};function Qo(e,t,n,r){let i=e.posAtCoords({left:t.clientX+("right"==n?-r:r),top:t.clientY});if(!i)return -1;let{pos:o}=i,s=FA(e.state.doc.resolve(o));if(!s)return -1;if("right"==n)return s.pos;let a=FS.get(s.node(-1)),l=s.start(-1),c=a.map.indexOf(s.pos-l);return c%a.width==0?-1:l+a.map[c-1]}function Qs(e,t,n){let r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function Qa(e,t){e.dispatch(e.state.tr.setMeta(Qr,{setHandle:t}))}function Ql(e,t,n,r){let i=e.state.doc.resolve(t),o=i.node(-1),s=i.start(-1),a=FS.get(o).colCount(i.pos-s)+i.nodeAfter.attrs.colspan-1,l=e.domAtPos(i.start(-1)).node;for(;l&&"TABLE"!=l.nodeName;)l=l.parentNode;l&&Qn(o,l.firstChild,l,r,a,n)}function Qc(e,t){return t?["width",`${Math.max(t,e)}px`]:["min-width",`${e}px`]}function Qh(e,t,n,r,i,o){var s;let a=0,l=!0,c=t.firstChild,h=e.firstChild;if(null!==h)for(let e=0,n=0;e<h.childCount;e+=1){let{colspan:s,colwidth:u}=h.child(e).attrs;for(let e=0;e<s;e+=1,n+=1){let s=i===n?o:u&&u[e],h=s?`${s}px`:"";if(a+=s||r,s||(l=!1),c){if(c.style.width!==h){let[e,t]=Qc(r,s);c.style.setProperty(e,t)}c=c.nextSibling}else{let e=document.createElement("col"),[n,i]=Qc(r,s);e.style.setProperty(n,i),t.appendChild(e)}}}for(;c;){let e=c.nextSibling;null===(s=c.parentNode)||void 0===s||s.removeChild(c),c=e}l?(n.style.width=`${a}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${a}px`)}class Qu{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Qh(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type===this.node.type&&(this.node=e,Qh(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return"attributes"===e.type&&(e.target===this.table||this.colgroup.contains(e.target))}}function Qd(e,t){return e.createAndFill()}let Qf=({editor:e})=>{let{selection:t}=e.state;if(!(t instanceof Fj))return!1;let n=0,r=zy(t.ranges[0].$from,e=>"table"===e.type.name);return null==r||r.node.descendants(e=>{if("table"===e.type.name)return!1;["tableCell","tableHeader"].includes(e.type.name)&&(n+=1)}),n===t.ranges.length&&(e.commands.deleteTable(),!0)},Qp=zF.create({name:"table",addOptions:()=>({HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:Qu,lastColumnResizable:!0,allowTableNodeSelection:!1}),content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({node:e,HTMLAttributes:t}){let{colgroup:n,tableWidth:r,tableMinWidth:i}=function(e,t,n,r){let i=0,o=!0,s=[],a=e.firstChild;if(!a)return{};for(let e=0,n=0;e<a.childCount;e+=1){let{colspan:r,colwidth:l}=a.child(e).attrs;for(let e=0;e<r;e+=1,n+=1){let r=void 0===n?void 0:l&&l[e];i+=r||t,r||(o=!1);let[a,c]=Qc(t,r);s.push(["col",{style:`${a}: ${c}`}])}}return{colgroup:["colgroup",{},...s],tableWidth:o?`${i}px`:"",tableMinWidth:o?"":`${i}px`}}(e,this.options.cellMinWidth);return["table",qj(this.options.HTMLAttributes,t,{style:r?`width: ${r}`:`min-width: ${i}`}),n,["tbody",0]]},addCommands:()=>({insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:i,editor:o})=>{let s=function(e,t,n,r,i){let o=function(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;let t={};return Object.keys(e.nodes).forEach(n=>{let r=e.nodes[n];r.spec.tableRole&&(t[r.spec.tableRole]=r)}),e.cached.tableNodeTypes=t,t}(e),s=[],a=[];for(let e=0;e<n;e+=1){let e=Qd(o.cell);if(e&&a.push(e),r){let e=Qd(o.header_cell);e&&s.push(e)}}let l=[];for(let e=0;e<t;e+=1)l.push(o.row.createChecked(null,r&&0===e?s:a));return o.table.createChecked(null,l)}(o.schema,e,t,n);if(i){let e=r.selection.from+1;r.replaceSelectionWith(s).scrollIntoView().setSelection(Id.near(r.doc.resolve(e)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>(function(e,t){if(!FE(e))return!1;if(t){let n=Fz(e);t(FB(e.tr,n,n.left))}return!0})(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>(function(e,t){if(!FE(e))return!1;if(t){let n=Fz(e);t(FB(e.tr,n,n.right))}return!0})(e,t),deleteColumn:()=>({state:e,dispatch:t})=>(function(e,t){if(!FE(e))return!1;if(t){let n=Fz(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(let e=n.right-1;function(e,{map:t,table:n,tableStart:r},i){let o=e.mapping.maps.length;for(let s=0;s<t.height;){let a=s*t.width+i,l=t.map[a],c=n.nodeAt(l),h=c.attrs;if(i>0&&t.map[a-1]==l||i<t.width-1&&t.map[a+1]==l)e.setNodeMarkup(e.mapping.slice(o).map(r+l),null,FR(h,i-t.colCount(l)));else{let t=e.mapping.slice(o).map(r+l);e.delete(t,t+c.nodeSize)}s+=h.rowspan}}(r,n,e),e!=n.left;e--){let e=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!e)throw RangeError("No table found");n.table=e,n.map=FS.get(e)}t(r)}return!0})(e,t),addRowBefore:()=>({state:e,dispatch:t})=>(function(e,t){if(!FE(e))return!1;if(t){let n=Fz(e);t(FF(e.tr,n,n.top))}return!0})(e,t),addRowAfter:()=>({state:e,dispatch:t})=>(function(e,t){if(!FE(e))return!1;if(t){let n=Fz(e);t(FF(e.tr,n,n.bottom))}return!0})(e,t),deleteRow:()=>({state:e,dispatch:t})=>(function(e,t){if(!FE(e))return!1;if(t){let n=Fz(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(let e=n.bottom-1;function(e,{map:t,table:n,tableStart:r},i){let o=0;for(let e=0;e<i;e++)o+=n.child(e).nodeSize;let s=o+n.child(i).nodeSize,a=e.mapping.maps.length;e.delete(o+r,s+r);let l=new Set;for(let o=0,s=i*t.width;o<t.width;o++,s++){let c=t.map[s];if(!l.has(c)){if(l.add(c),i>0&&c==t.map[s-t.width]){let t=n.nodeAt(c).attrs;e.setNodeMarkup(e.mapping.slice(a).map(c+r),null,{...t,rowspan:t.rowspan-1}),o+=t.colspan-1}else if(i<t.height&&c==t.map[s+t.width]){let s=n.nodeAt(c),l=s.attrs,h=s.type.create({...l,rowspan:s.attrs.rowspan-1},s.content),u=t.positionAt(i+1,o,n);e.insert(e.mapping.slice(a).map(r+u),h),o+=l.colspan-1}}}}(r,n,e),e!=n.top;e--){let e=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!e)throw RangeError("No table found");n.table=e,n.map=FS.get(n.table)}t(r)}return!0})(e,t),deleteTable:()=>({state:e,dispatch:t})=>(function(e,t){let n=e.selection.$anchor;for(let r=n.depth;r>0;r--)if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1})(e,t),mergeCells:()=>({state:e,dispatch:t})=>FV(e,t),splitCell:()=>({state:e,dispatch:t})=>FW(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>FH("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>FH("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>FG(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>!!FV(e,t)||FW(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:r})=>(function(e,t){return function(n,r){if(!FE(n))return!1;let i=FM(n);if(i.nodeAfter.attrs[e]===t)return!1;if(r){let o=n.tr;n.selection instanceof Fj?n.selection.forEachCell((n,r)=>{n.attrs[e]!==t&&o.setNodeMarkup(r,null,{...n.attrs,[e]:t})}):o.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[e]:t}),r(o)}return!0}})(e,t)(n,r),goToNextCell:()=>({state:e,dispatch:t})=>FX(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>FX(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&Fq(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){let n=Fj.create(t.doc,e.anchorCell,e.headCell);t.setSelection(n)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Qf,"Mod-Backspace":Qf,Delete:Qf,"Mod-Delete":Qf}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[function({handleWidth:e=5,cellMinWidth:t=25,defaultCellMinWidth:n=100,View:r=Qt,lastColumnResizable:i=!0}={}){let o=new IT({key:Qr,state:{init(e,t){var i,s;let a=null==(s=null==(i=o.spec)?void 0:i.props)?void 0:s.nodeViews,l=FC(t.schema).table.name;return r&&a&&(a[l]=(e,t)=>new r(e,n,t)),new Qi(-1,!1)},apply:(e,t)=>t.apply(e)},props:{attributes:e=>{let t=Qr.getState(e);return t&&t.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(t,n)=>{!function(e,t,n,r){if(!e.editable)return;let i=Qr.getState(e.state);if(i&&!i.dragging){let o=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),s=-1;if(o){let{left:r,right:i}=o.getBoundingClientRect();t.clientX-r<=n?s=Qo(e,t,"left",n):i-t.clientX<=n&&(s=Qo(e,t,"right",n))}if(s!=i.activeHandle){if(!r&&-1!==s){let t=e.state.doc.resolve(s),n=t.node(-1),r=FS.get(n),i=t.start(-1);if(r.colCount(t.pos-i)+t.nodeAfter.attrs.colspan-1==r.width-1)return}Qa(e,s)}}}(t,n,e,i)},mouseleave:e=>{!function(e){if(!e.editable)return;let t=Qr.getState(e.state);t&&t.activeHandle>-1&&!t.dragging&&Qa(e,-1)}(e)},mousedown:(e,r)=>{!function(e,t,n,r){var i;if(!e.editable)return;let o=null!=(i=e.dom.ownerDocument.defaultView)?i:window,s=Qr.getState(e.state);if(!s||-1==s.activeHandle||s.dragging)return;let a=e.state.doc.nodeAt(s.activeHandle),l=function(e,t,{colspan:n,colwidth:r}){let i=r&&r[r.length-1];if(i)return i;let o=e.domAtPos(t),s=o.node.childNodes[o.offset].offsetWidth,a=n;if(r)for(let e=0;e<n;e++)r[e]&&(s-=r[e],a--);return s/a}(e,s.activeHandle,a.attrs);function c(t){o.removeEventListener("mouseup",c),o.removeEventListener("mousemove",h);let r=Qr.getState(e.state);null!=r&&r.dragging&&(function(e,t,n){let r=e.state.doc.resolve(t),i=r.node(-1),o=FS.get(i),s=r.start(-1),a=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,l=e.state.tr;for(let e=0;e<o.height;e++){let t=e*o.width+a;if(e&&o.map[t]==o.map[t-o.width])continue;let r=o.map[t],c=i.nodeAt(r).attrs,h=1==c.colspan?0:a-o.colCount(r);if(c.colwidth&&c.colwidth[h]==n)continue;let u=c.colwidth?c.colwidth.slice():Array(c.colspan).fill(0);u[h]=n,l.setNodeMarkup(s+r,null,{...c,colwidth:u})}l.docChanged&&e.dispatch(l)}(e,r.activeHandle,Qs(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(Qr,{setDragging:null})))}function h(t){if(!t.which)return c(t);let i=Qr.getState(e.state);if(i&&i.dragging){let o=Qs(i.dragging,t,n);Ql(e,i.activeHandle,o,r)}}e.dispatch(e.state.tr.setMeta(Qr,{setDragging:{startX:t.clientX,startWidth:l}})),Ql(e,s.activeHandle,l,r),o.addEventListener("mouseup",c),o.addEventListener("mousemove",h),t.preventDefault()}(e,r,t,n)}},decorations:e=>{let t=Qr.getState(e);if(t&&t.activeHandle>-1)return function(e,t){var n;let r=[],i=e.doc.resolve(t),o=i.node(-1);if(!o)return LN.empty;let s=FS.get(o),a=i.start(-1),l=s.colCount(i.pos-a)+i.nodeAfter.attrs.colspan-1;for(let t=0;t<s.height;t++){let i=l+t*s.width;if((l==s.width-1||s.map[i]!=s.map[i+1])&&(0==t||s.map[i]!=s.map[i-s.width])){let t=s.map[i],l=a+t+o.nodeAt(t).nodeSize-1,c=document.createElement("div");c.className="column-resize-handle",null!=(n=Qr.getState(e))&&n.dragging&&r.push(LM.node(a+t,a+t+o.nodeAt(t).nodeSize,{class:"column-resize-dragging"})),r.push(LM.widget(l,c))}}return LN.create(e.doc,r)}(e,t.activeHandle)},nodeViews:{}}});return o}({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],function({allowTableNodeSelection:e=!1}={}){return new IT({key:FT,state:{init:()=>null,apply(e,t){let n=e.getMeta(FT);if(null!=n)return -1==n?null:n;if(null==t||!e.docChanged)return t;let{deleted:r,pos:i}=e.mapping.mapResult(t);return r?null:i}},props:{decorations:F$,handleDOMEvents:{mousedown:F8},createSelectionBetween:e=>null!=FT.getState(e.state)?e.state.selection:null,handleTripleClick:F4,handleKeyDown:F1,handlePaste:F6},appendTransaction:(t,n,r)=>(function(e,t,n){let r,i;let o=(t||e).selection,s=(t||e).doc;if(o instanceof Ip&&(i=o.node.type.spec.tableRole)){if("cell"==i||"header_cell"==i)r=Fj.create(s,o.from);else if("row"==i){let e=s.resolve(o.from+1);r=Fj.rowSelection(e,e)}else if(!n){let e=FS.get(o.node),t=o.from+1,n=t+e.map[e.width*e.height-1];r=Fj.create(s,t+1,n)}}else o instanceof Id&&function({$from:e,$to:t}){if(e.pos==t.pos||e.pos<t.pos-6)return!1;let n=e.pos,r=t.pos,i=e.depth;for(;i>=0&&!(e.after(i+1)<e.end(i));i--,n++);for(let e=t.depth;e>=0&&!(t.before(e+1)>t.start(e));e--,r--);return n==r&&/row|table/.test(e.node(i).type.spec.tableRole)}(o)?r=Id.create(s,o.from):o instanceof Id&&function({$from:e,$to:t}){let n,r;for(let t=e.depth;t>0;t--){let r=e.node(t);if("cell"===r.type.spec.tableRole||"header_cell"===r.type.spec.tableRole){n=r;break}}for(let e=t.depth;e>0;e--){let n=t.node(e);if("cell"===n.type.spec.tableRole||"header_cell"===n.type.spec.tableRole){r=n;break}}return n!==r&&0===t.parentOffset}(o)&&(r=Id.create(s,o.$from.start(),o.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t})(r,Fq(r,n),e)})}({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){let t={name:e.name,options:e.options,storage:e.storage};return{tableRole:qL(qD(e,"tableRole",t))}}}),Qm=zF.create({name:"tableRow",addOptions:()=>({HTMLAttributes:{}}),content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML:()=>[{tag:"tr"}],renderHTML({HTMLAttributes:e}){return["tr",qj(this.options.HTMLAttributes,e),0]}}),Qg=zF.create({name:"tableHeader",addOptions:()=>({HTMLAttributes:{}}),content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?t.split(",").map(e=>parseInt(e,10)):null}}}),tableRole:"header_cell",isolating:!0,parseHTML:()=>[{tag:"th"}],renderHTML({HTMLAttributes:e}){return["th",qj(this.options.HTMLAttributes,e),0]}}),Qy=zF.create({name:"tableCell",addOptions:()=>({HTMLAttributes:{}}),content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?t.split(",").map(e=>parseInt(e,10)):null}}}),tableRole:"cell",isolating:!0,parseHTML:()=>[{tag:"td"}],renderHTML({HTMLAttributes:e}){return["td",qj(this.options.HTMLAttributes,e),0]}}),Qb={};function Qv(e,t){"string"!=typeof t&&(t=Qv.defaultChars);let n=function(e){let t=Qb[e];if(t)return t;t=Qb[e]=[];for(let e=0;e<128;e++){let n=String.fromCharCode(e);t.push(n)}for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(e){let t="";for(let r=0,i=e.length;r<i;r+=3){let o=parseInt(e.slice(r+1,r+3),16);if(o<128){t+=n[o];continue}if((224&o)==192&&r+3<i){let n=parseInt(e.slice(r+4,r+6),16);if((192&n)==128){let e=o<<6&1984|63&n;e<128?t+="":t+=String.fromCharCode(e),r+=3;continue}}if((240&o)==224&&r+6<i){let n=parseInt(e.slice(r+4,r+6),16),i=parseInt(e.slice(r+7,r+9),16);if((192&n)==128&&(192&i)==128){let e=o<<12&61440|n<<6&4032|63&i;e<2048||e>=55296&&e<=57343?t+="":t+=String.fromCharCode(e),r+=6;continue}}if((248&o)==240&&r+9<i){let n=parseInt(e.slice(r+4,r+6),16),i=parseInt(e.slice(r+7,r+9),16),s=parseInt(e.slice(r+10,r+12),16);if((192&n)==128&&(192&i)==128&&(192&s)==128){let e=o<<18&1835008|n<<12&258048|i<<6&4032|63&s;e<65536||e>1114111?t+="":(e-=65536,t+=String.fromCharCode(55296+(e>>10),56320+(1023&e))),r+=9;continue}}t+=""}return t})}Qv.defaultChars=";/?:@&=+$,#",Qv.componentChars="";let Qx={};function Qw(e,t,n){"string"!=typeof t&&(n=t,t=Qw.defaultChars),typeof n>"u"&&(n=!0);let r=function(e){let t=Qx[e];if(t)return t;t=Qx[e]=[];for(let e=0;e<128;e++){let n=String.fromCharCode(e);/^[0-9a-z]$/i.test(n)?t.push(n):t.push("%"+("0"+e.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}(t),i="";for(let t=0,o=e.length;t<o;t++){let s=e.charCodeAt(t);if(n&&37===s&&t+2<o&&/^[0-9a-f]{2}$/i.test(e.slice(t+1,t+3))){i+=e.slice(t,t+3),t+=2;continue}if(s<128){i+=r[s];continue}if(s>=55296&&s<=57343){if(s>=55296&&s<=56319&&t+1<o){let n=e.charCodeAt(t+1);if(n>=56320&&n<=57343){i+=encodeURIComponent(e[t]+e[t+1]),t++;continue}}i+="%EF%BF%BD";continue}i+=encodeURIComponent(e[t])}return i}function Qk(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&-1!==e.hostname.indexOf(":")?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||""}function QO(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}Qw.defaultChars=";/?:@&=+$,-_.!~*'()#",Qw.componentChars="-_.!~*'()";let QS=/^([a-z0-9.+-]+:)/i,QC=/:[0-9]*$/,QT=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,QA=["%","/","?",";","#"].concat(["'"].concat(["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]))),QE=["/","?","#"],QM=/^[+a-z0-9A-Z_-]{0,63}$/,Q_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,QD={javascript:!0,"javascript:":!0},QN={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function QR(e,t){if(e&&e instanceof QO)return e;let n=new QO;return n.parse(e,t),n}QO.prototype.parse=function(e,t){let n,r,i,o=e;if(o=o.trim(),!t&&1===e.split("#").length){let e=QT.exec(o);if(e)return this.pathname=e[1],e[2]&&(this.search=e[2]),this}let s=QS.exec(o);if(s&&(n=(s=s[0]).toLowerCase(),this.protocol=s,o=o.substr(s.length)),(t||s||o.match(/^\/\/[^@\/]+@[^@\/]+/))&&(i="//"===o.substr(0,2))&&!(s&&QD[s])&&(o=o.substr(2),this.slashes=!0),!QD[s]&&(i||s&&!QN[s])){let e,t,n=-1;for(let e=0;e<QE.length;e++)-1!==(r=o.indexOf(QE[e]))&&(-1===n||r<n)&&(n=r);-1!==(t=-1===n?o.lastIndexOf("@"):o.lastIndexOf("@",n))&&(e=o.slice(0,t),o=o.slice(t+1),this.auth=e),n=-1;for(let e=0;e<QA.length;e++)-1!==(r=o.indexOf(QA[e]))&&(-1===n||r<n)&&(n=r);-1===n&&(n=o.length),":"===o[n-1]&&n--;let i=o.slice(0,n);o=o.slice(n),this.parseHost(i),this.hostname=this.hostname||"";let s="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!s){let e=this.hostname.split(/\./);for(let t=0,n=e.length;t<n;t++){let n=e[t];if(n&&!n.match(QM)){let r="";for(let e=0,t=n.length;e<t;e++)n.charCodeAt(e)>127?r+="x":r+=n[e];if(!r.match(QM)){let r=e.slice(0,t),i=e.slice(t+1),s=n.match(Q_);s&&(r.push(s[1]),i.unshift(s[2])),i.length&&(o=i.join(".")+o),this.hostname=r.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),s&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}let a=o.indexOf("#");-1!==a&&(this.hash=o.substr(a),o=o.slice(0,a));let l=o.indexOf("?");return -1!==l&&(this.search=o.substr(l),o=o.slice(0,l)),o&&(this.pathname=o),QN[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this},QO.prototype.parseHost=function(e){let t=QC.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};let QP=Object.freeze(Object.defineProperty({__proto__:null,decode:Qv,encode:Qw,format:Qk,parse:QR},Symbol.toStringTag,{value:"Module"})),Qj=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,QI=/[\0-\x1F\x7F-\x9F]/,Q$=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,QL=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,Qq=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Qz=Object.freeze(Object.defineProperty({__proto__:null,Any:Qj,Cc:QI,Cf:/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,P:Q$,S:QL,Z:Qq},Symbol.toStringTag,{value:"Module"})),QB=new Uint16Array('<\xd5\0\0\0\0\0\0EMabcfglmnoprstu\\bfms\x7f\x84\x8b\x90\x95\x98\xa6\xb3\xb9\xc8\xcflig\xc6P&cute\xc1reve;iyx}rc\xc2;r;\uD835\uDD04rave\xc0pha;acr;d;gp\x9d\xa1on;f;\uD835\uDD38plyFunction;ing\xc5cs\xbe\xc3r;\uD835\uDC9Cign;ilde\xc3ml\xc4aceforsu\xe5\xfb\xfecr\xea\xf2kslash;\xf6\xf8;ed;y;crtause;noullis;a;r;\uD835\uDD05pf;\uD835\uDD39eve;c\xf2mpeq;HOacdefhilorsucy;PY\xa9cpyute;;italDifferentialD;leys;aeioron;dil\xc7rc;nint;ot;dnilla;terDot;\xf2i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;\uD835\uDC9Ep;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;\uD835\uDD07afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;\uD835\uDD3B;DEot;qual;bleCDLRUVontourIntegra\xeco\0\0\xbbnArrow;eoftARTrrow;ightArrow;e\xe5ngLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;\uD835\uDC9Frok;NTacdfglmopqstuxG;H\xd0cute\xc9aiyron;rc\xca;ot;r;\uD835\uDD08rave\xc8ement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;\uD835\uDD3Csilon;uail;Tilde;librium;cir;m;a;ml\xcbipsts;onentialE;cfiosy;r;\uD835\uDD09lled\0\0mallSquare;erySmallSquare;\0\0\0f;\uD835\uDD3DAll;riertrf;c\xf2JTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;\uD835\uDD0A;pf;\uD835\uDD3EeaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;\uD835\uDCA2;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ct\xf2rok;mpownHum\xf0qual;EJOacdfgmnostucy;lig;cy;cute\xcdiyrc\xce;ot;r;rave\xcc;apcgr;inaryI;lie\xf3\0;egrral;section;isibleCTomma;imes;gpton;f;\uD835\uDD40a;cr;ilde;\0cy;l\xcfcfosuiyrc;;r;\uD835\uDD0Dpf;\uD835\uDD41\0r;\uD835\uDCA5rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;\uD835\uDD0Epf;\uD835\uDD42cr;\uD835\uDCA6JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ight\xe1sEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;\uD835\uDD0F;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftaright\xe1ight\xe1f;\uD835\uDD43erLReftArrow;ightArrow;cht\xf2;rok;;acefiosup;y;dliumSpace;lintrf;r;\uD835\uDD10nusPlus;pf;\uD835\uDD44c\xf2;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicn\xeberyThi\xeetedGLreaterGreate\xf2essLes\xf3Line;r;\uD835\uDD11Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;\uD835\uDCA9ilde\xd1;Eacdfgmoprstuvlig;cute\xd3iyrc\xd4;blac;r;\uD835\uDD12rave\xd2aeicr;ga;cron;pf;\uD835\uDD46enCurlyDQoubleQuote;uote;;clr;\uD835\uDCAAash\xd8ide\xd5es;ml\xd6erBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;\uD835\uDD13i;;usMinus;ipncareplan\xe5f;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;\uD835\uDCAB;UfosOT"r;\uD835\uDD14pf;cr;\uD835\uDCACBEacefhiorsuarr;G\xaecnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;r\xbbo;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;\uD835\uDD16ortDLRUownArrow\xbbeftArrow\xbbightArrow\xbbpArrow;gma;allCircle;pf;\uD835\uDD4A\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;\uD835\uDCAEar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th\xe1;;esrset;Equal;et\xbbHRSacfhiorsORN\xdeADE;Hccy;y;bu;;aeyron;dil;;r;\uD835\uDD17ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;\uD835\uDD4BipleDot;ctr;\uD835\uDCAFrok;\0\0\0\0\0\0\0crute\xdar;ocir;r\0y;ve;iyrc\xdb;blac;r;\uD835\uDD18rave\xd9acr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;\uD835\uDD4CADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;own\xe1erLReftArrow;ightArrow;i;lon;ing;cr;\uD835\uDCB0ilde;ml\xdcDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;\uD835\uDD19pf;\uD835\uDD4Dcr;\uD835\uDCB1dash;cefosirc;dge;r;\uD835\uDD1Apf;\uD835\uDD4Ecr;\uD835\uDCB2fiosr;\uD835\uDD1B;pf;\uD835\uDD4Fcr;\uD835\uDCB3AIUacfosucy;cy;cy;cute\xddiyrc;;r;\uD835\uDD1Cpf;\uD835\uDD50cr;\uD835\uDCB4ml;Hacdefoscy;cute;ayron;;ot;\0oWidt\xe8a;r;pf;cr;\uD835\uDCB5\0\0\0\0\0\0\0cute\xe1reve;;Ediuy;;rc\xe2te\xb4;lig\xe6;r\xb2;\uD835\uDD1Erave\xe0epfpsym;\xe8ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;e\xbbsd;a;;;;;;;;t;vb;d;pth;\xbb\xb9arr;gpon;f;\uD835\uDD52;Eaeiop;cir;;d;s;rox;e\xf1ing\xe5ctyr;\uD835\uDCB6;mp;e\xf1ilde\xe3ml\xe4cionin\xf4nt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;ge\xbbrk;tbrk;oy;quo;cmprtaus;eptyv;s\xe9no\xf5ahw;;een;r;\uD835\uDD1Fgcostuvwaiu\xf0rc;p\xbbdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;e\xe5\xe5arow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;\uD835\uDD53;tom\xbbtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbar\xa6ceior;\uD835\uDCB7mi;m;el;bh;sub;l;et\xbbp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;\xeeaeiu\0s;on;dil\xe7rc;ps;sm;ot;dmnil\xb8ptyv;t\xa2;er\xe4r;\uD835\uDD20ceiy;ck;mark\xbb;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd\xbb;st;irc;ash;nint;id;cir;ubs;uit\xbb\0on;e;q\xc7\xc6\0\0a;t;;fl\xeeemxent\xbbe\xf3\0;dot;n\xf4fry;\uD835\uDD54o\xe4\xa9;sr;aorr;ss;cur;\uD835\uDCB8bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0re\xe3u\xe3ee;edge;en\xa4earrowlreft\xbbight\xbbe\xe4cionin\xf4nt;lcty;AHabcdefhijlorstuwzr\xf2ar;glrsger;eth;\xf2h;v\xbbarow;a\xe3ayron;;;aogrr;tseq;glm\xb0ta;ptyv;irsht;;\uD835\uDD21arlr\xbb\xbbaegsvm;osnd;suit;amma;in;;iode\xf7;ontimes;n\xf8cy;c\0\0rn;op;lptuwlar;f;\uD835\uDD55;empsq;dot;inus;lus;quare;blebarwedg\xe5\xfanadhownarrow\xf3arpoonlref\xf4igh\xf4karo\xf7\0\0rn;op;cotry;\uD835\uDCB9;l;rok;drot;i;fahr\xf2a\xf2angle;ciy;grarr;DacdefglmnopqrstuxDoo\xf4csute\xe9ter;aioyron;r;c\xealon;;ot;Drot;;\uD835\uDD22;rsave\xe8;dot;;ilsnters;;;dot;apscr;ty;svet\xbbp1;;;gs;p;gpon;f;\uD835\uDD56alsr;sl;us;i;lvon\xbb;csuviorc\xbb\0\0\xedantgltr\xbbess\xbbaeils;st;v;DD;parsl;Daot;rr;cdir;o\xf4ah;\xf0mrl\xebo;cipl;s\xf4eoctatio\xeenential\xe5\0\0\0\0\0\0\0llingdotse\xf1y;male;ilrlig;\0\0g;ig;;\uD835\uDD23lig;lig;fjaltt;ig;ns;of;\0f;\uD835\uDD57ak;v;artint;aocs\0\0\xbd;\xbc;;;\0;;\0\0\xbe;;5;\0;;8;l;wn;cr;\uD835\uDCBBEabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan\xf4;cdlc;ot;o;l;;es;r;\uD835\uDD24;gmel;cy;;Eaj;;;Eaes;p;prox\xbb;q;qim;pf;\uD835\uDD58cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pro\xf8r;qlqles\xf3i\xedenrtneqq;\xc5Aabcefkosyr\xf2ilmrrs\xf0f\xbbil\xf4drcy;;cwir;;ar;irc;alrrts;uit\xbblip;con;r;\uD835\uDD25sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;\uD835\uDD59bar;cltr;\uD835\uDCBDas\xe8rok;bpull;hen\xbb\0\0\0\0\0\0cute\xed;iyrc\xee;cxy;cl\xa1fr;\uD835\uDD26rave\xec;inoinnt;t;fin;ta;lig;aopcgtr;elpin\xe5ar\xf4h;f;ed;;cfotare;in;tie;do\xf4;celpal;grer\xf3\xe3arhk;rod;cgpty;on;f;\uD835\uDD5Aa;uest\xbfcir;\uD835\uDCBEn;Edsv;ot;;v;;ilde;\0cy;l\xefcfmosuiyrc;;r;\uD835\uDD27ath;pf;\uD835\uDD5B\0r;\uD835\uDCBFrcy;kcy;acfghjosppa;v;eydil;;r;\uD835\uDD28reen;cy;cy;pf;\uD835\uDD5Ccr;\uD835\uDCC0ABEHabcdefghjlmnoprstuvartr\xf2\xf2ail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;ra\xeebda;g;dl;\xe5;uo\xabr;bfhlpst;fs;s;\xebp;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;\xec\xe2;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;ta\xe9arpoonduown\xbbp\xbbeftarrows;ightahsrrow;sarpoon\xf3quigarro\xf7hreetimes;;qslan\xf4;cdgsc;ot;o;r;;es;adegsppro\xf8ot;qgq\xf4gt\xf2\xf4i\xedilrsht;;\uD835\uDD29;E;rdu;l;lk;cy;;achtr\xf2orne\xf2ard;ri;iodot;ust;ache\xbbEaes;p;prox\xbb;q;qim;abnoptwznrg;r;r\xebglmreftaright\xe1apsto;ight\xe1parrowlref\xf4ight;aflr;;\uD835\uDD5Dus;imes;st;\xe1;efnge\xbbar;lt;achmtr\xf2orne\xf2ar;d;;ri;achiqtquo;r;\uD835\uDCC1m;eg;;buo;r;rok;<;cdhilqrci;r;re\xe5mes;arr;uest;Piar;;efrdushar;har;enrtneqq;\xc5DacdefhilnopsuDot;clprr\xafet;;ese\xbb;sto;dluow\xeeef\xf4\xf0ker;oymma;;ash;asuredangle\xbbr;\uD835\uDD2Ao;cdnro\xb5;acds\xf4ir;ot\xb7us;bd;u;p;\xf2\xf0dpels;f;\uD835\uDD5Ectr;\uD835\uDCC2pos\xbb;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptla\xbbute;g;;Eiop;d;s;ro\xf8ur;al;s\0p\xa0mp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;ui\xf6eiar;\xedist;sr;\uD835\uDD2BEest;qs;qslan\xf4i\xed;r\xbbAapr\xf2rr;ar;;sv;d;cy;AEadestr\xf2;rr;r;;fqstarrro\xf7ightarro\xf7;qslan\xf4;s\xbbi\xed;ri;ei\xe4ptf;\uD835\uDD5F\xac;inn;Edv;ot;;;i;v;;aorr;astlle\xecl;;lint;;ceu\xe5;c;e\xf1Aaitr\xf2rr;cw;;ghtarrow\xbbri;echimpqu;ceru\xe5;\uD835\uDCC3ort\0\0ar\xe1m;e;qsubp\xe5\xe5bcp;Ees;et;eq;qc;e\xf1;Ees;et;eq;qgilr\xeclde\xf1\xe7ianglelreft;e\xf1ight;e\xf1;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csute\xf3iyr;c\xf4;abioslac;v;old;lig;crir;;\uD835\uDD2C\0\0\0n;ave\xf2;bmar;acitr\xf2irr;oss;n\xe5;aeicr;ga;cdnron;;pf;\uD835\uDD60aelr;rp;;adiosvr\xf2;efmr;of\xbb\xaa\xbagof;r;lope;;clo\xf2ash\xf8l;ide\xf5es;as;ml\xf6bar;\0\0\0\0\0\0\0\0\0r;ast\xb6;lle\xec\0\0m;;y;rcimptnt;od;il;enk;r;\uD835\uDD2Dimo;v;ma\xf4ne;;tvchfork\xbb;aunckk;h;\xf6s;abcdemstcir;ir;ou;;n\xb1im;wo;ipuntint;f;\uD835\uDD61nd\xa3;Eaceinosu;p;u\xe5;c;acensppro\xf8urlye\xf1\xf1aespprox;qq;im;i\xedme;sEas\xf0dfpalslar;ine;urf;;t\xefrel;cir;\uD835\uDCC5;ncsp;fiopsur;\uD835\uDD2Epf;\uD835\uDD62rime;cr;\uD835\uDCC6aeoteirnion\xf3nt;st;e\xf1\xf4ABHabcdefhilmnoprstuxartr\xf2\xf2ail;ar\xf2ar;cdenqrteu;te;i\xe3mptyv;g;del;;\xe5uo\xbbr;abcfhlpstwp;;fs;;s;\xeb\xf0l;im;l;;aiil;o;nal\xf3abrr\xf2rk;akcek;;es;ldu;;aeuyron;diil;\xec\xe2;clqsa;dhar;uo;rh;acgl;ipsn\xe5ar\xf4t;ilrsht;;\uD835\uDD2Faordu\xbb;l;;v;gnshtahlrstrrow;ta\xe9arpoonduow\xeep\xbbeftahrrow\xf3arpoon\xf3ightarrows;quigarro\xf7hreetimes;g;ingdotse\xf1ahmr\xf2a\xf2;oust;ache\xbbmid;abptnrg;r;r\xebaflr;;\uD835\uDD63us;imes;apr;gt;olint;ar\xf2achqquo;r;\uD835\uDCC7buo;rhirre\xe5mes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu\xef;Eaceinpsy;\0;on;u\xe5;dil;rc;Eas;p;im;olint;i\xed;ot;be;Aacmstxrr;rhr\xeb;ot\xa7i;war;min\xf0nu\xf3\xf1t;r;o\uD835\uDD30acoyrp;hycy;;rt\0\0i\xe4ara\xec\xadgmma;fv;;deglnprot;;q;E;;E;e;lus;arr;ar\xf2aeitlslsetm\xe9hp;parsl;dle;;e;s;flptcy;;b;ar;f;\uD835\uDD64adres;uit\xbbcsuaup;s;p;s;ubp;eset;e\xf1;eset;e\xf1;afr\xbbar\xf2cemtr;\uD835\uDCC8tm\xee\xf1i\xecar\xe6arr;fanighteppsilo\xeeh\xe9s\xbbbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acensppro\xf8urlye\xf1\xf1aesppro\xf8q\xf1g;123;Edehlmnps\xb9\xb2\xb3;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr\xeb;owar;lig\xdf\0\0\0\0\0\0\0\0\0\0\0\0get;;r\xebaeyron;dil;;lrec;r;\uD835\uDD31eiko\0e4fa;svym;cnkasppro\xf8im\xbbs\xf0as\xf0rn\xfees\xd7;bd;ar;;eps\xe1;bcfot;ir;;o\uD835\uDD65rk;\xe1rime;aipd\xe5adempstngle;dlqrown\xbbeft;e\xf1;ight;e\xf1ot;inus;lus;b;ime;ezium;chtry;\uD835\uDCC9;cy;rok;iox\xf4headlreftarro\xf7ightarrow\xbbAHabcdfghlmoprstuwr\xf2ar;crute\xfa\xf2r\0y;ve;iyrc\xfb;abhr\xf2lac;a\xf2irsht;;\uD835\uDD32rave\xf9rlr\xbb\xbblk;ct\0\0rn;er\xbbop;ri;alcr;\xa8gpon;f;\uD835\uDD66adhlsuown\xe1arpoonlref\xf4igh\xf4i;hl\xbbon\xbbparrows;cit\0\0rn;er\xbbop;ng;ri;cr;\uD835\uDCCAdirot;lde;i;f\xbbamr\xf2l\xfcangle;ABDacdeflnoprszr\xf2ar;v;as\xe8nrgrt;eknprstapp\xe1othin\xe7hirop\xf4;h\xefiugm\xe1bpsetneq;q;setneq;q;hret\xe1ianglelreft\xbbight\xbby;ash\xbbelr;bear;q;lip;bta\xf2r;\uD835\uDD33tr\xe9subp\xbb\xbbpf;\uD835\uDD67ro\xf0tr\xe9cur;\uD835\uDCCBbpnEe\xbbnEe\xbbigzag;cefoprsirc;dibgar;e;q;erp;r;\uD835\uDD34pf;\uD835\uDD68;eat\xe8cr;\uD835\uDCCC\0\0\0\0\0\0\0tr\xe9r;\uD835\uDD35Aar\xf2r\xf2;Aar\xf2r\xf2a\xf0is;dptfl;\uD835\uDD69im\xe5Aar\xf2r\xf2cqr;\uD835\uDCCDptr\xe9acefiosucuyte\xfd;iyrc;;n\xa5r;\uD835\uDD36cy;pf;\uD835\uDD6Acr;\uD835\uDCCEcmy;l\xffacdefhioswcute;ayron;;ot;ettr\xe6a;r;\uD835\uDD37cy;grarr;pf;\uD835\uDD6Bcr;\uD835\uDCCFjn;j;'.split("").map(e=>e.charCodeAt(0))),QF=new Uint16Array("aglq	\x15\x18\x1b\x0f\0\0\x12p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0))),QQ=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),QV=null!==(v=String.fromCodePoint)&&void 0!==v?v:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),t+=String.fromCharCode(e)};function QW(e){return e>=x.ZERO&&e<=x.NINE}!function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"}(x||(x={})),function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"}(w||(w={})),function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"}(k||(k={})),function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"}(O||(O={}));class QU{constructor(e,t,n){this.decodeTree=e,this.emitCodePoint=t,this.errors=n,this.state=k.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=O.Strict}startEntity(e){this.decodeMode=e,this.state=k.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case k.EntityStart:return e.charCodeAt(t)===x.NUM?(this.state=k.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=k.NamedEntity,this.stateNamedEntity(e,t));case k.NumericStart:return this.stateNumericStart(e,t);case k.NumericDecimal:return this.stateNumericDecimal(e,t);case k.NumericHex:return this.stateNumericHex(e,t);case k.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(32|e.charCodeAt(t))===x.LOWER_X?(this.state=k.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=k.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,n,r){if(t!==n){let i=n-t;this.result=this.result*Math.pow(r,i)+parseInt(e.substr(t,i),r),this.consumed+=i}}stateNumericHex(e,t){let n=t;for(;t<e.length;){var r;let i=e.charCodeAt(t);if(!QW(i)&&(!((r=i)>=x.UPPER_A)||!(r<=x.UPPER_F))&&(!(r>=x.LOWER_A)||!(r<=x.LOWER_F)))return this.addToNumericResult(e,n,t,16),this.emitNumericEntity(i,3);t+=1}return this.addToNumericResult(e,n,t,16),-1}stateNumericDecimal(e,t){let n=t;for(;t<e.length;){let r=e.charCodeAt(t);if(!QW(r))return this.addToNumericResult(e,n,t,10),this.emitNumericEntity(r,2);t+=1}return this.addToNumericResult(e,n,t,10),-1}emitNumericEntity(e,t){var n,r,i;if(this.consumed<=t)return null===(n=this.errors)||void 0===n||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===x.SEMI)this.consumed+=1;else if(this.decodeMode===O.Strict)return 0;return this.emitCodePoint((r=this.result)>=55296&&r<=57343||r>1114111?65533:null!==(i=QQ.get(r))&&void 0!==i?i:r,this.consumed),this.errors&&(e!==x.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){let{decodeTree:n}=this,r=n[this.treeIndex],i=(r&w.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){let o=e.charCodeAt(t);if(this.treeIndex=function(e,t,n,r){let i=(t&w.BRANCH_LENGTH)>>7,o=t&w.JUMP_TABLE;if(0===i)return 0!==o&&r===o?n:-1;if(o){let t=r-o;return t<0||t>=i?-1:e[n+t]-1}let s=n,a=s+i-1;for(;s<=a;){let t=s+a>>>1,n=e[t];if(n<r)s=t+1;else{if(!(n>r))return e[t+i];a=t-1}}return -1}(n,r,this.treeIndex+Math.max(1,i),o),this.treeIndex<0)return 0===this.result||this.decodeMode===O.Attribute&&(0===i||function(e){var t;return e===x.EQUALS||(t=e)>=x.UPPER_A&&t<=x.UPPER_Z||t>=x.LOWER_A&&t<=x.LOWER_Z||QW(t)}(o))?0:this.emitNotTerminatedNamedEntity();if(0!=(i=((r=n[this.treeIndex])&w.VALUE_LENGTH)>>14)){if(o===x.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==O.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return -1}emitNotTerminatedNamedEntity(){var e;let{result:t,decodeTree:n}=this,r=(n[t]&w.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,r,this.consumed),null===(e=this.errors)||void 0===e||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,n){let{decodeTree:r}=this;return this.emitCodePoint(1===t?r[e]&~w.VALUE_LENGTH:r[e+1],n),3===t&&this.emitCodePoint(r[e+2],n),n}end(){var e;switch(this.state){case k.NamedEntity:return 0!==this.result&&(this.decodeMode!==O.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case k.NumericDecimal:return this.emitNumericEntity(0,2);case k.NumericHex:return this.emitNumericEntity(0,3);case k.NumericStart:return null===(e=this.errors)||void 0===e||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case k.EntityStart:return 0}}}function QH(e){let t="",n=new QU(e,e=>t+=QV(e));return function(e,r){let i=0,o=0;for(;(o=e.indexOf("&",o))>=0;){t+=e.slice(i,o),n.startEntity(r);let s=n.write(e,o+1);if(s<0){i=o+n.end();break}i=o+s,o=0===s?i+1:i}let s=t+e.slice(i);return t="",s}}let QG=QH(QB);function QX(e,t=O.Legacy){return QG(e,t)}function QZ(e){return"[object String]"===Object.prototype.toString.call(e)}QH(QF);let QY=Object.prototype.hasOwnProperty;function QJ(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t){if("object"!=typeof t)throw TypeError(t+"must be object");Object.keys(t).forEach(function(n){e[n]=t[n]})}}),e}function QK(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function Q0(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(65535&e)==65535||(65535&e)==65534||e>=0&&e<=8||11===e||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function Q1(e){return e>65535?String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e)):String.fromCharCode(e)}let Q2=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,Q5=RegExp(Q2.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),Q3=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function Q4(e){return 0>e.indexOf("\\")&&0>e.indexOf("&")?e:e.replace(Q5,function(e,t,n){return t||function(e,t){if(35===t.charCodeAt(0)&&Q3.test(t)){let n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return Q0(n)?Q1(n):e}let n=QX(e);return n!==e?n:e}(e,n)})}let Q6=/[&<>"]/,Q8=/[&<>"]/g,Q9={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function Q7(e){return Q9[e]}function Ve(e){return Q6.test(e)?e.replace(Q8,Q7):e}let Vt=/[.?*+^$[\]\\(){}|-]/g;function Vn(e){switch(e){case 9:case 32:return!0}return!1}function Vr(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Vi(e){return Q$.test(e)||QL.test(e)}function Vo(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function Vs(e){return(e=e.trim().replace(/\s+/g," ")).toLowerCase().toUpperCase()}let Va=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:QK,assign:QJ,escapeHtml:Ve,escapeRE:function(e){return e.replace(Vt,"\\$&")},fromCodePoint:Q1,has:function(e,t){return QY.call(e,t)},isMdAsciiPunct:Vo,isPunctChar:Vi,isSpace:Vn,isString:QZ,isValidEntityCode:Q0,isWhiteSpace:Vr,lib:{mdurl:QP,ucmicro:Qz},normalizeReference:Vs,unescapeAll:Q4,unescapeMd:function(e){return 0>e.indexOf("\\")?e:e.replace(Q2,"$1")}},Symbol.toStringTag,{value:"Module"})),Vl=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:function(e,t,n){let r,i=t,o={ok:!1,pos:0,str:""};if(60===e.charCodeAt(i)){for(i++;i<n&&10!==(r=e.charCodeAt(i))&&60!==r;){if(62===r)return o.pos=i+1,o.str=Q4(e.slice(t+1,i)),o.ok=!0,o;if(92===r&&i+1<n){i+=2;continue}i++}return o}let s=0;for(;i<n&&!(32===(r=e.charCodeAt(i))||r<32||127===r);){if(92===r&&i+1<n){if(32===e.charCodeAt(i+1))break;i+=2;continue}if(40===r&&++s>32)return o;if(41===r){if(0===s)break;s--}i++}return t===i||0!==s||(o.str=Q4(e.slice(t,i)),o.pos=i,o.ok=!0),o},parseLinkLabel:function(e,t,n){let r,i,o,s;let a=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<a;){if(93===(o=e.src.charCodeAt(e.pos))&&0==--r){i=!0;break}if(s=e.pos,e.md.inline.skipToken(e),91===o){if(s===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return i&&(c=e.pos),e.pos=l,c},parseLinkTitle:function(e,t,n,r){let i,o=t,s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(o>=n)return s;let r=e.charCodeAt(o);if(34!==r&&39!==r&&40!==r)return s;t++,o++,40===r&&(r=41),s.marker=r}for(;o<n;){if((i=e.charCodeAt(o))===s.marker)return s.pos=o+1,s.str+=Q4(e.slice(t,o)),s.ok=!0,s;if(40===i&&41===s.marker)return s;92===i&&o+1<n&&o++,o++}return s.can_continue=!0,s.str+=Q4(e.slice(t,o)),s}},Symbol.toStringTag,{value:"Module"})),Vc={};function Vh(){this.rules=QJ({},Vc)}function Vu(){this.__rules__=[],this.__cache__=null}function Vd(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}function Vf(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}Vc.code_inline=function(e,t,n,r,i){let o=e[t];return"<code"+i.renderAttrs(o)+">"+Ve(o.content)+"</code>"},Vc.code_block=function(e,t,n,r,i){let o=e[t];return"<pre"+i.renderAttrs(o)+"><code>"+Ve(e[t].content)+`</code></pre>
`},Vc.fence=function(e,t,n,r,i){let o;let s=e[t],a=s.info?Q4(s.info).trim():"",l="",c="";if(a){let e=a.split(/(\s+)/g);l=e[0],c=e.slice(2).join("")}if(0===(o=n.highlight&&n.highlight(s.content,l,c)||Ve(s.content)).indexOf("<pre"))return o+`
`;if(a){let e=s.attrIndex("class"),t=s.attrs?s.attrs.slice():[];return e<0?t.push(["class",n.langPrefix+l]):(t[e]=t[e].slice(),t[e][1]+=" "+n.langPrefix+l),`<pre><code${i.renderAttrs({attrs:t})}>${o}</code></pre>
`}return`<pre><code${i.renderAttrs(s)}>${o}</code></pre>
`},Vc.image=function(e,t,n,r,i){let o=e[t];return o.attrs[o.attrIndex("alt")][1]=i.renderInlineAsText(o.children,n,r),i.renderToken(e,t,n)},Vc.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`},Vc.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`},Vc.text=function(e,t){return Ve(e[t].content)},Vc.html_block=function(e,t){return e[t].content},Vc.html_inline=function(e,t){return e[t].content},Vh.prototype.renderAttrs=function(e){let t,n,r;if(!e.attrs)return"";for(r="",t=0,n=e.attrs.length;t<n;t++)r+=" "+Ve(e.attrs[t][0])+'="'+Ve(e.attrs[t][1])+'"';return r},Vh.prototype.renderToken=function(e,t,n){let r=e[t],i="";if(r.hidden)return"";r.block&&-1!==r.nesting&&t&&e[t-1].hidden&&(i+=`
`),i+=(-1===r.nesting?"</":"<")+r.tag,i+=this.renderAttrs(r),0===r.nesting&&n.xhtmlOut&&(i+=" /");let o=!1;if(r.block&&(o=!0,1===r.nesting&&t+1<e.length)){let n=e[t+1];("inline"===n.type||n.hidden||-1===n.nesting&&n.tag===r.tag)&&(o=!1)}return i+(o?`>
`:">")},Vh.prototype.renderInline=function(e,t,n){let r="",i=this.rules;for(let o=0,s=e.length;o<s;o++){let s=e[o].type;"u">typeof i[s]?r+=i[s](e,o,t,n,this):r+=this.renderToken(e,o,t)}return r},Vh.prototype.renderInlineAsText=function(e,t,n){let r="";for(let i=0,o=e.length;i<o;i++)switch(e[i].type){case"text":case"html_inline":case"html_block":r+=e[i].content;break;case"image":r+=this.renderInlineAsText(e[i].children,t,n);break;case"softbreak":case"hardbreak":r+=`
`}return r},Vh.prototype.render=function(e,t,n){let r="",i=this.rules;for(let o=0,s=e.length;o<s;o++){let s=e[o].type;"inline"===s?r+=this.renderInline(e[o].children,t,n):"u">typeof i[s]?r+=i[s](e,o,t,n,this):r+=this.renderToken(e,o,t,n)}return r},Vu.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return -1},Vu.prototype.__compile__=function(){let e=this,t=[""];e.__rules__.forEach(function(e){e.enabled&&e.alt.forEach(function(e){0>t.indexOf(e)&&t.push(e)})}),e.__cache__={},t.forEach(function(t){e.__cache__[t]=[],e.__rules__.forEach(function(n){n.enabled&&(t&&0>n.alt.indexOf(t)||e.__cache__[t].push(n.fn))})})},Vu.prototype.at=function(e,t,n){let r=this.__find__(e);if(-1===r)throw Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=(n||{}).alt||[],this.__cache__=null},Vu.prototype.before=function(e,t,n,r){let i=this.__find__(e);if(-1===i)throw Error("Parser rule not found: "+e);this.__rules__.splice(i,0,{name:t,enabled:!0,fn:n,alt:(r||{}).alt||[]}),this.__cache__=null},Vu.prototype.after=function(e,t,n,r){let i=this.__find__(e);if(-1===i)throw Error("Parser rule not found: "+e);this.__rules__.splice(i+1,0,{name:t,enabled:!0,fn:n,alt:(r||{}).alt||[]}),this.__cache__=null},Vu.prototype.push=function(e,t,n){this.__rules__.push({name:e,enabled:!0,fn:t,alt:(n||{}).alt||[]}),this.__cache__=null},Vu.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);let n=[];return e.forEach(function(e){let r=this.__find__(e);if(r<0){if(t)return;throw Error("Rules manager: invalid rule name "+e)}this.__rules__[r].enabled=!0,n.push(e)},this),this.__cache__=null,n},Vu.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(e){e.enabled=!1}),this.enable(e,t)},Vu.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);let n=[];return e.forEach(function(e){let r=this.__find__(e);if(r<0){if(t)return;throw Error("Rules manager: invalid rule name "+e)}this.__rules__[r].enabled=!1,n.push(e)},this),this.__cache__=null,n},Vu.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},Vd.prototype.attrIndex=function(e){if(!this.attrs)return -1;let t=this.attrs;for(let n=0,r=t.length;n<r;n++)if(t[n][0]===e)return n;return -1},Vd.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]},Vd.prototype.attrSet=function(e,t){let n=this.attrIndex(e),r=[e,t];n<0?this.attrPush(r):this.attrs[n]=r},Vd.prototype.attrGet=function(e){let t=this.attrIndex(e),n=null;return t>=0&&(n=this.attrs[t][1]),n},Vd.prototype.attrJoin=function(e,t){let n=this.attrIndex(e);n<0?this.attrPush([e,t]):this.attrs[n][1]=this.attrs[n][1]+" "+t},Vf.prototype.Token=Vd;let Vp=/\r\n?|\n/g,Vm=/\0/g,Vg=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,Vy=/\((c|tm|r)\)/i,Vb=/\((c|tm|r)\)/ig,Vv={c:"\xa9",r:"\xae",tm:""};function Vx(e,t){return Vv[t.toLowerCase()]}let Vw=/['"]/,Vk=/['"]/g;function VO(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}let VS=[["normalize",function(e){let t;t=(t=e.src.replace(Vp,`
`)).replace(Vm,""),e.src=t}],["block",function(e){let t;e.inlineMode?((t=new e.Token("inline","",0)).content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}],["inline",function(e){let t=e.tokens;for(let n=0,r=t.length;n<r;n++){let r=t[n];"inline"===r.type&&e.md.inline.parse(r.content,e.md,e.env,r.children)}}],["linkify",function(e){let t=e.tokens;if(e.md.options.linkify)for(let i=0,o=t.length;i<o;i++){if("inline"!==t[i].type||!e.md.linkify.pretest(t[i].content))continue;let o=t[i].children,s=0;for(let a=o.length-1;a>=0;a--){var n,r;let l=o[a];if("link_close"===l.type){for(a--;o[a].level!==l.level&&"link_open"!==o[a].type;)a--;continue}if("html_inline"===l.type&&(n=l.content,/^<a[>\s]/i.test(n)&&s>0&&s--,r=l.content,/^<\/a\s*>/i.test(r)&&s++),!(s>0)&&"text"===l.type&&e.md.linkify.test(l.content)){let n=l.content,r=e.md.linkify.match(n),s=[],c=l.level,h=0;r.length>0&&0===r[0].index&&a>0&&"text_special"===o[a-1].type&&(r=r.slice(1));for(let t=0;t<r.length;t++){let i=r[t].url,o=e.md.normalizeLink(i);if(!e.md.validateLink(o))continue;let a=r[t].text;a=r[t].schema?"mailto:"!==r[t].schema||/^mailto:/i.test(a)?e.md.normalizeLinkText(a):e.md.normalizeLinkText("mailto:"+a).replace(/^mailto:/,""):e.md.normalizeLinkText("http://"+a).replace(/^http:\/\//,"");let l=r[t].index;if(l>h){let t=new e.Token("text","",0);t.content=n.slice(h,l),t.level=c,s.push(t)}let u=new e.Token("link_open","a",1);u.attrs=[["href",o]],u.level=c++,u.markup="linkify",u.info="auto",s.push(u);let d=new e.Token("text","",0);d.content=a,d.level=c,s.push(d);let f=new e.Token("link_close","a",-1);f.level=--c,f.markup="linkify",f.info="auto",s.push(f),h=r[t].lastIndex}if(h<n.length){let t=new e.Token("text","",0);t.content=n.slice(h),t.level=c,s.push(t)}t[i].children=o=QK(o,a,s)}}}}],["replacements",function(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)"inline"===e.tokens[t].type&&(Vy.test(e.tokens[t].content)&&function(e){let t=0;for(let n=e.length-1;n>=0;n--){let r=e[n];"text"!==r.type||t||(r.content=r.content.replace(Vb,Vx)),"link_open"===r.type&&"auto"===r.info&&t--,"link_close"===r.type&&"auto"===r.info&&t++}}(e.tokens[t].children),Vg.test(e.tokens[t].content)&&function(e){let t=0;for(let n=e.length-1;n>=0;n--){let r=e[n];"text"===r.type&&!t&&Vg.test(r.content)&&(r.content=r.content.replace(/\+-/g,"\xb1").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),"link_open"===r.type&&"auto"===r.info&&t--,"link_close"===r.type&&"auto"===r.info&&t++}}(e.tokens[t].children))}],["smartquotes",function(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)"inline"===e.tokens[t].type&&Vw.test(e.tokens[t].content)&&function(e,t){let n;let r=[];for(let i=0;i<e.length;i++){let o=e[i],s=e[i].level;for(n=r.length-1;n>=0&&!(r[n].level<=s);n--);if(r.length=n+1,"text"!==o.type)continue;let a=o.content,l=0,c=a.length;e:for(;l<c;){Vk.lastIndex=l;let h=Vk.exec(a);if(!h)break;let u=!0,d=!0;l=h.index+1;let f="'"===h[0],p=32;if(h.index-1>=0)p=a.charCodeAt(h.index-1);else for(n=i-1;n>=0&&!("softbreak"===e[n].type||"hardbreak"===e[n].type);n--)if(e[n].content){p=e[n].content.charCodeAt(e[n].content.length-1);break}let m=32;if(l<c)m=a.charCodeAt(l);else for(n=i+1;n<e.length&&!("softbreak"===e[n].type||"hardbreak"===e[n].type);n++)if(e[n].content){m=e[n].content.charCodeAt(0);break}let g=Vo(p)||Vi(String.fromCharCode(p)),y=Vo(m)||Vi(String.fromCharCode(m)),b=Vr(p),v=Vr(m);if(v?u=!1:y&&(b||g||(u=!1)),b?d=!1:g&&(v||y||(d=!1)),34===m&&'"'===h[0]&&p>=48&&p<=57&&(d=u=!1),u&&d&&(u=g,d=y),!u&&!d){f&&(o.content=VO(o.content,h.index,""));continue}if(d)for(n=r.length-1;n>=0;n--){let u=r[n];if(r[n].level<s)break;if(u.single===f&&r[n].level===s){let s,d;u=r[n],f?(s=t.md.options.quotes[2],d=t.md.options.quotes[3]):(s=t.md.options.quotes[0],d=t.md.options.quotes[1]),o.content=VO(o.content,h.index,d),e[u.token].content=VO(e[u.token].content,u.pos,s),l+=d.length-1,u.token===i&&(l+=s.length-1),c=(a=o.content).length,r.length=n;continue e}}u?r.push({token:i,pos:h.index,single:f,level:s}):d&&f&&(o.content=VO(o.content,h.index,""))}}}(e.tokens[t].children,e)}],["text_join",function(e){let t,n;let r=e.tokens,i=r.length;for(let e=0;e<i;e++){if("inline"!==r[e].type)continue;let i=r[e].children,o=i.length;for(t=0;t<o;t++)"text_special"===i[t].type&&(i[t].type="text");for(t=n=0;t<o;t++)"text"===i[t].type&&t+1<o&&"text"===i[t+1].type?i[t+1].content=i[t].content+i[t+1].content:(t!==n&&(i[n]=i[t]),n++);t!==n&&(i.length=n)}}]];function VC(){this.ruler=new Vu;for(let e=0;e<VS.length;e++)this.ruler.push(VS[e][0],VS[e][1])}function VT(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;let i=this.src;for(let e=0,t=0,n=0,r=0,o=i.length,s=!1;t<o;t++){let a=i.charCodeAt(t);if(!s){if(Vn(a)){n++,9===a?r+=4-r%4:r++;continue}s=!0}(10===a||t===o-1)&&(10!==a&&t++,this.bMarks.push(e),this.eMarks.push(t),this.tShift.push(n),this.sCount.push(r),this.bsCount.push(0),s=!1,n=0,r=0,e=t+1)}this.bMarks.push(i.length),this.eMarks.push(i.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}function VA(e,t){let n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function VE(e){let t=[],n=e.length,r=0,i=e.charCodeAt(r),o=!1,s=0,a="";for(;r<n;)124===i&&(o?(a+=e.substring(s,r-1),s=r):(t.push(a+e.substring(s,r)),a="",s=r+1)),o=92===i,r++,i=e.charCodeAt(r);return t.push(a+e.substring(s)),t}function VM(e,t){let n=e.eMarks[t],r=e.bMarks[t]+e.tShift[t],i=e.src.charCodeAt(r++);return 42!==i&&45!==i&&43!==i||r<n&&!Vn(e.src.charCodeAt(r))?-1:r}function V_(e,t){let n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t],i=n;if(i+1>=r)return -1;let o=e.src.charCodeAt(i++);if(o<48||o>57)return -1;for(;;){if(i>=r)return -1;if((o=e.src.charCodeAt(i++))>=48&&o<=57){if(i-n>=10)return -1;continue}if(41===o||46===o)break;return -1}return i<r&&!Vn(o=e.src.charCodeAt(i))?-1:i}VC.prototype.process=function(e){let t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)},VC.prototype.State=Vf,VT.prototype.push=function(e,t,n){let r=new Vd(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r},VT.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},VT.prototype.skipEmptyLines=function(e){for(let t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},VT.prototype.skipSpaces=function(e){for(let t=this.src.length;e<t&&Vn(this.src.charCodeAt(e));e++);return e},VT.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!Vn(this.src.charCodeAt(--e)))return e+1;return e},VT.prototype.skipChars=function(e,t){for(let n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},VT.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},VT.prototype.getLines=function(e,t,n,r){if(e>=t)return"";let i=Array(t-e);for(let o=0,s=e;s<t;s++,o++){let e=0,a=this.bMarks[s],l=a,c;for(c=s+1<t||r?this.eMarks[s]+1:this.eMarks[s];l<c&&e<n;){let t=this.src.charCodeAt(l);if(Vn(t))9===t?e+=4-(e+this.bsCount[s])%4:e++;else if(l-a<this.tShift[s])e++;else break;l++}e>n?i[o]=Array(e-n+1).join(" ")+this.src.slice(l,c):i[o]=this.src.slice(l,c)}return i.join("")},VT.prototype.Token=Vd;let VD="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",VN="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",VR=RegExp("^(?:"+VD+"|"+VN+"|\x3c!---?>|\x3c!--(?:[^-]|-[^-]|--[^>])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Za-z][^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),VP=RegExp("^(?:"+VD+"|"+VN+")"),Vj=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[RegExp("^</?(address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?=(\\s|/?>|$))","i"),/^$/,!0],[RegExp(VP.source+"\\s*$"),/^$/,!1]],VI=[["table",function(e,t,n,r){if(t+2>n)return!1;let i=t+1;if(e.sCount[i]<e.blkIndent||e.sCount[i]-e.blkIndent>=4)return!1;let o=e.bMarks[i]+e.tShift[i];if(o>=e.eMarks[i])return!1;let s=e.src.charCodeAt(o++);if(124!==s&&45!==s&&58!==s||o>=e.eMarks[i])return!1;let a=e.src.charCodeAt(o++);if(124!==a&&45!==a&&58!==a&&!Vn(a)||45===s&&Vn(a))return!1;for(;o<e.eMarks[i];){let t=e.src.charCodeAt(o);if(124!==t&&45!==t&&58!==t&&!Vn(t))return!1;o++}let l=VA(e,t+1),c=l.split("|"),h=[];for(let e=0;e<c.length;e++){let t=c[e].trim();if(!t){if(0===e||e===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(t))return!1;58===t.charCodeAt(t.length-1)?h.push(58===t.charCodeAt(0)?"center":"right"):58===t.charCodeAt(0)?h.push("left"):h.push("")}if(-1===(l=VA(e,t).trim()).indexOf("|")||e.sCount[t]-e.blkIndent>=4)return!1;(c=VE(l)).length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop();let u=c.length;if(0===u||u!==h.length)return!1;if(r)return!0;let d=e.parentType;e.parentType="table";let f=e.md.block.ruler.getRules("blockquote"),p=e.push("table_open","table",1),m=[t,0];p.map=m,e.push("thead_open","thead",1).map=[t,t+1],e.push("tr_open","tr",1).map=[t,t+1];for(let t=0;t<c.length;t++){let n=e.push("th_open","th",1);h[t]&&(n.attrs=[["style","text-align:"+h[t]]]);let r=e.push("inline","",0);r.content=c[t].trim(),r.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let g,y=0;for(i=t+2;i<n&&!(e.sCount[i]<e.blkIndent);i++){let r=!1;for(let t=0,o=f.length;t<o;t++)if(f[t](e,i,n,!0)){r=!0;break}if(r||!(l=VA(e,i).trim())||e.sCount[i]-e.blkIndent>=4||((c=VE(l)).length&&""===c[0]&&c.shift(),c.length&&""===c[c.length-1]&&c.pop(),(y+=u-c.length)>65536))break;i===t+2&&(e.push("tbody_open","tbody",1).map=g=[t+2,0]),e.push("tr_open","tr",1).map=[i,i+1];for(let t=0;t<u;t++){let n=e.push("td_open","td",1);h[t]&&(n.attrs=[["style","text-align:"+h[t]]]);let r=e.push("inline","",0);r.content=c[t]?c[t].trim():"",r.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return g&&(e.push("tbody_close","tbody",-1),g[1]=i),e.push("table_close","table",-1),m[1]=i,e.parentType=d,e.line=i,!0},["paragraph","reference"]],["code",function(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,i=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){i=++r;continue}break}e.line=i;let o=e.push("code_block","code",0);return o.content=e.getLines(t,i,4+e.blkIndent,!1)+`
`,o.map=[t,e.line],!0}],["fence",function(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||i+3>o)return!1;let s=e.src.charCodeAt(i);if(126!==s&&96!==s)return!1;let a=i,l=(i=e.skipChars(i,s))-a;if(l<3)return!1;let c=e.src.slice(a,i),h=e.src.slice(i,o);if(96===s&&h.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let u=t,d=!1;for(;!(++u>=n||(i=a=e.bMarks[u]+e.tShift[u])<(o=e.eMarks[u])&&e.sCount[u]<e.blkIndent);)if(e.src.charCodeAt(i)===s&&!(e.sCount[u]-e.blkIndent>=4)&&!((i=e.skipChars(i,s))-a<l)&&!((i=e.skipSpaces(i))<o)){d=!0;break}l=e.sCount[t],e.line=u+(d?1:0);let f=e.push("fence","code",0);return f.info=h,f.content=e.getLines(t+1,u,l,!0),f.markup=c,f.map=[t,e.line],!0},["paragraph","reference","blockquote","list"]],["blockquote",function(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t],s=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||62!==e.src.charCodeAt(i))return!1;if(r)return!0;let a=[],l=[],c=[],h=[],u=e.md.block.ruler.getRules("blockquote"),d=e.parentType;e.parentType="blockquote";let f=!1,p;for(p=t;p<n;p++){let t=e.sCount[p]<e.blkIndent;if((i=e.bMarks[p]+e.tShift[p])>=(o=e.eMarks[p]))break;if(62===e.src.charCodeAt(i++)&&!t){let t=e.sCount[p]+1,n,r;32===e.src.charCodeAt(i)?(i++,t++,r=!1,n=!0):9===e.src.charCodeAt(i)?(n=!0,(e.bsCount[p]+t)%4==3?(i++,t++,r=!1):r=!0):n=!1;let s=t;for(a.push(e.bMarks[p]),e.bMarks[p]=i;i<o;){let t=e.src.charCodeAt(i);if(Vn(t))9===t?s+=4-(s+e.bsCount[p]+(r?1:0))%4:s++;else break;i++}f=i>=o,l.push(e.bsCount[p]),e.bsCount[p]=e.sCount[p]+1+(n?1:0),c.push(e.sCount[p]),e.sCount[p]=s-t,h.push(e.tShift[p]),e.tShift[p]=i-e.bMarks[p];continue}if(f)break;let r=!1;for(let t=0,i=u.length;t<i;t++)if(u[t](e,p,n,!0)){r=!0;break}if(r){e.lineMax=p,0!==e.blkIndent&&(a.push(e.bMarks[p]),l.push(e.bsCount[p]),h.push(e.tShift[p]),c.push(e.sCount[p]),e.sCount[p]-=e.blkIndent);break}a.push(e.bMarks[p]),l.push(e.bsCount[p]),h.push(e.tShift[p]),c.push(e.sCount[p]),e.sCount[p]=-1}let m=e.blkIndent;e.blkIndent=0;let g=e.push("blockquote_open","blockquote",1);g.markup=">";let y=[t,0];g.map=y,e.md.block.tokenize(e,t,p),e.push("blockquote_close","blockquote",-1).markup=">",e.lineMax=s,e.parentType=d,y[1]=e.line;for(let n=0;n<h.length;n++)e.bMarks[n+t]=a[n],e.tShift[n+t]=h[n],e.sCount[n+t]=c[n],e.bsCount[n+t]=l[n];return e.blkIndent=m,!0},["paragraph","reference","blockquote","list"]],["hr",function(e,t,n,r){let i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let o=e.bMarks[t]+e.tShift[t],s=e.src.charCodeAt(o++);if(42!==s&&45!==s&&95!==s)return!1;let a=1;for(;o<i;){let t=e.src.charCodeAt(o++);if(t!==s&&!Vn(t))return!1;t===s&&a++}if(a<3)return!1;if(r)return!0;e.line=t+1;let l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(a+1).join(String.fromCharCode(s)),!0},["paragraph","reference","blockquote","list"]],["list",function(e,t,n,r){let i,o,s,a,l,c,h,u=t,d=!0;if(e.sCount[u]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[u]-e.listIndent>=4&&e.sCount[u]<e.blkIndent)return!1;let f=!1;if(r&&"paragraph"===e.parentType&&e.sCount[u]>=e.blkIndent&&(f=!0),(s=V_(e,u))>=0){if(i=!0,c=e.bMarks[u]+e.tShift[u],o=Number(e.src.slice(c,s-1)),f&&1!==o)return!1}else{if(!((s=VM(e,u))>=0))return!1;i=!1}if(f&&e.skipSpaces(s)>=e.eMarks[u])return!1;if(r)return!0;let p=e.src.charCodeAt(s-1),m=e.tokens.length;i?(h=e.push("ordered_list_open","ol",1),1!==o&&(h.attrs=[["start",o]])):h=e.push("bullet_list_open","ul",1);let g=[u,0];h.map=g,h.markup=String.fromCharCode(p);let y=!1,b=e.md.block.ruler.getRules("list"),v=e.parentType;for(e.parentType="list";u<n;){let t;l=s,a=e.eMarks[u];let r=e.sCount[u]+s-(e.bMarks[u]+e.tShift[u]),o=r;for(;l<a;){let t=e.src.charCodeAt(l);if(9===t)o+=4-(o+e.bsCount[u])%4;else if(32===t)o++;else break;l++}let f=l;(t=f>=a?1:o-r)>4&&(t=1);let m=r+t;(h=e.push("list_item_open","li",1)).markup=String.fromCharCode(p);let g=[u,0];h.map=g,i&&(h.info=e.src.slice(c,s-1));let v=e.tight,x=e.tShift[u],w=e.sCount[u],k=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=m,e.tight=!0,e.tShift[u]=f-e.bMarks[u],e.sCount[u]=o,f>=a&&e.isEmpty(u+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,u,n,!0),(!e.tight||y)&&(d=!1),y=e.line-u>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=k,e.tShift[u]=x,e.sCount[u]=w,e.tight=v,(h=e.push("list_item_close","li",-1)).markup=String.fromCharCode(p),u=e.line,g[1]=u,u>=n||e.sCount[u]<e.blkIndent||e.sCount[u]-e.blkIndent>=4)break;let O=!1;for(let t=0,r=b.length;t<r;t++)if(b[t](e,u,n,!0)){O=!0;break}if(O)break;if(i){if((s=V_(e,u))<0)break;c=e.bMarks[u]+e.tShift[u]}else if((s=VM(e,u))<0)break;if(p!==e.src.charCodeAt(s-1))break}return(h=i?e.push("ordered_list_close","ol",-1):e.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(p),g[1]=u,e.line=u,e.parentType=v,d&&function(e,t){let n=e.level+2;for(let r=t+2,i=e.tokens.length-2;r<i;r++)e.tokens[r].level===n&&"paragraph_open"===e.tokens[r].type&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}(e,m),!0},["paragraph","reference","blockquote"]],["reference",function(e,t,n,r){let i,o=e.bMarks[t]+e.tShift[t],s=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||91!==e.src.charCodeAt(o))return!1;function l(t){let n=e.lineMax;if(t>=n||e.isEmpty(t))return null;let r=!1;if(e.sCount[t]-e.blkIndent>3&&(r=!0),e.sCount[t]<0&&(r=!0),!r){let r=e.md.block.ruler.getRules("reference"),i=e.parentType;e.parentType="reference";let o=!1;for(let i=0,s=r.length;i<s;i++)if(r[i](e,t,n,!0)){o=!0;break}if(e.parentType=i,o)return null}let i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];return e.src.slice(i,o+1)}let c=e.src.slice(o,s+1);s=c.length;let h=-1;for(o=1;o<s;o++){let e=c.charCodeAt(o);if(91===e)return!1;if(93===e){h=o;break}if(10===e){let e=l(a);null!==e&&(c+=e,s=c.length,a++)}else if(92===e&&++o<s&&10===c.charCodeAt(o)){let e=l(a);null!==e&&(c+=e,s=c.length,a++)}}if(h<0||58!==c.charCodeAt(h+1))return!1;for(o=h+2;o<s;o++){let e=c.charCodeAt(o);if(10===e){let e=l(a);null!==e&&(c+=e,s=c.length,a++)}else if(!Vn(e))break}let u=e.md.helpers.parseLinkDestination(c,o,s);if(!u.ok)return!1;let d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;let f=o=u.pos,p=a,m=o;for(;o<s;o++){let e=c.charCodeAt(o);if(10===e){let e=l(a);null!==e&&(c+=e,s=c.length,a++)}else if(!Vn(e))break}let g=e.md.helpers.parseLinkTitle(c,o,s);for(;g.can_continue;){let t=l(a);if(null===t)break;c+=t,o=s,s=c.length,a++,g=e.md.helpers.parseLinkTitle(c,o,s,g)}for(o<s&&m!==o&&g.ok?(i=g.str,o=g.pos):(i="",o=f,a=p);o<s&&Vn(c.charCodeAt(o));)o++;if(o<s&&10!==c.charCodeAt(o)&&i)for(i="",o=f,a=p;o<s&&Vn(c.charCodeAt(o));)o++;if(o<s&&10!==c.charCodeAt(o))return!1;let y=Vs(c.slice(1,h));return!!y&&(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[y]>"u"&&(e.env.references[y]={title:i,href:d}),e.line=a),!0)}],["html_block",function(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||60!==e.src.charCodeAt(i))return!1;let s=e.src.slice(i,o),a=0;for(;a<Vj.length&&!Vj[a][0].test(s);a++);if(a===Vj.length)return!1;if(r)return Vj[a][2];let l=t+1;if(!Vj[a][1].test(s)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(i=e.bMarks[l]+e.tShift[l],o=e.eMarks[l],s=e.src.slice(i,o),Vj[a][1].test(s)){0!==s.length&&l++;break}}e.line=l;let c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0},["paragraph","reference","blockquote"]],["heading",function(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let s=e.src.charCodeAt(i);if(35!==s||i>=o)return!1;let a=1;for(s=e.src.charCodeAt(++i);35===s&&i<o&&a<=6;)a++,s=e.src.charCodeAt(++i);if(a>6||i<o&&!Vn(s))return!1;if(r)return!0;o=e.skipSpacesBack(o,i);let l=e.skipCharsBack(o,35,i);l>i&&Vn(e.src.charCodeAt(l-1))&&(o=l),e.line=t+1;let c=e.push("heading_open","h"+String(a),1);c.markup="########".slice(0,a),c.map=[t,e.line];let h=e.push("inline","",0);return h.content=e.src.slice(i,o).trim(),h.map=[t,e.line],h.children=[],e.push("heading_close","h"+String(a),-1).markup="########".slice(0,a),!0},["paragraph","reference","blockquote"]],["lheading",function(e,t,n){let r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.parentType;e.parentType="paragraph";let o=0,s,a=t+1;for(;a<n&&!e.isEmpty(a);a++){if(e.sCount[a]-e.blkIndent>3)continue;if(e.sCount[a]>=e.blkIndent){let t=e.bMarks[a]+e.tShift[a],n=e.eMarks[a];if(t<n&&(45===(s=e.src.charCodeAt(t))||61===s)&&(t=e.skipChars(t,s),(t=e.skipSpaces(t))>=n)){o=61===s?1:2;break}}if(e.sCount[a]<0)continue;let t=!1;for(let i=0,o=r.length;i<o;i++)if(r[i](e,a,n,!0)){t=!0;break}if(t)break}if(!o)return!1;let l=e.getLines(t,a,e.blkIndent,!1).trim();e.line=a+1;let c=e.push("heading_open","h"+String(o),1);c.markup=String.fromCharCode(s),c.map=[t,e.line];let h=e.push("inline","",0);return h.content=l,h.map=[t,e.line-1],h.children=[],e.push("heading_close","h"+String(o),-1).markup=String.fromCharCode(s),e.parentType=i,!0}],["paragraph",function(e,t,n){let r=e.md.block.ruler.getRules("paragraph"),i=e.parentType,o=t+1;for(e.parentType="paragraph";o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3||e.sCount[o]<0)continue;let t=!1;for(let i=0,s=r.length;i<s;i++)if(r[i](e,o,n,!0)){t=!0;break}if(t)break}let s=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o,e.push("paragraph_open","p",1).map=[t,e.line];let a=e.push("inline","",0);return a.content=s,a.map=[t,e.line],a.children=[],e.push("paragraph_close","p",-1),e.parentType=i,!0}]];function V$(){this.ruler=new Vu;for(let e=0;e<VI.length;e++)this.ruler.push(VI[e][0],VI[e][1],{alt:(VI[e][2]||[]).slice()})}function VL(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}V$.prototype.tokenize=function(e,t,n){let r=this.ruler.getRules(""),i=r.length,o=e.md.options.maxNesting,s=t,a=!1;for(;s<n&&(e.line=s=e.skipEmptyLines(s),!(s>=n||e.sCount[s]<e.blkIndent));){if(e.level>=o){e.line=n;break}let t=e.line,l=!1;for(let o=0;o<i;o++)if(l=r[o](e,s,n,!1)){if(t>=e.line)throw Error("block rule didn't increment state.line");break}if(!l)throw Error("none of the block rules matched");e.tight=!a,e.isEmpty(e.line-1)&&(a=!0),(s=e.line)<n&&e.isEmpty(s)&&(a=!0,s++,e.line=s)}},V$.prototype.parse=function(e,t,n,r){if(!e)return;let i=new this.State(e,t,n,r);this.tokenize(i,i.line,i.lineMax)},V$.prototype.State=VT,VL.prototype.pushPending=function(){let e=new Vd("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e},VL.prototype.push=function(e,t,n){this.pending&&this.pushPending();let r=new Vd(e,t,n),i=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(i),r},VL.prototype.scanDelims=function(e,t){let n=this.posMax,r=this.src.charCodeAt(e),i=e>0?this.src.charCodeAt(e-1):32,o=e;for(;o<n&&this.src.charCodeAt(o)===r;)o++;let s=o-e,a=o<n?this.src.charCodeAt(o):32,l=Vo(i)||Vi(String.fromCharCode(i)),c=Vo(a)||Vi(String.fromCharCode(a)),h=Vr(i),u=Vr(a),d=!u&&(!c||h||l),f=!h&&(!l||u||c);return{can_open:d&&(t||!f||l),can_close:f&&(t||!d||c),length:s}},VL.prototype.Token=Vd;let Vq=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i,Vz=[];for(let e=0;e<256;e++)Vz.push(0);function VB(e,t){let n;let r=[],i=t.length;for(let o=0;o<i;o++){let i=t[o];if(126!==i.marker||-1===i.end)continue;let s=t[i.end];(n=e.tokens[i.token]).type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",(n=e.tokens[s.token]).type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="","text"===e.tokens[s.token-1].type&&"~"===e.tokens[s.token-1].content&&r.push(s.token-1)}for(;r.length;){let t=r.pop(),i=t+1;for(;i<e.tokens.length&&"s_close"===e.tokens[i].type;)i++;t!==--i&&(n=e.tokens[i],e.tokens[i]=e.tokens[t],e.tokens[t]=n)}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){Vz[e.charCodeAt(0)]=1});let VF={tokenize:function(e,t){let n=e.pos,r=e.src.charCodeAt(n);if(t||126!==r)return!1;let i=e.scanDelims(e.pos,!0),o=i.length,s=String.fromCharCode(r);if(o<2)return!1;o%2&&(e.push("text","",0).content=s,o--);for(let t=0;t<o;t+=2)e.push("text","",0).content=s+s,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return e.pos+=i.length,!0},postProcess:function(e){let t=e.tokens_meta,n=e.tokens_meta.length;VB(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&VB(e,t[r].delimiters)}};function VQ(e,t){let n=t.length;for(let r=n-1;r>=0;r--){let n=t[r];if(95!==n.marker&&42!==n.marker||-1===n.end)continue;let i=t[n.end],o=r>0&&t[r-1].end===n.end+1&&t[r-1].marker===n.marker&&t[r-1].token===n.token-1&&t[n.end+1].token===i.token+1,s=String.fromCharCode(n.marker),a=e.tokens[n.token];a.type=o?"strong_open":"em_open",a.tag=o?"strong":"em",a.nesting=1,a.markup=o?s+s:s,a.content="";let l=e.tokens[i.token];l.type=o?"strong_close":"em_close",l.tag=o?"strong":"em",l.nesting=-1,l.markup=o?s+s:s,l.content="",o&&(e.tokens[t[r-1].token].content="",e.tokens[t[n.end+1].token].content="",r--)}}let VV={tokenize:function(e,t){let n=e.pos,r=e.src.charCodeAt(n);if(t||95!==r&&42!==r)return!1;let i=e.scanDelims(e.pos,42===r);for(let t=0;t<i.length;t++)e.push("text","",0).content=String.fromCharCode(r),e.delimiters.push({marker:r,length:i.length,token:e.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return e.pos+=i.length,!0},postProcess:function(e){let t=e.tokens_meta,n=e.tokens_meta.length;VQ(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&VQ(e,t[r].delimiters)}},VW=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,VU=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/,VH=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,VG=/^&([a-z][a-z0-9]{1,31});/i;function VX(e){let t={},n=e.length;if(!n)return;let r=0,i=-2,o=[];for(let s=0;s<n;s++){let n=e[s];if(o.push(0),(e[r].marker!==n.marker||i!==n.token-1)&&(r=s),i=n.token,n.length=n.length||0,!n.close)continue;t.hasOwnProperty(n.marker)||(t[n.marker]=[-1,-1,-1,-1,-1,-1]);let a=t[n.marker][(n.open?3:0)+n.length%3],l=r-o[r]-1,c=l;for(;l>a;l-=o[l]+1){let t=e[l];if(t.marker===n.marker&&t.open&&t.end<0){let r=!1;if((t.close||n.open)&&(t.length+n.length)%3==0&&(t.length%3!=0||n.length%3!=0)&&(r=!0),!r){let r=l>0&&!e[l-1].open?o[l-1]+1:0;o[s]=s-l+r,o[l]=r,n.open=!1,t.end=s,t.close=!1,c=-1,i=-2;break}}}-1!==c&&(t[n.marker][(n.open?3:0)+(n.length||0)%3]=c)}}let VZ=[["text",function(e,t){let n=e.pos;for(;n<e.posMax&&!function(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}(e.src.charCodeAt(n));)n++;return n!==e.pos&&(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}],["linkify",function(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;let n=e.pos;if(n+3>e.posMax||58!==e.src.charCodeAt(n)||47!==e.src.charCodeAt(n+1)||47!==e.src.charCodeAt(n+2))return!1;let r=e.pending.match(Vq);if(!r)return!1;let i=r[1],o=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!o)return!1;let s=o.url;if(s.length<=i.length)return!1;s=s.replace(/\*+$/,"");let a=e.md.normalizeLink(s);if(!e.md.validateLink(a))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);let t=e.push("link_open","a",1);t.attrs=[["href",a]],t.markup="linkify",t.info="auto",e.push("text","",0).content=e.md.normalizeLinkText(s);let n=e.push("link_close","a",-1);n.markup="linkify",n.info="auto"}return e.pos+=s.length-i.length,!0}],["newline",function(e,t){let n=e.pos;if(10!==e.src.charCodeAt(n))return!1;let r=e.pending.length-1,i=e.posMax;if(!t){if(r>=0&&32===e.pending.charCodeAt(r)){if(r>=1&&32===e.pending.charCodeAt(r-1)){let t=r-1;for(;t>=1&&32===e.pending.charCodeAt(t-1);)t--;e.pending=e.pending.slice(0,t),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0)}else e.push("softbreak","br",0)}for(n++;n<i&&Vn(e.src.charCodeAt(n));)n++;return e.pos=n,!0}],["escape",function(e,t){let n=e.pos,r=e.posMax;if(92!==e.src.charCodeAt(n)||++n>=r)return!1;let i=e.src.charCodeAt(n);if(10===i){for(t||e.push("hardbreak","br",0),n++;n<r&&Vn(i=e.src.charCodeAt(n));)n++;return e.pos=n,!0}let o=e.src[n];if(i>=55296&&i<=56319&&n+1<r){let t=e.src.charCodeAt(n+1);t>=56320&&t<=57343&&(o+=e.src[n+1],n++)}let s="\\"+o;if(!t){let t=e.push("text_special","",0);i<256&&0!==Vz[i]?t.content=o:t.content=s,t.markup=s,t.info="escape"}return e.pos=n+1,!0}],["backticks",function(e,t){let n=e.pos;if(96!==e.src.charCodeAt(n))return!1;let r=n;n++;let i=e.posMax;for(;n<i&&96===e.src.charCodeAt(n);)n++;let o=e.src.slice(r,n),s=o.length;if(e.backticksScanned&&(e.backticks[s]||0)<=r)return t||(e.pending+=o),e.pos+=s,!0;let a=n,l;for(;-1!==(l=e.src.indexOf("`",a));){for(a=l+1;a<i&&96===e.src.charCodeAt(a);)a++;let r=a-l;if(r===s){if(!t){let t=e.push("code_inline","code",0);t.markup=o,t.content=e.src.slice(n,l).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=a,!0}e.backticks[r]=l}return e.backticksScanned=!0,t||(e.pending+=o),e.pos+=s,!0}],["strikethrough",VF.tokenize],["emphasis",VV.tokenize],["link",function(e,t){let n,r,i,o,s="",a="",l=e.pos,c=!0;if(91!==e.src.charCodeAt(e.pos))return!1;let h=e.pos,u=e.posMax,d=e.pos+1,f=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(f<0)return!1;let p=f+1;if(p<u&&40===e.src.charCodeAt(p)){for(c=!1,p++;p<u&&!(!Vn(n=e.src.charCodeAt(p))&&10!==n);p++);if(p>=u)return!1;if(l=p,(i=e.md.helpers.parseLinkDestination(e.src,p,e.posMax)).ok){for(s=e.md.normalizeLink(i.str),e.md.validateLink(s)?p=i.pos:s="",l=p;p<u&&!(!Vn(n=e.src.charCodeAt(p))&&10!==n);p++);if(i=e.md.helpers.parseLinkTitle(e.src,p,e.posMax),p<u&&l!==p&&i.ok)for(a=i.str,p=i.pos;p<u&&!(!Vn(n=e.src.charCodeAt(p))&&10!==n);p++);}(p>=u||41!==e.src.charCodeAt(p))&&(c=!0),p++}if(c){if(typeof e.env.references>"u")return!1;if(p<u&&91===e.src.charCodeAt(p)?(l=p+1,(p=e.md.helpers.parseLinkLabel(e,p))>=0?r=e.src.slice(l,p++):p=f+1):p=f+1,r||(r=e.src.slice(d,f)),!(o=e.env.references[Vs(r)]))return e.pos=h,!1;s=o.href,a=o.title}if(!t){e.pos=d,e.posMax=f;let t=e.push("link_open","a",1),n=[["href",s]];t.attrs=n,a&&n.push(["title",a]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=p,e.posMax=u,!0}],["image",function(e,t){let n,r,i,o,s,a,l,c,h="",u=e.pos,d=e.posMax;if(33!==e.src.charCodeAt(e.pos)||91!==e.src.charCodeAt(e.pos+1))return!1;let f=e.pos+2,p=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(p<0)return!1;if((o=p+1)<d&&40===e.src.charCodeAt(o)){for(o++;o<d&&!(!Vn(n=e.src.charCodeAt(o))&&10!==n);o++);if(o>=d)return!1;for(c=o,(a=e.md.helpers.parseLinkDestination(e.src,o,e.posMax)).ok&&(h=e.md.normalizeLink(a.str),e.md.validateLink(h)?o=a.pos:h=""),c=o;o<d&&!(!Vn(n=e.src.charCodeAt(o))&&10!==n);o++);if(a=e.md.helpers.parseLinkTitle(e.src,o,e.posMax),o<d&&c!==o&&a.ok)for(l=a.str,o=a.pos;o<d&&!(!Vn(n=e.src.charCodeAt(o))&&10!==n);o++);else l="";if(o>=d||41!==e.src.charCodeAt(o))return e.pos=u,!1;o++}else{if(typeof e.env.references>"u")return!1;if(o<d&&91===e.src.charCodeAt(o)?(c=o+1,(o=e.md.helpers.parseLinkLabel(e,o))>=0?i=e.src.slice(c,o++):o=p+1):o=p+1,i||(i=e.src.slice(f,p)),!(s=e.env.references[Vs(i)]))return e.pos=u,!1;h=s.href,l=s.title}if(!t){r=e.src.slice(f,p);let t=[];e.md.inline.parse(r,e.md,e.env,t);let n=e.push("image","img",0),i=[["src",h],["alt",""]];n.attrs=i,n.children=t,n.content=r,l&&i.push(["title",l])}return e.pos=o,e.posMax=d,!0}],["autolink",function(e,t){let n=e.pos;if(60!==e.src.charCodeAt(n))return!1;let r=e.pos,i=e.posMax;for(;;){if(++n>=i)return!1;let t=e.src.charCodeAt(n);if(60===t)return!1;if(62===t)break}let o=e.src.slice(r+1,n);if(VU.test(o)){let n=e.md.normalizeLink(o);if(!e.md.validateLink(n))return!1;if(!t){let t=e.push("link_open","a",1);t.attrs=[["href",n]],t.markup="autolink",t.info="auto",e.push("text","",0).content=e.md.normalizeLinkText(o);let r=e.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return e.pos+=o.length+2,!0}if(VW.test(o)){let n=e.md.normalizeLink("mailto:"+o);if(!e.md.validateLink(n))return!1;if(!t){let t=e.push("link_open","a",1);t.attrs=[["href",n]],t.markup="autolink",t.info="auto",e.push("text","",0).content=e.md.normalizeLinkText(o);let r=e.push("link_close","a",-1);r.markup="autolink",r.info="auto"}return e.pos+=o.length+2,!0}return!1}],["html_inline",function(e,t){if(!e.md.options.html)return!1;let n=e.posMax,r=e.pos;if(60!==e.src.charCodeAt(r)||r+2>=n)return!1;let i=e.src.charCodeAt(r+1);if(33!==i&&63!==i&&47!==i&&!function(e){let t=32|e;return t>=97&&t<=122}(i))return!1;let o=e.src.slice(r).match(VR);if(!o)return!1;if(!t){var s,a;let t=e.push("html_inline","",0);t.content=o[0],s=t.content,/^<a[>\s]/i.test(s)&&e.linkLevel++,a=t.content,/^<\/a\s*>/i.test(a)&&e.linkLevel--}return e.pos+=o[0].length,!0}],["entity",function(e,t){let n=e.pos,r=e.posMax;if(38!==e.src.charCodeAt(n)||n+1>=r)return!1;if(35===e.src.charCodeAt(n+1)){let r=e.src.slice(n).match(VH);if(r){if(!t){let t="x"===r[1][0].toLowerCase()?parseInt(r[1].slice(1),16):parseInt(r[1],10),n=e.push("text_special","",0);n.content=Q0(t)?Q1(t):Q1(65533),n.markup=r[0],n.info="entity"}return e.pos+=r[0].length,!0}}else{let r=e.src.slice(n).match(VG);if(r){let n=QX(r[0]);if(n!==r[0]){if(!t){let t=e.push("text_special","",0);t.content=n,t.markup=r[0],t.info="entity"}return e.pos+=r[0].length,!0}}}return!1}]],VY=[["balance_pairs",function(e){let t=e.tokens_meta,n=e.tokens_meta.length;VX(e.delimiters);for(let e=0;e<n;e++)t[e]&&t[e].delimiters&&VX(t[e].delimiters)}],["strikethrough",VF.postProcess],["emphasis",VV.postProcess],["fragments_join",function(e){let t,n,r=0,i=e.tokens,o=e.tokens.length;for(t=n=0;t<o;t++)i[t].nesting<0&&r--,i[t].level=r,i[t].nesting>0&&r++,"text"===i[t].type&&t+1<o&&"text"===i[t+1].type?i[t+1].content=i[t].content+i[t+1].content:(t!==n&&(i[n]=i[t]),n++);t!==n&&(i.length=n)}]];function VJ(){this.ruler=new Vu;for(let e=0;e<VZ.length;e++)this.ruler.push(VZ[e][0],VZ[e][1]);this.ruler2=new Vu;for(let e=0;e<VY.length;e++)this.ruler2.push(VY[e][0],VY[e][1])}function VK(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){t&&Object.keys(t).forEach(function(n){e[n]=t[n]})}),e}function V0(e){return Object.prototype.toString.call(e)}function V1(e){return"[object Function]"===V0(e)}function V2(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}VJ.prototype.skipToken=function(e){let t=e.pos,n=this.ruler.getRules(""),r=n.length,i=e.md.options.maxNesting,o=e.cache;if("u">typeof o[t]){e.pos=o[t];return}let s=!1;if(e.level<i){for(let i=0;i<r;i++)if(e.level++,s=n[i](e,!0),e.level--,s){if(t>=e.pos)throw Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;s||e.pos++,o[t]=e.pos},VJ.prototype.tokenize=function(e){let t=this.ruler.getRules(""),n=t.length,r=e.posMax,i=e.md.options.maxNesting;for(;e.pos<r;){let o=e.pos,s=!1;if(e.level<i){for(let r=0;r<n;r++)if(s=t[r](e,!1)){if(o>=e.pos)throw Error("inline rule didn't increment state.pos");break}}if(s){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},VJ.prototype.parse=function(e,t,n,r){let i=new this.State(e,t,n,r);this.tokenize(i);let o=this.ruler2.getRules(""),s=o.length;for(let e=0;e<s;e++)o[e](i)},VJ.prototype.State=VL;let V5={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1},V3={"http:":{validate:function(e,t,n){let r=e.slice(t);return n.re.http||(n.re.http=RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){let r=e.slice(t);return n.re.no_http||(n.re.no_http=RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&":"===e[t-3]||t>=3&&"/"===e[t-3]?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){let r=e.slice(t);return n.re.mailto||(n.re.mailto=RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},V4="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function V6(){return function(e,t){t.normalize(e)}}function V8(e){let t=e.re=function(e){let t={};e=e||{},t.src_Any=Qj.source,t.src_Cc=QI.source,t.src_Z=Qq.source,t.src_P=Q$.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");let n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+"|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}(e.__opts__),n=e.__tlds__.slice();function r(e){return e.replace("%TLDS%",t.src_tlds)}e.onCompile(),e.__tlds_replaced__||n.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),n.push(t.src_xn),t.src_tlds=n.join("|"),t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");let i=[];function o(e,t){throw Error('(LinkifyIt) Invalid schema "'+e+'": '+t)}e.__compiled__={},Object.keys(e.__schemas__).forEach(function(t){let n=e.__schemas__[t];if(null===n)return;let r={validate:null,link:null};if(e.__compiled__[t]=r,"[object Object]"===V0(n)){var s;"[object RegExp]"===V0(n.validate)?r.validate=(s=n.validate,function(e,t){let n=e.slice(t);return s.test(n)?n.match(s)[0].length:0}):V1(n.validate)?r.validate=n.validate:o(t,n),V1(n.normalize)?r.normalize=n.normalize:n.normalize?o(t,n):r.normalize=V6();return}if("[object String]"===V0(n)){i.push(t);return}o(t,n)}),i.forEach(function(t){e.__compiled__[e.__schemas__[t]]&&(e.__compiled__[t].validate=e.__compiled__[e.__schemas__[t]].validate,e.__compiled__[t].normalize=e.__compiled__[e.__schemas__[t]].normalize)}),e.__compiled__[""]={validate:null,normalize:V6()};let s=Object.keys(e.__compiled__).filter(function(t){return t.length>0&&e.__compiled__[t]}).map(V2).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+s+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+s+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),e.__index__=-1,e.__text_cache__=""}function V9(e,t){let n=e.__index__,r=e.__last_index__,i=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=i,this.text=i,this.url=i}function V7(e,t){let n=new V9(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function We(e,t){if(!(this instanceof We))return new We(e,t);t||Object.keys(e||{}).reduce(function(e,t){return e||V5.hasOwnProperty(t)},!1)&&(t=e,e={}),this.__opts__=VK({},V5,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=VK({},V3,e),this.__compiled__={},this.__tlds__=V4,this.__tlds_replaced__=!1,this.re={},V8(this)}We.prototype.add=function(e,t){return this.__schemas__[e]=t,V8(this),this},We.prototype.set=function(e){return this.__opts__=VK(this.__opts__,e),this},We.prototype.test=function(e){let t,n,r,i,o,s,a,l;if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;if(this.re.schema_test.test(e)){for((a=this.re.schema_search).lastIndex=0;null!==(t=a.exec(e));)if(i=this.testSchemaAt(e,t[2],a.lastIndex)){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(o=n.index+n[1].length,(this.__index__<0||o<this.__index__)&&(this.__schema__="",this.__index__=o,this.__last_index__=n.index+n[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&e.indexOf("@")>=0&&null!==(r=e.match(this.re.email_fuzzy))&&(o=r.index+r[1].length,s=r.index+r[0].length,(this.__index__<0||o<this.__index__||o===this.__index__&&s>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=o,this.__last_index__=s)),this.__index__>=0},We.prototype.pretest=function(e){return this.re.pretest.test(e)},We.prototype.testSchemaAt=function(e,t,n){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,n,this):0},We.prototype.match=function(e){let t=[],n=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(V7(this,n)),n=this.__last_index__);let r=n?e.slice(n):e;for(;this.test(r);)t.push(V7(this,n)),r=r.slice(this.__last_index__),n+=this.__last_index__;return t.length?t:null},We.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;let t=this.re.schema_at_start.exec(e);if(!t)return null;let n=this.testSchemaAt(e,t[2],t[0].length);return n?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+n,V7(this,0)):null},We.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?this.__tlds__=this.__tlds__.concat(e).sort().filter(function(e,t,n){return e!==n[t-1]}).reverse():(this.__tlds__=e.slice(),this.__tlds_replaced__=!0),V8(this),this},We.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),"mailto:"!==e.schema||/^mailto:/i.test(e.url)||(e.url="mailto:"+e.url)},We.prototype.onCompile=function(){};let Wt=/^xn--/,Wn=/[^\0-\x7F]/,Wr=/[\x2E\u3002\uFF0E\uFF61]/g,Wi={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Wo=Math.floor,Ws=String.fromCharCode;function Wa(e){throw RangeError(Wi[e])}function Wl(e,t){let n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+(function(e,t){let n=[],r=e.length;for(;r--;)n[r]=t(e[r]);return n})((e=e.replace(Wr,".")).split("."),t).join(".")}let Wc=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},Wh=function(e,t,n){let r=0;for(e=n?Wo(e/700):e>>1,e+=Wo(e/t);e>455;r+=36)e=Wo(e/35);return Wo(r+36*e/(e+38))},Wu=function(e){let t=[],n=e.length,r=0,i=128,o=72,s=e.lastIndexOf("-");s<0&&(s=0);for(let n=0;n<s;++n)e.charCodeAt(n)>=128&&Wa("not-basic"),t.push(e.charCodeAt(n));for(let l=s>0?s+1:0;l<n;){let s=r;for(let t=1,i=36;;i+=36){var a;l>=n&&Wa("invalid-input");let s=(a=e.charCodeAt(l++))>=48&&a<58?26+(a-48):a>=65&&a<91?a-65:a>=97&&a<123?a-97:36;s>=36&&Wa("invalid-input"),s>Wo((0x7fffffff-r)/t)&&Wa("overflow"),r+=s*t;let c=i<=o?1:i>=o+26?26:i-o;if(s<c)break;let h=36-c;t>Wo(0x7fffffff/h)&&Wa("overflow"),t*=h}let c=t.length+1;o=Wh(r-s,c,0==s),Wo(r/c)>0x7fffffff-i&&Wa("overflow"),i+=Wo(r/c),r%=c,t.splice(r++,0,i)}return String.fromCodePoint(...t)},Wd=function(e){let t=[],n=(e=function(e){let t=[],n=0,r=e.length;for(;n<r;){let i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){let r=e.charCodeAt(n++);(64512&r)==56320?t.push(((1023&i)<<10)+(1023&r)+65536):(t.push(i),n--)}else t.push(i)}return t}(e)).length,r=128,i=0,o=72;for(let n of e)n<128&&t.push(Ws(n));let s=t.length,a=s;for(s&&t.push("-");a<n;){let n=0x7fffffff;for(let t of e)t>=r&&t<n&&(n=t);let l=a+1;for(let c of(n-r>Wo((0x7fffffff-i)/l)&&Wa("overflow"),i+=(n-r)*l,r=n,e))if(c<r&&++i>0x7fffffff&&Wa("overflow"),c===r){let e=i;for(let n=36;;n+=36){let r=n<=o?1:n>=o+26?26:n-o;if(e<r)break;let i=e-r,s=36-r;t.push(Ws(Wc(r+i%s,0))),e=Wo(i/s)}t.push(Ws(Wc(e,0))),o=Wh(i,l,a===s),i=0,++a}++i,++r}return t.join("")},Wf={toASCII:function(e){return Wl(e,function(e){return Wn.test(e)?"xn--"+Wd(e):e})},toUnicode:function(e){return Wl(e,function(e){return Wt.test(e)?Wu(e.slice(4).toLowerCase()):e})}},Wp={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},zero:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}}},Wm=/^(vbscript|javascript|file|data):/,Wg=/^data:image\/(gif|png|jpeg|webp);/;function Wy(e){let t=e.trim().toLowerCase();return!Wm.test(t)||Wg.test(t)}let Wb=["http:","https:","mailto:"];function Wv(e){let t=QR(e,!0);if(t.hostname&&(!t.protocol||Wb.indexOf(t.protocol)>=0))try{t.hostname=Wf.toASCII(t.hostname)}catch{}return Qw(Qk(t))}function Wx(e){let t=QR(e,!0);if(t.hostname&&(!t.protocol||Wb.indexOf(t.protocol)>=0))try{t.hostname=Wf.toUnicode(t.hostname)}catch{}return Qv(Qk(t),Qv.defaultChars+"%")}function Ww(e,t){if(!(this instanceof Ww))return new Ww(e,t);t||QZ(e)||(t=e||{},e="default"),this.inline=new VJ,this.block=new V$,this.core=new VC,this.renderer=new Vh,this.linkify=new We,this.validateLink=Wy,this.normalizeLink=Wv,this.normalizeLinkText=Wx,this.utils=Va,this.helpers=QJ({},Vl),this.options={},this.configure(e),t&&this.set(t)}Ww.prototype.set=function(e){return QJ(this.options,e),this},Ww.prototype.configure=function(e){let t=this;if(QZ(e)){let t=e;if(!(e=Wp[t]))throw Error('Wrong `markdown-it` preset "'+t+'", check name')}if(!e)throw Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this},Ww.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(t){n=n.concat(this[t].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));let r=e.filter(function(e){return 0>n.indexOf(e)});if(r.length&&!t)throw Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this},Ww.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(t){n=n.concat(this[t].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));let r=e.filter(function(e){return 0>n.indexOf(e)});if(r.length&&!t)throw Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this},Ww.prototype.use=function(e){let t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this},Ww.prototype.parse=function(e,t){if("string"!=typeof e)throw Error("Input data should be a String");let n=new this.core.State(e,this,t);return this.core.process(n),n.tokens},Ww.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},Ww.prototype.parseInline=function(e,t){let n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens},Ww.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};let Wk=new jb({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",0]},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["div",["hr"]]},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:e=>["h"+e.attrs.level,0]},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>({params:e.getAttribute("data-params")||""})}],toDOM:e=>["pre",e.attrs.params?{"data-params":e.attrs.params}:{},["code",0]]},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?+e.getAttribute("start"):1,tight:e.hasAttribute("data-tight")})}],toDOM:e=>["ol",{start:1==e.attrs.order?null:e.attrs.order,"data-tight":e.attrs.tight?"true":null},0]},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:e=>({tight:e.hasAttribute("data-tight")})}],toDOM:e=>["ul",{"data-tight":e.attrs.tight?"true":null},0]},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM:()=>["li",0]},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt")})}],toDOM:e=>["img",e.attrs]},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:e=>"em"==e.type.name}],toDOM:()=>["em"]},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>"strong"==e.type.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>["strong"]},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title")})}],toDOM:e=>["a",e.attrs]},code:{parseDOM:[{tag:"code"}],toDOM:()=>["code"]}}});class WO{constructor(e,t){this.schema=e,this.tokenHandlers=t,this.stack=[{type:e.topNodeType,attrs:null,content:[],marks:PJ.none}]}top(){return this.stack[this.stack.length-1]}push(e){this.stack.length&&this.top().content.push(e)}addText(e){if(!e)return;let t=this.top(),n=t.content,r=n[n.length-1],i=this.schema.text(e,t.marks),o;r&&(o=function(e,t){if(e.isText&&t.isText&&PJ.sameSet(e.marks,t.marks))return e.withText(e.text+t.text)}(r,i))?n[n.length-1]=o:n.push(i)}openMark(e){let t=this.top();t.marks=e.addToSet(t.marks)}closeMark(e){let t=this.top();t.marks=e.removeFromSet(t.marks)}parseTokens(e){for(let t=0;t<e.length;t++){let n=e[t],r=this.tokenHandlers[n.type];if(!r)throw Error("Token type `"+n.type+"` not supported by Markdown parser");r(this,n,e,t)}}addNode(e,t,n){let r=this.top(),i=e.createAndFill(t,n,r?r.marks:[]);return i?(this.push(i),i):null}openNode(e,t){this.stack.push({type:e,attrs:t,content:[],marks:PJ.none})}closeNode(){let e=this.stack.pop();return this.addNode(e.type,e.attrs,e.content)}}function WS(e,t,n,r){return e.getAttrs?e.getAttrs(t,n,r):e.attrs instanceof Function?e.attrs(t):e.attrs}function WC(e,t){return e.noCloseToken||"code_inline"==t||"code_block"==t||"fence"==t}function WT(e){return e[e.length-1]==`
`?e.slice(0,e.length-1):e}function WA(){}function WE(e,t){for(;++t<e.length;)if("list_item_open"!=e[t].type)return e[t].hidden;return!1}new class{constructor(e,t,n){this.schema=e,this.tokenizer=t,this.tokens=n,this.tokenHandlers=function(e,t){let n=Object.create(null);for(let r in t){let i=t[r];if(i.block){let t=e.nodeType(i.block);WC(i,r)?n[r]=(e,n,r,o)=>{e.openNode(t,WS(i,n,r,o)),e.addText(WT(n.content)),e.closeNode()}:(n[r+"_open"]=(e,n,r,o)=>e.openNode(t,WS(i,n,r,o)),n[r+"_close"]=e=>e.closeNode())}else if(i.node){let t=e.nodeType(i.node);n[r]=(e,n,r,o)=>e.addNode(t,WS(i,n,r,o))}else if(i.mark){let t=e.marks[i.mark];WC(i,r)?n[r]=(e,n,r,o)=>{e.openMark(t.create(WS(i,n,r,o))),e.addText(WT(n.content)),e.closeMark(t)}:(n[r+"_open"]=(e,n,r,o)=>e.openMark(t.create(WS(i,n,r,o))),n[r+"_close"]=e=>e.closeMark(t))}else if(i.ignore)WC(i,r)?n[r]=WA:(n[r+"_open"]=WA,n[r+"_close"]=WA);else throw RangeError("Unrecognized parsing spec "+JSON.stringify(i))}return n.text=(e,t)=>e.addText(t.content),n.inline=(e,t)=>e.parseTokens(t.children),n.softbreak=n.softbreak||(e=>e.addText(" ")),n}(e,n)}parse(e,t={}){let n=new WO(this.schema,this.tokenHandlers),r;n.parseTokens(this.tokenizer.parse(e,t));do r=n.closeNode();while(n.stack.length);return r||this.schema.topNodeType.createAndFill()}}(Wk,Ww("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:(e,t,n)=>({tight:WE(t,n)})},ordered_list:{block:"ordered_list",getAttrs:(e,t,n)=>({order:+e.attrGet("start")||1,tight:WE(t,n)})},heading:{block:"heading",getAttrs:e=>({level:+e.tag.slice(1)})},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:e=>({params:e.info||""}),noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:e=>({src:e.attrGet("src"),title:e.attrGet("title")||null,alt:e.children[0]&&e.children[0].content||null})},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:e=>({href:e.attrGet("href"),title:e.attrGet("title")||null})},code_inline:{mark:"code",noCloseToken:!0}});let WM={open:"",close:"",mixable:!0},W_=new class{constructor(e,t,n={}){this.nodes=e,this.marks=t,this.options=n}serialize(e,t={}){t=Object.assign({},this.options,t);let n=new WN(this.nodes,this.marks,t);return n.renderContent(e),n.out}}({blockquote(e,t){e.wrapBlock("> ",null,t,()=>e.renderContent(t))},code_block(e,t){let n=t.textContent.match(/`{3,}/gm),r=n?n.sort().slice(-1)[0]+"`":"```";e.write(r+(t.attrs.params||"")+`
`),e.text(t.textContent,!1),e.write(`
`),e.write(r),e.closeBlock(t)},heading(e,t){e.write(e.repeat("#",t.attrs.level)+" "),e.renderInline(t,!1),e.closeBlock(t)},horizontal_rule(e,t){e.write(t.attrs.markup||"---"),e.closeBlock(t)},bullet_list(e,t){e.renderList(t,"  ",()=>(t.attrs.bullet||"*")+" ")},ordered_list(e,t){let n=t.attrs.order||1,r=String(n+t.childCount-1).length,i=e.repeat(" ",r+2);e.renderList(t,i,t=>{let i=String(n+t);return e.repeat(" ",r-i.length)+i+". "})},list_item(e,t){e.renderContent(t)},paragraph(e,t){e.renderInline(t),e.closeBlock(t)},image(e,t){e.write("!["+e.esc(t.attrs.alt||"")+"]("+t.attrs.src.replace(/[\(\)]/g,"\\$&")+(t.attrs.title?' "'+t.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break(e,t,n,r){for(let i=r+1;i<n.childCount;i++)if(n.child(i).type!=t.type){e.write(`\\
`);return}},text(e,t){e.text(t.text,!e.inAutolink)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open:(e,t,n,r)=>(e.inAutolink=function(e,t,n){if(e.attrs.title||!/^\w+:/.test(e.attrs.href))return!1;let r=t.child(n);return!!r.isText&&r.text==e.attrs.href&&r.marks[r.marks.length-1]==e&&(n==t.childCount-1||!e.isInSet(t.child(n+1).marks))}(t,n,r),e.inAutolink?"<":"["),close(e,t,n,r){let{inAutolink:i}=e;return e.inAutolink=void 0,i?">":"]("+t.attrs.href.replace(/[\(\)"]/g,"\\$&")+(t.attrs.title?` "${t.attrs.title.replace(/"/g,'\\"')}"`:"")+")"},mixable:!0},code:{open:(e,t,n,r)=>WD(n.child(r),-1),close:(e,t,n,r)=>WD(n.child(r-1),1),escape:!1}});function WD(e,t){let n=/`+/g,r,i=0;if(e.isText)for(;r=n.exec(e.text);)i=Math.max(i,r[0].length);let o=i>0&&t>0?" `":"`";for(let e=0;e<i;e++)o+="`";return i>0&&t<0&&(o+=" "),o}let WN=class{constructor(e,t,n){this.nodes=e,this.marks=t,this.options=n,this.delim="",this.out="",this.closed=null,this.inAutolink=void 0,this.atBlockStart=!1,this.inTightList=!1,typeof this.options.tightLists>"u"&&(this.options.tightLists=!1),typeof this.options.hardBreakNodeName>"u"&&(this.options.hardBreakNodeName="hard_break")}flushClose(e=2){if(this.closed){if(this.atBlank()||(this.out+=`
`),e>1){let t=this.delim,n=/\s+$/.exec(t);n&&(t=t.slice(0,t.length-n[0].length));for(let n=1;n<e;n++)this.out+=t+`
`}this.closed=null}}getMark(e){let t=this.marks[e];if(!t){if(!1!==this.options.strict)throw Error(`Mark type \`${e}\` not supported by Markdown renderer`);t=WM}return t}wrapBlock(e,t,n,r){let i=this.delim;this.write(t??e),this.delim+=e,r(),this.delim=i,this.closeBlock(n)}atBlank(){return/(^|\n)$/.test(this.out)}ensureNewLine(){this.atBlank()||(this.out+=`
`)}write(e){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),e&&(this.out+=e)}closeBlock(e){this.closed=e}text(e,t=!0){let n=e.split(`
`);for(let e=0;e<n.length;e++)this.write(),!t&&"["==n[e][0]&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=t?this.esc(n[e],this.atBlockStart):n[e],e!=n.length-1&&(this.out+=`
`)}render(e,t,n){if(this.nodes[e.type.name])this.nodes[e.type.name](this,e,t,n);else{if(!1!==this.options.strict)throw Error("Token type `"+e.type.name+"` not supported by Markdown renderer");e.type.isLeaf||(e.type.inlineContent?this.renderInline(e):this.renderContent(e),e.isBlock&&this.closeBlock(e))}}renderContent(e){e.forEach((t,n,r)=>this.render(t,e,r))}renderInline(e,t=!0){this.atBlockStart=t;let n=[],r="",i=(t,i,o)=>{let s=t?t.marks:[];t&&t.type.name===this.options.hardBreakNodeName&&(s=s.filter(t=>{if(o+1==e.childCount)return!1;let n=e.child(o+1);return t.isInSet(n.marks)&&(!n.isText||/\S/.test(n.text))}));let a=r;if(r="",t&&t.isText&&s.some(e=>{let t=this.getMark(e.type.name);return t&&t.expelEnclosingWhitespace&&!e.isInSet(n)})){let[e,r,i]=/^(\s*)(.*)$/m.exec(t.text);r&&(a+=r,(t=i?t.withText(i):null)||(s=n))}if(t&&t.isText&&s.some(t=>{let n=this.getMark(t.type.name);return n&&n.expelEnclosingWhitespace&&(o==e.childCount-1||!t.isInSet(e.child(o+1).marks))})){let[e,i,o]=/^(.*?)(\s*)$/m.exec(t.text);o&&(r=o,(t=i?t.withText(i):null)||(s=n))}let l=s.length?s[s.length-1]:null,c=l&&!1===this.getMark(l.type.name).escape,h=s.length-(c?1:0);e:for(let e=0;e<h;e++){let t=s[e];if(!this.getMark(t.type.name).mixable)break;for(let r=0;r<n.length;r++){let i=n[r];if(!this.getMark(i.type.name).mixable)break;if(t.eq(i)){e>r?s=s.slice(0,r).concat(t).concat(s.slice(r,e)).concat(s.slice(e+1,h)):r>e&&(s=s.slice(0,e).concat(s.slice(e+1,r)).concat(t).concat(s.slice(r,h)));continue e}}}let u=0;for(;u<Math.min(n.length,h)&&s[u].eq(n[u]);)++u;for(;u<n.length;)this.text(this.markString(n.pop(),!1,e,o),!1);if(a&&this.text(a),t){for(;n.length<h;){let t=s[n.length];n.push(t),this.text(this.markString(t,!0,e,o),!1),this.atBlockStart=!1}c&&t.isText?this.text(this.markString(l,!0,e,o)+t.text+this.markString(l,!1,e,o+1),!1):this.render(t,e,o),this.atBlockStart=!1}null!=t&&t.isText&&t.nodeSize>0&&(this.atBlockStart=!1)};e.forEach(i),i(null,0,e.childCount),this.atBlockStart=!1}renderList(e,t,n){this.closed&&this.closed.type==e.type?this.flushClose(3):this.inTightList&&this.flushClose(1);let r="u">typeof e.attrs.tight?e.attrs.tight:this.options.tightLists,i=this.inTightList;this.inTightList=r,e.forEach((i,o,s)=>{s&&r&&this.flushClose(1),this.wrapBlock(t,n(s),e,()=>this.render(i,e,s))}),this.inTightList=i}esc(e,t=!1){return e=e.replace(/[`*\\~\[\]_]/g,(t,n)=>"_"==t&&n>0&&n+1<e.length&&e[n-1].match(/\w/)&&e[n+1].match(/\w/)?t:"\\"+t),t&&(e=e.replace(/^(\+[ ]|[\-*>])/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(e=e.replace(this.options.escapeExtraCharacters,"\\$&")),e}quote(e){let t=-1==e.indexOf('"')?'""':-1==e.indexOf("'")?"''":"()";return t[0]+e+t[1]}repeat(e,t){let n="";for(let r=0;r<t;r++)n+=e;return n}markString(e,t,n,r){let i=this.getMark(e.type.name),o=t?i.open:i.close;return"string"==typeof o?o:o(this,e,n,r)}getEnclosingWhitespace(e){return{leading:(e.match(/^(\s+)/)||[void 0])[0],trailing:(e.match(/(\s+)$/)||[void 0])[0]}}};var WR=!0,WP=!1,Wj=!1;function WI(e,t,n){var r=e.attrIndex(t),i=[t,n];r<0?e.attrPush(i):e.attrs[r]=i}let W$=(0,S.a3)(function(e,t){t&&(WR=!t.enabled,WP=!!t.label,Wj=!!t.labelAfter),e.core.ruler.after("inline","github-task-lists",function(e){for(var t=e.tokens,n=2;n<t.length;n++)(function(e,t){var n;return"inline"===e[t].type&&"paragraph_open"===e[t-1].type&&"list_item_open"===e[t-2].type&&(0===(n=e[t]).content.indexOf("[ ] ")||0===n.content.indexOf("[x] ")||0===n.content.indexOf("[X] "))})(t,n)&&(function(e,t){if(e.children.unshift(function(e,t){var n=new t("html_inline","",0),r=WR?' disabled="" ':"";return 0===e.content.indexOf("[ ] ")?n.content='<input class="task-list-item-checkbox"'+r+'type="checkbox">':(0===e.content.indexOf("[x] ")||0===e.content.indexOf("[X] "))&&(n.content='<input class="task-list-item-checkbox" checked=""'+r+'type="checkbox">'),n}(e,t)),e.children[1].content=e.children[1].content.slice(3),e.content=e.content.slice(3),WP){if(Wj){e.children.pop();var n="task-item-"+Math.ceil(1e4*1e3*Math.random()-1e3);e.children[0].content=e.children[0].content.slice(0,-1)+' id="'+n+'">',e.children.push(function(e,t,n){var r=new n("html_inline","",0);return r.content='<label class="task-list-item-label" for="'+t+'">'+e+"</label>",r.attrs=[{for:t}],r}(e.content,n,t))}else e.children.unshift(function(e){var t=new e("html_inline","",0);return t.content="<label>",t}(t)),e.children.push(function(e){var t=new e("html_inline","",0);return t.content="</label>",t}(t))}}(t[n],e.Token),WI(t[n-2],"class","task-list-item"+(WR?"":" enabled")),WI(t[function(e,t){for(var n=e[t].level-1,r=t-1;r>=0;r--)if(e[r].level===n)return r;return -1}(t,n-2)],"class","contains-task-list"))})});var WL=Object.defineProperty,Wq=(e,t,n)=>t in e?WL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wz=(e,t,n)=>(Wq(e,"symbol"!=typeof t?t+"":t,n),n);let WB=q5.create({name:"markdownTightLists",addOptions:()=>({tight:!0,tightClass:"tight",listTypes:["bulletList","orderedList"]}),addGlobalAttributes(){return[{types:this.options.listTypes,attributes:{tight:{default:this.options.tight,parseHTML:e=>"true"===e.getAttribute("data-tight")||!e.querySelector("p"),renderHTML:e=>({class:e.tight?this.options.tightClass:null,"data-tight":e.tight?"true":null})}}}]},addCommands(){var e=this;return{toggleTight:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return n=>{let{editor:r,commands:i}=n;return e.options.listTypes.some(e=>(function(e){if(!r.isActive(e))return!1;let n=r.getAttributes(e);return i.updateAttributes(e,{tight:t??!(null!=n&&n.tight)})})(e))}}}}}),WF=Ww();function WQ(e,t){return WF.inline.State.prototype.scanDelims.call({src:e,posMax:e.length}),new WF.inline.State(e,null,null,[]).scanDelims(t,!0)}function WV(e,t,n,r){let i=e.substring(0,n)+e.substring(n+t.length);return i.substring(0,n+r)+t+i.substring(n+r)}class WW extends WN{constructor(e,t,n){super(e,t,n??{}),Wz(this,"inTable",!1),this.inlines=[]}render(e,t,n){super.render(e,t,n);let r=this.inlines[this.inlines.length-1];if(null!=r&&r.start&&null!=r&&r.end){let e;let{delimiter:t,start:n,end:i}=this.normalizeInline(r);this.out=((e=function(e,t,n,r){let i=r,o=e;for(;i>n&&!WQ(o,i).can_close;)o=WV(o,t,i,-1),i--;return{text:o,from:n,to:i}}((e=function(e,t,n,r){let i=n,o=e;for(;i<r&&!WQ(o,i).can_open;)o=WV(o,t,i,1),i++;return{text:o,from:i,to:r}}((e={text:this.out,from:n,to:i}).text,t,e.from,e.to)).text,t,e.from,e.to)).to-e.from<t.length+1&&(e.text=e.text.substring(0,e.from)+e.text.substring(e.to+t.length)),e.text),this.inlines.pop()}}markString(e,t,n,r){let i=this.marks[e.type.name];if(i.expelEnclosingWhitespace){if(t)this.inlines.push({start:this.out.length,delimiter:i.open});else{let e=this.inlines.pop();this.inlines.push({...e,end:this.out.length})}}return super.markString(e,t,n,r)}normalizeInline(e){let{start:t,end:n}=e;for(;this.out.charAt(t).match(/\s/);)t++;return{...e,start:t}}}let WU=qY.create({name:"markdownHTMLMark",addStorage:()=>({markdown:{serialize:{open(e,t){var n,r;return this.editor.storage.markdown.options.html?null!==(n=null===(r=WH(t))||void 0===r?void 0:r[0])&&void 0!==n?n:"":(console.warn(`Tiptap Markdown: "${t.type.name}" mark is only available in html mode`),"")},close(e,t){var n,r;return this.editor.storage.markdown.options.html&&null!==(n=null===(r=WH(t))||void 0===r?void 0:r[1])&&void 0!==n?n:""}},parse:{}}})});function WH(e){let t=e.type.schema,n=t.text(" ",[e]),r=qQ(PG.from(n),t).match(/^(<.*?>) (<\/.*?>)$/);return r?[r[1],r[2]]:null}function WG(e){let t=`<body>${e}</body>`;return new window.DOMParser().parseFromString(t,"text/html").body}let WX=zF.create({name:"markdownHTMLNode",addStorage:()=>({markdown:{serialize(e,t,n){this.editor.storage.markdown.options.html?e.write(function(e,t){let n=e.type.schema,r=qQ(PG.from(e),n);return e.isBlock&&(t instanceof PG||t.type.name===n.topNodeType.name)?function(e){let t=WG(e).firstElementChild;return t.innerHTML=t.innerHTML.trim()?`
${t.innerHTML}
`:`
`,t.outerHTML}(r):r}(t,n)):(console.warn(`Tiptap Markdown: "${t.type.name}" node is only available in html mode`),e.write(`[${t.type.name}]`)),t.isBlock&&e.closeBlock(t)},parse:{}}})}),WZ=zF.create({name:"blockquote"}).extend({addStorage:()=>({markdown:{serialize:W_.nodes.blockquote,parse:{}}})}),WY=zF.create({name:"bulletList"}).extend({addStorage:()=>({markdown:{serialize(e,t){return e.renderList(t,"  ",()=>(this.editor.storage.markdown.options.bulletListMarker||"-")+" ")},parse:{}}})}),WJ=zF.create({name:"codeBlock"}).extend({addStorage:()=>({markdown:{serialize(e,t){e.write("```"+(t.attrs.language||"")+`
`),e.text(t.textContent,!1),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},parse:{setup(e){var t;e.set({langPrefix:null!==(t=this.options.languageClassPrefix)&&void 0!==t?t:"language-"})},updateDOM(e){e.innerHTML=e.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}})}),WK=zF.create({name:"hardBreak"}).extend({addStorage:()=>({markdown:{serialize(e,t,n,r){for(let i=r+1;i<n.childCount;i++)if(n.child(i).type!=t.type){e.write(e.inTable?WX.storage.markdown.serialize.call(this,e,t,n):`\\
`);return}},parse:{}}})}),W0=zF.create({name:"heading"}).extend({addStorage:()=>({markdown:{serialize:W_.nodes.heading,parse:{}}})}),W1=zF.create({name:"horizontalRule"}).extend({addStorage:()=>({markdown:{serialize:W_.nodes.horizontal_rule,parse:{}}})}),W2=zF.create({name:"image"}).extend({addStorage:()=>({markdown:{serialize:W_.nodes.image,parse:{}}})}),W5=zF.create({name:"listItem"}).extend({addStorage:()=>({markdown:{serialize:W_.nodes.list_item,parse:{}}})}),W3=zF.create({name:"orderedList"}).extend({addStorage:()=>({markdown:{serialize(e,t,n,r){let i=t.attrs.start||1,o=String(i+t.childCount-1).length,s=e.repeat(" ",o+2),a=function(e,t,n){let r=0;for(;n-r>0&&t.child(n-r-1).type.name===e.type.name;r++);return r}(t,n,r)%2?") ":". ";e.renderList(t,s,t=>{let n=String(i+t);return e.repeat(" ",o-n.length)+n+a})},parse:{}}})}),W4=zF.create({name:"paragraph"}).extend({addStorage:()=>({markdown:{serialize:W_.nodes.paragraph,parse:{}}})});function W6(e){var t,n;return null!==(t=null==e||null===(n=e.content)||void 0===n?void 0:n.content)&&void 0!==t?t:[]}let W8=zF.create({name:"table"}).extend({addStorage:()=>({markdown:{serialize(e,t,n){if(!function(e){let t=W6(e),n=t[0],r=t.slice(1);return!(W6(n).some(e=>"tableHeader"!==e.type.name||W9(e)||e.childCount>1)||r.some(e=>W6(e).some(e=>"tableHeader"===e.type.name||W9(e)||e.childCount>1)))}(t)){WX.storage.markdown.serialize.call(this,e,t,n);return}e.inTable=!0,t.forEach((t,n,r)=>{if(e.write("| "),t.forEach((t,n,r)=>{r&&e.write(" | ");let i=t.firstChild;i.textContent.trim()&&e.renderInline(i)}),e.write(" |"),e.ensureNewLine(),!r){let n=Array.from({length:t.childCount}).map(()=>"---").join(" | ");e.write(`| ${n} |`),e.ensureNewLine()}}),e.closeBlock(t),e.inTable=!1},parse:{}}})});function W9(e){return e.attrs.colspan>1||e.attrs.rowspan>1}let W7=zF.create({name:"taskItem"}).extend({addStorage:()=>({markdown:{serialize(e,t){let n=t.attrs.checked?"[x]":"[ ]";e.write(`${n} `),e.renderContent(t)},parse:{updateDOM(e){[...e.querySelectorAll(".task-list-item")].forEach(e=>{let t=e.querySelector("input");e.setAttribute("data-type","taskItem"),t&&(e.setAttribute("data-checked",t.checked),t.remove())})}}}})}),Ue=zF.create({name:"taskList"}).extend({addStorage:()=>({markdown:{serialize:WY.storage.markdown.serialize,parse:{setup(e){e.use(W$)},updateDOM(e){[...e.querySelectorAll(".contains-task-list")].forEach(e=>{e.setAttribute("data-type","taskList")})}}}})}),Ut=zF.create({name:"text"}).extend({addStorage:()=>({markdown:{serialize(e,t){var n;e.text(null==(n=t.text)?void 0:n.replace(/</g,"&lt;").replace(/>/g,"&gt;"))},parse:{}}})}),Un=qY.create({name:"bold"}).extend({addStorage:()=>({markdown:{serialize:W_.marks.strong,parse:{}}})}),Ur=qY.create({name:"code"}).extend({addStorage:()=>({markdown:{serialize:W_.marks.code,parse:{}}})}),Ui=[WZ,WY,WJ,WK,W0,W1,WX,W2,W5,W3,W4,W8,W7,Ue,Ut,Un,Ur,WU,qY.create({name:"italic"}).extend({addStorage:()=>({markdown:{serialize:W_.marks.em,parse:{}}})}),qY.create({name:"link"}).extend({addStorage:()=>({markdown:{serialize:W_.marks.link,parse:{}}})}),qY.create({name:"strike"}).extend({addStorage:()=>({markdown:{serialize:{open:"~~",close:"~~",expelEnclosingWhitespace:!0},parse:{}}})})];function Uo(e){var t,n;let r=null===(t=e.storage)||void 0===t?void 0:t.markdown,i=null===(n=Ui.find(t=>t.name===e.name))||void 0===n?void 0:n.storage.markdown;return r||i?{...i,...r}:null}class Us{constructor(e){Wz(this,"editor",null),this.editor=e}serialize(e){let t=new WW(this.nodes,this.marks,{hardBreakNodeName:WK.name});return t.renderContent(e),t.out}get nodes(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.nodes).map(e=>[e,this.serializeNode(WX)])),...Object.fromEntries(null!==(e=this.editor.extensionManager.extensions.filter(e=>"node"===e.type&&this.serializeNode(e)).map(e=>[e.name,this.serializeNode(e)]))&&void 0!==e?e:[])}}get marks(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.marks).map(e=>[e,this.serializeMark(WU)])),...Object.fromEntries(null!==(e=this.editor.extensionManager.extensions.filter(e=>"mark"===e.type&&this.serializeMark(e)).map(e=>[e.name,this.serializeMark(e)]))&&void 0!==e?e:[])}}serializeNode(e){var t;return null===(t=Uo(e))||void 0===t||null===(t=t.serialize)||void 0===t?void 0:t.bind({editor:this.editor,options:e.options})}serializeMark(e){var t;let n=null===(t=Uo(e))||void 0===t?void 0:t.serialize;return n?{...n,open:"function"==typeof n.open?n.open.bind({editor:this.editor,options:e.options}):n.open,close:"function"==typeof n.close?n.close.bind({editor:this.editor,options:e.options}):n.close}:null}}class Ua{constructor(e,t){Wz(this,"editor",null),Wz(this,"md",null);let{html:n,linkify:r,breaks:i}=t;this.editor=e,this.md=this.withPatchedRenderer(Ww({html:n,linkify:r,breaks:i}))}parse(e){let{inline:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){this.editor.extensionManager.extensions.forEach(e=>{var t;return null===(t=Uo(e))||void 0===t||null===(t=t.parse)||void 0===t||null===(t=t.setup)||void 0===t?void 0:t.call({editor:this.editor,options:e.options},this.md)});let n=WG(this.md.render(e));return this.editor.extensionManager.extensions.forEach(e=>{var t;return null===(t=Uo(e))||void 0===t||null===(t=t.parse)||void 0===t||null===(t=t.updateDOM)||void 0===t?void 0:t.call({editor:this.editor,options:e.options},n)}),this.normalizeDOM(n,{inline:t,content:e}),n.innerHTML}return e}normalizeDOM(e,t){let{inline:n,content:r}=t;return this.normalizeBlocks(e),e.querySelectorAll("*").forEach(e=>{var t;(null===(t=e.nextSibling)||void 0===t?void 0:t.nodeType)!==Node.TEXT_NODE||e.closest("pre")||(e.nextSibling.textContent=e.nextSibling.textContent.replace(/^\n/,""))}),n&&this.normalizeInline(e,r),e}normalizeBlocks(e){let t=Object.values(this.editor.schema.nodes).filter(e=>e.isBlock).map(e=>{var t;return null===(t=e.spec.parseDOM)||void 0===t?void 0:t.map(e=>e.tag)}).flat().filter(Boolean).join(",");t&&[...e.querySelectorAll(t)].forEach(e=>{e.parentElement.matches("p")&&function(e){let t=e.parentElement,n=t.cloneNode();for(;t.firstChild&&t.firstChild!==e;)n.appendChild(t.firstChild);n.childNodes.length>0&&t.parentElement.insertBefore(n,t),t.parentElement.insertBefore(e,t),0===t.childNodes.length&&t.remove()}(e)})}normalizeInline(e,t){var n,r,i,o,s;if(null!==(n=e.firstElementChild)&&void 0!==n&&n.matches("p")){let n=e.firstElementChild,{nextElementSibling:a}=n,l=null!==(r=null===(i=t.match(/^\s+/))||void 0===i?void 0:i[0])&&void 0!==r?r:"",c=a?"":null!==(o=null===(s=t.match(/\s+$/))||void 0===s?void 0:s[0])&&void 0!==o?o:"";if(t.match(/^\n\n/)){n.innerHTML=`${n.innerHTML}${c}`;return}(function(e){let t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)})(n),e.innerHTML=`${l}${e.innerHTML}${c}`}}withPatchedRenderer(e){let t=e=>function(){let t=e(...arguments);return t===`
`?t:t[t.length-1]===`
`?t.slice(0,-1):t};return e.renderer.rules.hardbreak=t(e.renderer.rules.hardbreak),e.renderer.rules.softbreak=t(e.renderer.rules.softbreak),e.renderer.rules.fence=t(e.renderer.rules.fence),e.renderer.rules.code_block=t(e.renderer.rules.code_block),e.renderer.renderToken=t(e.renderer.renderToken.bind(e.renderer)),e}}let Ul=q5.create({name:"markdownClipboard",addOptions:()=>({transformPastedText:!1,transformCopiedText:!1}),addProseMirrorPlugins(){return[new IT({key:new IM("markdownClipboard"),props:{clipboardTextParser:(e,t,n)=>{if(n||!this.options.transformPastedText)return null;let r=this.editor.storage.markdown.parser.parse(e,{inline:!0});return jx.fromSchema(this.editor.schema).parseSlice(WG(r),{preserveWhitespace:!0,context:t})},clipboardTextSerializer:e=>this.options.transformCopiedText?this.editor.storage.markdown.serializer.serialize(e.content):null}})]}}),Uc=q5.create({name:"markdown",priority:50,addOptions:()=>({html:!0,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!1,breaks:!1,transformPastedText:!1,transformCopiedText:!1}),addCommands(){let e=zj.Commands.config.addCommands();return{setContent:(t,n,r)=>i=>e.setContent(i.editor.storage.markdown.parser.parse(t),n,r)(i),insertContentAt:(t,n,r)=>i=>e.insertContentAt(t,i.editor.storage.markdown.parser.parse(n,{inline:!0}),r)(i)}},onBeforeCreate(){this.editor.storage.markdown={options:{...this.options},parser:new Ua(this.editor,this.options),serializer:new Us(this.editor),getMarkdown:()=>this.editor.storage.markdown.serializer.serialize(this.editor.state.doc)},this.editor.options.initialContent=this.editor.options.content,this.editor.options.content=this.editor.storage.markdown.parser.parse(this.editor.options.content)},onCreate(){this.editor.options.content=this.editor.options.initialContent,delete this.editor.options.initialContent},addStorage:()=>({}),addExtensions(){return[WB.configure({tight:this.options.tightLists,tightClass:this.options.tightListClass}),Ul.configure({transformPastedText:this.options.transformPastedText,transformCopiedText:this.options.transformCopiedText})]}}),Uh=qY.create({name:"comment",addOptions:()=>({HTMLAttributes:{},onCommentActivated:()=>{}}),addAttributes:()=>({commentId:{default:null,parseHTML:e=>e.getAttribute("data-comment-id"),renderHTML:e=>({"data-comment-id":e.commentId})}}),parseHTML:()=>[{tag:"span[data-comment-id]",getAttrs:e=>{var t;return!!(!(null===(t=e.getAttribute("data-comment-id"))||void 0===t)&&t.trim())&&null}}],renderHTML({HTMLAttributes:e}){return["span",qj(this.options.HTMLAttributes,e),0]},onSelectionUpdate(){let{$from:e}=this.editor.state.selection,t=e.marks();if(!t.length){this.storage.activeCommentId=null,this.options.onCommentActivated(this.storage.activeCommentId);return}let n=this.editor.schema.marks.comment,r=t.find(e=>e.type===n);this.storage.activeCommentId=(null==r?void 0:r.attrs.commentId)||null,this.options.onCommentActivated(this.storage.activeCommentId)},addStorage:()=>({activeCommentId:null}),addCommands:()=>({setComment:e=>({commands:t})=>{if(!e)return!1;t.setMark("comment",{commentId:e})},unsetComment:e=>({tr:t,dispatch:n})=>{if(!e)return!1;let r=[];return t.doc.descendants((t,n)=>{let i=t.marks.find(t=>"comment"===t.type.name&&t.attrs.commentId===e);i&&r.push({mark:i,range:{from:n,to:n+t.nodeSize}})}),r.forEach(({mark:e,range:n})=>{t.removeMark(n.from,n.to,e)}),null==n?void 0:n(t)}})});function Uu({node:e}){let{multiTables:t,tables:n}=(0,C.useContext)(Bl),r=t[e.attrs.id],i=Array.isArray(null==r?void 0:r.tableIds)?r.tableIds:[],[o,s]=(0,C.useState)(i.length>0?i[0]:null),a=(0,C.useMemo)(()=>{let e={};return i.forEach(t=>{let{columns:r,data:i,attributes:o}=n[t]||{};e[t]=[{name:"Table",content:S.j.jsx(S.b,{columns:r,rows:i,columnHeaderClassNames:"py-2",skipColumns:["index"]})},{name:"Chart",content:S.j.jsx(wW,{children:S.j.jsx(Pl,{rows:i,columns:r,initialQuestion:null==o?void 0:o.generated_qn,initialOptionsExpanded:!1})})},o.sql?{name:"SQL",content:S.j.jsx("pre",{className:"whitespace-pre-wrap px-2 py-4 bg-gray-800",children:S.j.jsx("code",{children:o.sql})})}:null]}),e},[n]);return S.j.jsxs(Bi,{as:"div",className:"react-component react-multitable-container not-prose lg:-mx-40 my-10","data-id":e.attrs.id,children:[i&&i.length>1&&S.j.jsx("div",{className:"table-selection flex flex-row gap-2 w-100 overflow-auto mb-4",children:i.map(e=>{var t,r;return S.j.jsx("div",{className:`p-2 bg-gray-200 border border-gray-300 rounded-full cursor-pointer whitespace-nowrap text-xs ${o===e?"bg-gray-600 border-transparent text-white":"text-gray-500 hover:bg-gray-300"}`,onClick:()=>s(e),children:US[null==(t=n[e])?void 0:t.type]||(null==(r=n[e])?void 0:r.type)||"Table"},e)})}),o&&a[o]&&S.j.jsx(S.T,{tabs:a[o].filter(Boolean),size:"small",contentClassNames:"border dark:border-gray-600",defaultSelected:o})]})}let Ud=zF.create({name:"oracle-multi-table",group:"block",content:"text*",addAttributes:()=>({id:{default:null,isRequired:!0}}),parseHTML:()=>[{tag:"oracle-multi-table"}],renderHTML:({HTMLAttributes:e})=>["oracle-multi-table",qj(e)],addNodeView:()=>Ba(Uu)});function Uf({node:e}){let{apiEndpoint:t,images:n,projectName:r,reportId:i,token:o}=(0,C.useContext)(Bl),{src:s,alt:a}=n[e.attrs.id]||{},[l,c]=(0,C.useState)(null),[h,u]=(0,C.useState)(null);return(0,C.useEffect)(()=>{(async function(){try{let e=await Bm(t,i,r,o,s);u(null),c("data:image/png;base64,"+e)}catch(e){console.error(e),u("Error fetching image")}})()},[]),S.j.jsx(Bi,{className:"react-component not-prose",children:h?S.j.jsx("div",{className:"bg-rose-100 text-red text-center rounded-md p-2",children:h}):l?S.j.jsx("img",{src:l,alt:a}):S.j.jsx(S.d,{})})}let Up=zF.create({name:"oracle-image",group:"block",addAttributes:()=>({id:{default:null,isRequired:!0}}),parseHTML:()=>[{tag:"oracle-image"}],renderHTML:({HTMLAttributes:e})=>["oracle-image",qj(e)],addNodeView:()=>Ba(Uf)});function Um({comment:e,onUpdate:t,onDelete:n,anchorEl:r,isEditing:i}){let o=(0,C.useRef)(null),s=(0,C.useRef)(null);(0,C.useEffect)(()=>{if(s.current&&r){let e=r.getBoundingClientRect(),t=s.current;t.style.position="fixed",t.style.left=`${e.left+e.width/2-t.offsetWidth/2}px`,t.style.top=`${e.top-t.offsetHeight-8}px`,e.top<t.offsetHeight+16&&(t.style.top=`${e.bottom+8}px`)}},[r]);let[a,l]=(0,C.useState)(!1);return(0,C.useEffect)(()=>{i&&o.current&&o.current.focus()},[i]),r?S.j.jsxs("div",{ref:s,className:"fixed z-50 p-2 border rounded-lg bg-white shadow-custom comment-popover not-prose border-gray-300 overflow-hidden dark:bg-gray-700 dark:border-gray-600 w-80",onClick:e=>e.stopPropagation(),children:[S.j.jsxs("div",{className:"text-xs flex flex-row mb-1 items-center",children:[S.j.jsx("p",{className:"text-gray-400",children:i?a?"Commenting":"Posted":"Click to edit comment"}),S.j.jsx("div",{className:"flex gap-2 ml-auto",children:i&&S.j.jsxs(S.j.Fragment,{children:[S.j.jsx("button",{onClick:()=>{if(o.current){let n={...e,content:o.current.value};null==t||t(n),o.current.blur()}},className:`cursor-pointer ${a?"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300":"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"}`,children:"Submit"}),S.j.jsx("div",{className:"text-gray-400 hover:text-rose-500 dark:hover:text-rose-300 cursor-pointer",onClick:n,children:"Delete"})]})})]}),S.j.jsx(S.e,{ref:o,defaultValue:e.content,defaultRows:2,textAreaHtmlProps:{onBlur:n=>{l(!1);let r={...e,content:n.target.value};null==t||t(r)},onFocus:()=>{l(!0)},onKeyDown:n=>{if("Enter"===n.key&&!n.shiftKey){n.preventDefault();let r={...e,content:n.currentTarget.value};null==t||t(r),n.currentTarget.blur()}},onClick:e=>e.stopPropagation()},textAreaClassNames:(0,S.t)("w-full bg-transparent text-sm border-none focus:outline-none focus:ring-1 focus:ring-blue-500 rounded px-1 resize-none overflow-hidden dark:bg-gray-800 dark:text-gray-400 dark:border-none",i?"cursor-text dark:text-gray-200":"cursor-default text-gray-500 dark:text-gray-400"),disabled:!i,autoResize:!0,placeholder:"Type your comment here"})]}):null}function Ug({editor:e,commentManager:t}){let n=(0,C.useSyncExternalStore)(t.subscribeToCommentUpdates,t.getComments),{interactionState:r,setInteractionState:i}=function(e){let[t,n]=(0,C.useState)({hoveredId:null,hoveredElement:null,editingId:null,relativeTop:null,pmPos:null,pmNode:null});return(0,C.useEffect)(()=>{if(!e)return;let r=r=>{let i=r.target,o=i.getAttribute("data-comment-id"),s=i.classList.contains("oracle-report-tiptap"),a=i.closest(".oracle-comment-handler"),l=i.closest(".oracle-report-tiptap");if(!t.editingId&&!s&&!a&&l){let t=e.view.dom.getBoundingClientRect().top,s=i.getBoundingClientRect().top-t,a=e.view.posAtCoords({left:r.clientX,top:r.clientY});if(!a)return;let l=e.view.nodeDOM(a.inside);n(e=>({...e,hoveredId:o,hoveredElement:i,relativeTop:s,pmPos:a,pmNode:l}))}},i=e=>{let t=e.target,r=t.getAttribute("data-comment-id");"svg"===t.tagName||"path"===t.tagName||t.closest(".comment-icon")||r&&(e.stopPropagation(),n(e=>({...e,editingId:r,hoveredId:r,hoveredElement:t})))};return e.view.dom.addEventListener("mousemove",r,!0),e.view.dom.addEventListener("click",i,!0),()=>{e.view.dom.removeEventListener("mousemove",r,!0),e.view.dom.removeEventListener("click",i,!0)}},[e,t.editingId]),{interactionState:t,setInteractionState:n}}(e);(0,C.useEffect)(()=>{let e=e=>{let t=e.target;"svg"===t.tagName||"path"===t.tagName||t.closest(".comment-icon")||t.closest(".comment-popover")||t.getAttribute("data-comment-id")||i(()=>({hoveredId:null,hoveredElement:null,editingId:null,relativeTop:null,pmPos:null,pmNode:null}))};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[i]),(0,C.useEffect)(()=>(e.on("commentCreated",r=>{t.updateComments(e,[...n,r]),i(e=>({...e,editingId:r.id,hoveredElement:document.querySelector(`[data-comment-id="${r.id}"]`)}))}),()=>{e.off("commentCreated")}),[e,n,t,i]);let o=n.find(e=>e.id===r.hoveredId||e.id===r.editingId);return S.j.jsxs(Bi,{className:"h-full w-0 absolute top-0 right-0 oracle-comment-handler",children:[o&&S.j.jsx(Um,{onDelete:()=>{e.commands.unsetComment(o.id);let r=n.filter(e=>e.id!==o.id);t.updateComments(e,r),i(e=>({...e,editingId:null}))},comment:o,anchorEl:r.hoveredElement,isEditing:r.editingId===o.id,onUpdate:r=>{t.updateComments(e,n.map(e=>e.id===r.id?r:e))}}),S.j.jsx("div",{className:"comment-ramp h-full absolute -right-2 top-0",children:r.hoveredElement&&!r.editingId&&!r.hoveredId&&S.j.jsx(V,{className:"comment-icon absolute w-5 left-2 cursor-pointer text-gray-400 hover:scale-110 hover:text-gray-500 transition-none",style:{top:`${r.relativeTop}px`},onClick:()=>{r.pmPos&&r.pmNode&&e.chain().setNodeSelection(r.pmPos.inside).addComment({id:crypto.randomUUID(),content:"",user:localStorage.getItem("user")}).run()}})})]})}function Uy(){let{editor:e}=Be(),{commentManager:t}=(0,C.useContext)(Bl);return e&&t?S.j.jsx(Ug,{editor:e,commentManager:t}):null}let Ub=zF.create({name:"oracle-comment-handler",group:"block",parseHTML:()=>[{tag:"oracle-comment-handler"}],renderHTML:({HTMLAttributes:e})=>["oracle-comment-handler",qj(e)],addNodeView:()=>Ba(Uy),addOptions:()=>({HTMLAttributes:{class:"oracle-comment-handler"}}),addStorage:()=>({comments:[]}),addCommands:()=>({addComment:e=>({tr:t,chain:n})=>{let{$from:r,$to:i}=t.selection,o=t.mapping.map(r.pos);if(o!==t.mapping.map(i.pos))return n().setComment(e.id).run(),n().setTextSelection(o).command(({editor:t})=>(t.emit("commentCreated",e),!0)).run(),!0}})}),Uv=[FO,Qp.configure({resizable:!0}),Qm,Qg,Qy,Ub,Uh.configure({HTMLAttributes:{class:"oracle-report-comment"}}),Uc],Ux=[FO,Qp.configure({resizable:!0}),Qm,Qg,Qy,Ud,Up,Uh.configure({HTMLAttributes:{class:"oracle-report-comment"}}),Uc],Uw=PI(async(e,t,n,r,i,o)=>{if(!(!n||!r))try{await Promise.all([By(e,n,r,i,o),Bp(e,n,r,i,null==t?void 0:t.storage.markdown.getMarkdown())])}catch(e){console.error("Error updating comments:",e)}},500),Uk=(e,t,n,r,i,o)=>{t.storage["oracle-comment-handler"].comments=o,Uw(e,t,n,r,i,o)},UO=({apiEndpoint:e,reportId:t,projectName:n,token:r,initialComments:i})=>{let o=i,s=[];return{subscribeToCommentUpdates:e=>(s.push(e),function(){s=s.filter(t=>t!==e)}),getComments:()=>o,updateComments:(i,a)=>{Uk(e,i,t,n,r,o=a),s.forEach(e=>e())}}},US={table_csv:"Aggregated data",fetched_table_csv:"Fetched data",anomalies_csv:"Anomalies data"}}}]);