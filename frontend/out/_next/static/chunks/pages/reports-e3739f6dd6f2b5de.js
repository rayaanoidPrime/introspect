(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{1224:(e,t,a)=>{"use strict";a.d(t,{A5:()=>r.a,XV:()=>l});var r=a(5789),s=a(8732),o=a(4109);function l({apiEndpoint:e,publicUuid:t}){let[a,l]=(0,o.useState)(null),[n,i]=(0,o.useState)(null),[c,d]=(0,o.useState)([]),[m,x]=(0,o.useState)(""),[u,h]=(0,o.useState)(null),[p,g]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{t&&(async()=>{try{g(!0),console.log("Fetching public report with UUID:",t);let a="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?`/api/oracle/public/report/${t}`:`${e}/oracle/public/report/${t}`;console.log("Fetching from URL:",a);let s=await fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw console.error("Response error:",e),Error(`Failed to fetch report: ${s.status} ${s.statusText}`)}let o=await s.json();console.log("Report data received:",o);let n=o.report;if(!n)throw Error("Invalid report format received");n.mdx&&(l(n.mdx),(0,r.p)(n.mdx)),n.report_content_with_citations&&i(n.report_content_with_citations),n.analyses&&(console.log("Setting analyses:",n.analyses),d(n.analyses)),x(n.report_name||"Report")}catch(e){console.error("Error fetching report:",e),h(e.message||String(e))}finally{g(!1)}})()},[e,t]),p)?s.j.jsx("div",{className:"flex items-center justify-center h-screen",children:s.j.jsx("div",{className:"w-12 h-12 border-t-4 border-blue-500 border-solid rounded-full animate-spin"})}):u?s.j.jsxs("div",{className:"flex flex-col items-center justify-center h-screen text-center p-4",children:[s.j.jsx("div",{className:"text-red-500 text-2xl mb-2",children:"Error"}),s.j.jsx("div",{className:"text-gray-700 dark:text-gray-300",children:u})]}):s.j.jsxs("div",{className:"relative overflow-auto bg-white dark:bg-gray-900 min-h-screen",children:[s.j.jsxs("div",{className:"bg-white dark:bg-gray-900 shadow-sm mb-4 py-4 px-6",children:[s.j.jsx("h1",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-100",children:m}),s.j.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Public Report"})]}),s.j.jsx(r.O.Provider,{value:{apiEndpoint:e,tables:{},multiTables:{},images:{},analyses:c||[],executiveSummary:{title:m,introduction:"",recommendations:[]},reportId:"public",projectName:"public",token:"",commentManager:{subscribeToCommentUpdates:()=>()=>{},getComments:()=>[],updateComments:()=>{}},isLoading:!1,setIsLoading:()=>{}},children:s.j.jsx("div",{className:"relative oracle-report-ctr w-full",children:n&&n.length>0?s.j.jsx("div",{className:"w-full max-w-none sm:max-w-3xl lg:max-w-4xl xl:max-w-5xl 2xl:max-w-6xl mx-auto py-2 px-2 sm:px-4 md:px-6 mb-12 md:mb-0",children:s.j.jsx(r.R,{citations:n})}):s.j.jsx(r.E,{extensions:r.e,content:a,immediatelyRender:!1,editable:!1,editorProps:{attributes:{class:"w-full max-w-none sm:max-w-3xl lg:max-w-4xl xl:max-w-5xl 2xl:max-w-6xl oracle-report-tiptap relative prose prose-base dark:prose-invert mx-auto py-2 px-2 sm:px-4 md:px-6 mb-12 md:mb-0 focus:outline-none *:cursor-default"}}})})})]})}a(446)},2966:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(8017),s=a(4109),o=a(1224),l=a(6428),n=a(5183),i=a(694),c=a(1085),d=a(9678);function m(){let e=(0,c.useRouter)(),[t,a]=(0,s.useState)(""),[m,x]=(0,s.useState)(""),[u,h]=(0,s.useState)([]),[p,g]=(0,s.useState)(!0),f=async()=>{let e=localStorage.getItem("defogToken")||"4adaf64ff68cd84fb8f3aa6366812cb8aa20a8cd8d1abd156d15d578bea6680a";if(!e){g(!1);return}try{let t=await fetch((d.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"")+"/get_db_names",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(!t.ok)throw Error("Failed to get api key names - are you sure your network is working?");let a=await t.json();h(a.db_names)}catch(e){console.error("Error fetching db names:",e)}finally{g(!1)}};return((0,s.useEffect)(()=>{let t=localStorage.getItem("defogToken")||"4adaf64ff68cd84fb8f3aa6366812cb8aa20a8cd8d1abd156d15d578bea6680a",r=localStorage.getItem("defogUserType");t?(x(r),a(t),f()):setTimeout(()=>{let t=window.location.pathname+window.location.search;e.push({pathname:"/log-in",query:{message:"You are not logged in. Please log in to access reports.",returnUrl:t}})},1500)},[e]),t||p)?!0===p?(0,r.jsx)(i.c5,{}):(0,r.jsxs)("div",{className:"h-screen",children:[(0,r.jsx)(n.A,{}),(0,r.jsx)(l.A,{id:"query-data",userType:m,containerClassNames:"max-h-screen h-screen flex flex-col",contentClassNames:"h-full max-h-full",children:(0,r.jsx)(o.A5,{apiEndpoint:d.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"",token:t,initialProjectNames:u})})]}):(0,r.jsxs)("div",{className:"h-screen flex flex-col items-center justify-center",children:[(0,r.jsx)(n.A,{}),(0,r.jsxs)("div",{className:"text-center p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Not Logged In"}),(0,r.jsx)("p",{className:"mb-4",children:"You are not logged in. Redirecting to login page..."}),(0,r.jsx)(i.c5,{})]})]})}},4398:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports",function(){return a(2966)}])},5183:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(8017),s=a(1326),o=a.n(s);let l=()=>(0,r.jsxs)(o(),{children:[(0,r.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,r.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},6428:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(8017),s=a(4109),o=a(1085),l=a(694),n=a(3930),i=a(2074);let c=e=>{let{id:t,userType:a,children:c,rootClassNames:d="",contentClassNames:m="max-h-full h-full",containerClassNames:x="flex flex-col md:min-h-screen relative container mx-auto"}=e,[u,h]=(0,s.useState)([]),p=(0,o.useRouter)(),g=e=>{p.push(e)},f=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),g("/log-in")},b=(0,n.usePathname)();return(0,s.useEffect)(()=>{let e=[];h(("ADMIN"==a?[{title:"Admin",href:"#!",children:[{key:"manage-database",title:"Manage Database",href:"/extract-metadata"},{key:"manage-users",title:"Manage Users",href:"/manage-users"},{key:"align-model",title:"Align Model",href:"/align-model"}]},{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:f}]:a?[{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:f}]:[]).map(e=>(e.current=e.href==b,e)).map(e=>(e.children&&(e.children=e.children.map(e=>(e.current=e.href==b,e))),e)))},[a]),(0,r.jsxs)("div",{className:(0,i.QP)(x,d),children:[u.length?(0,r.jsx)(l.jq,{rootClassNames:(0,i.QP)("border-b dark:border-dark-border","bg-white dark:bg-dark-bg-primary","text-primary-text dark:text-dark-text-primary"),items:u.map(e=>({...e,classNames:(0,i.QP)(e.classNames,"hover:bg-gray-100 dark:hover:bg-dark-hover",e.current&&"bg-gray-100 dark:bg-dark-hover")}))}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)("div",{className:m,children:c})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[680,628,718,636,593,792],()=>t(4398)),_N_E=e.O()}]);