(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{7951:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-sources",function(){return r(1096)}])},6389:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(5105),s=r(9035),l=r.n(s);let o=()=>(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,a.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},3360:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(5105),s=r(8101),l=r(3472),o=r(6665),n=r(6159),c=r(4799);let i=e=>{let{id:t,userType:r,children:i,rootClassNames:d="",contentClassNames:u="max-h-full h-full",containerClassNames:m="flex flex-col md:min-h-screen relative container mx-auto"}=e,[h,f]=(0,s.useState)([]),y=(0,l.useRouter)(),g=e=>{y.push(e)},x=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),g("/log-in")},p=(0,n.usePathname)();return(0,s.useEffect)(()=>{f(("admin"==r?[{title:"Admin",href:"#!",children:[{key:"manage-database",title:"Manage Database",href:"/extract-metadata"},{key:"manage-users",title:"Manage Users",href:"/manage-users"},{key:"align-model",title:"Align Model",href:"/align-model"},{key:"evaluate-model",title:"Evaluate Model",href:"/evaluate-model"}]},{key:"query-data",title:"Query Data",href:"/query-data"},{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:x}]:r?[{key:"query-data",title:"Query Data",href:"/query-data"},{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:x}]:[]).map(e=>(e.current=e.href==p,e)).map(e=>(e.children&&(e.children=e.children.map(e=>(e.current=e.href==p,e))),e)))},[r]),(0,a.jsxs)("div",{className:(0,c.QP)(m,d),children:[h.length?(0,a.jsx)(o.jq,{rootClassNames:(0,c.QP)("border-b dark:border-dark-border","bg-white dark:bg-dark-bg-primary","text-primary-text dark:text-dark-text-primary"),items:h.map(e=>({...e,classNames:(0,c.QP)(e.classNames,"hover:bg-gray-100 dark:hover:bg-dark-hover",e.current&&"bg-gray-100 dark:bg-dark-hover")}))}):(0,a.jsx)(a.Fragment,{}),(0,a.jsx)("div",{className:u,children:i})]})}},9834:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(8101);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:i="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:r,strokeWidth:c?24*Number(n)/Number(s):n,className:l("lucide",i),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let r=(0,a.forwardRef)((r,o)=>{let{className:c,...i}=r;return(0,a.createElement)(n,{ref:o,iconNode:t,className:l("lucide-".concat(s(e)),c),...i})});return r.displayName="".concat(e),r}},4580:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9834).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1096:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(5105),s=r(6389),l=r(3360),o=r(8101),n=r(4580),c=r(6665);let i=e=>{let{name:t,description:r,columns:s,rows:l}=e,o=s.map(e=>({title:e,dataIndex:e})),n=l.map(e=>e.reduce((e,t,r)=>(e[s[r]]=t,e),{}));return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 italic mt-2 mb-3",children:r}),(0,a.jsx)(c.XI,{columns:o,rows:n})]})},d=e=>{let{link:t,source:r,deleteSource:s}=e,l=(0,o.useMemo)(()=>r.tables.map((e,t)=>{var r;return{name:(null==e?void 0:null===(r=e.name)||void 0===r?void 0:r.replace("imported.",""))||e.name,content:(0,a.jsx)(i,{...e},t)}}),[r]);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:t,className:"text-2xl font-bold",children:r.source_title?r.source_title:t}),(0,a.jsx)(n.A,{className:"ml-auto cursor-pointer",onClick:()=>s(t)})]}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:r.source_summary}),r.tables.length>0&&(0,a.jsx)("h2",{className:"text-xl font-semibold mt-4 mb-4",children:"Imported Tables"}),r.tables.length>0&&(0,a.jsx)(c.tU,{size:"small",tabs:l,defaultSelected:r.tables[0].name}),(0,a.jsx)("hr",{className:"my-4 border-gray-300 dark:border-gray-700"})]},t)};var u=r(4379);let m=(0,r(9834).A)("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);var h=r(3184);let f=()=>{let[e,t]=(0,o.useState)(null),[r,n]=(0,o.useState)([]),[i,f]=(0,o.useState)(""),[y,g]=(0,o.useState)([]),[x,p]=(0,o.useState)(!1),k=(0,o.useContext)(c.oS),v=async e=>{try{var r;let a=await fetch((h.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"")+"/get_db_names",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(!a.ok)throw Error("Failed to get api key names. Check your network?");let s=await a.json();n(s.db_names||[]),t((null===(r=s.db_names)||void 0===r?void 0:r[0])||null)}catch(e){k.error(e.message),console.error(e)}};(0,o.useEffect)(()=>{v(localStorage.getItem("defogToken"))},[]);let N=(0,o.useCallback)(async()=>{if(e)try{let t=localStorage.getItem("defogToken"),r=await fetch((0,u.A)("http","sources/list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,key_name:e})});if(!r.ok){k.error("Failed to get sources");return}let a=await r.json();g(a)}catch(e){k.error(e.message),console.error(e)}},[e,k]);(0,o.useEffect)(()=>{N()},[e,N]);let j=(0,o.useCallback)(async()=>{try{let t=localStorage.getItem("defogToken");if(p(!0),!(await fetch((0,u.A)("http","sources/import"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,key_name:e,links:[i]})})).ok){k.error("Failed to add source");return}k.info("Source added successfully"),f(""),N()}catch(e){k.error("Failed to add source"),console.error(e)}finally{p(!1)}},[e,i,N,k]),b=(0,o.useCallback)(async t=>{try{let r=localStorage.getItem("defogToken");if(!(await fetch((0,u.A)("http","sources/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:r,key_name:e,link:t})})).ok){k.error("Failed to delete source");return}k.info("Source deleted successfully"),N()}catch(e){k.error("Error deleting source"),console.error(e)}},[e,N,k]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.A,{}),(0,a.jsxs)(l.A,{id:"manage-users",userType:"admin",children:[r.length>1&&(0,a.jsx)("div",{className:"w-full mb-4",children:(0,a.jsx)(c.Z,{options:r.map(e=>({value:e,label:e})),value:e,onChange:e=>t(e),placeholder:"Select an API key",rootClassNames:"w-full"})}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-1 mt-5",children:[(0,a.jsx)("h1",{children:(0,a.jsx)(m,{size:48,color:"#1890ff"})}),(0,a.jsx)("h1",{className:"text-3xl mt-4",children:"Manage Sources"})]}),(0,a.jsx)("div",{className:"flex flex-col items-center p-1 mt-4 w-full",children:(0,a.jsxs)("div",{className:"flex items-center w-full px-4 my-2",children:[(0,a.jsx)(c.pd,{value:i,onChange:e=>f(e.target.value),placeholder:"Enter source link here",size:"default",rootClassNames:"flex-grow w-full",inputClassNames:"p-3 border border-gray-300 rounded-lg text-gray-700 focus:outline-none w-full"}),(0,a.jsx)("div",{className:"ml-4",children:x?(0,a.jsx)(c.c5,{classNames:"text-blue-600 w-6 h-6"}):(0,a.jsx)(c.$n,{variant:"primary",onClick:j,children:"Add Source"})})]})}),(0,a.jsx)("div",{className:"flex flex-col p-1 mt-2",children:Object.entries(y).map(e=>{let[t,r]=e;return(0,a.jsx)(d,{link:t,source:r,deleteSource:b},t)})})]})]})}},4379:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(3184);let s=(e,t)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return""!==t?"ws"===e?"".concat((a.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"").replace("http","ws"),"/").concat(t):"".concat(a.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"","/").concat(t):"".concat(a.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"")}}},e=>{var t=t=>e(e.s=t);e.O(0,[328,636,593,792],()=>t(7951)),_N_E=e.O()}]);